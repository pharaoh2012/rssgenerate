
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Johny-zhao/p/18876083" title="发布于 2025-05-14 16:04">
    <span role="heading" aria-level="2">Ubuntu安装部署Zabbix网络监控平台和设备配置添加</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<div class="dad65929">
<div class="_4f9bf79 d7dc56a8 _43c05b5">
<div class="ds-markdown ds-markdown--block">
<p class="ds-markdown-paragraph"><span style="font-size: 1em">概述</span></p>
<p>Zabbix 由 Alexei Vladishev 创建，目前由 Zabbix SIA 主导开发和支持。</p>
<p>Zabbix 是一个企业级的开源分布式监控解决方案。</p>
<p>Zabbix 是一款监控众多参数的网络以及服务器、虚拟机、应用程序、服务、数据库、网站、云等的健康和完整性的软件。Zabbix 使用灵活的通知机制，允许用户为几乎任何事件配置基于电子邮件的告警，以实现对服务器问题做出快速反应。Zabbix 基于存储的数据提供出色的报告和数据可视化功能。这使得 Zabbix 成为容量规划的理想选择。</p>
<p>Zabbix 支持轮询和 trapping。所有 Zabbix 报告和统计数据以及配置参数都可以通过基于 Web 的前端访问。基于 Web 的前端确保可以从任何位置评估您的网络状态和服务器的健康状况。如果配置得当，不管对于拥有少量服务器的小型组织还是拥有大量服务器的大公司来讲，Zabbix 都可以在监控 IT 基础设施方面发挥重要作用。</p>
<p>Zabbix 是免费的。Zabbix 是AGPL-3.0许可证下编写和分发的。这意味着它的源代码是免费分发的，可供公众使用。</p>
<p class="ds-markdown-paragraph">以下是在Ubuntu系统安装Zabbix 7.0并配置全平台监控的详细步骤：</p>
<h3>一、Ubuntu安装Zabbix 7.0</h3>
<div class="md-code-block md-code-block-light">
<pre><span class="token comment"># 1. 更新系统
<span class="token function">sudo <span class="token function">apt update <span class="token operator">&amp;&amp; <span class="token function">sudo <span class="token function">apt upgrade <span class="token parameter variable">-y

<span class="token comment"># 2. 安装必要依赖
<span class="token function">sudo <span class="token function">apt <span class="token function">install <span class="token parameter variable">-y apache2 php php-mysql php-gd php-xml php-bcmath php-mbstring mysql-server

<span class="token comment"># 3. 添加Zabbix仓库
<span class="token function">wget https://repo.zabbix.com/zabbix/7.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_7.0-1+ubuntu22.04_all.deb
<span class="token function">sudo dpkg <span class="token parameter variable">-i zabbix-release_7.0-1+ubuntu22.04_all.deb
<span class="token function">sudo <span class="token function">apt update

<span class="token comment"># 4. 安装Zabbix组件
<span class="token function">sudo <span class="token function">apt <span class="token function">install <span class="token parameter variable">-y zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent

<span class="token comment"># 5. 配置MySQL数据库
<span class="token function">sudo mysql <span class="token parameter variable">-e <span class="token string">"CREATE DATABASE zabbix CHARACTER SET utf8 COLLATE utf8_bin"
<span class="token function">sudo mysql <span class="token parameter variable">-e <span class="token string">"CREATE USER 'zabbix'@'localhost' IDENTIFIED BY 'YourPassword'"
<span class="token function">sudo mysql <span class="token parameter variable">-e <span class="token string">"GRANT ALL PRIVILEGES ON zabbix.* TO 'zabbix'@'localhost'"
<span class="token function">sudo mysql <span class="token parameter variable">-e <span class="token string">"FLUSH PRIVILEGES"

<span class="token comment"># 6. 导入初始数据
zcat /usr/share/zabbix-sql-scripts/mysql/server.sql.gz <span class="token operator">| mysql --default-character-set<span class="token operator">=utf8mb4 <span class="token parameter variable">-uzabbix <span class="token parameter variable">-pYourPassword zabbix

<span class="token comment"># 7. 修改Zabbix配置
<span class="token function">sudo <span class="token function">nano /etc/zabbix/zabbix_server.conf
<span class="token string">'''
<span class="token assign-left variable">DBPassword<span class="token operator">=YourPassword
<span class="token string">'''

<span class="token comment"># 8. 启动服务
<span class="token function">sudo systemctl restart zabbix-server apache2
<span class="token function">sudo systemctl <span class="token builtin class-name">enable zabbix-server apache2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
<p class="ds-markdown-paragraph">通过浏览器访问&nbsp;<code>http://your-server-ip/zabbix</code>&nbsp;完成Web配置向导</p>
<p><img src="https://img2024.cnblogs.com/blog/1184638/202505/1184638-20250514160135682-278281313.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<h3>二、添加Windows服务器监控</h3>
<ol start="1">
<li>
<p class="ds-markdown-paragraph">下载Windows Agent：</p>
<ul>
<li>
<p class="ds-markdown-paragraph">访问&nbsp;<a href="https://www.zabbix.com/download_agents" rel="noopener nofollow" target="_blank">https://www.zabbix.com/download_agents</a></p>
</li>
<li>
<p class="ds-markdown-paragraph">下载最新版Zabbix Agent 2（MSI包）</p>
</li>
</ul>
</li>
<li>
<p class="ds-markdown-paragraph">安装时配置参数：</p>
<div class="md-code-block md-code-block-light">
<pre>Server=zabbix_server_ip
ServerActive=zabbix_server_ip
Hostname=Windows-hostname</pre>
</div>
</li>
<li>
<p class="ds-markdown-paragraph">防火墙放行：</p>
<div class="md-code-block md-code-block-light">
<div class="md-code-block-banner-wrap">
<div class="md-code-block-banner md-code-block-banner-lite">
<div class="_121d384">
<div class="d2a24f03"><span class="d813de27">powershell</span></div>
</div>
</div>
</div>
<pre><span class="token function">New-NetFirewallRule <span class="token operator">-DisplayName <span class="token string">"Zabbix Agent" <span class="token operator">-Direction Inbound <span class="token operator">-Protocol TCP <span class="token operator">-LocalPort 10050 <span class="token operator">-Action Allow</span></span></span></span></span></span></span></pre>
</div>
</li>
<li>
<p class="ds-markdown-paragraph">Zabbix Web操作：</p>
<ul>
<li>
<p class="ds-markdown-paragraph">配置 -&gt; 主机 -&gt; 创建主机</p>
</li>
<li>
<p class="ds-markdown-paragraph">填写主机名称和IP</p>
</li>
<li>
<p class="ds-markdown-paragraph">选择模板：Windows by Zabbix agent</p>
</li>
<li>
<p class="ds-markdown-paragraph">添加Agent接口：10050端口</p>
</li>
</ul>
</li>
</ol>
<h3>三、添加Linux服务器监控</h3>
<div class="md-code-block md-code-block-light">
<pre><span class="token comment"># 在被监控Linux执行：
<span class="token function">sudo <span class="token function">apt <span class="token function">install zabbix-agent2
<span class="token function">sudo <span class="token function">nano /etc/zabbix/zabbix_agent2.conf
<span class="token string">'''
<span class="token assign-left variable">Server<span class="token operator">=zabbix_server_ip
<span class="token assign-left variable">ServerActive<span class="token operator">=zabbix_server_ip
<span class="token assign-left variable">Hostname<span class="token operator">=Linux-hostname
<span class="token string">'''
<span class="token function">sudo systemctl restart zabbix-agent2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
<p class="ds-markdown-paragraph">Zabbix Web添加步骤同Windows，选择模板："Linux by Zabbix agent 2"</p>
<h3>四、网络设备监控配置</h3>
<h4>1. 通用SNMP配置步骤</h4>
<div class="md-code-block md-code-block-light">
<pre><span class="token comment"># Zabbix服务器安装SNMP工具
<span class="token function">sudo <span class="token function">apt <span class="token function">install snmp snmp-mibs-downloader</span></span></span></span></pre>
</div>
<h4>2. 各厂商设备配置（示例）：</h4>
<p class="ds-markdown-paragraph"><strong>思科设备：</strong></p>
<div class="md-code-block md-code-block-light">
<div class="md-code-block-banner-wrap">
<div class="md-code-block-banner md-code-block-banner-lite">
<div class="_121d384">
<div class="d2a24f03"><span class="d813de27">cisco</span></div>
</div>
</div>
</div>
<pre>snmp-server community YourCommunity RO
snmp-server host zabbix_server_ip version 2c YourCommunity</pre>
</div>
<p class="ds-markdown-paragraph"><strong>华为设备：</strong></p>
<div class="md-code-block md-code-block-light">
<div class="md-code-block-banner-wrap">
<div class="md-code-block-banner md-code-block-banner-lite">
<div class="_121d384">
<div class="d2a24f03"><span class="d813de27">huawei</span></div>
</div>
</div>
</div>
<pre>snmp-agent
snmp-agent community read YourCommunity
snmp-agent sys-info version v2c</pre>
</div>
<p class="ds-markdown-paragraph"><strong>华三设备：</strong></p>
<div class="md-code-block md-code-block-light">
<div class="md-code-block-banner-wrap">
<div class="md-code-block-banner md-code-block-banner-lite">
<div class="_121d384">
<div class="d2a24f03"><span class="d813de27">h3c</span></div>
</div>
</div>
</div>
<pre>snmp-agent
snmp-agent community read YourCommunity
snmp-agent sys-info version v2c</pre>
</div>
<p class="ds-markdown-paragraph"><strong>锐捷设备：</strong></p>
<div class="md-code-block md-code-block-light">
<pre>snmp-server community YourCommunity ro
snmp-server host zabbix_server_ip YourCommunity</pre>
</div>
<h4>3. Zabbix添加步骤：</h4>
<ol start="1">
<li>
<p class="ds-markdown-paragraph">创建主机：</p>
<ul>
<li>
<p class="ds-markdown-paragraph">名称：设备名称</p>
</li>
<li>
<p class="ds-markdown-paragraph">接口类型：SNMP</p>
</li>
<li>
<p class="ds-markdown-paragraph">SNMP版本：v2c</p>
</li>
<li>
<p class="ds-markdown-paragraph">SNMP community：YourCommunity</p>
</li>
</ul>
</li>
<li>
<p class="ds-markdown-paragraph">关联模板：</p>
<ul>
<li>
<p class="ds-markdown-paragraph">通用模板：Template SNMP Device</p>
</li>
<li>
<p class="ds-markdown-paragraph">厂商专用模板（需手动导入）：</p>
<ul>
<li>
<p class="ds-markdown-paragraph">Cisco: Template Module SNMP Cisco</p>
</li>
<li>
<p class="ds-markdown-paragraph">Huawei: Template Module SNMP Huawei</p>
</li>
<li>
<p class="ds-markdown-paragraph">其他厂商模板可从Zabbix官网下载</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3>五、日常维护操作</h3>
<ol start="1">
<li>
<p class="ds-markdown-paragraph"><strong>定期备份：</strong></p>
<div class="md-code-block md-code-block-light">
<pre><span class="token comment"># 数据库备份
mysqldump <span class="token parameter variable">-uzabbix <span class="token parameter variable">-pYourPassword zabbix <span class="token operator">| <span class="token function">gzip <span class="token operator">&gt; /backup/zabbix_db_<span class="token variable"><span class="token variable">$(<span class="token function">date +%F<span class="token variable">).sql.gz
<span class="token comment"># 配置文件备份
<span class="token function">tar czf /backup/zabbix_conf_<span class="token variable"><span class="token variable">$(<span class="token function">date +%F<span class="token variable">).tar.gz /etc/zabbix/</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
</li>
<li>
<p class="ds-markdown-paragraph"><strong>日志检查：</strong></p>
<div class="md-code-block md-code-block-light">
<pre><span class="token function">tail <span class="token parameter variable">-f /var/log/zabbix/zabbix_server.log
journalctl <span class="token parameter variable">-u zabbix-server <span class="token parameter variable">-f</span></span></span></span></pre>
</div>
</li>
<li>
<p class="ds-markdown-paragraph"><strong>性能优化：</strong></p>
<ul>
<li>
<p class="ds-markdown-paragraph">调整Housekeeper设置</p>
</li>
<li>
<p class="ds-markdown-paragraph">分区表管理历史数据</p>
</li>
<li>
<p class="ds-markdown-paragraph">增加缓存大小（修改zabbix_server.conf）</p>
</li>
</ul>
</li>
<li>
<p class="ds-markdown-paragraph"><strong>升级流程：</strong></p>
<div class="md-code-block md-code-block-light">
<pre><span class="token function">sudo systemctl stop zabbix-server
<span class="token function">sudo <span class="token function">apt update <span class="token operator">&amp;&amp; <span class="token function">sudo <span class="token function">apt upgrade zabbix*
<span class="token function">sudo zcat /usr/share/zabbix-sql-scripts/mysql/upgrade/6.0.0.0.0.7.0.0.0.0.sql <span class="token operator">| mysql <span class="token parameter variable">-uzabbix <span class="token parameter variable">-p zabbix
<span class="token function">sudo systemctl start zabbix-server</span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
</li>
</ol>
<h3>六、注意事项</h3>
<ol start="1">
<li>
<p class="ds-markdown-paragraph">安全规范：</p>
<ul>
<li>
<p class="ds-markdown-paragraph">禁止使用public作为SNMP community</p>
</li>
<li>
<p class="ds-markdown-paragraph">对Zabbix Web界面启用HTTPS</p>
</li>
<li>
<p class="ds-markdown-paragraph">定期轮换数据库密码</p>
</li>
</ul>
</li>
<li>
<p class="ds-markdown-paragraph">性能建议：</p>
<ul>
<li>
<p class="ds-markdown-paragraph">监控项总数控制在50,000以下</p>
</li>
<li>
<p class="ds-markdown-paragraph">每秒处理值(NVPS)不超过1000</p>
</li>
<li>
<p class="ds-markdown-paragraph">使用Proxy分布式监控</p>
</li>
</ul>
</li>
<li>
<p class="ds-markdown-paragraph">故障排查：</p>
<div class="md-code-block md-code-block-light">
<pre><span class="token comment"># 测试SNMP连通性
snmpwalk <span class="token parameter variable">-v2c <span class="token parameter variable">-c YourCommunity 设备IP sysDescr
<span class="token comment"># 测试Agent连通性
zabbix_get <span class="token parameter variable">-s 客户端IP <span class="token parameter variable">-k system.uname</span></span></span></span></span></span></pre>
</div>
</li>
<li>
<p class="ds-markdown-paragraph">模板管理：</p>
<ul>
<li>
<p class="ds-markdown-paragraph">优先使用官方模板</p>
</li>
<li>
<p class="ds-markdown-paragraph">自定义监控项时使用低发现频率</p>
</li>
<li>
<p class="ds-markdown-paragraph">定期更新模板库</p>
</li>
</ul>
</li>
</ol>
<p class="ds-markdown-paragraph">建议监控拓扑结构：</p>
<div class="md-code-block md-code-block-light">
<pre>[网络设备] --&gt; [Zabbix Server]
       ↑           ↑
[Windows/Linux]--+</pre>
</div>
</div>
<div class="ds-flex">&nbsp;参考zabbix安装资料：https://www.zabbix.com/documentation/7.0/zh/manual</div>
<div class="ds-flex">https://www.zabbix.com/forum/</div>
<div class="ds-flex">https://www.zabbix.com/cn/download?zabbix=7.0&amp;os_distribution=ubuntu&amp;os_version=22.04&amp;components=server_frontend_agent&amp;db=mysql&amp;ws=apache</div>
</div>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.011785473467592593" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-14 16:04">2025-05-14 16:04</span>&nbsp;
<a href="https://www.cnblogs.com/Johny-zhao">Johny_Zhao</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18876083);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18876083', targetLink: 'https://www.cnblogs.com/Johny-zhao/p/18876083', title: 'Ubuntu安装部署Zabbix网络监控平台和设备配置添加' })">举报</a>
</div>
        