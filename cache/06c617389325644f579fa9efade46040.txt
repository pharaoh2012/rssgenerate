
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/kevinarcsin001/p/18864112" title="发布于 2025-05-07 13:59">
    <span role="heading" aria-level="2">beagle 的使用方法和参数信息</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p><strong>一、基本使用场景</strong><br>
<strong>1. 单倍型推断（Phasing）</strong><br>
将未分型的基因型数据（如 VCF/BCF 文件）推断为单倍型。</p>
<pre><code class="language-bash">java -jar beagle.jar \
  gt=input.vcf.gz \       # 输入基因型数据（需bgzip压缩）
  out=phased_output       # 输出文件前缀（自动生成 .vcf.gz 和 .log）
</code></pre>
<p><strong>2. 基因型填充（Imputation）</strong><br>
使用参考面板填充目标数据中的缺失基因型。</p>
<pre><code class="language-bash">java -jar beagle.jar \
  gt=target.vcf.gz \      # 待填充的目标数据
  ref=reference.vcf.gz \  # 参考面板（如千人基因组）
  out=imputed_output      # 输出文件名前缀
</code></pre>
<hr>
<p><strong>二、核心参数说明</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
<th>示例值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gt</code></td>
<td>输入基因型数据（VCF/BCF）</td>
<td><code>gt=data.vcf.gz</code></td>
</tr>
<tr>
<td><code>ref</code></td>
<td>参考面板文件（用于填充）</td>
<td><code>ref=1kgp.vcf.gz</code></td>
</tr>
<tr>
<td><code>out</code></td>
<td>输出文件前缀</td>
<td><code>out=result</code></td>
</tr>
<tr>
<td><code>nthreads</code></td>
<td>使用的CPU线程数</td>
<td><code>nthreads=4</code></td>
</tr>
<tr>
<td><code>window</code></td>
<td>分析窗口大小（cM）</td>
<td><code>window=40</code></td>
</tr>
<tr>
<td><code>impute</code></td>
<td>强制填充缺失基因型</td>
<td><code>impute=true</code></td>
</tr>
<tr>
<td><code>Xmx</code></td>
<td>Java堆内存分配</td>
<td><code>java -Xmx8g -jar beagle.jar ...</code></td>
</tr>
</tbody>
</table>
<hr>
<p><strong>三、进阶使用示例</strong><br>
<strong>1. 使用参考面板和外部遗传图谱</strong></p>
<pre><code class="language-bash">java -jar beagle.jar \
  gt=target.vcf.gz \
  ref=reference.vcf.gz \
  map=genetic_map.b37.txt \  # 遗传图谱文件（染色体位置→cM）
  out=imputed_with_map
</code></pre>
<p><strong>2. 多线程加速（推荐用于大型数据）</strong></p>
<pre><code class="language-bash">java -Xmx16g -jar beagle.jar \  # 分配 16GB 内存
  gt=large_data.vcf.gz \
  nthreads=8 \                  # 使用8个CPU线程
  out=fast_phasing
</code></pre>
<hr>
<p><strong>四、输入文件准备</strong></p>
<ol>
<li>
<p>VCF文件压缩和索引：</p>
<pre><code class="language-bash">bgzip input.vcf           # 压缩为 .vcf.gz
tabix -p vcf input.vcf.gz # 生成索引文件 .tbi
</code></pre>
</li>
<li>
<p>参考面板下载：<br>
• 千人基因组计划参考面板（1KGP）：</p>
<pre><code class="language-bash">wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/
</code></pre>
</li>
</ol>
<hr>
<p><strong>五、输出文件说明</strong><br>
• <code>phased_output.vcf.gz</code>：分型/填充后的结果（bgzip压缩）。</p>
<p>• <code>phased_output.log</code>：运行日志（检查错误和耗时）。</p>
<p>• <code>phased_output.phased.vcf.gz</code>（旧版本可能生成此文件）。</p>
<hr>
<p><strong>六、常见问题</strong><br>
<strong>1. 内存不足（OutOfMemoryError）</strong><br>
增加Java堆内存（如分配32GB）：</p>
<pre><code class="language-bash">java -Xmx32g -jar beagle.jar ...
</code></pre>
<p><strong>2. 输入文件格式错误</strong><br>
• 错误信息：<code>Invalid VCF header</code> 或 <code>Could not read input file</code></p>
<p>• 解决：</p>
<ol>
<li>用 <code>bcftools</code> 验证文件：<pre><code class="language-bash">bcftools view input.vcf.gz
</code></pre>
</li>
<li>确保文件用 <code>bgzip</code>（而非 <code>gzip</code>）压缩。</li>
</ol>
<p><strong>3. 参考面板与目标数据不兼容</strong><br>
• 表现：填充后结果异常或报错。</p>
<p>• 解决：确保参考面板和目标数据的基因组版本一致（如 hg19 vs. hg38）。</p>
<hr>
<p><strong>七、参考资源</strong><br>
• 官方文档：<a href="http://faculty.washington.edu/browning/beagle/beagle_5.4_08Jul22.pdf" target="_blank" rel="noopener nofollow">http://faculty.washington.edu/browning/beagle/beagle_5.4_08Jul22.pdf</a></p>
<p>• 示例数据集：<a href="https://github.com/chrchang/beagle-examples" target="_blank" rel="noopener nofollow">https://github.com/chrchang/beagle-examples</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.01583705435763889" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-07 14:00">2025-05-07 13:59</span>&nbsp;
<a href="https://www.cnblogs.com/kevinarcsin001">Kevinarcsin001</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18864112);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18864112', targetLink: 'https://www.cnblogs.com/kevinarcsin001/p/18864112', title: 'beagle 的使用方法和参数信息' })">举报</a>
</div>
        