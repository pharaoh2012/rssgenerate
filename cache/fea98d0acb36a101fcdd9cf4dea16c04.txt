
	<h1 class="postTitle"><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jqCode/p/18996317" title="发布于 2025-07-21 18:15">
    <span role="heading" aria-level="2">个人封装了一个展示图片、圈选图片获取坐标及截图内容的组件</span>
    

</a>
</h1>
	<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>应项目需求，实现了一个可缩放、拖拽、圈选、标记、定位、获取坐标、截图转base64的功能组件。样例图如下：<br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2686952/202507/2686952-20250721181341585-984790536.png" class="lazyload"><br>
样例代码：<br>
`&lt;!--<br>
imgShow.vue 图片圈选与预览组件</p>
<p>功能说明：</p>
<ul>
<li>支持图片全屏预览、缩放、拖拽、右键圈选矩形区域</li>
<li>圈选区域可多选，支持删除，所有圈选框随缩放/拖拽同步</li>
<li>右侧抽屉展示所有圈选区域的缩略图，点击可居中主图</li>
<li>支持父组件传入初始圈选数据</li>
<li>支持获取所有圈选区域的坐标和base64图片，并通过事件和暴露方法传递给父组件</li>
</ul>
<p>Props：</p>
<ul>
<li>url: String，图片地址</li>
<li>show: Boolean，是否显示组件（v-model:show）</li>
<li>initialRects: Array&lt;{x, y, w, h}&gt;，初始圈选数据，未传则用默认样例</li>
</ul>
<p>Emit事件：</p>
<ul>
<li>update:show (Boolean)：用于v-model:show控制显示/隐藏</li>
<li>rects-data (Array)：点击“获取圈选数据”按钮时，传递所有圈选区域的坐标和base64图片</li>
</ul>
<p>暴露方法（defineExpose）：</p>
<ul>
<li>openViewer(url: string)：打开指定图片</li>
<li>closeViewer()：关闭预览</li>
<li>getRectsData()：获取所有圈选区域的坐标和base64图片，返回值同rects-data事件</li>
</ul>
<p>主要方法说明：</p>
<ul>
<li>getRectsData：获取所有圈选区域的4个顶点坐标（原图坐标，保留2位小数）和base64截图</li>
<li>centerRect(idx)：将指定圈选区域移动到主图中央</li>
<li>removeRect(idx)：删除指定圈选区域</li>
<li>onWheel：鼠标滚轮缩放，支持以鼠标为中心缩放</li>
<li>onCanvasMouseDown/Move/Up：支持左键拖拽和右键圈选</li>
<li>resetZoom：重置为原始大小，不清空圈选<br>
--&gt;<br>
<template><br>
<teleport to="body">  <div v-if="show" class="image-viewer-modal" @click.self="closeViewer">
    <div class="image-viewer-toolbar">
      <span>缩放比例：
        <input class="scale-input" v-model="scaleInput" @blur="onScaleInputChange" @keyup.enter="onScaleInputChange" type="number" min="10" max="1000" step="0.1">%
      </span>
      <span class="img-size">原图尺寸：{{ imgNaturalWidth }} x {{ imgNaturalHeight }}</span>
      <button @click.stop="zoomIn">放大</button>
      <button @click.stop="zoomOut">缩小</button>
      <button @click.stop="resetZoom">原始大小</button>
      <button @click.stop="getRectsData">获取圈选数据</button>
      <button @click.stop="closeViewer">关闭</button>
    </div>
    <canvas ref="canvasRef" class="image-viewer-canvas" @wheel.prevent="onWheel"></canvas>
    <!-- 右侧抽屉 -->
    <div :class="['rect-drawer', { open: drawerOpen }]">
      <div class="drawer-toggle-top" @click.stop="drawerOpen = !drawerOpen">
        <span v-if="drawerOpen">收起&gt;</span>
        <span v-else="">展开&lt;</span>
      </div>
      <div v-if="drawerOpen" class="drawer-content">
        <div v-for="(rect, idx) in imgRects" :key="idx" class="drawer-item">
          <div class="drawer-thumb-wrap">
            <span class="drawer-thumb-index">{{ idx + 1 }}</span>
            <img :src="getRectThumb(rect)" class="drawer-thumb" @click="centerRect(idx)">
          </div>
          <button class="drawer-del" @click.stop="removeRect(idx)">删除</button>
        </div>
      </div>
    </div>
  </div>
</teleport>


</template>



<p>`</p>
</li></ul>
</div>
<div class="clear"></div>

	<div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-21 18:15">2025-07-21 18:15</span>&nbsp;
<a href="https://www.cnblogs.com/jqCode">温华从此不练剑</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18996317);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18996317', targetLink: 'https://www.cnblogs.com/jqCode/p/18996317', title: '个人封装了一个展示图片、圈选图片获取坐标及截图内容的组件' })">举报</a>
</div>
