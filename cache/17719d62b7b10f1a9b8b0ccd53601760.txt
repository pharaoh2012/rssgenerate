
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/zxlh1529/p/18928151" title="å‘å¸ƒäº 2025-06-14 12:11">
    <span role="heading" aria-level="2">å¾®ä¿¡å°ç¨‹åºå®ç°ç”¨æˆ·è¿›è¡Œæ¨å®¢çš„æ³¨å†Œç»‘å®š</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å¾®ä¿¡æ¨å®¢æ³¨å†Œå‚æ•°è§£æuniapp">å¾®ä¿¡æ¨å®¢æ³¨å†Œå‚æ•°è§£æï¼ˆUniAppï¼‰</h1>
<blockquote>
<p>âœ… è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ uniapp å®ç°å°ç¨‹åºå¯¹æ¥æ¨å®¢ç”¨æˆ·æ³¨å†Œï¼Œèšç„¦å¾®ä¿¡ç”Ÿæ€æ¨å®¢ä¸šåŠ¡çš„æ³¨å†Œæµç¨‹è§£æä¸ UniAppï¼Œç»“åˆå®æˆ˜é¿å‘ç»éªŒã€‚</p>
</blockquote>
<hr>
<h2 id="ä¸€æ¥å£å‚æ•°è§£æ">ä¸€ã€æ¥å£å‚æ•°è§£æ</h2>
<p>å…ˆè®©åç«¯è°ƒç”¨å¾®ä¿¡çš„æ¥å£è·å–æ•°æ®ç»™åˆ°å‰ç«¯ï¼Œå¯ä»¥çœ‹å‡ºä»å¾®ä¿¡è¿”å›çš„æ¥å£æ•°æ®ä¸­ï¼Œä»¥ä¸‹å­—æ®µä¸æ³¨å†Œæµç¨‹å¼ºç›¸å…³ï¼š</p>
<pre><code class="language-json">{
  "errcode": 0,
  "errmsg": "ok",
  "bind_status": 0,
  "register_status": 2,
  "bind_business_type": "CreatorApplyments",
  "bind_query_string": "redirect_url=...&amp;is_simple_register=1&amp;is_from_promoter=1"
}
</code></pre>
<table>
<thead>
<tr>
<th>å‚æ•°å­—æ®µ</th>
<th>å®æˆ˜è§£è¯»</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bind_status = 0</code></td>
<td>ç”¨æˆ·æœªç»‘å®šå¾®ä¿¡æ¨å®¢ï¼Œå¿…é¡»ä¸»åŠ¨è§¦å‘ç»‘å®šæµç¨‹ï¼ˆå¦åˆ™æ— æ³•è¿›è¡Œåˆ†ä½£ï¼‰</td>
</tr>
<tr>
<td><code>register_status = 2</code></td>
<td>æ³¨å†Œæµç¨‹æœªå®Œæˆï¼ˆé€šå¸¸æ˜¯æäº¤èµ„æ–™åæœªç¡®è®¤ï¼‰ï¼Œéœ€å®ç°â€œæ–­ç‚¹ç»­æ³¨å†Œâ€</td>
</tr>
<tr>
<td><code>bind_business_type</code></td>
<td>å›ºå®šä¸º <code>CreatorApplyments</code>ï¼Œå¿…é¡»ä¸å¾®ä¿¡å•†åŠ¡åå°é…ç½®ä¸€è‡´</td>
</tr>
<tr>
<td><code>bind_query_string</code></td>
<td>æ§åˆ¶æµç¨‹çš„å…³é”®å­—ç¬¦ä¸²ï¼ˆéœ€ URL è§£ç ï¼‰</td>
</tr>
</tbody>
</table>
<p><strong>bind_query_string æ·±åº¦è§£æï¼š</strong></p>
<ul>
<li><code>redirect_url</code>: æ³¨å†Œå®Œæˆåè·³è½¬é¡µé¢ï¼ˆå¿…é¡»æ˜¯çº¿ä¸Šåœ°å€ï¼Œä¸èƒ½æ˜¯æœ¬åœ°å¼€å‘è·¯å¾„ï¼‰</li>
<li><code>is_simple_register=1</code>: å¼€å¯æç®€æ³¨å†Œæµç¨‹ï¼ˆå‡å°‘æ­¥éª¤ï¼‰</li>
<li><code>is_from_promoter=1</code>: æ ‡è®°æ³¨å†Œæ¥æºä¸ºæ¨å®¢</li>
</ul>
<p>âš ï¸ <strong>é‡ç‚¹æé†’</strong>ï¼šregister_status = 2 æ˜¯æ ¸å¿ƒå…³æ³¨çŠ¶æ€ï¼Œå¿…é¡»å®ç°è‡ªåŠ¨é‡è¯•æœºåˆ¶å’Œ UI æç¤ºé€»è¾‘ã€‚</p>
<hr>
<h2 id="äºŒuniapp-æ³¨å†Œæµç¨‹å®ç°">äºŒã€UniApp æ³¨å†Œæµç¨‹å®ç°</h2>
<h3 id="-å®ç°ç›®æ ‡">ğŸ¯ å®ç°ç›®æ ‡</h3>
<p>é€šè¿‡ <code>wx.openBusinessView</code> å”¤èµ·å¾®ä¿¡å®˜æ–¹æ¨å®¢æ³¨å†Œé¡µï¼Œå¹¶é€šè¿‡è½®è¯¢æ¥å£åˆ¤æ–­æ˜¯å¦æ³¨å†ŒæˆåŠŸã€‚</p>
<h3 id="-ä»£ç å®ç°">ğŸ“¦ ä»£ç å®ç°</h3>
<pre><code class="language-js">// pages/promoter/index.vue
export default {
  methods: {
    // #ifdef MP-WEIXIN
    async startRegistration() {
      const bizType = "CreatorApplyments";
      const queryParams = decodeURIComponent(
        "redirect_url=...&amp;is_simple_register=1&amp;is_from_promoter=1"
      );

      try {
        const res = await wx.openBusinessView({
          businessType: bizType,
          queryString: queryParams,
          extraData: {
            commissionType: 1, // ä»¥å¹³å°åˆ†ä½£ä¸ºä¾‹ï¼Œæ ¹æ®å®é™…éœ€æ±‚æ”¹ 0 æˆ– 1
            commissionRatio: 0, // å‡è®¾åˆ†ä½£ 30%ï¼Œå¹³å°åˆ†ä½£æ—¶æŒ‰éœ€åœ¨ 100000 - 900000 é€‰å€¼
            headSupplierAppid: "appid", // å®é™…æœºæ„ appid æ›¿æ¢è¿™é‡Œ
          },
          success(res) {
            // è°ƒç”¨æˆåŠŸçš„å›è°ƒå¤„ç†ï¼Œæ¯”å¦‚å¤„ç†è¿”å›æ•°æ®ç­‰
            console.log("openBusinessView è°ƒç”¨æˆåŠŸ", res);
          },
          fail(err) {
            // è°ƒç”¨å¤±è´¥çš„å›è°ƒå¤„ç†ï¼Œæ¯”å¦‚æç¤ºç”¨æˆ·å¤±è´¥åŸå› 
            console.error("openBusinessView è°ƒç”¨å¤±è´¥", err);
            uni.showToast({
              title: "æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•",
              icon: "none",
            });
          },
        });

        // æ³¨æ„ï¼šæ­¤å¤„ä»…ä»£è¡¨å”¤èµ·æˆåŠŸï¼Œåç»­å¿…é¡»è½®è¯¢æ³¨å†ŒçŠ¶æ€
        this.checkRegisterResult();
      } catch (e) {
        if (e.errMsg.includes("permission")) {
          this.showToast("æœªå¼€é€šæ¨å®¢æƒé™ï¼Œè¯·è”ç³»è¿è¥äººå‘˜");
        } else if (e.errMsg.includes("queryString")) {
          this.showToast("å‚æ•°æ ¼å¼æœ‰è¯¯ï¼Œè¯·æ£€æŸ¥ URL ç¼–ç ");
        } else {
          this.showToast(`ç³»ç»Ÿç¹å¿™ï¼Œé”™è¯¯ç ï¼š${e.errCode}`);
        }
      }
    },
    // å¯ä»¥ä¸è¦
    async checkRegisterResult() {
      let retryCount = 0;
      const timer = setInterval(async () =&gt; {
        if (retryCount &gt; 5) {
          clearInterval(timer);
          this.showModal("æ³¨å†Œè¶…æ—¶ï¼Œè¯·ç¨åæ‰‹åŠ¨æŸ¥çœ‹æ³¨å†ŒçŠ¶æ€");
          return;
        }

        const { status } = await api.getRegisterStatus();
        if (status === 1) {
          clearInterval(timer);
          uni.redirectTo({ url: "/pages/promoter/success" });
        }

        retryCount++;
      }, 2000);
    },
    // #endif
  },
};
</code></pre>
<h3 id="-é¡µé¢-ui-ç¤ºä¾‹">ğŸ–¼ é¡µé¢ UI ç¤ºä¾‹</h3>
<pre><code class="language-html">&lt;template&gt;
  &lt;view class="promoter-container"&gt;
    &lt;button
      v-if="registerStatus === 0"
      @click="startRegistration"
      class="reg-btn"
    &gt;
      ç«‹å³æˆä¸ºæ¨å®¢
    &lt;/button&gt;

    &lt;view v-else-if="registerStatus === 2" class="continue-box"&gt;
      &lt;text&gt;æ‚¨æœ‰æœªå®Œæˆçš„æ³¨å†Œ&lt;/text&gt;
      &lt;button @click="startRegistration"&gt;ç»§ç»­æ³¨å†Œ&lt;/button&gt;
    &lt;/view&gt;
  &lt;/view&gt;
&lt;/template&gt;
</code></pre>
<hr>
<h2 id="ä¸‰å¤šç«¯å…¼å®¹ç­–ç•¥ä¸è¸©å‘ç»éªŒ">ä¸‰ã€å¤šç«¯å…¼å®¹ç­–ç•¥ä¸è¸©å‘ç»éªŒ</h2>
<table>
<thead>
<tr>
<th>å¹³å°ç±»å‹</th>
<th>æ”¯æŒæ–¹å¼</th>
<th>å®é™…è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¾®ä¿¡å°ç¨‹åº</td>
<td>âœ… <code>wx.openBusinessView</code></td>
<td>å”¯ä¸€å®˜æ–¹æ–¹å¼ï¼Œæ¨èä½¿ç”¨</td>
</tr>
<tr>
<td>H5 ç½‘é¡µ</td>
<td>âš ï¸ åµŒå…¥å¾®ä¿¡å¼€æ”¾å¹³å°æ³¨å†Œé¡µ</td>
<td>éœ€å¼€é€šå¾®ä¿¡å¼€æ”¾å¹³å°æƒé™</td>
</tr>
<tr>
<td>App åŸç”Ÿ</td>
<td>ğŸ˜… æ··åˆè·³è½¬ï¼ˆå°ç¨‹åº + WebViewï¼‰</td>
<td>æ— æ³•ç›´æ¥åŸç”Ÿæ”¯æŒï¼Œéœ€å¼•å¯¼è‡³å°ç¨‹åº</td>
</tr>
</tbody>
</table>
<h3 id="ï¸-é«˜é¢‘é”™è¯¯æ€»ç»“">âš ï¸ é«˜é¢‘é”™è¯¯æ€»ç»“</h3>
<ul>
<li><strong>redirect_url é…ç½®é”™è¯¯</strong>ï¼šåç«¯è°ƒç”¨å¾®ä¿¡æ¥å£åè¿”å›åˆ°å‰ç«¯æ¥å£æ•°æ®ï¼Œåœ¨è°ƒèµ·ä¸åŠ çš„è¯ä¼šè·³åˆ°å…¶ä»–å¾®ä¿¡çš„æ‰©å±•é¡µé¢ï¼Œä¾‹å¦‚å°åº—æ³¨å†Œç­‰ã€‚</li>
<li><strong>å‚æ•°ç¼–ç é—®é¢˜</strong>ï¼šqueryString ä¸­å‚æ•°å¿…é¡»å…ˆ URL ç¼–ç ï¼ŒextraData ä¸­å‚æ•°ä¸èƒ½ç¼–ç ã€‚</li>
<li><strong>æ¥å£æƒé™å»¶è¿Ÿ</strong>ï¼šå¾®ä¿¡å¼€æ”¾æƒé™åä¸€èˆ¬éœ€è¦ç­‰å¾… 2 å°æ—¶æ‰èƒ½ç”Ÿæ•ˆï¼Œæµ‹è¯•å‰åŠ¡å¿…ç¡®è®¤æƒé™ç”Ÿæ•ˆã€‚</li>
</ul>
<hr>
<h2 id="å››å»ºè®®ä¸æ‹“å±•">å››ã€å»ºè®®ä¸æ‹“å±•</h2>
<ul>
<li>âœ… æ³¨å†ŒçŠ¶æ€æŸ¥è¯¢å»ºè®®å‰åç«¯è”åˆå¤„ç†ï¼Œé¿å…è½®è¯¢è¶…æ—¶æµªè´¹èµ„æº</li>
<li>âœ… æä¾›è·³è½¬å‰æç¤ºï¼Œå¢å¼ºç”¨æˆ·æ„ŸçŸ¥ä¸æ“ä½œä¿¡å¿ƒ</li>
<li>âœ… æ³¨å†Œå®Œæˆåè‡ªåŠ¨è·³è½¬æ¨å¹¿å‘˜ä¸“å±é¡µé¢ï¼ˆå¦‚ï¼šæ”¶ç›Šé¡µã€è®¢å•é¡µï¼‰</li>
</ul>
<hr>
<h2 id="äº”å‚è€ƒé“¾æ¥">äº”ã€å‚è€ƒé“¾æ¥</h2>
<ul>
<li><a href="https://developers.weixin.qq.com/doc/store/leagueheadsupplier/API/promotion/sharer/getpromoterregisterandbindstatus.html" target="_blank" rel="noopener nofollow">å¾®ä¿¡æ¨å®¢å¼€æ”¾å¹³å°æ–‡æ¡£</a></li>
<li><a href="https://uniapp.dcloud.io/api/plugins/business-view" target="_blank" rel="noopener nofollow">uniapp å®˜æ–¹æ–‡æ¡£</a></li>
</ul>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-06-14 12:11">2025-06-14 12:11</span>&nbsp;
<a href="https://www.cnblogs.com/zxlh1529">å¹¼å„¿å›­æŠ€æœ¯å®¶</a>&nbsp;
é˜…è¯»(<span id="post_view_count">0</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18928151);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18928151', targetLink: 'https://www.cnblogs.com/zxlh1529/p/18928151', title: 'å¾®ä¿¡å°ç¨‹åºå®ç°ç”¨æˆ·è¿›è¡Œæ¨å®¢çš„æ³¨å†Œç»‘å®š' })">ä¸¾æŠ¥</a>
</div>
        