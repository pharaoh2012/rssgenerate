
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/alt-zhiyu/p/18865918" title="发布于 2025-05-08 11:15">
    <span role="heading" aria-level="2">如何在 Linux 上检查开放的端口并关闭不需要的端口</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p class="js_darkmode__1" data-tool="mdnice编辑器"><span>检查服务器开放端口并关闭不必要的端口是网络安全管理中的关键环节，开放端口如同服务器的“窗口”，若其中存在未被利用或未受保护的端口，就如同为潜在的攻击者敞开了大门，他们可能会利用这些端口的漏洞来入侵系统、窃取数据或进行恶意操作。通过检查开放端口，可以明确哪些端口正在被合法服务使用，哪些可能是被遗忘或未授权的端口，从而及时发现潜在的安全隐患。关闭不必要的端口则能有效减少攻击面，降低服务器被攻击的风险，同时也有助于优化系统性能，避免资源被无效占用，确保服务器的安全、稳定和高效运行。</span></p>
<p class="js_darkmode__2" data-tool="mdnice编辑器"><span>本文介绍如何在本地和远程检查服务器上开放的端口，以及如何关闭它们。</span></p>
<h4 data-tool="mdnice编辑器"><span class="js_darkmode__3"><span><span>1.在本地检查Linux上开放的端口</span></span></span></h4>
<p class="js_darkmode__4" data-tool="mdnice编辑器"><span>所有计算机操作系统（OS）都包含<code class="js_darkmode__5"><span>netstat</span></code><span>命令，用于监控网络连接。</span></span></p>
<p class="js_darkmode__6" data-tool="mdnice编辑器"><span>以下命令使用<code class="js_darkmode__7"><span>netstat</span></code><span>显示使用 TCP 协议的所有监听端口：</span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__0 js_darkmode__8" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__9"><span>[root@monitor ~]<span class="js_darkmode__10"># netstat -lt<br><span>Active Internet connections (only servers)<br><span>Proto Recv-Q Send-Q Local Address &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Foreign Address &nbsp; &nbsp; &nbsp; &nbsp; State<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:ssh &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhost:ipp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhost:smtp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhos:x11-ssh-offset 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhost:6011 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:sunrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 monitor:domain &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 [::]:ssh &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhost:ipp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhost:smtp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhos:x11-ssh-offset [::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhost:6011 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 [::]:sunrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>[root@monitor ~]<span class="js_darkmode__11">#<br></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre>
<p class="js_darkmode__12" data-tool="mdnice编辑器"><strong class="js_darkmode__13">其中：</strong></p>
<ul class="list-paddingleft-1 js_darkmode__14">
<li><span>netstat：调用程序</span></li>
<li><span>-l：列出监听端口</span></li>
<li><span>-t：指定TCP协议</span></li>
</ul>
<p class="js_darkmode__18" data-tool="mdnice编辑器"><span>输出内容以人类友好的方式排列，按列显示<strong class="js_darkmode__19">协议</strong><span>、<strong class="js_darkmode__20">接收</strong><span>和<strong class="js_darkmode__21">发送的数据包</strong><span>、<strong class="js_darkmode__22">本地和远程IP地址</strong><span>以及<strong class="js_darkmode__23">端口状态</strong><span>。</span></span></span></span></span></span></p>
<p class="js_darkmode__24" data-tool="mdnice编辑器"><span>如果将TCP协议替换为UDP，结果只会显示开放端口（至少在Linux上），而不会指定状态。与TCP协议不同，UDP协议是无状态的。</span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__1 js_darkmode__25" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__26"><span>[root@monitor ~]<span class="js_darkmode__27"># netstat -lu<br><span>Active Internet connections (only servers)<br><span>Proto Recv-Q Send-Q Local Address &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Foreign Address &nbsp; &nbsp; &nbsp; &nbsp; State<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 monitor:domain &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:bootps &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:sunrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhost:323 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:824 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:37740 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:mdns &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:*<br><span>udp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 [::]:sunrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [::]:*<br><span>udp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhost:323 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [::]:*<br><span>udp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 [::]:824 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:*<br><span>[root@monitor ~]<span class="js_darkmode__28">#<br></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre>
<p class="js_darkmode__24" data-tool="mdnice编辑器"><span><img src="https://mmbiz.qpic.cn/sz_mmbiz_png/5tMzyFfmcgjO2rzksxuq3bnc7YGb0ic9klh19xq9uvDje7yuzc8KQc0ibxhmGmIczzpb1sjfT9OWSqbeERqw6jIg/640?wx_fmt=png&amp;from=appmsg&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1" alt="图片" class="rich_pages wxw-img js_insertlocalimg" data-imgfileid="100018453" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/5tMzyFfmcgjO2rzksxuq3bnc7YGb0ic9klh19xq9uvDje7yuzc8KQc0ibxhmGmIczzpb1sjfT9OWSqbeERqw6jIg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-original-style="null" data-index="3" data-ratio="0.25" data-w="1192" data-before-load-time="1746673946410" data-report-img-idx="2" data-fail="0"></span></p>
<p class="js_darkmode__29" data-tool="mdnice编辑器"><span>也可以不指定协议，仅使用<code class="js_darkmode__30"><span>-l</span></code><span>或<code class="js_darkmode__31"><span>–listen</span></code><span>选项来获取所有监听端口的信息，无论其使用何种协议：</span></span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__2 js_darkmode__32" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__33"><span>[root@monitor ~]<span class="js_darkmode__34"># netstat --listen<br><span>Active Internet connections (only servers)<br><span>Proto Recv-Q Send-Q Local Address &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Foreign Address &nbsp; &nbsp; &nbsp; &nbsp; State<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:ssh &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhost:ipp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhost:smtp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhost:6011 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:sunrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 monitor:domain &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 [::]:ssh &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhost:ipp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhost:smtp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhost:6011 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>tcp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 [::]:sunrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LISTEN<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 monitor:domain &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:bootps &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:sunrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 localhost:323 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:824 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:37740 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:*<br><span>udp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:mdns &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0:*<br><span>udp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 [::]:sunrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [::]:*<br><span>udp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 localhost:323 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [::]:*<br><span>udp6 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 [::]:824 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:*<br><span>raw6 &nbsp; &nbsp;4608 &nbsp; &nbsp; &nbsp;0 [::]:ipv6-icmp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[::]:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7<br><span>Active UNIX domain sockets (only servers)<br><span>Proto RefCnt Flags &nbsp; &nbsp; &nbsp; Type &nbsp; &nbsp; &nbsp; State &nbsp; &nbsp; &nbsp; &nbsp; I-Node &nbsp; Path<br><span>unix &nbsp;2 &nbsp; &nbsp; &nbsp;[ ACC ] &nbsp; &nbsp; STREAM &nbsp; &nbsp; LISTENING &nbsp; &nbsp; 26821 &nbsp; &nbsp;@/tmp/dbus-VWpRiaqJ<br><span>unix &nbsp;2 &nbsp; &nbsp; &nbsp;[ ACC ] &nbsp; &nbsp; STREAM &nbsp; &nbsp; LISTENING &nbsp; &nbsp; 19199 &nbsp; &nbsp;/var/run/spice-vdagentd/spice-vdagent-sock<br><span>unix &nbsp;2 &nbsp; &nbsp; &nbsp;[ ACC ] &nbsp; &nbsp; STREAM &nbsp; &nbsp; LISTENING &nbsp; &nbsp; 19201 &nbsp; &nbsp;/run/dbus/system_bus_socket<br><span>unix &nbsp;2 &nbsp; &nbsp; &nbsp;[ ACC ] &nbsp; &nbsp; STREAM &nbsp; &nbsp; LISTENING &nbsp; &nbsp; 19204 &nbsp; &nbsp;/var/run/libvirt/virtlockd-sock<br><span>……<br></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre>
<p class="js_darkmode__24" data-tool="mdnice编辑器">&nbsp;</p>
<p class="js_darkmode__35" data-tool="mdnice编辑器"><span>如上，显示了 TCP、UDP和Unix套接字协议的信息。</span></p>
<p class="js_darkmode__36" data-tool="mdnice编辑器"><span>前面所有示例都展示了如何显示没有建立连接的监听端口信息。以下命令展示了如何显示监听端口和已建立的连接：</span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__3 js_darkmode__37" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__38"><span>netstat -vatn<br></span></code></span></pre>
<p class="js_darkmode__24" data-tool="mdnice编辑器">&nbsp;</p>
<p class="js_darkmode__39" data-tool="mdnice编辑器"><span><span>其中：</span></span></p>
<ul class="list-paddingleft-1 js_darkmode__40">
<li><span>netstat：调用程序</span></li>
<li><span>-v：详细信息</span></li>
<li><span>-a：显示活动连接</span></li>
<li><span>-t：显示TCP连接</span></li>
<li><span><span>-n：以数字形式显示端口<br></span></span>
<p class="js_darkmode__46" data-tool="mdnice编辑器"><em class="js_darkmode__47"><strong class="js_darkmode__48"># 实例：假设现在系统中发现了一个可疑进程，想要检查与之关联的端口。</strong></em></p>
<p class="js_darkmode__49" data-tool="mdnice编辑器"><span>根据这个问题，我们可以使用<code class="js_darkmode__50"><span>lsof</span></code><span>命令，该命令用于列出与进程相关联的打开文件。</span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__4 js_darkmode__51" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__52"><span>lsof -i 4 -a -p &lt;进程数字&gt;<br></span></code></span></pre>
<p class="js_darkmode__53" data-tool="mdnice编辑器"><span>比如，现在要检查进程&nbsp;<code class="js_darkmode__54"><span>1593</span></code><span>：</span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__5 js_darkmode__55" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__56"><span>[root@monitor ~]<span class="js_darkmode__57"># lsof -i 4 -a -p 1593<br><span>COMMAND &nbsp;PID USER &nbsp; FD &nbsp; TYPE DEVICE SIZE/OFF NODE NAME<br><span>master &nbsp;1593 root &nbsp; 13u &nbsp;IPv4 &nbsp;29723 &nbsp; &nbsp; &nbsp;0t0 &nbsp;TCP localhost:smtp (LISTEN)<br></span></span></span></span></code></span></pre>
<p class="js_darkmode__58" data-tool="mdnice编辑器"><strong class="js_darkmode__59">其中</strong><span>：</span></p>
<ul class="list-paddingleft-1 js_darkmode__60">
<li><span>lsof：调用程序</span></li>
<li><span>-i：列出与互联网交互的文件，选项4表示仅打印IPv4，选项6可用于IPv6。</span></li>
<li><span>-a：指示输出结果进行逻辑与操作</span></li>
<li><span>-p：指定要检查的进程的PID编号</span></li>
</ul>
<p class="js_darkmode__65" data-tool="mdnice编辑器"><span>正如前面所看到的，该进程与监听的SMTP端口相关联。</span></p>
<h4 data-tool="mdnice编辑器"><span class="js_darkmode__66"><span><span>2.远程检查 linux 上的开放的端口</span></span></span></h4>
<p class="js_darkmode__67" data-tool="mdnice编辑器"><span>如果想要检测远程系统的端口，最常用的工具是<strong class="js_darkmode__68">Nmap</strong><span>（网络映射器）。下面对远程服务器&nbsp;<code class="js_darkmode__69"><span>haopython.com</span></code><span>&nbsp;进行端口扫描：</span></span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__6 js_darkmode__70" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__71"><span>nmap www.haopython.com<br></span></code></span></pre>
<p class="js_darkmode__72" data-tool="mdnice编辑器"><span>输出分为 3 列，分别显示端口、端口状态和在端口后面侦听的服务：</span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__7 js_darkmode__73" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__74"><span>[root@monitor ~]<span class="js_darkmode__75"># nmap www.haopython.com<br><br><span>Starting Nmap 6.40 ( http://nmap.org ) at 2025-05-08 10:03 CST<br><span>Nmap scan report&nbsp;for<span>&nbsp;www.haopython.com (147.94.44.183)<br><span>Host is up (0.022s latency).<br><span>Not shown: 994 filtered ports<br><span>PORT &nbsp; &nbsp; STATE SERVICE<br><span>22/tcp &nbsp; open &nbsp;ssh<br><span>80/tcp &nbsp; open &nbsp;http<br><span>443/tcp &nbsp;open &nbsp;https<br><span>888/tcp &nbsp;open &nbsp;accessbuilder<br><span>3306/tcp open &nbsp;mysql<br><span>8888/tcp open &nbsp;sun-answerbook<br><br><span>Nmap&nbsp;done<span>: 1 IP address (1 host up) scanned&nbsp;in<span>&nbsp;9.97 seconds<br><span>[root@monitor ~]<span class="js_darkmode__76">#<br></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre>
<p class="js_darkmode__77" data-tool="mdnice编辑器"><span>默认情况下，Nmap仅扫描最常用的1000个端口。如果要Nmap扫描所有端口，则添加下面参数并运行：</span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__8 js_darkmode__78" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__79"><span>nmap -p- www.haopython.com<br></span></code></span></pre>
<h4 data-tool="mdnice编辑器"><span class="js_darkmode__80"><span><span>3.在CentOS 8上移除httpd服务</span></span></span></h4>
<p class="js_darkmode__81" data-tool="mdnice编辑器"><span>为确保服务器的安全，除了防火墙规则以保持端口被阻止外，还建议删除不必要的服务。</span></p>
<p class="js_darkmode__82" data-tool="mdnice编辑器"><span>下面举例删除CentOS 8上已经安装且不提供服务的<code class="js_darkmode__83"><span>httpd</span></code><span>服务。</span></span></p>
<p class="js_darkmode__84" data-tool="mdnice编辑器"><strong class="js_darkmode__85">1）确认服务状态</strong></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__9 js_darkmode__86" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__87"><span>systemctl status httpd<br></span></code></span></pre>
<p class="js_darkmode__88" data-tool="mdnice编辑器"><strong class="js_darkmode__89">2）停止服务并禁用自动启动</strong></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__10 js_darkmode__90" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__91"><span>systemctl stop httpd<br><span>systemctl&nbsp;disable<span>&nbsp;httpd<br></span></span></span></code></span></pre>
<p class="js_darkmode__92" data-tool="mdnice编辑器"><strong class="js_darkmode__93">3）移除服务</strong></p>
<p class="js_darkmode__94" data-tool="mdnice编辑器"><span>使用&nbsp;<code class="js_darkmode__95"><span>yum</span></code><span>&nbsp;或&nbsp;<code class="js_darkmode__96"><span>dnf</span></code><span>（CentOS 8 默认使用&nbsp;<code class="js_darkmode__97"><span>dnf</span></code><span>）来移除&nbsp;<code class="js_darkmode__98"><span>httpd</span></code><span>&nbsp;服务及其相关文件：</span></span></span></span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__11 js_darkmode__99" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__100"><span>dnf remove httpd<br></span></code></span></pre>
<p class="js_darkmode__101" data-tool="mdnice编辑器"><strong class="js_darkmode__102">4）验证移除结果</strong></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__12 js_darkmode__103" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__104"><span>dnf list installed | grep httpd<br></span></code></span></pre>
<p class="js_darkmode__105" data-tool="mdnice编辑器"><span>如果没有输出，说明&nbsp;<code class="js_darkmode__106"><span>httpd</span></code><span>&nbsp;服务及其相关文件已被成功移除。</span></span></p>
<p class="js_darkmode__107" data-tool="mdnice编辑器"><span>通过以上步骤，成功移除了 CentOS 8 系统中不再需要的&nbsp;<code class="js_darkmode__108"><span>httpd</span></code><span>&nbsp;服务，减少了系统资源的占用，同时也降低了因未使用服务可能带来的安全风险。</span></span></p>
<h4 data-tool="mdnice编辑器"><span class="js_darkmode__109"><span><span>4.使用 UFW 关闭 Linux 上的开放的端口</span></span></span></h4>
<p class="js_darkmode__110" data-tool="mdnice编辑器"><span>如果我们发现有不需要开放的端口，最简单的解决方案是使用UFW（简单防火墙）将其关闭，某些Linux 系统可能需要先安装UFW。</span></p>
<p class="js_darkmode__111" data-tool="mdnice编辑器"><span>关闭端口有两种方式，一种是使用<code class="js_darkmode__112"><span>deny</span></code><span>选项，另一种是使用<code class="js_darkmode__113"><span>reject</span></code><span>选项，两者的区别在于<code class="js_darkmode__114"><span>reject</span></code><span>指令会告知另一端连接已被拒绝。</span></span></span></span></p>
<p class="js_darkmode__115" data-tool="mdnice编辑器"><span>要使用<code class="js_darkmode__116"><span>deny</span></code><span>&nbsp;规则阻止<code class="js_darkmode__117"><span>22</span></code><span>端口，则运行：</span></span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__13 js_darkmode__118" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__119"><span>ufw deny 22<br></span></code></span></pre>
<p class="js_darkmode__120" data-tool="mdnice编辑器"><span>要使用&nbsp;<code class="js_darkmode__121"><span>reject</span></code><span>&nbsp;规则阻止&nbsp;<code class="js_darkmode__122"><span>22</span></code><span>端口，请运行：</span></span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__14 js_darkmode__123" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__124"><span>ufw reject 22<br></span></code></span></pre>
<h4 data-tool="mdnice编辑器"><span class="js_darkmode__125"><span><span>5.使用 iptables 关闭 Linux 上的开放的端口</span></span></span></h4>
<p class="js_darkmode__126" data-tool="mdnice编辑器"><span>虽然 UFW 是管理端口的最简单方法，但它是 Iptables 的前端。</span></p>
<p class="js_darkmode__127" data-tool="mdnice编辑器"><span>以下示例显示如何使用 iptables 拒绝与端口&nbsp;<code class="js_darkmode__128"><span>22</span></code><span>&nbsp;的连接：</span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__15 js_darkmode__129" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__130"><span>iptables -I INPUT -p tcp --dport 22 -j REJECT<br></span></code></span></pre>
<p class="js_darkmode__131" data-tool="mdnice编辑器"><span>上述规则表示拒绝所有目标端口（dport）为&nbsp;<code class="js_darkmode__132"><span>22</span></code><span>&nbsp;的TCP传入（INPUT）连接。被拒绝后，源端将被告知连接已被拒绝。</span></span></p>
<p class="js_darkmode__133" data-tool="mdnice编辑器"><span>下面规则只是丢弃所有数据包，而不通知源连接被拒绝：</span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__16 js_darkmode__134" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__135"><span>iptables -A INPUT -p tcp --dport 22 -j DROP<br></span></code></span></pre>
<h4 data-tool="mdnice编辑器"><span class="js_darkmode__136"><span><span>6.使用firewalld在Linux上关闭开放的端口</span></span></span></h4>
<p class="js_darkmode__137" data-tool="mdnice编辑器"><span>确保 firewalld 防火墙已经运行，假设现在想关闭端口<code class="js_darkmode__138"><span>80/tcp</span></code><span>，可以使用以下命令：</span></span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__17 js_darkmode__139" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__140"><span>firewall-cmd --zone=public --remove-port=80/tcp --permanent<br></span></code></span></pre>
<p class="js_darkmode__141" data-tool="mdnice编辑器"><span>然后重新加载：</span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__18 js_darkmode__142" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__143"><span>firewall-cmd --reload<br></span></code></span></pre>
<p class="js_darkmode__144" data-tool="mdnice编辑器"><span>最后确认端口是否已关闭：</span></p>
<pre data-tool="mdnice编辑器"><span class="js_darkmode__bg__19 js_darkmode__145" data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/Hp9HAaP9GFASN9NRuriaWeTkbPib7MjXfkomjOCWkD5pPnmNT3e7VkYNLNnGzgMKlpuuA90v9cI75cLhmunL5RSPFWsZQEFEEf/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code class="js_darkmode__146"><span>firewall-cmd --list-all</span></code></span></pre>
</li>
</ul>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.21237793851041667" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-08 11:16">2025-05-08 11:15</span>&nbsp;
<a href="https://www.cnblogs.com/alt-zhiyu">Alt_致郁</a>&nbsp;
阅读(<span id="post_view_count">93</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18865918);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18865918', targetLink: 'https://www.cnblogs.com/alt-zhiyu/p/18865918', title: '如何在 Linux 上检查开放的端口并关闭不需要的端口' })">举报</a>
</div>
        