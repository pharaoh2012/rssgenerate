
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/baoshu/p/18641764/finclip_rag_doc_qa" title="发布于 2024-12-30 17:10">
    <span role="heading" aria-level="2">RAG实践 - AI 知识库问答功能的建设</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>最近在工作中构建了一套自动的基于文档中心为数据集构建知识库 AI 问答的系统，来提升用户体验和技术支持效率，分享一下在实现过程中的技术选型和架构设计。</p>
<h2 id="背景">背景</h2>
<p>先说下背景，我们公司的产品 <a href="https://finclip.com/" target="_blank" rel="noopener nofollow">FinClip</a> 是做小程序全套解决方案的，因为产品属性的原因，接入的过程中主要是面向开发者的，会有很多的开发相关的问题。我们有一个文档中心 <a href="https://finclip.com/mop/document/" target="_blank" rel="noopener nofollow">https://finclip.com/mop/document/</a> ，里面几乎存储了我们大部分的面向客户开发的文档。</p>
<p>所以在构建知识库问答的时候，我们有以下的数据源</p>
<ol>
<li>文档中心的文档 <a href="https://finclip.com/mop/document/" target="_blank" rel="noopener nofollow">https://finclip.com/mop/document/</a></li>
<li>在社区交付过程中，交付整理的问题 QA</li>
<li>售前和销售在和客户阐述方案的时候，腾讯会议纪要</li>
</ol>
<p>在构建知识库的时候，希望的采用的是「自动化数据集」为主 &amp; 「手动数据集」为辅的策略。将文档中心 &amp; 腾讯会议纪要两部分打通自动化设置数据集的流程，剩余的交付整理的 QA 文档作为手动数据集为补充。</p>
<h2 id="实现效果">实现效果</h2>
<p>实现效果侧还是还对比较简单，对于用户而言在我们的管理后台实现了一个聊天框，能够回答整个系统内的基本所有的问题，只要数据集有涉及到的<br>
<img src="https://img2024.cnblogs.com/blog/1664266/202412/1664266-20241230171721578-868676702.png" alt="" loading="lazy"></p>
<h2 id="整体架构设计">整体架构设计</h2>
<p><img src="https://img2024.cnblogs.com/blog/1664266/202412/1664266-20241230171736524-40618804.png" alt="" loading="lazy"></p>
<p>整个基于 RAG 实现的AI 问答的链路，主要包含以下几个核心部分：</p>
<ul>
<li><strong>文档中心Gitlab仓库</strong>：基于 Gitlab 管理所有技术文档
<ul>
<li><strong>CI Pipeline</strong>：在文档中心的文档负责文档更新的自动化处理流程</li>
</ul>
</li>
<li><strong>LLM Service</strong>：大语言模型服务层，负责文档理解和问答生成，此处会针对源文档进行一次 QA 的拆分</li>
<li><strong>FastGPT</strong>：向量数据库和知识检索服务</li>
<li><strong>用户交互层</strong>：提供统一的问答接口</li>
</ul>
<p>这种设计带来几个明显优势：</p>
<ol>
<li>文档更新自动化，确保知识库实时性</li>
<li>服务解耦，便于独立扩展和维护</li>
<li>分层处理提升系统可靠性</li>
</ol>
<h2 id="文档处理流程">文档处理流程</h2>
<p>文档处理是整个系统的基础，我们的处理流程如下：</p>
<ol>
<li><strong>文档变更触发</strong>：通过 Gitlab CI 监听文档更新</li>
<li><strong>自动化处理</strong>：CI Pipeline 自动执行以下步骤：
<ul>
<li>检测文档增量更新</li>
<li>提取文档内容</li>
<li>进行 QA 拆分，生成问答对</li>
<li>推送到知识库</li>
</ul>
</li>
</ol>
<p>这个流程确保了知识库能够及时反映最新的文档内容，无需人工干预。</p>
<h2 id="知识库技术选型">知识库技术选型</h2>
<p>在知识库方案选型时，我们主要对比了 FastGPT 和 RAGFlow：</p>
<h3 id="fastgpt-的优势">FastGPT 的优势：</h3>
<ul>
<li>开箱即用的向量检索能力</li>
<li>良好的社区支持</li>
<li>简单的部署维护</li>
<li>内置的文本分块策略</li>
</ul>
<h3 id="embedding-和-rerank">Embedding 和 Rerank</h3>
<p>我们的向量检索策略采用：</p>
<ol>
<li>使用 embedding 模型将文本转换为向量</li>
<li>通过 ReRank 优化搜索结果相关性</li>
<li>动态调整检索阈值，平衡召回率和精确度</li>
</ol>
<p>最终的流程图如下</p>
<p><img src="https://img2024.cnblogs.com/blog/1664266/202412/1664266-20241230171959978-1467724689.png" alt="" loading="lazy"></p>
<h2 id="ai-问答实现">AI 问答实现</h2>
<p>问答系统的核心流程：</p>
<ol>
<li>
<p><strong>知识检索</strong>：</p>
<ul>
<li>用户提问向量化</li>
<li>在知识库中检索相关内容</li>
<li>通过 Rerank 筛选最相关片段</li>
</ul>
</li>
<li>
<p><strong>答案生成</strong>：</p>
<ul>
<li>将检索内容作为上下文</li>
<li>通过 LLM 生成自然、准确的回答</li>
<li>添加引用来源，提升可信度</li>
</ul>
</li>
<li>
<p><strong>质量保证</strong>：</p>
<ul>
<li>答案相关性评分</li>
<li>兜底策略处理</li>
<li>用户反馈收集</li>
</ul>
</li>
</ol>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.03355738110300926" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2024-12-30 17:28">2024-12-30 17:10</span>&nbsp;
<a href="https://www.cnblogs.com/baoshu">宝树呐</a>&nbsp;
阅读(<span id="post_view_count">40</span>)&nbsp;
评论(<span id="post_comment_count">1</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18641764" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18641764);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18641764', targetLink: 'https://www.cnblogs.com/baoshu/p/18641764/finclip_rag_doc_qa', title: 'RAG实践 - AI 知识库问答功能的建设' })">举报</a>
</div>
        