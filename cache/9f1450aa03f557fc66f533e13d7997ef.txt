
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xiao987334176/p/18864140" title="发布于 2025-05-07 16:00">
    <span role="heading" aria-level="2">windows11 安装WSL2详细过程</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h1>一、什么是 WSL 2</h1>
<p>时间来到 2017 年，事情正在起变化。微软正式发布了「适用于 Linux 的 Windows 子系统」，即人们熟知的 Windows Subsystem for Linux，简称 WSL。<br>在 2019 年，微软又基于 Hyper-V 架构的部分功能，推出了全新的 WSL 2。它能够在一个高度优化的虚拟化中运行完整的 Linux 内核。</p>
<h2>WSL 2 的系统要求</h2>
<p>WSL 2 使用了 Hyper-V 架构的一部分功能，但对 Windows 11 的版本并没有限制。家庭版、教育版、专业版和企业版都可以安装。<br>除了x86_64架构外，WSL 2 也支持ARM处理器。但要在基于 ARM 的设备上运行，所使用的 Linux 系统也必须是 ARM 版本。<br>如果你使用的虚拟机软件支持嵌套虚拟化，WSL 2 也可以在虚拟机中的 Windows 上运行。</p>
<h2>为什么要安装WSL 2</h2>
<p>AI大模型本地运行是需要显卡的，如果你需要对AI模型进行微调，必须是Linux系统，Windows系统是不行的。</p>
<p>为什么？因为微调涉及到的一些组件，Windows无法运行，只能是Linux系统才行。</p>
<p>虽然window有运行AI大模型的软件，比如大家熟悉的‌Ollama，LM Studio。这些只是能运行大模型而已，想要微调是不可能的。</p>
<p>&nbsp;</p>
<p>我尝试安装过VirtualBox、VMware Workstation。使用这些虚拟化软件安装ubuntu系统，但是加载英伟达显卡有问题，不是很理想。</p>
<p>经过几天的尝试，在Windows系统中，想要通过ubuntu系统加载英伟达显卡，最好的方案就是WSL 2，能完美加载英伟达显卡。</p>
<p>&nbsp;</p>
<p><span style="color: rgba(255, 0, 0, 1)"><strong>注意：window11家庭版也是可以运行WSL 2，网上说什么必须要升级到专业版，都是扯淡的。</strong></span></p>
<p>一般我们购买的游戏笔记本电脑，默认都是Windows11家庭版，没必要升级到专业版，还得购买激活码，太麻烦了。</p>
<h1>二、安装 WSL 2</h1>
<h2>启用 WSL 和虚拟机平台功能</h2>
<p>打开cmd窗口，运行以下2个命令</p>
<div class="cnblogs_code">
<pre>dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /<span style="color: rgba(0, 0, 0, 1)">norestart
dism.exe </span>/online /enable-feature /featurename:VirtualMachinePlatform /all /norestart</pre>
</div>
<p><span style="color: rgba(255, 0, 0, 1)"><strong>注意：运行过程比较漫长，大概15分钟左右，请耐心等待。</strong></span></p>
<p>运行完成后，效果如下：</p>
<div class="cnblogs_code">
<pre>PS C:\WINDOWS\system32&gt; dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /<span style="color: rgba(0, 0, 0, 1)">norestart

部署映像服务和管理工具
版本: </span><span style="color: rgba(128, 0, 128, 1)">10.0</span>.<span style="color: rgba(128, 0, 128, 1)">26100.1150</span><span style="color: rgba(0, 0, 0, 1)">

映像版本: </span><span style="color: rgba(128, 0, 128, 1)">10.0</span>.<span style="color: rgba(128, 0, 128, 1)">26100.3775</span><span style="color: rgba(0, 0, 0, 1)">

启用一个或多个功能
[</span>==========================<span style="color: rgba(128, 0, 128, 1)">100.0</span>%==========================<span style="color: rgba(0, 0, 0, 1)">]
操作成功完成。
PS C:\WINDOWS\system32</span>&gt; dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /<span style="color: rgba(0, 0, 0, 1)">norestart

部署映像服务和管理工具
版本: </span><span style="color: rgba(128, 0, 128, 1)">10.0</span>.<span style="color: rgba(128, 0, 128, 1)">26100.1150</span><span style="color: rgba(0, 0, 0, 1)">

映像版本: </span><span style="color: rgba(128, 0, 128, 1)">10.0</span>.<span style="color: rgba(128, 0, 128, 1)">26100.3775</span><span style="color: rgba(0, 0, 0, 1)">

启用一个或多个功能
[</span>==========================<span style="color: rgba(128, 0, 128, 1)">100.0</span>%==========================<span style="color: rgba(0, 0, 0, 1)">]
操作成功完成。</span></pre>
</div>
<p><span style="color: rgba(255, 0, 0, 1)"><strong>提示操作成功之后，必须要重启电脑。</strong></span></p>
<p>&nbsp;</p>
<h2>更新wsl</h2>
<p>自带的wsl更新命令，会非常慢。为了加快速度，直接从github里面下载最新版本。</p>
<p><a href="https://github.com/microsoft/WSL/releases" target="_blank" rel="noopener nofollow">https://github.com/microsoft/WSL/releases</a></p>
<p>使用迅雷下载</p>
<p><img src="https://img2024.cnblogs.com/blog/1341090/202505/1341090-20250507144138275-1301524998.png" alt="" loading="lazy"></p>
<p>&nbsp;下载完成后，直接双击安装，下一步，下一步即可。</p>
<h2>设置版本</h2>
<p>以管理员身份打开Powershell，输入命令</p>
<div class="cnblogs_code">
<pre>wsl --set-default-version <span style="color: rgba(128, 0, 128, 1)">2</span></pre>
</div>
<h1>三、WSL2运行ubuntu系统</h1>
<p>使用自带的命令在线安装ubuntu系统，会特别的慢。</p>
<p>这里直接下载ubuntu镜像文件</p>
<p><a href="https://learn.microsoft.com/en-us/windows/wsl/install-manual#downloading-distributions" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/windows/wsl/install-manual#downloading-distributions</a></p>
<p>下载最新版本24.04，开启迅雷下载，速度飞快。</p>
<p><img src="https://img2024.cnblogs.com/blog/1341090/202505/1341090-20250507144949043-1282875312.png" alt="" loading="lazy"></p>
<p>下载完成后，会得到文件Ubuntu2404-240425.AppxBundle</p>
<p>将文件名，重命名为Ubuntu2404-240425.zip，不用担心文件会损坏，改成zip就是为了方便解压而已。</p>
<p>解压之后，得到文件夹Ubuntu2404-240425</p>
<p>进入文件夹，找到文件Ubuntu_2404.0.5.0_x64.appx，重命名为：Ubuntu_2404.0.5.0_x64.zip，然后解压。</p>
<p>得到文件夹Ubuntu_2404.0.5.0_x64</p>
<p>将文件夹复制到D盘，因为你的C盘空间，可能会不太够，只要是一个空间比较的大磁盘即可。</p>
<p>进入文件夹D:\Ubuntu_2404.0.5.0_x64，你会看到一个ubuntu2404.exe，直接双击即可</p>
<p><img src="https://img2024.cnblogs.com/blog/1341090/202505/1341090-20250507145852093-1560862957.png" alt="" loading="lazy"></p>
<p>&nbsp;运行之后，会提示输入用户名和密码</p>
<p><img src="https://img2024.cnblogs.com/blog/1341090/202505/1341090-20250507150046834-629198822.png" alt="" loading="lazy"></p>
<p><span style="color: rgba(255, 0, 0, 1)"><strong>注意：这里的用户，就是管理员，使用你的名字中文拼音或者英文名都行，密码随意。</strong></span>当然，和root用户，不是一个级别的。</p>
<p>&nbsp;</p>
<p>登录成功之后，使用以下命令，切换到root用户</p>
<div class="cnblogs_code">
<pre>$ <span style="color: rgba(255, 0, 0, 1)">sudo su</span><span style="color: rgba(0, 0, 0, 1)"><span style="color: rgba(255, 0, 0, 1)"> root</span>
[</span><span style="color: rgba(0, 0, 255, 1)">sudo</span>] password <span style="color: rgba(0, 0, 255, 1)">for</span><span style="color: rgba(0, 0, 0, 1)"> xiao:
root@DESKTOP</span>-1SGUH22:/home/xiao# <span style="color: rgba(255, 0, 0, 1)">whoami</span><span style="color: rgba(0, 0, 0, 1)">
root
root@DESKTOP</span>-1SGUH22:/home/xiao#</pre>
</div>
<p>&nbsp;</p>
<p>安装组件net-tools，openssh-server</p>
<div class="cnblogs_code">
<pre>apt-get <span style="color: rgba(0, 0, 255, 1)">install</span> -y net-tools openssh-server</pre>
</div>
<p>查看ip地址</p>
<div class="cnblogs_code">
<pre># <span style="color: rgba(255, 0, 0, 1)">ifconfig</span><span style="color: rgba(0, 0, 0, 1)">
eth0: flags</span>=<span style="color: rgba(128, 0, 128, 1)">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span style="color: rgba(128, 0, 128, 1)">1500</span><span style="color: rgba(0, 0, 0, 1)">
        inet </span><span style="color: rgba(128, 0, 128, 1)">172.28</span>.<span style="color: rgba(128, 0, 128, 1)">255.140</span>  netmask <span style="color: rgba(128, 0, 128, 1)">255.255</span>.<span style="color: rgba(128, 0, 128, 1)">240.0</span>  broadcast <span style="color: rgba(128, 0, 128, 1)">172.28</span>.<span style="color: rgba(128, 0, 128, 1)">255.255</span><span style="color: rgba(0, 0, 0, 1)">
        inet6 fe80::</span><span style="color: rgba(128, 0, 128, 1)">215</span>:5dff:fe47:b74c  prefixlen <span style="color: rgba(128, 0, 128, 1)">64</span>  scopeid <span style="color: rgba(128, 0, 128, 1)">0x20</span>&lt;link&gt;<span style="color: rgba(0, 0, 0, 1)">
        ether </span><span style="color: rgba(128, 0, 128, 1)">00</span>:<span style="color: rgba(128, 0, 128, 1)">15</span>:5d:<span style="color: rgba(128, 0, 128, 1)">47</span>:b7:4c  txqueuelen <span style="color: rgba(128, 0, 128, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">  (Ethernet)
        RX packets </span><span style="color: rgba(128, 0, 128, 1)">2712288</span>  bytes <span style="color: rgba(128, 0, 128, 1)">4101955783</span> (<span style="color: rgba(128, 0, 128, 1)">4.1</span><span style="color: rgba(0, 0, 0, 1)"> GB)
        RX errors </span><span style="color: rgba(128, 0, 128, 1)">0</span>  dropped <span style="color: rgba(128, 0, 128, 1)">0</span>  overruns <span style="color: rgba(128, 0, 128, 1)">0</span>  frame <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">
        TX packets </span><span style="color: rgba(128, 0, 128, 1)">275004</span>  bytes <span style="color: rgba(128, 0, 128, 1)">21708764</span> (<span style="color: rgba(128, 0, 128, 1)">21.7</span><span style="color: rgba(0, 0, 0, 1)"> MB)
        TX errors </span><span style="color: rgba(128, 0, 128, 1)">0</span>  dropped <span style="color: rgba(128, 0, 128, 1)">0</span> overruns <span style="color: rgba(128, 0, 128, 1)">0</span>  carrier <span style="color: rgba(128, 0, 128, 1)">0</span>  collisions <span style="color: rgba(128, 0, 128, 1)">0</span></pre>
</div>
<p>注意：这个ip，Windows11是可以直接通讯的。所以你使用xshell客户端，也是可以连接的。</p>
<p>&nbsp;</p>
<h1>四、安装英伟达显卡驱动</h1>
<p>我的游戏本，英伟达显卡型号是，NVIDIA GeForce RTX 5080 Laptop GPU，显存有16GB</p>
<p>内存有64GB，已经顶级配置了，因为主板最大只能支持64GB</p>
<p>固态硬盘2TB，也接近顶级了，因为主板只有2个硬盘插槽。</p>
<p>cpu是Intel Core i9 14900HX，是英特尔移动端性能比较高的cpu。</p>
<h2>CUDA Toolkit</h2>
<p>CUDA Toolkit 是NVIDIA 提供的一套开发工具，它包含了用于开发CUDA 应用程序所需的各种工具，如编译器、调试器和库。 因此，CUDA 和CUDA Toolkit 是有关系的，CUDA 是并行计算平台和编程模型，而CUDA Toolkit 是一套开发工具。</p>
<p>&nbsp;</p>
<p>如果你想在 WSL 中使用 CUDA Toolkit，可以按照以下步骤进行安装：<br>1. 在 NVIDIA 官网找到与你的显卡和驱动程序兼容的 CUDA Toolkit 版本。</p>
<p><br>2. 在 WSL 的 Ubuntu 终端中安装 CUDA Toolkit。例如，安装 CUDA Toolkit 12.8：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">wget</span> https:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-wsl-ubuntu.pin</span>
<span style="color: rgba(0, 0, 255, 1)">sudo</span> <span style="color: rgba(0, 0, 255, 1)">mv</span> cuda-wsl-ubuntu.pin /etc/apt/preferences.d/cuda-repository-pin-<span style="color: rgba(128, 0, 128, 1)">600</span>
<span style="color: rgba(0, 0, 255, 1)">wget</span> https:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">developer.download.nvidia.com/compute/cuda/12.8.0/local_installers/cuda-repo-wsl-ubuntu-12-8-local_12.8.0-1_amd64.deb</span>
<span style="color: rgba(0, 0, 255, 1)">sudo</span> dpkg -i cuda-repo-wsl-ubuntu-<span style="color: rgba(128, 0, 128, 1)">12</span>-<span style="color: rgba(128, 0, 128, 1)">8</span>-local_12.<span style="color: rgba(128, 0, 128, 1)">8.0</span>-<span style="color: rgba(0, 0, 0, 1)">1_amd64.deb
</span><span style="color: rgba(0, 0, 255, 1)">sudo</span> <span style="color: rgba(0, 0, 255, 1)">cp</span> /var/cuda-repo-wsl-ubuntu-<span style="color: rgba(128, 0, 128, 1)">12</span>-<span style="color: rgba(128, 0, 128, 1)">8</span>-local/cuda-*-keyring.gpg /usr/share/keyrings/
<span style="color: rgba(0, 0, 255, 1)">sudo</span> apt-<span style="color: rgba(0, 0, 0, 1)">get update
</span><span style="color: rgba(0, 0, 255, 1)">sudo</span> apt-get -y <span style="color: rgba(0, 0, 255, 1)">install</span> cuda-toolkit-<span style="color: rgba(128, 0, 128, 1)">12</span>-<span style="color: rgba(128, 0, 128, 1)">8</span></pre>
</div>
<p>&nbsp;</p>
<p>3. 将 CUDA 工具链添加到环境变量中：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">echo</span> <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">export PATH=/usr/local/cuda/bin:$PATH</span><span style="color: rgba(128, 0, 0, 1)">'</span> &gt;&gt; ~/<span style="color: rgba(0, 0, 0, 1)">.bashrc
</span><span style="color: rgba(0, 0, 255, 1)">echo</span> <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH</span><span style="color: rgba(128, 0, 0, 1)">'</span> &gt;&gt; ~/<span style="color: rgba(0, 0, 0, 1)">.bashrc
source </span>~/.bashrc</pre>
</div>
<p>&nbsp;</p>
<p>4. 验证 CUDA Toolkit<br>运行以下命令验证 CUDA Toolkit 是否安装成功：</p>
<div class="cnblogs_code">
<pre># <span style="color: rgba(255, 0, 0, 1)">nvcc -</span><span style="color: rgba(0, 0, 0, 1)"><span style="color: rgba(255, 0, 0, 1)">V</span>
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) </span><span style="color: rgba(128, 0, 128, 1)">2005</span>-<span style="color: rgba(128, 0, 128, 1)">2025</span><span style="color: rgba(0, 0, 0, 1)"> NVIDIA Corporation
Built on Wed_Jan_15_19:</span><span style="color: rgba(128, 0, 128, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">:09_PST_2025
Cuda compilation tools, release </span><span style="color: rgba(128, 0, 128, 1)">12.8</span>, V12.<span style="color: rgba(128, 0, 128, 1)">8.61</span><span style="color: rgba(0, 0, 0, 1)">
Build cuda_12.</span><span style="color: rgba(128, 0, 128, 1)">8</span>.r12.<span style="color: rgba(128, 0, 128, 1)">8</span>/compiler.35404655_0</pre>
</div>
<p>&nbsp;</p>
<h2>NVIDIA 驱动程序</h2>
<p>在 WSL 的 Ubuntu 终端中运行以下命令，安装与你的显卡兼容的 NVIDIA 驱动程序。例如，安装最新的驱动程序版本：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">sudo</span> apt <span style="color: rgba(0, 0, 255, 1)">install</span> nvidia-utils-<span style="color: rgba(128, 0, 128, 1)">570</span>-server</pre>
</div>
<p>安装完成后，运行以下命令验证 NVIDIA 驱动程序是否正确安装：</p>
<div class="cnblogs_code">
<pre>nvidia-smi</pre>
</div>
<p>效果如下：</p>
<div class="cnblogs_code">
<pre># nvidia-<span style="color: rgba(0, 0, 0, 1)">smi
Wed May  </span><span style="color: rgba(128, 0, 128, 1)">7</span> <span style="color: rgba(128, 0, 128, 1)">15</span>:<span style="color: rgba(128, 0, 128, 1)">19</span>:<span style="color: rgba(128, 0, 128, 1)">11</span> <span style="color: rgba(128, 0, 128, 1)">2025</span>
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI <span style="color: rgba(128, 0, 128, 1)">570.133</span>.<span style="color: rgba(128, 0, 128, 1)">20</span>             Driver Version: <span style="color: rgba(128, 0, 128, 1)">576.28</span>         CUDA Version: <span style="color: rgba(128, 0, 128, 1)">12.9</span>     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   <span style="color: rgba(128, 0, 128, 1)">0</span>  NVIDIA GeForce RTX <span style="color: rgba(128, 0, 128, 1)">5080</span> ...    On  |   <span style="color: rgba(128, 0, 128, 1)">00000000</span>:<span style="color: rgba(128, 0, 128, 1)">01</span>:<span style="color: rgba(128, 0, 128, 1)">00.0</span>  On |                  N/A |
| N/A   45C    P5             28W /  100W |    1870MiB /  16303MiB |      <span style="color: rgba(128, 0, 128, 1)">5</span>%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+</pre>
</div>
<p>可以看到显卡NVIDIA GeForce RTX 5080，显存为16303MiB，也就是16GB</p>
<p>&nbsp;</p>
<h1>五、WSL文件管理</h1>
<p>Ubuntu运行成功之后，可以看到一个小企鹅图标，点击进去</p>
<p><img src="https://img2024.cnblogs.com/blog/1341090/202505/1341090-20250507152212205-1929823353.png" alt="" loading="lazy"></p>
<p>&nbsp;这里可以看到Linux文件</p>
<p><img src="https://img2024.cnblogs.com/blog/1341090/202505/1341090-20250507152309896-1371778542.png" alt="" loading="lazy"></p>
<p><span style="color: rgba(255, 0, 0, 1)"><strong>注意：某些目录是不允许访问的。</strong></span></p>
<p>如果你需要上传文件，可以上传到tmp目录，是可以的。</p>
<p>你也可以通过xftp工具进行上传也没问题。</p>
<p>&nbsp;</p>
<p>进入本地目录，D:\Ubuntu_2404.0.5.0_x64，可以看到文件ext4.vhdx</p>
<p><img src="https://img2024.cnblogs.com/blog/1341090/202505/1341090-20250507152716225-530392344.png" alt="" loading="lazy"></p>
<p>上面展示的Linux文件系统的文件，都在这个硬盘文件里面，目前有18.6GB。</p>
<p>之后产生的所有文件，都在这里。</p>
<p>&nbsp;</p>
<p><strong><span style="color: rgba(255, 0, 0, 1)">最后说明一下，WSL官方是不建议在生产环境中使用的，因为不稳定。</span></strong></p>
<p>当然，我在使用过程中，也确实遇到了卡死情况。卡死了，怎么办？直接把cmd窗口关闭即可。</p>
<p>想要再次启动，直接运行D:\Ubuntu_2404.0.5.0_x64里面的ubuntu2404.exe文件即可。</p>
<p>&nbsp;</p>
<p>WSL可以本地运行ubuntu系统，方便我们学习AI模型微调。在真正的生产环境中，是用Ubuntu服务器，直接加载服务器级别的显卡进行运算的。</p>
<p>当然，显卡价格是贵的离谱，一般都是公司买单。几十万，上百万的都有。</p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.018179474780092592" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-07 16:01">2025-05-07 16:00</span>&nbsp;
<a href="https://www.cnblogs.com/xiao987334176">肖祥</a>&nbsp;
阅读(<span id="post_view_count">12</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18864140);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18864140', targetLink: 'https://www.cnblogs.com/xiao987334176/p/18864140', title: 'windows11 安装WSL2详细过程' })">举报</a>
</div>
        