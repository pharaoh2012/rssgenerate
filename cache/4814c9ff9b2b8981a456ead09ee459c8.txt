
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xiao987334176/p/18809253" title="发布于 2025-04-04 18:05">
    <span role="heading" aria-level="2">ubuntu 22.04安装docker</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h1>一、安装</h1>
<p>更新软件包索引：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">sudo</span> apt-get update</pre>
</div>
<p>&nbsp;</p>
<p>允许APT使用HTTPS：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">sudo</span> apt-get <span style="color: rgba(0, 0, 255, 1)">install</span> -y apt-transport-https ca-certificates curl software-properties-common</pre>
</div>
<p>&nbsp;</p>
<p>添加Docker官方GPG密钥：</p>
<div class="cnblogs_code">
<pre>curl -fsSL https:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span></pre>
</div>
<p>&nbsp;</p>
<p>添加Docker的稳定版本仓库：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">echo</span> <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable</span><span style="color: rgba(128, 0, 0, 1)">"</span> | <span style="color: rgba(0, 0, 255, 1)">sudo</span> <span style="color: rgba(0, 0, 255, 1)">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/<span style="color: rgba(0, 0, 255, 1)">null</span></pre>
</div>
<p>&nbsp;</p>
<p>再次更新软件包索引：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">sudo</span> apt-get update</pre>
</div>
<p>&nbsp;</p>
<p>安装Docker CE（社区版）：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">sudo</span> apt-get <span style="color: rgba(0, 0, 255, 1)">install</span> -y docker-ce</pre>
</div>
<p>查看版本</p>
<div class="cnblogs_code">
<pre># docker <span style="color: rgba(0, 0, 255, 1)">info</span><span style="color: rgba(0, 0, 0, 1)">
Client: Docker Engine </span>-<span style="color: rgba(0, 0, 0, 1)"> Community
 Version:    </span><span style="color: rgba(128, 0, 128, 1)">28.0</span>.<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">
 Context:    default
 Debug Mode: </span><span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">
...</span></pre>
</div>
<p>&nbsp;</p>
<h1>二、修改配置</h1>
<p>创建docker数据目录</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">mkdir</span> -p /data/docker</pre>
</div>
<p>&nbsp;</p>
<p>创建文件</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">vi</span> /etc/docker/daemon.json</pre>
</div>
<p>内容如下：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 0, 1)">{
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">registry-mirrors</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">: [
        </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">https://docker.1ms.run</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
        </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">https://docker.xuanyuan.me</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
    ],
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">log-driver</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">json-file</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">log-opts</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">: {
        </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">max-size</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">50m</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
        </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">max-file</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
    },
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">data-root</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">/data/docker</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">insecure-registries</span><span style="color: rgba(128, 0, 0, 1)">"</span>: [<span style="color: rgba(128, 0, 0, 1)">"mirrors.aliyun.com</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">]
}</span></pre>
</div>
<p>参数解释：</p>
<p>registry-mirrors: 配置镜像加速器，加快镜像拉取速度。<span style="color: rgba(255, 0, 0, 1)"><strong>由于dockerhub镜像无法直接下载，这里提供了国内加速器，可以直接下载镜像，非常方便。</strong></span><br>log-driver 和 log-opts: 控制容器日志的存储和管理。<strong><span style="color: rgba(255, 0, 0, 1)">这个非常有必要，docker长期运行就产生大量的日志，导致磁盘占满。</span></strong><br>data-root: 更改 Docker 数据的存储路径。<strong><span style="color: rgba(255, 0, 0, 1)">主要是为了将目录改为数据磁盘所在的目录，因为那块硬盘空间大。</span></strong><br>insecure-registries: 允许连接不安全的注册表。<strong><span style="color: rgba(255, 0, 0, 1)">主要是配置私有仓库的，比如：harbor</span></strong></p>
<p>&nbsp;</p>
<p>重启docker</p>
<div class="cnblogs_code">
<pre>systemctl restart docker</pre>
</div>
<p>&nbsp;</p>
<p>设置开机自启动</p>
<div class="cnblogs_code">
<pre>systemctl enable docker</pre>
</div>
<p>&nbsp;</p>
<p>测试下载dockerhub镜像</p>
<div class="cnblogs_code">
<pre>docker pull nginx:latest</pre>
</div>
<p>能成功下载，说明加速器设置好了。</p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.007921934681712962" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-04-04 18:05">2025-04-04 18:05</span>&nbsp;
<a href="https://www.cnblogs.com/xiao987334176">肖祥</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18809253" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18809253);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18809253', targetLink: 'https://www.cnblogs.com/xiao987334176/p/18809253', title: 'ubuntu 22.04安装docker' })">举报</a>
</div>
        