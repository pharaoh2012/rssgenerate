
<table cellspacing="0" cellpadding="0"><tbody><tr><td class="t_f" id="postmessage_53750688">
<i class="pstatus"> 本帖最后由 352667284 于 2025-8-27 10:33 编辑 </i><br>
<br>
<font size="4">最近在折腾某个程序A，假如这个程序设定了必须连接ip为<i>aa.aa.aa.aa</i>的<i>101,202,303</i>端口，但是我希望程序A去连接<i>bb.bb.bb.bb</i>的的<i>101,202,303</i>端口，于是我这么做：</font><br>
<font size="4"><br>
</font><br>
<font size="5">一、新建虚拟网卡</font><br>
<font size="4"><br>
</font><br>
<font size="4">1.设备管理器-添加过时硬件-安装我手动从列表选择的硬件（高级）-网络适配器-等一会左边选Microsoft-右边选Microsoft Loopback Adapter-完成</font><br>
<font size="4"><br>
</font><br>
<font size="4">2.改虚拟网卡ip为</font><font size="4"><i>aa.aa.aa.aa</i></font><br>
<font size="4"><br>
</font><br>
<font size="5">二、端口转发</font><br>
<font size="4"><br>
</font><br>
<font size="4">新建txt</font><br>
<font size="4"><br>
</font><br>
<font size="4">粘入以下代码</font><br>
<br>
<font size="4">netsh interface portproxy add v4tov4 listenaddress=</font><font size="4"><font color="#ff0000">aa.aa.aa.aa</font></font><font size="4"> listenport=<font color="#ff0000">101</font> connectaddress=</font><font size="4"><font color="#ff0000">bb.bb.bb.bb</font></font><font size="4"> connectport=<font color="#ff0000">101</font></font><br>
<font size="4"><br>
</font><br>
<font size="4">netsh interface portproxy add v4tov4 </font><font size="4">listenaddress=</font><font size="4"><font color="#ff0000">aa.aa.aa.aa</font> </font><font size="4">listenport=<font color="#ff0000">202</font> connectaddress=</font><font size="4"><font color="#ff0000">bb.bb.bb.bb</font></font><font size="4"> connectport=<font color="#ff0000">202</font></font><br>
<font size="4"><br>
</font><br>
<font size="4">netsh interface portproxy add v4tov4 </font><font size="4">listenaddress=</font><font size="4"><font color="#ff0000">aa.aa.aa.aa</font> </font><font size="4">listenport=<font color="#ff0000">303</font> connectaddress=</font><font size="4"><font color="#ff0000">bb.bb.bb.bb</font></font><font size="4"> connectport=<font color="#ff0000">303</font></font><br>
<font size="4"><br>
</font><br>
<font size="4">netsh interface portproxy show all</font><br>
<font size="4"><br>
</font><br>
<font size="4">pause</font><br>
<font size="4"><br>
</font><br>
<font size="4">改.txt为.bat右键以管理员权限运行。</font><br>
<font size="4"><br>
</font><br>
<font size="4">#</font><font size="4">listenaddress=程序A设定</font><font size="4">必须的连接ip，如例子中的</font><font size="4"><i>aa.aa.aa.aa</i> ，可以留空，留空既拦截所有ip；</font><br>
<font size="4">listenport=</font><font size="4">程序A设定</font><font size="4">必须连接ip的端口，如例子中的<i>101,202,303</i>；</font><font size="4"><br>
</font><br>
<font size="4">connectaddress=你希望程序A连接的ip，</font><font size="4">如例子中的<i>bb.bb.bb.bb</i>,</font><font size="4">通过测试也可以是域名；</font><br>
<font size="4">connectport=</font><font size="4">你希望程序A</font><font size="4">连接的ip（或者域名）端口，</font><font size="4">如例子中的<i>101,202,303</i>。</font><br>
<font size="4"><br>
</font><br>
<font size="4">其实也可以用</font><font size="4">https://www.52pojie.cn/forum.php?mod=viewthread&amp;tid=1994331&amp;highlight=%B6%CB%BF%DA%D7%AA%B7%A2</font><font size="4">这个帖子里的软件，</font><br>
<font size="4">这个软件功能更全面，可以ipv4转ipv6，也可以用来查看建立的ip端口转发规则，和删除、重置已建立规则，</font><br>
<font size="4">但是如果转发的ip和端口多的话要一个一个敲，我是直接改了bat后双击运行的。</font><br>
<font size="4"><br>
</font><br>
<font size="4"><br>
</font><br>
<font size="5">三、关闭防火墙或者建立入站出站新规则（重中之重，我踩坑的地方）</font><br>
<br>
<font size="4">假如你是win7这一步也可以关闭windows防火墙实现，但还是建议在控制面板-windows防火墙中，高级设置中新建出入站规则放行</font><font size="4">放行例子中的<i>101,202,303</i>端口。</font><br>
<font size="4">假如你是win7这一步也可以关闭windows防火墙实现，但还是建议在控制面板-windows防火墙中，高级设置中新建出入站规则放行</font><font size="4">放行例子中的<i>101,202,303</i>端口。</font><br>
<font size="4">假如你是win7这一步也可以关闭windows防火墙实现，但还是建议在控制面板-windows防火墙中，高级设置中新建出入站规则放行</font><font size="4">放行例子中的<i>101,202,303</i>端口。</font><br>
<font size="4"><br>
</font><br>
<font size="4">因为：</font><br>
<br>
<font size="4"><br>
</font><br>
<font size="4">就是因为第一次是在win7机子上操作的，直接关闭了windows防火墙，实现了ip端口转发功能，然后在win10和win11中测试总是不成功，发现即使关闭了win10和win11的防火墙，依然转发不了，</font><br>
<font size="4">必须</font><font size="4">新建出入站规则放行</font><font size="4">放行例子中的<i>101,202,303</i>端口。</font><br>
<font size="4">必须</font><font size="4">新建出入站规则放行</font><font size="4">放行例子中的<i>101,202,303</i>端口。</font><br>
<font size="4">必须</font><font size="4">新建出入站规则放行</font><font size="4">放行例子中的<i>101,202,303</i>端口。</font><br>
<font size="4"><br>
</font><br>
<font size="4">四、最后</font><br>
<font size="4">例子中的ip：<i>aa.aa.aa.aa、bb.bb.bb.bb</i>，端口：<i>101,202,303</i>，按照你遇到的情况对应替换即可，</font><br>
<font size="4"><br>
</font><br>
<font size="4">一句话总结，程序A你要连接哪个ip端口，我就新建个虚拟网卡设定为哪个ip端口，然后通过</font><font size="4">netsh命令监听这个ip端口并转发到我希望的IP端口。</font><br>
<font size="4"><br>
</font><br>
<font size="4">本文仅为记录和经验分享。</font><br>
<font size="4"><br>
</font><br>
<font size="4"><br>
</font><br>
<br>
<br>
</td></tr></tbody></table>


