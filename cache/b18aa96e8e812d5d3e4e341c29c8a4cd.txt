
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/data-analytics/p/18874386" title="å‘å¸ƒäº 2025-05-13 15:43">
    <span role="heading" aria-level="2">ã€SQLå‘¨å‘¨ç»ƒã€‘ä¸€åƒæ¡æ•°æ®éœ€è¦åšä¸€å¤©ï¼Œæ€ä¹ˆç”¨ SQL å¤„ç†ç”µè¡¨æ•°æ®ï¼ˆå¦‚ä½•åŠ¨æ€æ„é€ è‡ªç„¶æœˆï¼‰</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3640949/202505/3640949-20250513154135545-2094420927.png" alt="ã€SQLå‘¨å‘¨ç»ƒã€‘ä¸€åƒæ¡æ•°æ®éœ€è¦åšä¸€å¤©ï¼Œæ€ä¹ˆç”¨ SQL å¤„ç†ç”µè¡¨æ•°æ®ï¼ˆå¦‚ä½•åŠ¨æ€æ„é€ è‡ªç„¶æœˆï¼‰" class="desc_img">
        é¢˜ç›®æ¥è‡ªäºæŸä½å‘å¸–äººåœ¨æŸ Excel è®ºå›çš„æ±‚åŠ©ï¼Œä»–éœ€è¦å°†ç”µè¡¨ç¼´è´¹æ•°æ®æŒ‰ç…§ç¼´è´¹åŒºé—´æ‹†å¼€åå†æŒ‰æœˆä»½æ±‡æ€»ã€‚å½“æ—¶ç”¨æ‰‹å·¥å¤„ç†æ•°æ®ï¼Œè‡ªç§°ä¸€åƒæ¡æ•°æ®å°±éœ€è¦å¤„ç†ä¸€å¤©ã€‚æˆ‘å°†è¿™ä¸ªé—®é¢˜è½¬åŒ–ä¸º SQL é¢˜ç›®ã€‚
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯â€œè’‹ç‚¹æ•°åˆ†â€ï¼Œå¤šå¹´ä»¥æ¥ä¸€ç›´ä»äº‹æ•°æ®åˆ†æå·¥ä½œã€‚ä»ä»Šå¤©å¼€å§‹ï¼Œä¸å¤§å®¶æŒç»­åˆ†äº«å…³äºæ•°æ®åˆ†æçš„å­¦ä¹ å†…å®¹ã€‚</p>
<p>æœ¬æ–‡æ˜¯ç¬¬ 6 ç¯‡ï¼Œä¹Ÿæ˜¯ã€SQL å‘¨å‘¨ç»ƒã€‘ç³»åˆ—çš„ç¬¬ 5 ç¯‡ã€‚è¯¥ç³»åˆ—æ˜¯æŒ‘é€‰æˆ–è‡ªåˆ›å…·æœ‰ä¸€äº›éš¾åº¦çš„ SQL é¢˜ç›®ï¼Œä¸€å‘¨è‡³å°‘æ›´æ–°ä¸€ç¯‡ã€‚åç»­åˆ›ä½œçš„å†…å®¹ï¼Œåˆæ­¥è§„åˆ’çš„æ–¹å‘åŒ…æ‹¬ï¼š</p>
<h2 id="åç»­å†…å®¹è§„åˆ’">åç»­å†…å®¹è§„åˆ’</h2>
<p>1.åˆ©ç”¨ <strong>Streamlit</strong> å®ç° <code>Hive å…ƒæ•°æ®å±•ç¤º</code>ã€<code>SQL ç¼–è¾‘å™¨</code>ã€ ç»“åˆ<code>Docker æ²™ç®±å®ç°æ•°æ®åˆ†æ Agent</code><br>
2.æ—¶é—´åºåˆ—å¼‚å¸¸è¯†åˆ«ã€å¼‚åŠ¨å½’å› ç®—æ³•<br>
3.ç•™å­˜ç‡æ‹Ÿåˆã€é¢„æµ‹ã€å»ºæ¨¡<br>
4.å­¦ä¹  <code>AB å®éªŒ</code>ã€å¤æ‚å®éªŒè®¾è®¡ç­‰<br>
5.<code>è‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ </code>ã€è‡ªåŠ¨åŒ–ç‰¹å¾å·¥ç¨‹<br>
6.<code>å› æœæ¨æ–­</code>å­¦ä¹ <br>
7. â€¦â€¦</p>
<p><strong>æ¬¢è¿å…³æ³¨</strong>ï¼Œä¸€èµ·å­¦ä¹ ã€‚</p>
<h2 id="ç¬¬-5-æœŸé¢˜ç›®">ç¬¬ 5 æœŸé¢˜ç›®</h2>
<p>é¢˜ç›®æ¥æºï¼šæ”¹ç¼–é¢˜ç›®ï¼Œåœ¨æŸ Excel è®ºå›çœ‹åˆ°çš„ï¼›æ±‚åŠ©å¸Œæœ›ä½¿ç”¨ VBA å¤„ç†ï¼ˆæ±‚åŠ©è€…è‡ªç§°æ‰‹å·¥å¤„ç†ï¼Œä¸Šåƒæ¡æ•°æ®å°±éœ€è¦åšä¸€å¤©ï¼‰ã€‚æˆ‘å‚ç…§ä»–çš„æ•°æ®æ ¼å¼æ”¹ç¼–ä¸º SQL é¢˜ç›®ï¼ˆæˆ‘çš„æ•°æ®å®Œå…¨ç”±è‡ªå·±æ¨¡æ‹Ÿç”Ÿæˆï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨æ±‚åŠ©è€…çš„æ•°æ®ï¼‰</p>
<h3 id="ä¸€é¢˜ç›®ä»‹ç»">ä¸€ã€é¢˜ç›®ä»‹ç»</h3>
<p>æœ‰ä¸€å¼ è®°å½•äº†ç”µè¡¨ç¼´è´¹æ•°æ®çš„è¡¨ï¼Œç¼´è´¹çš„æ—¶é—´é—´éš”æ˜¯ä¸å›ºå®šçš„ã€‚é¢†å¯¼å¸Œæœ›å°†è¿™å¼ è¡¨é‡æ–°æ‹†è§£æŒ‰ç…§æœˆä»½æ¥æ±‡æ€»ï¼Œåˆ†ææ¯æœˆçš„æ—¥å‡ä½¿ç”¨ç”µé‡ç­‰ç­‰ã€‚æ±‚åŠ©è€…çš„åŸå§‹æ•°æ®è¿˜æœ‰ç«™ç‚¹ç¼–ç ã€ç”µè¡¨å·ã€ä¾›ç”µç±»å‹ç­‰ç­‰ï¼Œæˆ‘è¿™é‡Œå°†é—®é¢˜ç®€åŒ–ï¼Œçœç•¥è¿™äº›ä¿¡æ¯ï¼Œå°±å‡è®¾åªæœ‰ä¸€ä¸ªç”µè¡¨ã€‚</p>
<p>æ³¨ï¼šåªæœ‰ç¼´è´¹åŒºé—´çš„æ€»ç”µé‡ï¼Œæ²¡æœ‰æ¯æ—¥ç”µé‡ï¼›åˆ©ç”¨å¹³å‡å€¼æ‹†åˆ†åˆ°æ¯å¤©å†æ ¹æ®ä¸åŒåŒºé—´æ±‡æ€»åˆ°è‡ªç„¶æœˆã€‚é’ˆå¯¹æœ€å¼€å§‹çš„æ—¥æœŸå’Œç»“æŸæ—¥æœŸï¼Œå¦‚æœä¸æ»¡æ•´æœˆï¼Œå°±æŒ‰ç…§å®é™…å­˜åœ¨çš„æ—¥æœŸåŒºé—´æ¥è®¡ç®—ï¼ˆæ—¶é—´ç»´åº¦æŒ‰æ—¥æ¥å¤„ç†ï¼Œä¸è€ƒè™‘å°æ—¶ç­‰æ›´ç²¾ç»†çš„çº§åˆ« | æ±‚åŠ©è€…ç»™çš„æ•°æ®ä¹Ÿæ˜¯ç²¾ç¡®åˆ°æ—¥æœŸè€Œä¸æ˜¯å°æ—¶ï¼‰</p>
<table>
<thead>
<tr>
<th>åˆ—å</th>
<th>æ•°æ®ç±»å‹</th>
<th>æ³¨é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>period_start</td>
<td>string</td>
<td>ç¼´è´¹åŒºé—´å¼€å§‹æ—¥æœŸ</td>
</tr>
<tr>
<td>period_end</td>
<td>string</td>
<td>ç¼´è´¹åŒºé—´ç»“æŸæ—¥æœŸ</td>
</tr>
<tr>
<td>electricity_usage</td>
<td>int</td>
<td>è¿™æ®µåŒºé—´ä½¿ç”¨çš„ç”µé‡</td>
</tr>
<tr>
<td>daily_electricity_usage</td>
<td>int</td>
<td>è¿™æ®µåŒºé—´çš„æ—¥å¹³å‡ç”µé‡<br>ï¼ˆæœ¬åº”è¯¥è®¾ç½®ä¸ºæµ®ç‚¹ç±»å‹ï¼Œä½†æ˜¯æˆ‘ç”¨æ•´æ•°ç”Ÿæˆçš„ï¼‰<br>è¿™å­—æ®µæœ¬æ¥ä¹Ÿæ²¡å¿…è¦å­˜åœ¨ï¼Œåªä¸è¿‡çœå¾—åœ¨ SQL å†ç®—ä¸€é</td>
</tr>
<tr>
<td>period</td>
<td>int</td>
<td>è¿™æ®µæ—¥æœŸæœ‰å‡ å¤©ï¼ˆæ²¡å•¥ç”¨ï¼Œæˆ‘ç”Ÿæˆæ•°æ®åäºŒæ¬¡æ ¡éªŒç”¨çš„ï¼‰</td>
</tr>
</tbody>
</table>
<p>éƒ¨åˆ†æ ·ä¾‹æ•°æ®ï¼ˆå®Œæ•´ç”Ÿæˆé€»è¾‘å‚è§ç¬¬ä¸‰èŠ‚ï¼‰</p>
<table>
<thead>
<tr>
<th>period_start</th>
<th>period_end</th>
<th>electricity_usage</th>
<th>daily_electricity_usage</th>
<th>period</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-12-01</td>
<td>2023-12-30</td>
<td>14700</td>
<td>490</td>
<td>30</td>
</tr>
<tr>
<td>2023-12-31</td>
<td>2024-01-06</td>
<td>420</td>
<td>60</td>
<td>7</td>
</tr>
<tr>
<td>2024-01-07</td>
<td>2024-01-07</td>
<td>230</td>
<td>230</td>
<td>1</td>
</tr>
<tr>
<td>2024-01-08</td>
<td>2024-02-04</td>
<td>13160</td>
<td>470</td>
<td>28</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>2025-02-11</td>
<td>2025-02-24</td>
<td>3360</td>
<td>240</td>
<td>14</td>
</tr>
<tr>
<td>2025-02-25</td>
<td>2025-03-10</td>
<td>6020</td>
<td>430</td>
<td>14</td>
</tr>
</tbody>
</table>
<h3 id="äºŒé¢˜ç›®æ€è·¯">äºŒã€é¢˜ç›®æ€è·¯</h3>
<p>æƒ³è¦ç­”é¢˜çš„åŒå­¦ï¼Œå¯ä»¥å…ˆæ€è€ƒç­”æ¡ˆğŸ¤”ã€‚<br>
.â€¦â€¦</p>
<p>.â€¦â€¦</p>
<p>.â€¦â€¦</p>
<p>æˆ‘æ¥è°ˆè°ˆæˆ‘çš„æ€è·¯ï¼Œè¿™é“é¢˜ç›®è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ç‚¹ï¼š</p>
<p>1.æ ¹æ®æ•´ä¸ªç”µè´¹ç¼´çº³æ¶µç›–çš„åŒºé—´ï¼Œç”Ÿæˆè‡ªç„¶æœˆçš„â€œç»´åº¦è¡¨â€ã€‚æš´åŠ›çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯å–æœ€å¤§æœ€å°æ—¥æœŸï¼Œç„¶åæ„é€ ä¸€ä¸ªé€’å¢åºåˆ—æ±‚å‡ºæ¯ä¸€å¤©ï¼Œå†åˆ†ç»„/å»é‡æ±‡æ€»æˆæœˆï¼Œä½†æ˜¯å¤ªä½æ•ˆäº†ã€‚ç›´æ¥çš„æ–¹æ³•æ˜¯è·å–æœ€å¤§æœ€å°æ—¥æœŸä¹‹é—´æœ‰å¤šå°‘ä¸ªæœˆï¼Œç„¶å <code>add_months</code> åŠ ä¸Šå»ï¼Œé™¤äº†æœ€å¤§æœ€å°æ—¥æœŸçš„ç«¯ç‚¹ï¼Œå–å‡ºæ¯ä¸€ä¸ªæœˆçš„ 1 å·å’Œå½“æœˆæœ€åä¸€å¤©</p>
<blockquote>
<p>æ˜¯ä¸æ˜¯ä¸€å®šè¦åšè¿™ä¸€æ­¥ï¼Ÿå®é™…å·¥ä½œä¸­å¯ä»¥ä½¿ç”¨å›ºå®šæ—¥æœŸèŒƒå›´æˆ–è€…æ•°ä»“é‡Œç°æˆçš„ç»´åº¦è¡¨ <code>dim_date</code> ç­‰ç­‰ã€‚ä½†æ˜¯åŠ¨æ€æ—¥æœŸç»´åº¦è¡¨ç”Ÿæˆä¸€æ–¹é¢æ›´ç¬¦åˆè¿™ä¸ªåœºæ™¯çš„é€»è¾‘ï¼›å¦ä¸€æ–¹é¢ä¹Ÿæ˜¯ç¬”è¯•çš„è€ƒç‚¹ï¼Œåªä¸è¿‡åŠ¨æ€ç”Ÿæˆæ¯ä¸€å¤©æ—¥æœŸæ›´å¸¸è§ã€‚</p>
</blockquote>
<p>2.æ ¹æ®ä¸Šä¸€æ­¥è·å–çš„è‡ªç„¶æœˆåŒºé—´ï¼Œæ¥ä¸ç¼´è´¹åŒºé—´å…³è”ï¼Œå…³è”çš„æ¡ä»¶æ˜¯å­˜åœ¨äº¤é›†ã€‚è¿™åˆæ¶‰åŠåˆ°ä¸¤ç‚¹ï¼Œç¬¬ä¸€æ˜¯å¦‚ä½•åˆ¤æ–­æœ‰äº¤é›†ï¼ˆåŒ…æ‹¬å“ªæ€•åªæœ‰ç«¯ç‚¹ä¸€å¤©ç›¸äº¤ï¼‰ï¼Œç¬¬äºŒæ˜¯å¦‚ä½•å–äº¤é›†åŒºé—´çš„æ•°æ®æ¥è¿›è¡Œåç»­çš„è®¡ç®—</p>
<p>ï¼ˆç›®å‰ã€SQL å‘¨å‘¨ç»ƒã€‘ç³»åˆ—é»˜è®¤è®¨è®º <code>Hive</code>ï¼Œä½†å¾ˆå¤šæ€è·¯å¯ä»¥ç§»æ¤åˆ°å…¶ä»– SQL æ–¹è¨€ï¼›æˆ‘äº†è§£åˆ°è¯¸å¦‚ <code>Oracle</code> å’Œ <code>Postgre</code> æ˜¯æœ‰éå¸¸å¤šå‡½æ•°çš„ï¼Œå¯èƒ½ç›¸å¯¹äº <code>Hive</code> ä¼šæœ‰æ›´ç›´æ¥æ›´å¥½ç”¨çš„æ–¹æ³• | <code>SparkSQL</code> ä¸€èˆ¬éƒ½èƒ½å…¼å®¹ <code>Hive</code>ï¼ŒåæœŸæˆ‘ä¼šé€æ­¥æ‹“å±•åˆ° <code>MySQL</code>ã€<code>DuckDB</code>ã€<code>Doris/Starrocks</code>ï¼‰</p>
<p>ä¸‹é¢ï¼Œæˆ‘ç”¨ <code>NumPy</code> å’Œ <code>Scipy</code> ç”Ÿæˆæ¨¡æ‹Ÿçš„æ•°æ®é›†ï¼š</p>
<h3 id="ä¸‰ç”¨-python-ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®">ä¸‰ã€ç”¨ Python ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®</h3>
<p>åªå…³å¿ƒ SQL ä»£ç çš„åŒå­¦ï¼Œå¯ä»¥è·³è½¬åˆ°ç¬¬å››èŠ‚ï¼ˆæˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨ <code>Hive</code> è¾ƒå¤šï¼Œå› æ­¤é‡‡ç”¨ <code>Hive</code> çš„è¯­æ³•ï¼‰</p>
<p>æ¨¡æ‹Ÿä»£ç å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ„é€ æ—¥æœŸé—´éš”ï¼Œå¹¶å°†é¡ºåºéšæœºæ‰“ä¹±ï¼Œä½œä¸ºâ€œç¼´è´¹â€æ—¥æœŸåŒºé—´ï¼š</li>
</ol>
<pre><code class="language-python">import numpy as np
import pandas as pd
from datetime import datetime, timedelta

# ç¡®å®šéšæœºæ•°ç§å­
np.random.seed(2025)

# æ„é€ æ—¥æœŸé—´éš”
date_interval_list = [1, 3, 7, 14, 15, 28, 30, 45, 90] * 2

# æ‰“ä¹±é¡ºåºï¼Œæ³¨æ„å®ƒæ˜¯ç›´æ¥ä¿®æ”¹æ²¡æœ‰è¿”å›
np.random.shuffle(date_interval_list)  
print(date_interval_list)
</code></pre>
<ol start="2">
<li>éšæœºæŠ½æ ·ç”Ÿæˆâ€œç¼´è´¹â€åŒºé—´çš„æ—¥è€—ç”µé‡ï¼Œæ„é€ â€œç¼´è´¹â€åŒºé—´çš„èµ·å§‹æ—¥æœŸã€ç»“æŸæ—¥æœŸã€‚å°†å‰é¢ç”Ÿæˆçš„æ•°æ®è½¬ä¸º <code>pd.DataFrame</code>ï¼Œå¹¶è¾“å‡ºä¸º <code>csv</code> æ–‡ä»¶ï¼š</li>
</ol>
<pre><code class="language-python">power_consumption = range(50, 510, 10)

# éšæœºæŠ½å–æ•°å€¼ï¼Œä½œä¸ºç¼´è´¹åŒºé—´çš„å¹³å‡æ—¥æ¶ˆè€—ç”µé‡
daily_electricity_usage = np.random.choice(
    power_consumption, size=len(date_interval_list), replace=False
)

df = pd.DataFrame(
    {
        "period_start": [
            datetime(2023, 12, 1) + timedelta(days=sum(date_interval_list[:i]) )
            for i in range(len(date_interval_list))
        ],
        "period_end": [
            datetime(2023, 12, 1) + timedelta(days=sum(date_interval_list[:i])-1)
            for i in range(1, len(date_interval_list) + 1)
        ],
        "electricity_usage": date_interval_list * daily_electricity_usage,
        "daily_electricity_usage": daily_electricity_usage,
        "period": date_interval_list,
    }
)
# åœ¨ Jupyter ç¯å¢ƒä¸­æ˜¾ç¤º dataframeï¼Œå…¶ä»–ç¯å¢ƒæ‰§è¡Œå¯èƒ½æŠ¥é”™
display(df)

out_csv_path = "dwd_electricity_usage_records.csv"
df.to_csv(out_csv_path, index=False, header=False, encoding="utf-8-sig")
</code></pre>
<ol start="3">
<li>å¦‚æœè¡¨å­˜åœ¨åˆ™åˆ é™¤ï¼Œåˆ›å»ºæ–°çš„ <code>Hive</code> è¡¨ï¼Œå¹¶å°†æ•°æ® <code>load</code> åˆ°è¡¨ä¸­ï¼š</li>
</ol>
<pre><code class="language-python">from pyhive import hive

# é…ç½®è¿æ¥å‚æ•°
host_ip = "127.0.0.1"
port = 10000
username = "Jiang"


with hive.Connection(host=host_ip, port=port) as conn:
    cursor = conn.cursor()

    hive_table_name = 'data_exercise.dwd_electricity_usage_records'

    drop_table_sql = f"""
    drop table if exists {hive_table_name}
    """

    print('åˆ é™¤è¡¨è¯­å¥ï¼š\n', drop_table_sql)

    cursor.execute(drop_table_sql)

    create_table_sql = f"""
    create table if not exists `{hive_table_name}` (
        period_start string comment 'è´¹ç”¨æœŸå§‹',
        period_end string comment 'è´¹ç”¨æœŸç»ˆ',
        electricity_usage int comment 'è®¡è´¹æœŸé—´æ€»ç”¨ç”µé‡',
        daily_electricity_usage int comment 'è®¡è´¹æœŸé—´æ—¥å‡ç”µé‡ï¼ˆç”¨æ¥æ ¸å¯¹ç»“æœï¼‰',
        period int comment 'æœŸé—´å¤©æ•°'
    )
    comment "ä¸å®šæœŸçš„ç”µè¡¨è®¡è´¹æ•°æ® | author: è’‹ç‚¹æ•°åˆ† | æ–‡ç« ç¼–å·ï¼š04d08f61"
    row format delimited fields terminated by ','
    stored as textfile
    """

    print("åˆ›å»ºè¡¨è¯­å¥ï¼š\n", create_table_sql)
    cursor.execute(create_table_sql)

    import os

    load_data_sql = f"""
    load data local inpath "{os.path.abspath(out_csv_path)}"
    overwrite into table {hive_table_name}
    """

    print("è¦†ç›–å†™å…¥æ•°æ®è¯­å¥ï¼š\n", load_data_sql)
    cursor.execute(load_data_sql)

    cursor.close()
</code></pre>
<blockquote>
<p>æˆ‘é€šè¿‡ä½¿ç”¨ <code>PyHive</code> åŒ…å®ç° Python æ“ä½œ <code>Hive</code>ã€‚æˆ‘ä¸ªäººç”µè„‘éƒ¨ç½²äº† <code>Hadoop</code> åŠ <code>Hive</code>ï¼Œä½†æ˜¯æ²¡æœ‰å¼€å¯è®¤è¯ï¼Œä¼ä¸šé‡Œä¸€èˆ¬å¸¸ç”¨ <code>Kerberos</code> æ¥è¿›è¡Œå¤§æ•°æ®é›†ç¾¤çš„è®¤è¯ã€‚</p>
</blockquote>
<h3 id="å››sql-è§£ç­”">å››ã€SQL è§£ç­”</h3>
<p>æˆ‘ä½¿ç”¨ <code>CTE</code> çš„è¯­æ³•ï¼Œè¿™æ ·å°†æ­¥éª¤ä¸²è¡Œå±•ç¤ºï¼Œé€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸‹é¢åˆ†æˆå‡ éƒ¨åˆ†è§£é‡Š SQL è¯­å¥ï¼š</p>
<p>1.è¿™éƒ¨åˆ†ä»£ç çš„é€»è¾‘æ˜¯ï¼Œå…ˆæ±‚å‡ºæ‰€æœ‰ç¼´è´¹åŒºé—´æœ€å¤§æœ€å°çš„æ—¥æœŸï¼›ç„¶ååˆ©ç”¨æ±‚å‡ºæ¥ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„æœ‰å¤šå°‘è‡ªç„¶æœˆï¼ˆåŒ…å«ä¸¤ä¸ªç«¯ç‚¹æ‰€åœ¨çš„è‡ªç„¶æœˆï¼‰ï¼›æœ‰çš„åŒå­¦ä¼šé—®ï¼Œ<code>Hive</code> ä¸­æ˜¯å­˜åœ¨ <code>months_between</code> çš„ï¼Œä¸ºä»€ä¹ˆä½ ä¸ç”¨ï¼Œè€Œè¦è‡ªå·±â€œå¹´-å¹´â€ã€â€œæœˆ-æœˆâ€çš„è¿™ä¹ˆç®—ï¼Ÿå½“ç„¶å¯ä»¥ç”¨ï¼Œä½†æ˜¯è¦é¢å¤–å¤„ç†ä¸€ä¸‹ï¼Œæ­¤ä»£ç å—åé¢ï¼Œæˆ‘è§£é‡Šä¸€ä¸‹ï¼Œå¦‚ä½•é¢å¤–å¤„ç†ï¼š</p>
<pre><code class="language-sql">with get_date_interval as (
    -- è·å–æ€»ä½“çš„å¼€å§‹ã€ç»“æŸæ—¥æœŸï¼šè¿™é‡Œåªæ˜¯ä¸€ä¸ªç”µè¡¨
    -- å¤šä¸ªç”µè¡¨æ³¨æ„åç»­çš„é€»è¾‘è¯¥å¸¦åˆ†ç»„çš„åˆ†ç»„
    select
      min(period_start) as all_start
    , max(period_end) as all_end
    from data_exercise.dwd_electricity_usage_records
)
, get_inner_months as (
    -- è·å–ä¸¤ä¸ªæ—¥æœŸä¹‹é—´æœ‰å¤šå°‘ä¸ªæœˆï¼›â€œå¹´-å¹´â€*12â€œ+ æœˆ-æœˆâ€
    -- è¯·å‚çœ‹æ–‡ç« çš„è§£é‡Šï¼›å¦‚æœæŒ‰ç…§â€œæ•°æ•°â€çš„è§„åˆ™ï¼Œæ³¨æ„ç»“æœåŠ  1
    -- å¦‚æœè¦ç”¨ months_between å‡½æ•°ï¼Œè¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ
    -- æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œå¦‚æœ ä¸¤ä¸ªæ—¥æœŸçš„ day éƒ¨åˆ†ä¸ä¸€æ ·æˆ–è€…ä¸æ˜¯å½“æœˆçš„æœ€åä¸€å¤©
    -- åˆ™æ˜¯æŒ‰ç…§ 31 å¤©çš„æœˆä»½æ¥è®¡ç®—å°æ•°éƒ¨åˆ† `fractional portion`
    -- æ³¨æ„ months_between è¿”å›çš„å°æ•°ï¼Œè¦å–æ•´
    select
      all_start, all_end
    , (year(all_end) - year(all_start))*12 + month(all_end) - month(all_start) + 1 as month_cnt
    -- , int(months_between(last_day(all_start), last_day(all_start)))+1 as month_cnt
    from get_date_interval
)
â€¦â€¦
</code></pre>
<p>å…³äº <code>months_between</code> å‡½æ•°ï¼Œæˆ‘æŸ¥çœ‹äº† <code>Hive</code> çš„å®˜æ–¹æ–‡æ¡£ï¼Œäººå®¶æ˜¯è¿™ä¹ˆè¯´çš„ â€”â€” â€œIf date1 and date2 are either the same days of the month or both last days of months, then the result is always an integer. Otherwise the UDF calculates the fractional portion of the result based on a 31-day month and considers the difference in time components date1 and date2.â€ ç¿»è¯‘åæ˜¯ â€œå¦‚æœ date1 å’Œ date2 åœ¨å½“æœˆçš„æ—¥æœŸæ˜¯ç›¸åŒçš„ï¼Œæˆ–è€…éƒ½æ˜¯å„è‡ªæœˆä»½çš„æœ€åä¸€å¤© ï¼Œé‚£ä¹ˆç»“æœå§‹ç»ˆæ˜¯ä¸€ä¸ªæ•´æ•°ã€‚å¦åˆ™ï¼Œè¯¥å‡½æ•°ä¼šåŸºäºä¸€ä¸ª31å¤©çš„æœˆä»½æ¥è®¡ç®—ç»“æœçš„å°æ•°éƒ¨åˆ†ï¼Œå¹¶è€ƒè™‘ date1 å’Œ date2 çš„æ—¶é—´éƒ¨åˆ†å·®å¼‚ã€‚â€</p>
<p>æˆ‘æ²¡æœ‰çœ‹æºä»£ç ï¼Œä½†æ˜¯è¿™é‡Œé¢è¯´çš„æ˜¯ <code>fractional portion</code> å°æ•°éƒ¨åˆ†æŒ‰ç…§ 31 å¤©çš„æœˆæ¥å¤„ç†ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæˆ‘ç¨å¾®å®éªŒäº†ä¸€ä¸‹ï¼Œå°æ•°éƒ¨åˆ†åº”è¯¥å°±æ˜¯ <code>(day(...)-day(...))/31</code>ï¼ˆè´Ÿæ•°å°±å‘å‰å€Ÿä½ï¼‰ï¼Œå®ƒçš„ç»“æœæ˜¯å››èˆäº”å…¥ä¿ç•™ 8 ä½æ•°ã€‚æˆ‘ä»¬æƒ³é¿å¼€è¿™ä¸ªå°æ•°ï¼Œå°±æƒ³è®©å®ƒè¿”å›æ•´æ•°æœˆä»½æ€ä¹ˆåŠå‘¢ï¼ˆå› ä¸ºæƒ…å†µæ¯”è¾ƒå¤šï¼Œå•ç‹¬ç”¨å‘ä¸Šå–æ•´ã€å‘ä¸‹å–æ•´æˆ–è€…å››èˆäº”å…¥å–æ•´éƒ½æœ‰é—®é¢˜ï¼Œè¦ç»¼åˆåˆ¤æ–­ï¼Œç›´æ¥è¿”å›æ•´æ•°æœˆä»½æœ€å¥½ï¼‰</p>
<p>æˆ‘è¿™é‡Œçš„æœ€å¤§æœ€å°æ—¥æœŸï¼Œå¤§æ¦‚ç‡ day éƒ¨åˆ†æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¹Ÿä¸å¤ªå¯èƒ½éƒ½æ˜¯æ¯ä¸ªæœˆä»½çš„æœ€åä¸€å¤©ã€‚è¿™æ ·ä¼šæ¶‰åŠå°æ•°ï¼Œé‚£ä¹ˆå’±æ‰‹å·¥å¤„ç†ä¸€ä¸‹ â€”â€” æ¯”å¦‚å°†æœ€å¤§æœ€å°æ—¥æœŸæ”¹æˆå½“æœˆçš„æœ€åä¸€å¤©ï¼Œè¿™ä¸ªå¾ˆç®€å•ï¼Œä½¿ç”¨ <code>last_day</code> å‡½æ•°å³å¯ï¼›è¿˜å¯ä»¥æ”¹æˆå½“æœˆçš„ç¬¬ä¸€å¤©ï¼Œä½¿ç”¨ <code>trunc(...,'MM')</code>ï¼Œä¹Ÿæ»¡è¶³ä½¿ç”¨æ¡ä»¶ã€‚ç”šè‡³å’±è¿½æ±‚ä¸ªæ€§ï¼Œå°†æ—¥æœŸçš„å¹´æœˆéƒ¨åˆ†å–å‡ºæ¥ï¼Œæ—¥éƒ¨åˆ†éƒ½å†™ä¸ª 5 å·ã€13 å·ä¹Ÿå¯ä»¥ï¼Œåªè¦ä¸è¶…è¿‡ 28 å·ï¼Œå°±ä¸ç”¨è€ƒè™‘æ—¥æœŸåˆæ³•æ€§é—®é¢˜ã€‚</p>
<p><img src="https://img2024.cnblogs.com/blog/3640949/202505/3640949-20250513153951341-505652616.png" alt="" loading="lazy"></p>
<p>å›¾ç‰‡é‡Œ <code>m1</code> åˆ° <code>m4</code> çš„å†™æ³•éƒ½æ˜¯å¯ä»¥çš„ï¼Œåªä¸è¿‡åé¢è¦è½¬æ¢ä¸ºæ•´æ•°ã€‚</p>
<p>2.ä½¿ç”¨ <code>repeat</code> å’Œ <code>split</code> åŠ ä¸Š <code>posexplode</code> æ„é€ ä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„é€’å¢åºåˆ—ï¼Œè¿™ä¹Ÿæ˜¯ <code>Hive</code> çš„å¸¸è§æŠ€å·§ã€‚<code>explode</code> æ›´å¸¸è§ï¼Œ<code>posexplode</code> å°±æ˜¯å¤šè¿”å›ä¸€ä¸ªâ€œä½ç½®â€åˆ—ã€‚ï¼ˆæˆ‘ä¸ªäººç”µè„‘éƒ¨ç½²çš„ <code>Hive</code> ç‰ˆæœ¬æ˜¯ <code>3.1.3</code>ï¼Œæˆ‘éªŒè¯è¿‡æ²¡æœ‰ <code>sequence</code> å‡½æ•°ï¼‰ã€‚å¦‚æœæ ¹æ®æ—¥æœŸå–æŸä¸ªè‡ªç„¶æœˆçš„ 1 å·å’Œæœ€åä¸€å¤©ï¼Œä¸Šä¸€å°èŠ‚æˆ‘å·²ç»è§£é‡Šè¿‡ï¼›æ³¨æ„æœ€æ—©æœ€æ™šæ—¥æœŸæ ¹æ®æˆ‘é¢˜ç›®çš„å®šä¹‰ï¼Œè¦æŒ‰ç…§å®é™…æ—¥æœŸæ¥è®¡ç®—ï¼š</p>
<pre><code class="language-sql">â€¦â€¦
, get_every_month_start as (
    select
     (case
        -- å¯¹äºéå¼€å§‹æ—¥æœŸçš„é‚£ä¸ªæœˆï¼Œå–å½“æœˆçš„ 1 å·
        when idx &gt; 0 then add_months(trunc(g.all_start, 'MM'), idx)
        -- å¦‚æœæ˜¯å¼€å§‹æ—¥æœŸï¼Œç›´æ¥ç”¨å¼€å§‹æ—¥æœŸï¼Œä¸ç®¡å®ƒæ˜¯ä¸æ˜¯å½“æœˆçš„ 1 å·
        when idx = 0 then g.all_start 
     end) as month_start
    , all_end
    from get_inner_months g
    lateral view posexplode(split(repeat(',', month_cnt-1), ',')) month_table as idx, m
)
, get_every_month_end as (
    select
      month_start
      -- å¦‚æœæ˜¯ç»“æŸæ—¥æœŸçš„é‚£ä¸ªæœˆï¼Œç»“æŸæ—¥æœŸå°±å–æˆªæ­¢æ—¥æœŸ
      -- å¦åˆ™å–æ¯ä¸ªæœˆçš„æœ€åä¸€å¤©ï¼Œå³ last_day
    , if(date_format(month_start, 'yyyy-MM') = date_format(all_end, 'yyyy-MM'), all_end,
    last_day(month_start)) as month_end
    from get_every_month_start
)
â€¦â€¦
</code></pre>
<p>3.è¿™ä¸€æ­¥æ˜¯å°†å‰é¢æ„é€ çš„è‡ªç„¶æœˆç»´åº¦è¡¨ <code>get_every_month_end</code> ä¸ç”µè´¹æ•°æ®é›†ï¼Œè¿›è¡Œå…³è”ã€‚å…³è”çš„æ¡ä»¶æ˜¯åˆ¤æ–­æœ‰äº¤é›†ï¼Œä¸ºä»€ä¹ˆè¿™ä¸¤ä¸ªæ¡ä»¶å¯ä»¥ä¿è¯æœ‰äº¤é›†ï¼Œæˆ‘åœ¨ä»£ç ä¸‹é¢ç”¨å›¾ç‰‡ç»“åˆæ–‡å­—è®ºè¿°ã€‚å¦å¤–å°±æ˜¯å½“ä¸¤è€…æœ‰äº¤é›†çš„æƒ…å†µä¸‹ï¼Œå–äº¤é›†çš„é€»è¾‘æ˜¯ â€”â€” èµ·ç‚¹é€‰æ‹©æœ€æ™š <code>greatest</code> çš„é‚£ä¸ªï¼Œç»ˆç‚¹é€‰æ‹©æœ€æ—© <code>least</code> çš„é‚£ä¸ªã€‚</p>
<p><code>Hive</code> éå¸¸æ—©æœŸçš„ç‰ˆæœ¬æ˜¯ä¸æ”¯æŒä¸ç­‰å€¼è¿æ¥çš„ã€‚è¿™ä¸ªæ—¶å€™è¦å°å¿ƒå¤„ç† <code>on</code> åé¢çš„æ¡ä»¶ï¼Œå¦‚æœæ˜¯ <code>inner join</code> ä¸€èˆ¬å°† <code>on</code> åé¢çš„æ¡ä»¶ç§»åˆ° <code>where</code> ä¸­ï¼Œè€Œ <code>outer join</code> å¦‚æœ <code>on</code> ä¸åŒ¹é…ï¼Œåªæ˜¯ä»£è¡¨å…³è”çš„è¡¨æ²¡æœ‰åŒ¹é…çš„æ•°æ®ï¼Œå¯ä»¥ç†è§£ä¸ºç»™ä½ ä¸€ä¸ª <code>null</code>ï¼›æ¯”å¦‚æ‹¿ <code>left outer join</code> ä¸¾ä¾‹ï¼Œå·¦è¡¨çš„æ•°æ®æ˜¯ä¸ä¼šè¢« <code>on</code> æ¡ä»¶è¿‡æ»¤æ‰çš„ï¼Œå¦‚æœ <code>on</code> èƒ½å¯¼è‡´ä¸€æ¡æ•°æ®åŒ¹é…å¤šæ¡ï¼Œå·¦è¡¨çš„éƒ¨åˆ†æ•°æ®ç”šè‡³å…¨éƒ¨æ•°æ®è¿˜ä¼šç¿»å€ä¸Šæ¶¨ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä¸èƒ½å°† <code>on</code> çš„æ¡ä»¶ç›´æ¥ç§»åˆ° <code>where</code> ä¸­ï¼Œè€Œæ˜¯éœ€è¦ä¿æŒ <code>on</code> é‡Œé¢çš„æœ€ç²—ç³™çš„åŒ¹é…é€»è¾‘ï¼ˆè¿™ä¸ªåœºæ™¯ä¸è¡Œï¼Œå› ä¸ºä¸¤ä¸ªæ¡ä»¶éƒ½æ˜¯ä¸ç­‰å€¼ï¼Œéœ€è¦äººå·¥é€ ä¸€ä¸ªæ— ç”¨çš„å…³è”ï¼‰ï¼Œåœ¨ <code>select</code> ä¸­å¯¹äºå³è¡¨çš„åˆ—ï¼Œåœ¨ä½¿ç”¨æ—¶è¿›è¡Œ <code>on</code> æ¡ä»¶çš„å®Œæ•´åˆ¤æ–­ <code>if</code>ï¼Œå¦‚æœæ»¡è¶³ï¼Œè¿”å›å³è¡¨åˆ—çš„å€¼ï¼›å¦åˆ™è¿”å› <code>null</code>ã€‚è¿™ç§æ–¹æ³•ç¼ºç‚¹æ˜¯æ¯ä¸€ä¸ªç”¨åˆ°å³è¡¨çš„åˆ—ï¼Œéƒ½éœ€è¦è¿™ä¹ˆå¤„ç†ã€‚</p>
<pre><code class="language-sql">â€¦â€¦
, get_interval_power_usage as (
    select
      e.month_start as month_start
    , e.month_end as month_end
    -- æ³¨æ„å–ä¸¤ä¸ªæ—¥æœŸåŒºé—´çš„äº¤é›†
    -- éå¸¸é‡è¦ï¼Œåˆ«å¿˜äº†å–åŒºé—´çš„äº¤é›†
    -- èµ·ç‚¹å–æœ€åé¢çš„é‚£ä¸ªï¼Œç»ˆç‚¹å–æœ€æ—©çš„é‚£ä¸ª
    , greatest(r.period_start,e.month_start) as period_start
    , least(r.period_end,e.month_end) as period_end
    , nvl(r.daily_electricity_usage,0) as daily_electricity_usage
    from get_every_month_end e
    left outer join data_exercise.dwd_electricity_usage_records r
        on r.period_end &gt;= e.month_start
        and r.period_start &lt;= e.month_end
)
â€¦â€¦
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3640949/202505/3640949-20250513154004796-284630900.png" alt="" loading="lazy"></p>
<p>4.è¿™æ˜¯æœ€åæ±‚ç»“æœçš„ SQL éƒ¨åˆ†ï¼Œæ³¨æ„å‰é¢å–äº¤é›†åï¼Œä¼šåˆ’åˆ†ç§°æˆè‹¥å¹²â€œå­â€åŒºé—´ï¼Œæ¯ä¸ªåŒºé—´è®¡ç®—æ—¶ç”¨åŸæ¥çš„æ—¥å‡å€¼ä¹˜ä»¥åŒºé—´é•¿åº¦ï¼ˆæ³¨æ„ <code>datediff</code> ç»“æœåŠ  1ï¼‰è®¡ç®—è¯¥åŒºé—´çš„æ€»ç”µé‡æ¶ˆè€—ã€‚<code>group by</code> åŠ å’Œæ•´æœˆçš„ç”µé‡ï¼Œæ•´æœˆçš„é•¿åº¦å¯ä»¥ç”¨å­åŒºé—´é•¿åº¦å åŠ  <code>days_cnt</code> åˆ—ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ±‚ <code>days_cnt2</code> åˆ—ï¼Œæ³¨æ„æˆ‘è¿™é‡Œçš„ <code>month_start</code>ï¼Œ<code>month_end</code> åœ¨æœ€å¼€å§‹ä¸æœ€æ™šæ—¥æœŸæ˜¯æ ¹æ®å®é™…æ—¥æœŸå®šä¹‰çš„ï¼Œå› æ­¤å¯ä»¥ç”¨ <code>days_cnt2</code> çš„é€»è¾‘ã€‚</p>
<p>å¦å¤–ï¼Œè¿™é‡Œåªé  <code>month_start</code> å°±è¶³ä»¥æ ‡è®°ç»Ÿè®¡çš„è‡ªç„¶æœˆï¼Œæ²¡å¿…è¦å°† <code>month_end</code> ä¹Ÿä½œä¸º <code>group by</code> çš„åˆ†ç»„æ ‡è¯†ï¼Œç”¨ <code>max/min</code> å½“æˆç»´åº¦å€¼å¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯æœ€åŸºæœ¬çš„æŠ€å·§ã€‚ï¼ˆæˆ‘å·²ç»éªŒè¯<code>Hive 3.1.3</code> ä¹Ÿæ²¡æœ‰ <code>any_value</code>ï¼‰åœ¨æ•°æ®é‡å¾ˆå¤§æ—¶æˆ–è€…åˆ†ç»„ key æ¯”è¾ƒå¤šæ—¶ï¼Œæœ‰åŠ©äºæé«˜è®¡ç®—é€Ÿåº¦ã€å‡å°‘èµ„æºæ¶ˆè€—ï¼š</p>
<pre><code class="language-sql">â€¦â€¦
select
  month_start
, max(month_end) as month_end
  
, sum(daily_electricity_usage * (datediff(period_end, period_start)+1)) 
    / sum(datediff(period_end, period_start)+1) as new_daliy_usage
-- ç”¨å“ªä¸ªåšåˆ†æ¯éƒ½è¡Œ    
-- , sum(datediff(period_end, period_start)+1) as days_cnt
--, max(datediff(month_end, month_start)+1) as days_cnt2
from get_interval_power_usage
group by month_start 
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3640949/202505/3640949-20250513154018831-828499226.png" alt="" loading="lazy"></p>
<p>5.å®Œæ•´çš„ SQL è¯­å¥ï¼š</p>
<pre><code class="language-sql">with get_date_interval as (
    -- è·å–æ€»ä½“çš„å¼€å§‹ã€ç»“æŸæ—¥æœŸï¼šè¿™é‡Œåªæ˜¯ä¸€ä¸ªç”µè¡¨
    -- å¤šä¸ªç”µè¡¨æ³¨æ„åç»­çš„é€»è¾‘è¯¥å¸¦åˆ†ç»„çš„åˆ†ç»„
    select
      min(period_start) as all_start
    , max(period_end) as all_end
    from data_exercise.dwd_electricity_usage_records
)
, get_inner_months as (
    -- è·å–ä¸¤ä¸ªæ—¥æœŸä¹‹é—´æœ‰å¤šå°‘ä¸ªæœˆï¼›ä¸ºä»€ä¹ˆä¸ç”¨ months_between
    -- è¯·å‚çœ‹æ–‡ç« çš„è§£é‡Šï¼›å¦‚æœæŒ‰ç…§â€œæ•°æ•°â€çš„è§„åˆ™ï¼Œæ³¨æ„ç»“æœåŠ  1
    select
      all_start, all_end
    , (year(all_end) - year(all_start))*12 + month(all_end) - month(all_start) + 1 as month_cnt
    from get_date_interval
)
, get_every_month_start as (
    select
     (case
        -- å¯¹äºéå¼€å§‹æ—¥æœŸçš„é‚£ä¸ªæœˆï¼Œå–å½“æœˆçš„ 1 å·
        when idx &gt; 0 then add_months(trunc(g.all_start, 'MM'), idx)
        -- å¦‚æœæ˜¯å¼€å§‹æ—¥æœŸï¼Œç›´æ¥ç”¨å¼€å§‹æ—¥æœŸï¼Œä¸ç®¡å®ƒæ˜¯ä¸æ˜¯å½“æœˆçš„ 1 å·
        when idx = 0 then g.all_start 
     end) as month_start
    , all_end
    from get_inner_months g
    lateral view posexplode(split(repeat(',', month_cnt-1), ',')) month_table as idx, m
)
, get_every_month_end as (
    select
      month_start
      -- å¦‚æœæ˜¯ç»“æŸæ—¥æœŸçš„é‚£ä¸ªæœˆï¼Œç»“æŸæ—¥æœŸå°±å–æˆªæ­¢æ—¥æœŸ
      -- å¦åˆ™å–æ¯ä¸ªæœˆçš„æœ€åä¸€å¤©ï¼Œå³ last_day
    , if(date_format(month_start, 'yyyy-MM') = date_format(all_end, 'yyyy-MM'), all_end,
    last_day(month_start)) as month_end
    from get_every_month_start
)
, get_interval_power_usage as (
    select
      e.month_start as month_start
    , e.month_end as month_end
    -- æ³¨æ„å–ä¸¤ä¸ªæ—¥æœŸåŒºé—´çš„äº¤é›†
    -- éå¸¸é‡è¦ï¼Œåˆ«å¿˜äº†å–åŒºé—´çš„äº¤é›†
    -- èµ·ç‚¹å–æœ€åé¢çš„é‚£ä¸ªï¼Œç»ˆç‚¹å–æœ€æ—©çš„é‚£ä¸ª
    , greatest(r.period_start,e.month_start) as period_start
    , least(r.period_end,e.month_end) as period_end
    , r.daily_electricity_usage as daily_electricity_usage
    from get_every_month_end e
    left outer join data_exercise.dwd_electricity_usage_records r
        on r.period_end &gt;= e.month_start
        and r.period_start &lt;= e.month_end
)

select
  month_start
, max(month_end) as month_end
  
, sum(daily_electricity_usage * (datediff(period_end, period_start)+1)) 
    / sum(datediff(period_end, period_start)+1) as new_daliy_usage
-- ç”¨å“ªä¸ªåšåˆ†æ¯éƒ½è¡Œ    
-- , sum(datediff(period_end, period_start)+1) as days_cnt
--, max(datediff(month_end, month_start)+1) as days_cnt2
from get_interval_power_usage
group by month_start
</code></pre>
<hr>
<p>ğŸ˜ğŸ˜ğŸ˜<br>
<strong>æˆ‘ç°åœ¨æ­£åœ¨æ±‚èŒæ•°æ®ç±»å·¥ä½œ</strong>ï¼ˆä¸»è¦æ˜¯æ•°æ®åˆ†ææˆ–æ•°æ®ç§‘å­¦ï¼‰ï¼›å¦‚æœæ‚¨æœ‰åˆé€‚çš„æœºä¼šï¼Œå³æ—¶åˆ°å²—ï¼Œä¸é™åŸå¸‚ã€‚</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.13317779135069444" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-13 15:43">2025-05-13 15:43</span>&nbsp;
<a href="https://www.cnblogs.com/data-analytics">è’‹ç‚¹æ•°åˆ†</a>&nbsp;
é˜…è¯»(<span id="post_view_count">34</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18874386);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18874386', targetLink: 'https://www.cnblogs.com/data-analytics/p/18874386', title: 'ã€SQLå‘¨å‘¨ç»ƒã€‘ä¸€åƒæ¡æ•°æ®éœ€è¦åšä¸€å¤©ï¼Œæ€ä¹ˆç”¨ SQL å¤„ç†ç”µè¡¨æ•°æ®ï¼ˆå¦‚ä½•åŠ¨æ€æ„é€ è‡ªç„¶æœˆï¼‰' })">ä¸¾æŠ¥</a>
</div>
        