
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/heymar/p/18658958" title="发布于 2025-01-08 09:17">
    <span role="heading" aria-level="2">ThreeJs-12使用着色器加工材质</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="一three框架材质原理与应用">一.three框架材质原理与应用</h1>
<p>其实three里面所有的材质不管是基础还是点等等之类最终都会编译为shader然后执行，所以如果拿到一个材质我想对某个地方小改一下，那么也是可以用shader来进行修改的</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091615698-429573229.png" alt="image-20241228172314925" loading="lazy"></p>
<p>这里用基础材质创建一个平面</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091615318-1414742065.png" alt="image-20241228173407666" loading="lazy"></p>
<p>通过材质的这个回调就可以拿到他的shader并且里面也有顶点着色器和片段着色器</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091614963-1838152098.png" alt="image-20241228173729164" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091614636-1876395276.png" alt="image-20241228173737369" loading="lazy"></p>
<p>当然这里面这些定义都不是目前学的，因为这是three自己封装的，要看其源码都可以在这个目录下面找到</p>
<p>像commen就是封装了一些可以快速使用的变量函数等</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091614285-427660090.png" alt="image-20241228174051337" loading="lazy"></p>
<p>还比如这个导入就是对position做出了一个封装，可以快速修改位置通过transformed变量</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091613916-252679052.png" alt="image-20241228174248517" loading="lazy"></p>
<p><strong>当然如果我们要修改一些参数</strong></p>
<p>因为glsl是字符串，所以需要通过字符串的方法来修改</p>
<p>比如偏移位置</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091613563-736769903.png" alt="image-20241228174719387" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091613255-82112745.png" alt="image-20241228174726468" loading="lazy"></p>
<p>动起来</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091612947-300193261.png" alt="image-20241228175328680" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091612609-2106289060.gif" alt="GIF" loading="lazy"></p>
<h1 id="二修改物理光照材质制作人物被打效果">二.修改物理光照材质制作人物被打效果</h1>
<p>先把模型加载进来</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091612244-1757143238.png" alt="image-20241228181005889" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091611785-1658341167.png" alt="image-20241228181014266" loading="lazy"></p>
<p>继续加载纹理和法相纹理</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091611270-1822364032.png" alt="image-20241228181406442" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091610896-1169976423.png" alt="image-20241228181414568" loading="lazy"></p>
<p><strong>修改被打效果，核心就是脸扭曲变形</strong></p>
<p>比如让连续旋转180度，PI就是3.14就是180度，<strong>注意旋转角度是x轴和z轴同时转</strong></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091610471-1561740390.png" alt="image-20241228183022563" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091610046-1716976604.png" alt="image-20241228183031723" loading="lazy"></p>
<p>当然要捏造被打的形象，扭曲应该围绕着y轴为角度</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091609643-767071725.png" alt="image-20241228183141961" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091609209-1648153665.png" alt="image-20241228183149772" loading="lazy"></p>
<p>开启阴影后发现阴影有点问题</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091608820-187379634.png" alt="image-20241228192835134" loading="lazy"></p>
<p>这时候需要调整法相的旋转角度跟刚才保持一致</p>
<p>注意几个问题：法相在前，此时还没有transformed用原始的position</p>
<p>还有就是法相的位置是objectNormal</p>
<p>第三个就是法相前面已经声明了angle这些后面不用在声明直接用</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091608397-1401602331.png" alt="image-20241228193413906" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091607948-2132268987.png" alt="image-20241228193346518" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091607578-381559372.png" alt="image-20241228193551800" loading="lazy"></p>
<p>这个问题解决后但是投射到后面的还是不对</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091607111-1465887998.png" alt="image-20241228193612738" loading="lazy"></p>
<p><strong>对于3D物体有一个方法</strong></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091606650-1971736565.png" alt="image-20241228193759085" loading="lazy"></p>
<p>首先需要设置一个自定义深度材质</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091606286-737862453.png" alt="image-20241228194210279" loading="lazy"></p>
<p>有了这个材质后，跟刚才的材质一样也要去设置旋转角度，只是没有了法相的设置</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091605973-2122913439.png" alt="image-20241228194350942" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091605642-1241021126.png" alt="image-20241228194358175" loading="lazy"></p>
<p>最后添加来回被打的效果，加上时间器</p>
<p>注意来回要加sin函数</p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091605282-687622789.png" alt="image-20241228195516669" loading="lazy"></p>
<p><img src="https://img2023.cnblogs.com/blog/2680817/202501/2680817-20250108091603212-874833787.gif" alt="GIF" loading="lazy"></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.21104272908796295" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-01-08 09:17">2025-01-08 09:17</span>&nbsp;
<a href="https://www.cnblogs.com/heymar">Heymar-10</a>&nbsp;
阅读(<span id="post_view_count">3</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18658958" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18658958);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18658958', targetLink: 'https://www.cnblogs.com/heymar/p/18658958', title: 'ThreeJs-12使用着色器加工材质' })">举报</a>
</div>
        