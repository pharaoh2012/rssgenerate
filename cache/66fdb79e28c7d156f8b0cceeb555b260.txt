<!----> <meta itemprop="headline" content="程序员找房子的正确姿势(附上源码)"> <meta itemprop="keywords" content="前端"> <meta itemprop="datePublished" content="2024-10-11T08:04:19.000Z"> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="哈库拉马塔塔"> <meta itemprop="url" content="https://juejin.cn/user/2277843823507325"></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"> <meta itemprop="width" content="180"> <meta itemprop="height" content="180"></div></div> <h1 class="article-title" data-v-7cdd11fb="">
            程序员找房子的正确姿势(附上源码)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-7cdd11fb=""><div class="author-info-box" data-v-7cdd11fb=""><div class="author-name" data-v-7cdd11fb=""><a href="/user/2277843823507325/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-1800aadb="" data-v-7cdd11fb=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-1800aadb="">
    哈库拉马塔塔
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-7cdd11fb=""><time datetime="2024-10-11T08:04:19.000Z" title="Fri Oct 11 2024 08:04:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-7cdd11fb="">
                    2024-10-11
                  </time> <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-7cdd11fb=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-7cdd11fb=""></path><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-7cdd11fb=""></circle></svg> <span class="views-count" data-v-7cdd11fb="">
                    22,480
                  </span> <span class="read-time" data-v-7cdd11fb=""><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7cdd11fb=""><rect width="16" height="16" fill="none" data-v-7cdd11fb=""></rect><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-7cdd11fb=""></circle><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-7cdd11fb=""></path></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-7cdd11fb=""></div> <!----> <!----></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-7cdd11fb=""><div class="article-viewer markdown-body result"><p>本文已经授权【稀土掘金技术社区】官方公众号独家原创发布。</p>
<h3 data-id="heading-0">事情起源</h3>
<p>由于最近部门的办公地点要搬迁了，我租的房子离新场地有足足25公里，而且我对象最近也换了部门，我们以前租的房子在通勤上已经满足不了需求了。好在11月底我们的房子就到期了，所以租房子就被提上日程。(<strong>感慨，买房子有鸡毛用啊。</strong>)</p>
<p>我对象的办公地点和我新的办公点的距离开车是15公里，地铁是18公里，所以木的办法，只能在中间地带找个房子了。于是乎，我打开的了地图软件，打算把沿途的小区都一个一个记录下来，然后去计算通勤的性价比。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73e589c79faf4153a11b615cbde43169~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOI5bqT5ouJ6ams5aGU5aGU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1736459940&amp;x-signature=j35zdi%2FrXtNJKcxuKkMe6ontsVM%3D" alt="image.png" loading="lazy"></p>
<p>在地图软件上找小区倒是挺简单的，十几分钟我就记了几十个小区，然后我就做了个Excel表格，打算把各个小区到我和我对象办公点的通勤时间、距离都记录下，考虑到多种出勤方式，要统计包括了公交地铁、驾车、骑行。</p>
<p>于是乎，我傻傻的打开地图软件，一个一个导航，记录。当我进行到第十几个小区的时候，我吐了。</p>
<p>于是乎我想到了AI，于是乎我就去问AI，然后AI这么回答了我</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b15a4b1bbae7440e987659ece0334e10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOI5bqT5ouJ6ams5aGU5aGU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1736459940&amp;x-signature=Wpc5osRFS7HG2idMUKHL2mshXcI%3D" alt="image.png" loading="lazy">
可以可以，AI回答的一点毛病没有，有理有据令人信服。</p>
<p>由于我实在不想像SB一样去一个一个查了，于是乎我打开了高德的官网，希望能够得到一点启发。你别说，你还真别说，我还真就发现了一个解决方案。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90cd661df05248dfb5b7600fd79c929e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOI5bqT5ouJ6ams5aGU5aGU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1736459940&amp;x-signature=mxQBqYzCjsllRPOaEqt6wR42NfQ%3D" alt="image.png" loading="lazy"></p>
<p>这不就妥妥的能把问题解决了嘛，于是乎我新建了一个html文件，开始了coding。</p>
<h3 data-id="heading-1">我的需求</h3>
<ul>
<li>我需要能够输入多个地址、然后选择两个目标地点，用表格展示出距离、时间等信息</li>
<li>我需要能够生成Excel文件，方便我记录</li>
<li>我需要能够生成图表，能够更直观的看到结果</li>
</ul>
<h3 data-id="heading-2">开发思路</h3>
<ul>
<li>调用高德API，规划出A地点到B和C的路径，然后整合返回数据，插入表格</li>
<li>利用xlsx，生成Excel</li>
<li>用eCharts画一个柱状折线图</li>
</ul>
<h3 data-id="heading-3">开发中遇到的问题</h3>
<ul>
<li>首先就高德Key每天的调用次数限制，不支持我频繁的搜，按理说一天应该5000次啊，但是调了一百多次就会提醒我超了，但是过会又好了</li>
<li>由于我是sdk加载的高德依赖，所以三种出行方式的插件会用冲突，所以我只能加载一个插件就改名存以下，再加载另一个</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5beafc3c12f945dfada311c903bcdd25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOI5bqT5ouJ6ams5aGU5aGU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1736459940&amp;x-signature=UIyihZew4gSONZN1rdnSC18%2FFpc%3D" alt="image.png" loading="lazy"></p>
<ul>
<li>由于高德API是异步调用，不支持同步，多并发调用多次会出现有的请求失效，于是乎我想到了用Generator去控制每次请求结束再调用下一次。</li>
</ul>
<h3 data-id="heading-4">成果演示</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0f25a980d494255925b04b3565a16e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOI5bqT5ouJ6ams5aGU5aGU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1736459940&amp;x-signature=RShkfERGLyjQbHitTAFBwYJGHIM%3D" alt="企业微信截图_17285486793009.png" loading="lazy"></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08fe3f2f2cc143838d3524ba90939902~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOI5bqT5ouJ6ams5aGU5aGU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1736459940&amp;x-signature=%2Ba9XSBk03FFS3A%2Fb0yfX5AkVr3I%3D" alt="企业微信截图_17285506996476.png" loading="lazy"></p>
<h3 data-id="heading-5">成果展示</h3>
<p>这里是代码片段，可以执行下试试水，用的是我的key啊(给个赞呗)，有可能会调用次数超了</p>
<p><span href="https://code.juejin.cn/pen/7424424140389482506" class="code-editor-container"><iframe class="code-editor-frame" data-code="code-editor-element" data-code-id="7424424140389482506" data-src="https://code.juejin.cn/pen/7424424140389482506" style="display:none;" loading="lazy"></iframe><span class="loading-placeholder" style="display:none"><img class="placeholder-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAJElEQVRoge3BMQEAAADCoPVP7WkJoAAAAAAAAAAAAAAAAAAAbjh8AAFte11jAAAAAElFTkSuQmCC" loading="lazy"><span class="loading-logo"></span></span></span></p>
<h3 data-id="heading-6">遗留</h3>
<p>生成Excel那个我没写完，因为现在已经满足我的需求了。如果你希望用的话，稍微改下我的代码就好了</p>
<h3 data-id="heading-7">源码</h3>
<p>拷贝就能用哈
你只需要去申请一个高德官网完成开发者认证然后去申请自己的应用，把key和token加上就可以了 <a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fprerequisites" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/prerequisites" ref="nofollow noopener noreferrer">传送门</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe8f5afe363b405ea131ea8dc9b349de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOI5bqT5ouJ6ams5aGU5aGU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1736459940&amp;x-signature=EjUbVSVKtnTe6NlCxLofI1K6HIA%3D" alt="image.png" loading="lazy"></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span>
      <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span>
      <span class="hljs-attr">content</span>=<span class="hljs-string">"initial-scale=1.0, user-scalable=no, width=device-width"</span>
    /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span>
      <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>
      <span class="hljs-attr">href</span>=<span class="hljs-string">"https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css"</span>
    /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://a.amap.com/jsapi_demos/static/demo-center/js/demoutils.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">_AMapSecurityConfig</span> = {
        <span class="hljs-attr">securityJsCode</span>: <span class="hljs-string">"你的高德Token"</span>,
      };
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>
      <span class="hljs-attr">src</span>=<span class="hljs-string">"https://webapi.amap.com/maps?v=2.0&amp;key=你的高德Key"</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>
      <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cache.amap.com/lbs/static/addToolbar.js"</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 引入样式 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span>
      <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>
      <span class="hljs-attr">href</span>=<span class="hljs-string">"https://unpkg.com/element-ui/lib/theme-chalk/index.css"</span>
    /&gt;</span>
    <span class="hljs-comment">&lt;!-- 引入组件库 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/element-ui/lib/index.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/xlsx@0.17.0/dist/xlsx.full.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/echarts@5.5.1/dist/echarts.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"container"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"panel"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"vueContainer"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding: 16px"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myTable"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>小区名称<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>{{formData.target1}}最短距离<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>{{formData.target1}}最快用时<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"formData.target2"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>{{formData.target2}}最短距离<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>{{formData.target2}}最快用时<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in excelData"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{item.name}}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{item.distance1}}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{item.time1}}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"formData.target2"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{item.distance2}}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{item.time2}}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-form</span> <span class="hljs-attr">:model</span>=<span class="hljs-string">"formData"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"所在城市"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.city"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"起点"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"textarea"</span> <span class="hljs-attr">:rows</span>=<span class="hljs-string">"5"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.areas"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"终点1"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.target1"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"终点2"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.target2"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"出行方式"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.type"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Transfer"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"公交地铁"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Driving"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"驾车"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Riding"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"骑行"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-form</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"search"</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">"loading"</span>&gt;</span>
        查询
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"exportToExcel"</span>&gt;</span>生成Excel<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-table</span> <span class="hljs-attr">border</span> <span class="hljs-attr">:data</span>=<span class="hljs-string">"dataList"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"from"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"小区名称"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">:label</span>=<span class="hljs-string">"formData.target1 || '-'"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"minDistance1"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"最短距离"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">"{row}"</span>&gt;</span>
              {{row[formData.target1].minDistance}}
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"minTime1"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"最短时间"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">"{row}"</span>&gt;</span>
              {{row[formData.target1].minTime}}
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"具体路径"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">"{row}"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(plan,pIndex) in row[formData.target1].plans"</span>
                <span class="hljs-attr">:key</span>=<span class="hljs-string">"pIndex"</span>
              &gt;</span>
                方案{{pIndex +1}}: {{plan.instructions?.join(',')}}
                <span class="hljs-tag">&lt;<span class="hljs-name">b</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: burlywood"</span>&gt;</span>
                  总用时: {{plan.timeTotal || plan.time || 0}}
                  总距离：{{plan.distanceTotal || plan.distance || 0}}
                <span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">el-tag</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"plan.shortest"</span>&gt;</span> 最短距离 <span class="hljs-tag">&lt;/<span class="hljs-name">el-tag</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">el-tag</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"danger"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"plan.fastest"</span>&gt;</span>最快用时<span class="hljs-tag">&lt;/<span class="hljs-name">el-tag</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">:label</span>=<span class="hljs-string">"formData.target2 || '-'"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"minDistance2"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"最短距离"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">"{row}"</span>&gt;</span>
              {{row[formData.target2].minDistance}}
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"minTime2"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"最短时间"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">"{row}"</span>&gt;</span>
              {{row[formData.target2].minTime}}
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"具体路径"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">"{row}"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(plan,pIndex) in row[formData.target2].plans"</span>
                <span class="hljs-attr">:key</span>=<span class="hljs-string">"pIndex"</span>
              &gt;</span>
                方案{{pIndex +1}}: {{plan.instructions?.join(',')}}
                <span class="hljs-tag">&lt;<span class="hljs-name">b</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: burlywood"</span>&gt;</span>
                  总用时: {{plan.timeTotal || plan.time || 0}}
                  总距离：{{plan.distanceTotal || plan.distance || 0}}
                <span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">el-tag</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"plan.shortest"</span>&gt;</span> 最短距离 <span class="hljs-tag">&lt;/<span class="hljs-name">el-tag</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">el-tag</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"danger"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"plan.fastest"</span>&gt;</span>最快用时<span class="hljs-tag">&lt;/<span class="hljs-name">el-tag</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-table</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">id</span>=<span class="hljs-string">"chart-container"</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-top: 32px; height: 500px; overflow: hidden"</span>
      &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
      map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">Map</span>(<span class="hljs-string">"container"</span>, {
        <span class="hljs-attr">resizeEnable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">zoom</span>: <span class="hljs-number">13</span>,
      });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>
      <span class="hljs-attr">src</span>=<span class="hljs-string">"https://webapi.amap.com/maps?v=2.0&amp;key=你的高德Key&amp;plugin=AMap.Transfer"</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span>
      TransferAMap = AMap;
    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>
      <span class="hljs-attr">src</span>=<span class="hljs-string">"https://webapi.amap.com/maps?v=2.0&amp;key=你的高德Key&amp;plugin=AMap.Driving"</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span>
      DrivingAMap = AMap;
    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>
      <span class="hljs-attr">src</span>=<span class="hljs-string">"https://webapi.amap.com/maps?v=2.0&amp;key=你的高德Key&amp;plugin=AMap.Riding "</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span>
      RidingAMap = AMap;
    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
        <span class="hljs-attr">el</span>: <span class="hljs-string">"#vueContainer"</span>,
        <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) {
          <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">myChart</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">dataList</span>: [],
            <span class="hljs-attr">formData</span>: {
              <span class="hljs-attr">city</span>: <span class="hljs-string">"杭州"</span>,
              <span class="hljs-attr">type</span>: <span class="hljs-string">"Transfer"</span>,
              <span class="hljs-attr">areas</span>: <span class="hljs-string">""</span>,
              <span class="hljs-attr">target1</span>: <span class="hljs-string">"平安金融中心"</span>,
              <span class="hljs-attr">target2</span>: <span class="hljs-string">"金沙中心"</span>,
            },
          };
        },
        <span class="hljs-attr">computed</span>: {
          <span class="hljs-title function_">usefulAreas</span>(<span class="hljs-params"></span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">areas</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">"\n"</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> !!item);
          },
          <span class="hljs-title function_">excelData</span>(<span class="hljs-params"></span>) {
            <span class="hljs-keyword">return</span>;
          },
        },
        <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) {
          <span class="hljs-keyword">const</span> dom = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"chart-container"</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span> = echarts.<span class="hljs-title function_">init</span>(dom, <span class="hljs-literal">null</span>, {
            <span class="hljs-attr">renderer</span>: <span class="hljs-string">"canvas"</span>,
            <span class="hljs-attr">useDirtyRect</span>: <span class="hljs-literal">false</span>,
          });
          <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"resize"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-property">resize</span>);
        },
        <span class="hljs-attr">methods</span>: {
          <span class="hljs-title function_">formatDistance</span>(<span class="hljs-params">distance</span>) {
            <span class="hljs-keyword">return</span> (distance / <span class="hljs-number">1000</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>) + <span class="hljs-string">"公里"</span>;
          },
          <span class="hljs-title function_">formatTime</span>(<span class="hljs-params">time</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(time / <span class="hljs-number">60</span>) + <span class="hljs-string">"分钟"</span>;
          },
          <span class="hljs-title function_">searchFn</span>(<span class="hljs-params">source, <span class="hljs-keyword">from</span></span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
              <span class="hljs-keyword">switch</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">type</span>) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">"Transfer"</span>:
                  <span class="hljs-comment">//构造公交换乘类</span>
                  <span class="hljs-keyword">const</span> transfer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransferAMap</span>.<span class="hljs-title class_">Transfer</span>({
                    map,
                    <span class="hljs-attr">city</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">city</span>,
                    <span class="hljs-attr">panel</span>: <span class="hljs-string">"panel"</span>,
                    <span class="hljs-attr">policy</span>: <span class="hljs-title class_">TransferAMap</span>.<span class="hljs-property">TransferPolicy</span>.<span class="hljs-property">LEAST_TIME</span>, <span class="hljs-comment">//乘车策略</span>
                  });
                  transfer.<span class="hljs-title function_">search</span>(source, <span class="hljs-function">(<span class="hljs-params">status, result</span>) =&gt;</span> {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);
                    <span class="hljs-comment">// result即是对应的公交路线数据信息，相关数据结构文档请参考  https://lbs.amap.com/api/javascript-api/reference/route-search#m_TransferResult</span>
                    <span class="hljs-keyword">if</span> (status === <span class="hljs-string">"complete"</span>) {
                      <span class="hljs-keyword">const</span> plans = result.<span class="hljs-property">plans</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">plan</span>) =&gt;</span> {
                        <span class="hljs-keyword">let</span> distanceTotal = <span class="hljs-number">0</span>;
                        <span class="hljs-keyword">let</span> timeTotal = <span class="hljs-number">0</span>;
                        <span class="hljs-keyword">const</span> instructions = plan.<span class="hljs-property">segments</span>.<span class="hljs-title function_">map</span>(
                          <span class="hljs-function">(<span class="hljs-params">{ distance, time, instruction }</span>) =&gt;</span> {
                            distanceTotal += distance;
                            timeTotal += time;
                            <span class="hljs-keyword">return</span> instruction;
                          }
                        );
                        <span class="hljs-keyword">return</span> {
                          distanceTotal,
                          timeTotal,
                          instructions,
                        };
                      });
                      plans.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">plan, index</span>) =&gt;</span> {
                        <span class="hljs-keyword">const</span> others = plans.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">plan, i</span>) =&gt;</span> index !== i);
                        plan.<span class="hljs-property">fastest</span> = others.<span class="hljs-title function_">every</span>(
                          <span class="hljs-function">(<span class="hljs-params">other</span>) =&gt;</span> other.<span class="hljs-property">timeTotal</span> &gt; plan.<span class="hljs-property">timeTotal</span>
                        );
                        plan.<span class="hljs-property">shortest</span> = others.<span class="hljs-title function_">every</span>(
                          <span class="hljs-function">(<span class="hljs-params">other</span>) =&gt;</span> other.<span class="hljs-property">distanceTotal</span> &gt; plan.<span class="hljs-property">distanceTotal</span>
                        );
                      });
                      <span class="hljs-keyword">const</span> minDistance = plans.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span>
                        a.<span class="hljs-property">distanceTotal</span> &lt; b.<span class="hljs-property">distanceTotal</span> ? a : b
                      ).<span class="hljs-property">distanceTotal</span>;
                      <span class="hljs-keyword">const</span> minTime = plans.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span>
                        a.<span class="hljs-property">timeTotal</span> &lt; b.<span class="hljs-property">timeTotal</span> ? a : b
                      ).<span class="hljs-property">timeTotal</span>;
                      <span class="hljs-title function_">resolve</span>({
                        <span class="hljs-keyword">from</span>,
                        <span class="hljs-attr">minDistance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatDistance</span>(minDistance),
                        <span class="hljs-attr">minTime</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatTime</span>(minTime),
                        <span class="hljs-attr">plans</span>: plans.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">plan</span>) =&gt;</span> ({
                          ...plan,
                          <span class="hljs-attr">timeTotal</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatTime</span>(plan.<span class="hljs-property">timeTotal</span>),
                          <span class="hljs-attr">distanceTotal</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatDistance</span>(
                            plan.<span class="hljs-property">distanceTotal</span>
                          ),
                        })),
                      });
                    } <span class="hljs-keyword">else</span> {
                      log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"公交路线数据查询失败"</span> + result);
                      <span class="hljs-title function_">reject</span>();
                    }
                  });
                  <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"Driving"</span>:
                  <span class="hljs-keyword">const</span> driving = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DrivingAMap</span>.<span class="hljs-title class_">Driving</span>({
                    <span class="hljs-attr">map</span>: map,
                    <span class="hljs-attr">city</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">city</span>,
                    <span class="hljs-attr">panel</span>: <span class="hljs-string">"panel"</span>,
                  });
                  driving.<span class="hljs-title function_">search</span>(source, <span class="hljs-function">(<span class="hljs-params">status, result</span>) =&gt;</span> {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);
                    <span class="hljs-keyword">if</span> (status === <span class="hljs-string">"complete"</span>) {
                      <span class="hljs-keyword">const</span> minDistance = result.<span class="hljs-property">routes</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span>
                        a.<span class="hljs-property">distance</span> &lt; b.<span class="hljs-property">distance</span> ? a : b
                      ).<span class="hljs-property">distance</span>;
                      <span class="hljs-keyword">const</span> minTime = result.<span class="hljs-property">routes</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span>
                        a.<span class="hljs-property">time</span> &lt; b.<span class="hljs-property">time</span> ? a : b
                      ).<span class="hljs-property">time</span>;
                      <span class="hljs-title function_">resolve</span>({
                        <span class="hljs-keyword">from</span>,
                        <span class="hljs-attr">minDistance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatDistance</span>(minDistance),
                        <span class="hljs-attr">minTime</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatTime</span>(minTime),
                        <span class="hljs-attr">plans</span>: result.<span class="hljs-property">routes</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
                          <span class="hljs-keyword">return</span> {
                            <span class="hljs-attr">distance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatDistance</span>(item.<span class="hljs-property">distance</span>),
                            <span class="hljs-attr">time</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatTime</span>(item.<span class="hljs-property">time</span>),
                          };
                        }),
                      });
                    } <span class="hljs-keyword">else</span> {
                      log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"公交路线数据查询失败"</span> + result);
                      <span class="hljs-title function_">reject</span>();
                    }
                  });
                  <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"Riding"</span>:
                  <span class="hljs-keyword">const</span> riding = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RidingAMap</span>.<span class="hljs-title class_">Riding</span>({
                    <span class="hljs-attr">map</span>: map,
                    <span class="hljs-attr">city</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">city</span>,
                    <span class="hljs-attr">panel</span>: <span class="hljs-string">"panel"</span>,
                  });
                  riding.<span class="hljs-title function_">search</span>(source, <span class="hljs-function">(<span class="hljs-params">status, result</span>) =&gt;</span> {
                    <span class="hljs-keyword">if</span> (status === <span class="hljs-string">"complete"</span>) {
                      <span class="hljs-keyword">const</span> minDistance = result.<span class="hljs-property">routes</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span>
                        a.<span class="hljs-property">distance</span> &lt; b.<span class="hljs-property">distance</span> ? a : b
                      ).<span class="hljs-property">distance</span>;
                      <span class="hljs-keyword">const</span> minTime = result.<span class="hljs-property">routes</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span>
                        a.<span class="hljs-property">time</span> &lt; b.<span class="hljs-property">time</span> ? a : b
                      ).<span class="hljs-property">time</span>;
                      <span class="hljs-title function_">resolve</span>({
                        <span class="hljs-keyword">from</span>,
                        <span class="hljs-attr">minDistance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatDistance</span>(minDistance),
                        <span class="hljs-attr">minTime</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatTime</span>(minTime),
                        <span class="hljs-attr">plans</span>: result.<span class="hljs-property">routes</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
                          <span class="hljs-keyword">return</span> {
                            <span class="hljs-attr">distance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatDistance</span>(item.<span class="hljs-property">distance</span>),
                            <span class="hljs-attr">time</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatTime</span>(item.<span class="hljs-property">time</span>),
                          };
                        }),
                      });
                    } <span class="hljs-keyword">else</span> {
                      log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"骑行路线数据查询失败"</span> + result);
                      <span class="hljs-title function_">reject</span>();
                    }
                  });
                  <span class="hljs-keyword">break</span>;
              }
            });
          },
          <span class="hljs-attr">generateRequests</span>: <span class="hljs-keyword">function</span>* (arr) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">of</span> arr) {
              <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span>;
            }
          },
          <span class="hljs-keyword">async</span> <span class="hljs-title function_">search</span>(<span class="hljs-params"></span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataList</span> = [];
            <span class="hljs-keyword">const</span> requests = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateRequests</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">usefulAreas</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">of</span> requests) {
              <span class="hljs-comment">// 使用await关键字等待Generator函数生成的请求完成</span>
              <span class="hljs-keyword">let</span> result1 = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">searchFn</span>(
                [
                  { <span class="hljs-attr">keyword</span>: <span class="hljs-keyword">from</span>, <span class="hljs-attr">city</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">city</span> },
                  {
                    <span class="hljs-attr">keyword</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span>,
                    <span class="hljs-attr">city</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">city</span>,
                  },
                ],
                <span class="hljs-keyword">from</span>
              );
              <span class="hljs-keyword">let</span> result2 = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">searchFn</span>(
                [
                  { <span class="hljs-attr">keyword</span>: <span class="hljs-keyword">from</span>, <span class="hljs-attr">city</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">city</span> },
                  {
                    <span class="hljs-attr">keyword</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span>,
                    <span class="hljs-attr">city</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">city</span>,
                  },
                ],
                <span class="hljs-keyword">from</span>
              );
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataList</span>.<span class="hljs-title function_">push</span>({
                <span class="hljs-keyword">from</span>,
                [<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span>]: result1,
                [<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span>]: result2,
              });
              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataList</span>);
            }
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">draw</span>();
          },
          <span class="hljs-title function_">exportToExcel</span>(<span class="hljs-params"></span>) {
            <span class="hljs-keyword">var</span> table = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"myTable"</span>);
            <span class="hljs-keyword">var</span> wb = <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-property">utils</span>.<span class="hljs-title function_">table_to_book</span>(table, { <span class="hljs-attr">sheet</span>: <span class="hljs-string">"Sheet JS"</span> });
            <span class="hljs-comment">/*生成Excel文件*/</span>
            <span class="hljs-variable constant_">XLSX</span>.<span class="hljs-title function_">writeFile</span>(wb, <span class="hljs-string">"租房.xlsx"</span>);
          },
          <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) {
            <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"#5470C6"</span>, <span class="hljs-string">"#91CC75"</span>, <span class="hljs-string">"#EE6666"</span>, <span class="hljs-string">"#F9764F"</span>];
            <span class="hljs-keyword">const</span> option = {
              <span class="hljs-attr">color</span>: colors,
              <span class="hljs-attr">tooltip</span>: {
                <span class="hljs-attr">trigger</span>: <span class="hljs-string">"axis"</span>,
                <span class="hljs-attr">axisPointer</span>: {
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"cross"</span>,
                },
              },
              <span class="hljs-attr">grid</span>: {
                <span class="hljs-attr">right</span>: <span class="hljs-string">"20%"</span>,
              },
              <span class="hljs-attr">toolbox</span>: {
                <span class="hljs-attr">feature</span>: {
                  <span class="hljs-attr">dataView</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">readOnly</span>: <span class="hljs-literal">false</span> },
                  <span class="hljs-attr">restore</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span> },
                  <span class="hljs-attr">saveAsImage</span>: { <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span> },
                },
              },
              <span class="hljs-attr">legend</span>: {
                <span class="hljs-attr">data</span>: [<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span>],
              },
              <span class="hljs-attr">xAxis</span>: [
                {
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"category"</span>,
                  <span class="hljs-attr">axisTick</span>: {
                    <span class="hljs-attr">alignWithLabel</span>: <span class="hljs-literal">true</span>,
                  },
                  <span class="hljs-comment">// prettier-ignore</span>
                  <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">usefulAreas</span>,
                },
              ],
              <span class="hljs-attr">yAxis</span>: [
                {
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"value"</span>,
                  <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span> + <span class="hljs-string">"(距离)"</span>,
                  <span class="hljs-attr">position</span>: <span class="hljs-string">"left"</span>,
                  <span class="hljs-attr">alignTicks</span>: <span class="hljs-literal">true</span>,
                  <span class="hljs-attr">axisLine</span>: {
                    <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">lineStyle</span>: {
                      <span class="hljs-attr">color</span>: colors[<span class="hljs-number">0</span>],
                    },
                  },
                  <span class="hljs-attr">axisLabel</span>: {
                    <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${value / <span class="hljs-number">1000</span>}</span>公里`</span>,
                  },
                },
                {
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"value"</span>,
                  <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span> + <span class="hljs-string">"(距离)"</span>,
                  <span class="hljs-attr">position</span>: <span class="hljs-string">"left"</span>,
                  <span class="hljs-attr">alignTicks</span>: <span class="hljs-literal">true</span>,
                  <span class="hljs-attr">offset</span>: <span class="hljs-number">80</span>,
                  <span class="hljs-attr">axisLine</span>: {
                    <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">lineStyle</span>: {
                      <span class="hljs-attr">color</span>: colors[<span class="hljs-number">1</span>],
                    },
                  },
                  <span class="hljs-attr">axisLabel</span>: {
                    <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${value / <span class="hljs-number">1000</span>}</span>公里`</span>,
                  },
                },
                {
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"value"</span>,
                  <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span> + <span class="hljs-string">"(时间)"</span>,
                  <span class="hljs-attr">position</span>: <span class="hljs-string">"right"</span>,
                  <span class="hljs-attr">alignTicks</span>: <span class="hljs-literal">true</span>,
                  <span class="hljs-attr">axisLine</span>: {
                    <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">lineStyle</span>: {
                      <span class="hljs-attr">color</span>: colors[<span class="hljs-number">2</span>],
                    },
                  },
                  <span class="hljs-attr">axisLabel</span>: {
                    <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${value / <span class="hljs-number">60</span>}</span>分钟`</span>,
                  },
                },
                {
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"value"</span>,
                  <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span> + <span class="hljs-string">"(时间)"</span>,
                  <span class="hljs-attr">position</span>: <span class="hljs-string">"right"</span>,
                  <span class="hljs-attr">alignTicks</span>: <span class="hljs-literal">true</span>,
                  <span class="hljs-attr">axisLine</span>: {
                    <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">lineStyle</span>: {
                      <span class="hljs-attr">color</span>: colors[<span class="hljs-number">3</span>],
                    },
                  },
                  <span class="hljs-attr">axisLabel</span>: {
                    <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${value / <span class="hljs-number">60</span>}</span>分钟`</span>,
                  },
                },
              ],
              <span class="hljs-attr">series</span>: [
                {
                  <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span> + <span class="hljs-string">"(距离)"</span>,
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"bar"</span>,
                  <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataList</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
                    <span class="hljs-keyword">return</span> (
                      <span class="hljs-built_in">parseFloat</span>(item[<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span>].<span class="hljs-property">minDistance</span>) * <span class="hljs-number">1000</span>
                    );
                  }),
                },
                {
                  <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span> + <span class="hljs-string">"(距离)"</span>,
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"bar"</span>,
                  <span class="hljs-attr">yAxisIndex</span>: <span class="hljs-number">1</span>,
                  <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataList</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
                    <span class="hljs-keyword">return</span> (
                      <span class="hljs-built_in">parseFloat</span>(item[<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span>].<span class="hljs-property">minDistance</span>) * <span class="hljs-number">1000</span>
                    );
                  }),
                },
                {
                  <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span> + <span class="hljs-string">"(时间)"</span>,
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"line"</span>,
                  <span class="hljs-attr">yAxisIndex</span>: <span class="hljs-number">2</span>,
                  <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataList</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(item[<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target1</span>].<span class="hljs-property">minTime</span>) * <span class="hljs-number">60</span>;
                  }),
                },
                {
                  <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span> + <span class="hljs-string">"(时间)"</span>,
                  <span class="hljs-attr">type</span>: <span class="hljs-string">"line"</span>,
                  <span class="hljs-attr">yAxisIndex</span>: <span class="hljs-number">2</span>,
                  <span class="hljs-attr">data</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataList</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(item[<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">target2</span>].<span class="hljs-property">minTime</span>) * <span class="hljs-number">60</span>;
                  }),
                },
              ],
            };

            <span class="hljs-keyword">if</span> (option &amp;&amp; <span class="hljs-keyword">typeof</span> option === <span class="hljs-string">"object"</span>) {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">setOption</span>(option);
            }
          },
        },
      });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>

</code></pre></div></div>