
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/piwind/p/18971932" title="发布于 2025-07-08 00:03">
    <span role="heading" aria-level="2">群晖Synology NAS即DSM系统7.2去掉@eaDir文件夹并禁止其生成</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>原文永久链接：<a href="https://forum.piwind.com/d/28-qun-hui-synology-nasji-dsmxi-tong-72qu-diao-at-eadirwen-jian-jia-bing-jin-zhi-qi-sheng-cheng" target="_blank" rel="noopener nofollow">https://forum.piwind.com/d/28-qun-hui-synology-nasji-dsmxi-tong-72qu-diao-at-eadirwen-jian-jia-bing-jin-zhi-qi-sheng-cheng</a></p>
<p>Date: 2025-07-07</p>
</blockquote>
<p><strong>参考链接：</strong></p>
<ul>
<li><a href="https://community.synology.com/enu/forum/1/post/149183" target="_blank" rel="noopener nofollow">Another @eadir question - hear me out 😄 | Synology Community</a></li>
<li><a href="https://community.synology.com/enu/forum/17/post/70878" target="_blank" rel="noopener nofollow">How to Delete &amp; Prevent @eaDir Folders | Synology Community</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/85309513" target="_blank" rel="noopener nofollow">处理群晖NAS中的烦人@eaDir文件夹 - 知乎</a></li>
<li><a href="https://github.com/AlistGo/alist/discussions/6563" target="_blank" rel="noopener nofollow">alist在挂载群晖时显示@eaDir及索引后搜索会出现@eaDir的解决方法，附改MYSQL后搜索慢的解决方法 · AlistGo/alist · Discussion #6563</a></li>
<li><a href="https://community.synology.com/enu/forum/17/post/54085" target="_blank" rel="noopener nofollow">Thumbs.db, @eaDir and Samba veto files | Synology Community</a></li>
<li><a href="https://www.flynsarmy.com/2013/09/how-to-find-and-remove-eadir-directories-on-synology-nas/" target="_blank" rel="noopener nofollow">How to Find and Remove @eaDir Directories on Synology NAS | Flynsarmy</a></li>
</ul>
<p><strong>问题描述：</strong></p>
<p>DSM系统会在大量目录下各自生成一个 "@eaDir" 的目录（数量级参考：345个目录）</p>
<p><strong>解释：</strong></p>
<p>"@eaDir" 目录的作用：媒体/文件索引元数据、用于挂载加密共享的元数据、用户配额信息、macOS 扩展属性</p>
<p><strong>去掉@eaDir的原因：</strong></p>
<ul>
<li>做压缩包、同步、复制、挂载等各种场景下，都会有大量@eaDir在里面</li>
<li>索引不是单独做数据库而是放在各个目录下新建一个文件夹，太蠢了</li>
</ul>
<p><strong>为了方便调试，输出并制作一份表格来排查DSM系统上的所有系统单元：</strong></p>
<ul>
<li><a href="_MARKDOWN_ASSETS/04-pve%E4%B8%8B%E5%AE%89%E8%A3%85DSM7.assets/systemctl.txt" target="_blank" rel="noopener nofollow">systemctl.txt</a></li>
<li><a href="_MARKDOWN_ASSETS/04-pve%E4%B8%8B%E5%AE%89%E8%A3%85DSM7.assets/systemctl.xlsx" target="_blank" rel="noopener nofollow">systemctl.xlsx</a></li>
</ul>
<p>服务的路径基本都在：</p>
<ul>
<li>/usr/lib/systemd/system</li>
<li>/usr/local/lib/systemd/system</li>
</ul>
<p><strong>流程：</strong></p>
<p>先禁止生成，有如下操作：</p>
<ul>
<li>
<p>Universal Search - 设置 - 系统 - 系统更新或重启后,预加载索引数据可加快搜索，取消勾选。控制面板 - 索引服务 - 索引文件夹，确保没有任何索引文件夹</p>
</li>
<li>
<p>分析systemd，以下服务如果在运行的话，屏蔽掉</p>
<pre><code class="language-bash">## 原本就是没有启动的，暂不屏蔽
systemctl status synomkthumbd
# systemctl mask synomkthumbd
systemctl status synomkflvd
# systemctl mask synomkflvd

## 可能还有这些服务：
systemctl status synoindexd

## SynoFinder.slice中包含了pkg-SynoFinder-synoelasticd.service，这个就是Universal Search
systemctl status SynoFinder.slice
systemctl status pkg-SynoFinder-synoelasticd.service
</code></pre>
</li>
<li>
<p>分析套件</p>
<pre><code class="language-bash">## 查看群晖套件列表
synopkg list
synopkg list | awk -F: '{print $1}'
## 看到Universal Search就是SynoFinder套件
synopkg status SynoFinder
## 停止套件，停止SynoFinder之后，对应的服务pkg-SynoFinder-synoelasticd.service也看到停止了【停止状态是持续的，DSM重启也不影响】
synopkg stop SynoFinder
systemctl status pkg-SynoFinder-synoelasticd.service
## 卸载套件（暂不卸载）
# synopkg uninstall SynoFinder
</code></pre>
</li>
</ul>
<p>再删除现有的@eaDir：</p>
<pre><code class="language-bash">## 先审计内容
find /volume* -name "@eaDir" -type d
find /volume* \( -path /volume1/storage -o  -path /volume1/linux \) -prune -o -name "@eaDir" -print
find /volume* -name "@eaDir" -type d | xargs -i find {} -type f | egrep -v "@SynoEAStream|@SynoResource"
## 再删除
find /volume* -name "@eaDir" -type d -print0 | xargs -0 rm -rf
</code></pre>
<p><strong>当前配置情况下，保持观察是否会生成新的@eaDir：</strong></p>
<p>经过至少1年的观察，只有/volume*的根目录以及共享文件夹的根目录有"@eaDir"，满足需求，示例如下：</p>
<pre><code>/volume1/homes/@eaDir
/volume1/storage/@eaDir
/volume1/linux/@eaDir
/volume1/@eaDir
</code></pre>
<blockquote>
<p>本文声明：</p>
<ul>
<li>此文可能会存在排版、样式不美观，图片无法显示等问题</li>
<li>文章内容在原文永久链接中会定期更新，此文不做同步更新</li>
<li>限于篇幅长度限制，此文可能会有裁剪</li>
</ul>
<p>建议阅读原文链接</p>
</blockquote>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-08 00:04">2025-07-08 00:03</span>&nbsp;
<a href="https://www.cnblogs.com/piwind">派风社区Piwind</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18971932);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18971932', targetLink: 'https://www.cnblogs.com/piwind/p/18971932', title: '群晖Synology NAS即DSM系统7.2去掉@eaDir文件夹并禁止其生成' })">举报</a>
</div>
        