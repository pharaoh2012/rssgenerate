
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Johny-zhao/p/18887118" title="发布于 2025-05-20 15:12">
    <span role="heading" aria-level="2">HSRP、GLBP、VRRP、NSRP&nbsp;协议对比与配置指南</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><strong>HSRP、GLBP、VRRP、NSRP 协议对比与配置指南</strong></p>
<div align="center"><hr align="center" size="1" width="100%"></div>
<p><strong>一、协议对比表</strong></p>
<table border="0" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td>
<p><strong>特性</strong></p>
</td>
<td>
<p><strong>HSRP (Cisco)</strong></p>
</td>
<td>
<p><strong>GLBP (Cisco)</strong></p>
</td>
<td>
<p><strong>VRRP (标准协议)</strong></p>
</td>
<td>
<p><strong>NSRP (Juniper)</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><strong>协议类型</strong></p>
</td>
<td>
<p>思科私有</p>
</td>
<td>
<p>思科私有</p>
</td>
<td>
<p>开放标准 (RFC 5798)</p>
</td>
<td>
<p>Juniper私有</p>
</td>
</tr>
<tr>
<td>
<p><strong>冗余模式</strong></p>
</td>
<td>
<p>主备模式</p>
</td>
<td>
<p>主备 + 负载均衡</p>
</td>
<td>
<p>主备模式</p>
</td>
<td>
<p>主备模式（支持状态同步）</p>
</td>
</tr>
<tr>
<td>
<p><strong>负载均衡</strong></p>
</td>
<td>
<p>不支持</p>
</td>
<td>
<p>支持（基于权重或轮询）</p>
</td>
<td>
<p>不支持</p>
</td>
<td>
<p>不支持</p>
</td>
</tr>
<tr>
<td>
<p><strong>收敛时间</strong></p>
</td>
<td>
<p>约 10 秒</p>
</td>
<td>
<p>约 3-5 秒</p>
</td>
<td>
<p>约 3 秒</p>
</td>
<td>
<p>&lt;1 秒（快速故障切换）</p>
</td>
</tr>
<tr>
<td>
<p><strong>虚拟 MAC</strong></p>
</td>
<td>
<p>统一虚拟 MAC</p>
</td>
<td>
<p>动态分配多个虚拟 MAC</p>
</td>
<td>
<p>统一虚拟 MAC</p>
</td>
<td>
<p>无（基于实际 MAC）</p>
</td>
</tr>
<tr>
<td>
<p><strong>厂商支持</strong></p>
</td>
<td>
<p>仅 Cisco 设备</p>
</td>
<td>
<p>仅 Cisco 设备</p>
</td>
<td>
<p>多厂商（华为、H3C 等）</p>
</td>
<td>
<p>仅 Juniper 设备（如 SRX）</p>
</td>
</tr>
<tr>
<td>
<p><strong>典型应用</strong></p>
</td>
<td>
<p>网关冗余</p>
</td>
<td>
<p>网关冗余 + 流量负载</p>
</td>
<td>
<p>跨厂商网关冗余</p>
</td>
<td>
<p>防火墙/安全网关冗余</p>
</td>
</tr>
</tbody>
</table>
<div align="center"><hr align="center" size="1" width="100%"></div>
<p><strong>二、优缺点分析</strong></p>
<p><strong>1. HSRP (Hot Standby Router Protocol)</strong></p>
<ul>
<li><strong>优点</strong>:</li>
<ul>
<li>配置简单，适用于 Cisco 环境。</li>
<li>支持多组（Multiple HSRP Groups）实现多网关冗余。</li>
</ul>
<li><strong>缺点</strong>:</li>
<ul>
<li>无法负载均衡，仅主备切换。</li>
<li>收敛时间较长（默认 10 秒）。</li>
<li>依赖 Cisco 设备，扩展性差。</li>
</ul>
</ul>
<p><strong>2. GLBP (Gateway Load Balancing Protocol)</strong></p>
<ul>
<li><strong>优点</strong>:</li>
<ul>
<li>支持负载均衡（流量按权重或轮询分发）。</li>
<li>收敛速度快（3-5 秒）。</li>
<li>动态分配虚拟 MAC，提高链路利用率。</li>
</ul>
<li><strong>缺点</strong>:</li>
<ul>
<li>仅限 Cisco 设备。</li>
<li>配置复杂度高于 HSRP。</li>
</ul>
</ul>
<p><strong>3. VRRP (Virtual Router Redundancy Protocol)</strong></p>
<ul>
<li><strong>优点</strong>:</li>
<ul>
<li>开放标准，多厂商兼容。</li>
<li>收敛时间快（约 3 秒）。</li>
<li>支持抢占（Preemption）功能。</li>
</ul>
<li><strong>缺点</strong>:</li>
<ul>
<li>无内置负载均衡功能。</li>
<li>部分厂商实现存在差异。</li>
</ul>
</ul>
<p><strong>4. NSRP (Network Services Redundancy Protocol)</strong></p>
<ul>
<li><strong>优点</strong>:</li>
<ul>
<li>专为防火墙/安全网关设计，支持状态同步（会话表、策略等）。</li>
<li>毫秒级故障切换（&lt;1 秒）。</li>
<li>支持多节点冗余（如 Active/Passive/Active 集群）。</li>
</ul>
<li><strong>缺点</strong>:</li>
<ul>
<li>仅限 Juniper SRX 系列设备。</li>
<li>配置复杂，需管理心跳线和冗余组。</li>
</ul>
</ul>
<div align="center"><hr align="center" size="1" width="100%"></div>
<p><strong>三、配置示例</strong></p>
<p><strong>1. HSRP 配置（Cisco IOS）</strong></p>
<p><strong>场景</strong></p>
<ul>
<li><strong>主设备（A 机）IP: 192.168.1.1，优先级 110</strong></li>
<li><strong>备设备（B 机）IP: 192.168.1.2，优先级 90</strong></li>
<li><strong>虚拟 IP（VIP）: 192.168.1.254</strong></li>
</ul>
<p><strong>A 机（主）配置</strong></p>
<p><strong>interface GigabitEthernet0/0</strong></p>
<p><strong>&nbsp;ip address 192.168.1.1 255.255.255.0</strong></p>
<p><strong>&nbsp;standby 1 ip 192.168.1.254</strong></p>
<p><strong>&nbsp;standby 1 priority 110&nbsp;&nbsp;&nbsp; ! 主节点优先级更高</strong></p>
<p><strong>&nbsp;standby 1 preempt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 启用抢占（故障恢复后自动切回主）</strong></p>
<p><strong>&nbsp;standby 1 timers 3 10&nbsp;&nbsp;&nbsp;&nbsp; ! Hello时间3秒，保持时间10秒</strong></p>
<p><strong>&nbsp;standby 1 track GigabitEthernet0/1 20&nbsp; ! 跟踪上行接口，故障时优先级降20</strong></p>
<p><strong>B 机（备）配置</strong></p>
<p><strong>interface GigabitEthernet0/0</strong></p>
<p><strong>&nbsp;ip address 192.168.1.2 255.255.255.0</strong></p>
<p><strong>&nbsp;standby 1 ip 192.168.1.254</strong></p>
<p><strong>&nbsp;standby 1 priority 90&nbsp;&nbsp;&nbsp;&nbsp; ! 备用节点优先级较低</strong></p>
<p><strong>&nbsp;standby 1 preempt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 备用节点也启用抢占（可选）</strong></p>
<p><strong>&nbsp;standby 1 timers 3 10&nbsp;&nbsp;&nbsp;&nbsp; ! 必须与主节点时间参数一致</strong></p>
<p><strong>注意事项</strong></p>
<ol start="1">
<li><strong>组号一致性：A/B 机的&nbsp;standby 1&nbsp;组号必须相同。</strong></li>
<li><strong>抢占配置：主备均需配置&nbsp;preempt，否则主节点故障恢复后不会主动接管。</strong></li>
<li><strong>跟踪接口：建议主节点配置&nbsp;track&nbsp;监控上行链路（如 WAN 口），触发优先级降低。</strong></li>
<li><strong>时间参数：timers&nbsp;需主备一致，否则可能导致状态不一致。</strong></li>
</ol>
<p><strong>&nbsp;</strong></p>
<p><strong>2. GLBP 配置（Cisco IOS）</strong></p>
<p><strong>场景</strong></p>
<ul>
<li><strong>A 机 IP: 192.168.1.1，权重 200</strong></li>
<li><strong>B 机 IP: 192.168.1.2，权重 150</strong></li>
<li><strong>虚拟 IP: 192.168.1.254，负载均衡模式为加权轮询。</strong></li>
</ul>
<p><strong>A 机（主）配置</strong></p>
<p><strong>interface GigabitEthernet0/0</strong></p>
<p><strong>&nbsp;ip address 192.168.1.1 255.255.255.0</strong></p>
<p><strong>&nbsp;glbp 1 ip 192.168.1.254</strong></p>
<p><strong>&nbsp;glbp 1 priority 150&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 主节点优先级更高</strong></p>
<p><strong>&nbsp;glbp 1 preempt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 启用抢占</strong></p>
<p><strong>&nbsp;glbp 1 weighting 200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 权重值（流量分配比例）</strong></p>
<p><strong>&nbsp;glbp 1 load-balancing weighted ! 按权重分配流量</strong></p>
<p><strong>&nbsp;glbp 1 authentication md5 key-string MyKey ! 可选认证</strong></p>
<p><strong>&nbsp;glbp 1 track GigabitEthernet0/1 decrement 50&nbsp; ! 跟踪上行接口，权重降50</strong></p>
<p><strong>B 机（备）配置</strong></p>
<p><strong>interface GigabitEthernet0/0</strong></p>
<p><strong>&nbsp;ip address 192.168.1.2 255.255.255.0</strong></p>
<p><strong>&nbsp;glbp 1 ip 192.168.1.254</strong></p>
<p><strong>&nbsp;glbp 1 priority 100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 备用节点优先级较低</strong></p>
<p><strong>&nbsp;glbp 1 preempt</strong></p>
<p><strong>&nbsp;glbp 1 weighting 150</strong></p>
<p><strong>&nbsp;glbp 1 load-balancing weighted</strong></p>
<p><strong>&nbsp;glbp 1 authentication md5 key-string MyKey</strong></p>
<p><strong>注意事项</strong></p>
<ol start="1">
<li><strong>权重与优先级：优先级决定主备角色，权重决定流量分配比例。</strong></li>
<li><strong>负载均衡模式：支持&nbsp;round-robin（轮询）、weighted（加权）、host-dependent（基于源 IP）。</strong></li>
<li><strong>跟踪机制：权重&nbsp;decrement&nbsp;需合理设置，避免单点故障后流量分配失衡。</strong></li>
<li><strong>认证：建议配置 MD5 认证防止非法节点加入。</strong></li>
</ol>
<p><strong>3. VRRP 配置（华为/H3C）</strong></p>
<p><strong>场景</strong></p>
<ul>
<li><strong>主设备（A 机）IP: 192.168.1.1，优先级 120</strong></li>
<li><strong>备设备（B 机）IP: 192.168.1.2，优先级 100</strong></li>
<li><strong>虚拟 IP: 192.168.1.254</strong></li>
</ul>
<p><strong>A 机（主）配置</strong></p>
<p><strong>interface Vlanif10</strong></p>
<p><strong>&nbsp;ip address 192.168.1.1 24</strong></p>
<p><strong>&nbsp;vrrp vrid 1 virtual-ip 192.168.1.254</strong></p>
<p><strong>&nbsp;vrrp vrid 1 priority 120&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 主节点优先级更高</strong></p>
<p><strong>&nbsp;vrrp vrid 1 preempt-mode timer delay 20&nbsp; ! 抢占延迟20秒（防止震荡）</strong></p>
<p><strong>&nbsp;vrrp vrid 1 track interface GigabitEthernet0/0/1 reduced 30&nbsp; ! 跟踪上行接口</strong></p>
<p><strong>&nbsp;vrrp vrid 1 authentication-mode md5 Huawei@123&nbsp; ! 认证密码</strong></p>
<p><strong>B 机（备）配置</strong></p>
<p><strong>interface Vlanif10</strong></p>
<p><strong>&nbsp;ip address 192.168.1.2 24</strong></p>
<p><strong>&nbsp;vrrp vrid 1 virtual-ip 192.168.1.254</strong></p>
<p><strong>&nbsp;vrrp vrid 1 priority 100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 备用节点优先级较低</strong></p>
<p><strong>&nbsp;vrrp vrid 1 preempt-mode timer delay 20</strong></p>
<p><strong>&nbsp;vrrp vrid 1 authentication-mode md5 Huawei@123</strong></p>
<p><strong>注意事项</strong></p>
<ol start="1">
<li><strong>VRID 一致性：A/B 机的&nbsp;vrid 1&nbsp;必须相同。</strong></li>
<li><strong>抢占延迟：建议配置&nbsp;timer delay&nbsp;避免网络抖动导致频繁切换。</strong></li>
<li><strong>认证兼容性：不同厂商的 VRRP 认证方式可能不兼容（如华为与 H3C）。</strong></li>
<li><strong>跟踪接口：主节点需跟踪关键接口（如上行链路），触发优先级降低。</strong></li>
</ol>
<p><strong>&nbsp;</strong></p>
<p><strong>4. NSRP 配置（Juniper SRX）</strong></p>
<p><strong>场景</strong></p>
<ul>
<li><strong>A 机（主）节点 ID 0，B 机（备）节点 ID 1</strong></li>
<li><strong>心跳接口：ge-0/0/0（直连）</strong></li>
<li><strong>监控接口：ge-0/0/1（连接内网）</strong></li>
</ul>
<p><strong>A 机（主）配置</strong></p>
<p><strong>set chassis cluster cluster-id 1 node 0 reboot&nbsp;&nbsp;&nbsp; ! 节点0为主</strong></p>
<p><strong>set interfaces ge-0/0/0 fabric-options member-interfaces ge-0/0/0&nbsp; ! 心跳接口</strong></p>
<p><strong>set security nsrp cluster id 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 集群ID</strong></p>
<p><strong>set security nsrp vsd-group 0 priority 254&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 主节点优先级更高</strong></p>
<p><strong>set security nsrp vsd-group 0 monitor-interface ge-0/0/1&nbsp; ! 监控内网接口</strong></p>
<p><strong>set security nsrp vsd-group 0 preempt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 启用抢占</strong></p>
<p><strong>set security nsrp rto-sync&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ! 同步会话表</strong></p>
<p><strong>B 机（备）配置</strong></p>
<p><strong>set chassis cluster cluster-id 1 node 1 reboot&nbsp;&nbsp;&nbsp; ! 节点1为备</strong></p>
<p><strong>set interfaces ge-0/0/0 fabric-options member-interfaces ge-0/0/0</strong></p>
<p><strong>set security nsrp cluster id 1</strong></p>
<p><strong>set security nsrp vsd-group 0 priority 200</strong></p>
<p><strong>set security nsrp vsd-group 0 monitor-interface ge-0/0/1</strong></p>
<p><strong>set security nsrp rto-sync</strong></p>
<p><strong>注意事项</strong></p>
<ol start="1">
<li><strong>心跳链路冗余：建议使用双心跳链路（如&nbsp;ge-0/0/0&nbsp;和&nbsp;ge-0/0/1）防单点故障。</strong></li>
<li><strong>RTO 同步：rto-sync&nbsp;确保主备会话表同步，故障切换时业务不中断。</strong></li>
<li><strong>监控接口：选择关键接口（如内网口），若接口故障触发切换。</strong></li>
<li><strong>抢占配置：主节点恢复后需配置&nbsp;preempt&nbsp;以重新接管。</strong></li>
</ol>
<div align="center"><hr align="center" size="1" width="100%"></div>
<p><strong>四、最佳技术方案选择</strong></p>
<p><strong>场景与推荐方案</strong></p>
<ol start="1">
<li><strong>纯 Cisco 网络，需网关冗余 + 负载均衡</strong></li>
<ul>
<li><strong>推荐协议</strong>: GLBP</li>
<li><strong>理由</strong>: 充分利用 Cisco 私有功能，实现流量负载分担和高可用性。</li>
</ul>
<li><strong>多厂商混合网络，仅需网关冗余</strong></li>
<ul>
<li><strong>推荐协议</strong>: VRRP</li>
<li><strong>理由</strong>: 标准化协议，兼容性强，配置简单。</li>
</ul>
<li><strong>防火墙/安全网关高可用（Juniper 环境）</strong></li>
<ul>
<li><strong>推荐协议</strong>: NSRP</li>
<li><strong>理由</strong>: 支持状态同步，确保会话不中断，毫秒级故障切换。</li>
</ul>
<li><strong>数据中心网关冗余（需快速收敛）</strong></li>
<ul>
<li><strong>推荐方案</strong>: VRRP 或 HSRP + BFD（Bidirectional Forwarding Detection）</li>
<li><strong>理由</strong>: 结合 BFD 将收敛时间缩短至毫秒级。</li>
</ul>
</ol><ol start="5">
<li><strong>设备厂商限制</strong>：</li>
<ul>
<li>纯 Cisco 网络：优先选&nbsp;<strong>GLBP</strong>（负载均衡）或&nbsp;<strong>HSRP</strong>（简单冗余）。</li>
<li>多厂商环境：选&nbsp;<strong>VRRP</strong>（标准化兼容）。</li>
<li>防火墙高可用：选&nbsp;<strong>NSRP</strong>（状态同步，快速切换）。</li>
</ul>
<li><strong>关键配置要点</strong>：</li>
<ul>
<li><strong>主备优先级差异</strong>：确保主节点优先级高于备用。</li>
<li><strong>抢占机制</strong>：主节点恢复后应自动接管。</li>
<li><strong>链路跟踪</strong>：监控关键接口触发切换。</li>
<li><strong>认证配置</strong>：防止非法节点加入（HSRP/GLBP/VRRP）。</li>
</ul>
<li><strong>验证命令</strong>：</li>
<ul>
<li><strong>HSRP/GLBP</strong>：show standby brief&nbsp;/&nbsp;show glbp brief</li>
<li><strong>VRRP</strong>：display vrrp（华为）</li>
<li><strong>NSRP</strong>：show chassis cluster status（Juniper）</li>
</ul>
</ol>
<p>根据实际需求选择协议，并严格遵循主备配置差异与注意事项，可确保高可用性网络的稳定运行。</p>
<div align="center"><hr align="center" size="1" width="100%"></div>
<p><strong>五、总结</strong></p>
<ul>
<li><strong>HSRP</strong>: 简单易用，适合 Cisco 环境的基础冗余。</li>
<li><strong>GLBP</strong>: 适合 Cisco 环境下的负载均衡与冗余结合场景。</li>
<li><strong>VRRP</strong>: 跨厂商兼容，标准化部署的首选。</li>
<li><strong>NSRP</strong>: 专为防火墙设计，保障安全设备的高可用性和状态同步。</li>
</ul>
<p>根据实际网络架构、设备厂商和业务需求选择最合适的协议。</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.048473818899305555" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-20 15:12">2025-05-20 15:12</span>&nbsp;
<a href="https://www.cnblogs.com/Johny-zhao">Johny_Zhao</a>&nbsp;
阅读(<span id="post_view_count">12</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18887118);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18887118', targetLink: 'https://www.cnblogs.com/Johny-zhao/p/18887118', title: 'HSRP、GLBP、VRRP、NSRP&amp;#160;协议对比与配置指南' })">举报</a>
</div>
        