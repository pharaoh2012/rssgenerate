
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/cj8988/p/18976662" title="发布于 2025-07-10 12:13">
    <span role="heading" aria-level="2">文生图：介绍一个文字生成图片的开源工具</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><span style="font-size: 16px">之前介绍过音频处理，图片生成视频，图片+音频对嘴，视频+音频对嘴。</span></p>
<p><span style="font-size: 16px">今天介绍一个文字生成图片的开源项目，我已经在本地搭建完成了使用了。</span></p>
<p>&nbsp;</p>
<h2>一：下载源代码</h2>
<p><span style="font-size: 16px">地址：<a href="https://github.com/AUTOMATIC1111/stable-diffusion-webui" target="_blank" rel="noopener nofollow">https://github.com/AUTOMATIC1111/stable-diffusion-webui</a></span></p>
<p><span style="font-size: 16px">&nbsp;</span></p>
<p><span style="font-size: 16px">直接下载，解压就行。</span></p>
<p><span style="font-size: 16px">&nbsp;</span></p>
<h2>二：环境搭建</h2>
<p><span style="font-size: 16px">使用Anaconda环境中搭建：</span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 0, 1)">#进入加压包
cd stable</span>-diffusion-<span style="color: rgba(0, 0, 0, 1)">webui

#创建环境
conda create </span>--name stable-diff python=<span style="color: rgba(128, 0, 128, 1)">3.10</span><span style="color: rgba(0, 0, 0, 1)">

#激活环境：
conda activate stable</span>-<span style="color: rgba(0, 0, 0, 1)">diff

#首次运行（会下载模型）：
python launch.py<br><br>#运行中如果有报错，差什么就安装什么<br>pip install ...</span></pre>
</div>
<p>&nbsp;</p>
<h2>三：运行&nbsp;</h2>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 0, 1)">运行：
python  webui.py</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img alt="" width="1098" height="526" loading="lazy" data-src="https://img2024.cnblogs.com/blog/692485/202507/692485-20250710115234136-1335273824.png" class="lazyload"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>四：添加v2新模型</h2>
<p><span style="font-size: 16px">这里默认下载的是v1-5-pruned-emaonly。查了下最新的有v2版本，下面就配置个v2版本。</span></p>
<p><span style="font-size: 16px">（1）：模型下载：<a href="https://huggingface.co/stabilityai/stable-diffusion-2-1/tree/main" target="_blank" rel="noopener nofollow">https://huggingface.co/stabilityai/stable-diffusion-2-1/tree/main</a></span></p>
<p>&nbsp;</p>
<p><span style="font-size: 16px">下载 文件<strong>v2-1_768-ema-pruned.safetensors 有点大5G。放到文件夹\stable-diffusion-webui\models\Stable-diffusion 中。</strong></span></p>
<p><span style="font-size: 16px">然后重启服务，刷新模板，重新生成。图片生成了，但是图像不对。</span></p>
<p>&nbsp;</p>
<p><img alt="" width="1012" height="444" loading="lazy" data-src="https://img2024.cnblogs.com/blog/692485/202507/692485-20250710115918269-1991214466.png" class="lazyload"></p>
<p>&nbsp;</p>
<p><span style="color: rgba(255, 0, 0, 1)"><strong>注意如果有报错，需要设置一下：</strong></span></p>
<div class="cnblogs_code">
<pre>   modules.devices.NansException: A tensor with NaNs was produced <span style="color: rgba(0, 0, 255, 1)">in</span> Unet. This could be either because there<span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">s not enough precision to represent the picture, or because your video card does not support half type. Try setting the "Upcast cross attention layer to float32" option in Settings &gt; Stable Diffusion or using the --no-half commandline argument to fix this. Use --disable-nan-check commandline argument to disable this check.</span></pre>
</div>
<p>&nbsp;</p>
<p><img alt="" width="662" height="653" loading="lazy" data-src="https://img2024.cnblogs.com/blog/692485/202507/692485-20250710120438527-422581497.png" class="lazyload"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 16px">（2）：解码器下载，这里使用社区开源的解码器</span></p>
<p><span style="font-size: 16px"><a href="https://huggingface.co/stabilityai/sd-vae-ft-mse-original/resolve/main/vae-ft-mse-840000-ema-pruned.safetensors" rel="noopener nofollow">https://huggingface.co/stabilityai/sd-vae-ft-mse-original/resolve/main/vae-ft-mse-840000-ema-pruned.safetensors</a>。</span></p>
<p><span style="font-size: 16px">&nbsp;下载后存放在文件夹</span><strong>&nbsp;\stable-diffusion-webui\models\VAE 。</strong></p>
<p>&nbsp;</p>
<p><strong>（3）：配置：</strong></p>
<ol class="ng-star-inserted">
<li class="ng-star-inserted">
<p class="ng-star-inserted"><span class="ng-star-inserted">回到 Web UI 界面，进入&nbsp;<strong class="ng-star-inserted">Settings (设置)</strong><span class="ng-star-inserted">&nbsp;标签页。</span></span></p>
</li>
<li class="ng-star-inserted">
<p class="ng-star-inserted"><span class="ng-star-inserted">在左侧菜单，点击&nbsp;<strong class="ng-star-inserted">Stable Diffusion</strong><span class="ng-star-inserted">&nbsp;子菜单。（就是你之前找到 "Upcast" 选项的那个地方）。</span></span></p>
</li>
<li class="ng-star-inserted">
<p class="ng-star-inserted"><span class="ng-star-inserted">在右侧的选项中，找到一个叫做&nbsp;<strong class="ng-star-inserted">SD VAE</strong><span class="ng-star-inserted">&nbsp;的下拉菜单。</span></span></p>
</li>
<li class="ng-star-inserted">
<p class="ng-star-inserted"><span class="ng-star-inserted">点击这个下拉菜单，选择你刚刚放进去的那个 VAE 文件（比如&nbsp;<span class="inline-code ng-star-inserted">vae-ft-mse-840000-ema-pruned.safetensors<span class="ng-star-inserted">）。</span></span></span></p>
<ul class="ng-star-inserted">
<li class="ng-star-inserted">
<p class="ng-star-inserted"><span class="ng-star-inserted">如果菜单里没看到，可以点击下拉菜单旁边的小小的<strong class="ng-star-inserted">刷新按钮 🔄</strong><span class="ng-star-inserted">。</span></span></p>
</li>
</ul>
</li>
<li class="ng-star-inserted">
<p class="ng-star-inserted"><strong class="ng-star-inserted">非常重要</strong><span class="ng-star-inserted">：滚动到页面顶部，点击橙色的&nbsp;<strong class="ng-star-inserted">&nbsp;(应用设置)</strong><span class="ng-star-inserted">，然后点击&nbsp;<strong class="ng-star-inserted">&nbsp;(重载界面)。</strong><span class="ng-star-inserted"><br></span></span></span></p>

</li>

</ol>
<p><img alt="" width="1158" height="472" loading="lazy" data-src="https://img2024.cnblogs.com/blog/692485/202507/692485-20250710120558129-1939112693.png" class="lazyload"></p>
<p>&nbsp;</p>
<p><strong>（4）：重新启动，注意是在cmd的&nbsp;</strong>conda 环境中重新启动服务。</p>
<p>选择v2时，有一些参数可以适当的修改一些，然后使用相同的提示词，重新点击生成。</p>
<p>&nbsp;</p>
<p><img alt="" width="1168" height="513" loading="lazy" data-src="https://img2024.cnblogs.com/blog/692485/202507/692485-20250710121105058-508605026.png" class="lazyload"></p>
<p>&nbsp;</p>
<p><strong>搞定，收工。</strong></p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-10 12:13">2025-07-10 12:13</span>&nbsp;
<a href="https://www.cnblogs.com/cj8988">Joy_CShow</a>&nbsp;
阅读(<span id="post_view_count">9</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18976662);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18976662', targetLink: 'https://www.cnblogs.com/cj8988/p/18976662', title: '文生图：介绍一个文字生成图片的开源工具' })">举报</a>
</div>
        