
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/vipstone/p/18891936" title="发布于 2025-05-22 20:23">
    <span role="heading" aria-level="2">实战：Dify智能体+Java=自动化运营工具！</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>我们在运营某个圈子的时候，可能每天都要将这个圈子的“热门新闻”发送到朋友圈或聊天群里，但<strong>依靠传统的实现手段非常耗时耗力</strong>，我们通常要先收集热门新闻，再组装要新闻内容，再根据内容设计海报等。</p>
<p>那怎么才能简化并高效的完成以上工作呢？</p>
<p>答案是我们可以<strong>借助 AI 工具：Dify + Java 服务来实现热点新闻自动生成功能</strong>，最终生成效果如下：</p>
<p><img src="https://img2024.cnblogs.com/blog/172074/202505/172074-20250522202334805-564161775.png" alt="" loading="lazy"></p>
<h2 id="实现思路">实现思路</h2>
<p>具体实现步骤如下：</p>
<ol>
<li>在 dify 中创建 Agent 应用。</li>
<li>添加相关组件：
<ul>
<li><strong>time：获取当前时间</strong>，根据时间生成对应日期的热点新闻。</li>
<li><strong>tavily：联网的搜索服务</strong>，用于查询某个日期的热点新闻。</li>
<li><strong>自定义 Java 服务</strong>：实现将 HTML 页面转换为图片。</li>
</ul>
</li>
<li><strong>填写提示词</strong>，设置变量和编排任务。</li>
<li><strong>选择 LLM</strong>。</li>
<li>执行热点新闻生成操作。</li>
</ol>
<h2 id="为什么要使用java服务">为什么要使用Java服务？</h2>
<p>为什么要使用 Java 服务，而不是根据文案直接生成图片呢？</p>
<p>答：因为根据文案直接生成图片，目前大模型生成图片服务，并不能满足热点新闻的生成要求。所以，我们可以让大模型先生成美观的 HTML 页面，再将 HTML 转换成图片，才能满足生产级别的图片要求。当然，自定义服务不一定是 Java 语言实现的，其他语言也是可以的，例如 Python。</p>
<h2 id="1自定义工具">1.自定义工具</h2>
<p>自定义工具的 Schema 用于描述调用的外部调用服务，只需要满足 OpenAI-Swagger 要求即可：</p>
<pre><code class="language-json">{
  "openapi": "3.1.0",
  "info": {
    "title": "html to image",
    "description": "Generate image files based on HTML code",
    "version": "v1.0.0"
  },
  "servers": [
    {
      "url": "http://192.168.3.94:8080"
    }
  ],
  "paths": {
    "/html2img/gen": {
      "get": {
        "description": "Generate image files based on HTML code",
        "operationId": "generate",
        "parameters": [
          {
            "name": "html",
            "in": "query",
            "description": "HTML code",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "deprecated": false
      }
    }
  },
  "components": {
    "schemas": {}
  }
}
</code></pre>
<h2 id="2具体实现代码">2.具体实现代码</h2>
<pre><code class="language-java">import cn.alotus.HtmlRender;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.awt.image.BufferedImage;
import java.io.IOException;
import java.util.UUID;

@RestController
@RequestMapping("/html2img")
public class ApiController {

    @RequestMapping("/gen")
    public String generate(@RequestParam String html) throws IOException {
        HtmlRender htmlRender = new HtmlRender(BufferedImage.TYPE_INT_RGB);
        String imgPath = "D://" + UUID.randomUUID() + ".png";
        //生成图片
        htmlRender.toPng(html, imgPath);
        return imgPath;
    }
}
</code></pre>
<h2 id="3agent执行效果">3.Agent执行效果</h2>
<p>Agent 执行效果如下：</p>
<p><img src="https://img2024.cnblogs.com/blog/172074/202505/172074-20250522202350034-2053444185.png" alt="" loading="lazy"></p>
<h2 id="小结">小结</h2>
<p>AI 发展为我们提供了很大的便利，大大的提升了我们的工作效率，<strong>以后人机共创将是新的方向</strong>。我们也要灵活使用 AI 工具，加上我们之前的编程经验，可以发挥出巨大的化学反应，开发出很多很好玩又实用的产品。一起行动起来吧，使用 AI 技术做点有价值又有意义的事情~</p>
<blockquote>
<p>本文已收录到我的技术小站 <a href="https://www.javacn.site" target="_blank" rel="noopener nofollow">www.javacn.site</a>，其中包含的内容有：Spring AI、LangChain4j、Dify、AI Agent、MCP、Function Call、RAG、向量数据库、Prompt、多模态、向量数据库、嵌入模型等内容。</p>
</blockquote>

</div>
<div id="MySignature" role="contentinfo">
    <div style="text-align: center; color: red">
关注下面二维码，订阅更多精彩内容。
<br>
<img style="margin-left: 0px" src="https://images.cnblogs.com/cnblogs_com/vipstone/848916/o_211225130402_gognzhonghao.jpg">
</div>

<div style="display: none">
    <img src="http://icdn.apigo.cn/gitchat/rabbitmq.png?imageView2/0/w/500/h/400">
</div>
<div style="margin-bottom: 50px; display: none">

<img title="微信打赏" src="http://icdn.apigo.cn/myinfo/wchat-pay.png" alt="微信打赏">
<br>

<div style="display: none">
<span style="display: block; position: absolute; height: 40px; top: 50%; margin-top: -20px">关注公众号（加好友）：</span>

<img style="margin-left: 144px" src="http://icdn.apigo.cn/gongzhonghao2.png?imageView2/0/w/120/h/120">
</div>
<p></p>

<div id="AllanboltSignature">
    <p style="border-top: #e0e0e0 1px dashed; border-right: #e0e0e0 1px dashed; border-bottom: #e0e0e0 1px dashed; border-left: #e0e0e0 1px dashed; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 60px; background: url(&quot;https://images.cnblogs.com/cnblogs_com/lloydsheng/239039/o_copyright.gif&quot;) #e5f1f4 no-repeat 1% 50%; font-family: 微软雅黑; font-size: 11px" id="PSignature">
        <br> 作者：
        <a href="http://vipstone.cnblogs.com/" target="_blank">王磊的博客</a>
        <br> 出处：
        <a href="http://vipstone.cnblogs.com/" target="_blank">http://vipstone.cnblogs.com/</a>
        <br>
    </p>
</div></div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.9114866776377315" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-22 20:24">2025-05-22 20:23</span>&nbsp;
<a href="https://www.cnblogs.com/vipstone">磊哥|www.javacn.site</a>&nbsp;
阅读(<span id="post_view_count">193</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18891936);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18891936', targetLink: 'https://www.cnblogs.com/vipstone/p/18891936', title: '实战：Dify智能体+Java=自动化运营工具！' })">举报</a>
</div>
        