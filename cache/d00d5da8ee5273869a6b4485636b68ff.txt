
	<div class="postTitle">
		<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/pokersang/p/18713798" title="发布于 2025-02-13 15:59">
    <span role="heading" aria-level="2">让Visual Studio的终端拥有命令补全（PSReadLine）</span>
    

</a>

	</div>
	
	<div class="postText">
		<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>如果你下载了Windows Terminal和最新版的PowerShell Core就会发现，<br>
如果不特殊设置的话，即使我们使用的Windows Terminal拥有命令补全，Visual Studio的终端仍然没有任何补全。</p>
<p>这是因为Visual Studio的终端使用的是系统自带的Windows PowerShell的模块（Modules），而不是Windows Terminal的模块，<br>
所以看起来会有不同。</p>
<p>而命令补全功能是由一个名为<code>PSReadLine</code>的模块提供的，Windows PowerShell中只有老版本v2.0.0，而Windows Terminal中是最新的版本。<br>
我们可以用<code>Get-Module -ListAvailable</code>看到这种情况：</p>
<pre><code class="language-pwsh">PS C:\Users\poker&gt; Get-Module -ListAvailable

...

    Directory: C:\program files\windowsapps\microsoft.powershell_7.5.0.0_x64__8wekyb3d8bbwe\Modules

ModuleType Version    PreRelease Name       ...
---------- -------    ---------- ----       ...
Script     2.3.6                 PSReadLine ...
...

    Directory: C:\Program Files\WindowsPowerShell\Modules

ModuleType Version    PreRelease Name       ...
---------- -------    ---------- ----       ...
Script     2.0.0                 PSReadLine ...
...
</code></pre>
<p>既然是老版本，升级模块应该就可以了吧？然而它会报错：</p>
<pre><code class="language-pwsh">PS C:\Users\poker&gt; Update-Module PSReadLine
Update-Module: Module 'PSReadLine' was not installed by using Install-Module, so it cannot be updated.
</code></pre>
<h2 id="解决方法">解决方法</h2>
<p>通过尝试我找到了一种简单的解决方法：直接覆盖新的模块。</p>
<p>首先，如果Windows Terminal中也没有最新版的<code>PSReadLine</code>的话，可以运行<code>Install-Module PSReadLine</code>安装最新版本。<br>
安装过程中若有需要信任或同意的选项，信任/同意即可。</p>
<p>然后根据刚刚<code>Get-Module -ListAvailable</code>输出的路径，一般来说是：</p>
<ul>
<li>
<p>Windows Terminal模块路径</p>
<pre><code class="language-plaintext">C:\program files\windowsapps\microsoft.powershell_7.5.0.0_x64__8wekyb3d8bbwe\Modules
</code></pre>
</li>
<li>
<p>Windows PowerShell模块路径</p>
<pre><code class="language-plaintext">C:\Program Files\WindowsPowerShell\Modules
</code></pre>
</li>
</ul>
<p>分别打开之后，先关闭所有PowerShell窗口，包括并不限于Visual Studio中的。</p>
<p>然后删除Windows PowerShell路径下的<code>PSReadLine</code>文件夹，再将Windows Terminal路径下的<code>PSReadLine</code>文件夹复制过来即可。</p>
<p>最后再次打开Visual Studio的终端，可以发现已经支持命令补全了。</p>
<h2 id="注意">注意</h2>
<p>不要用此方法更新其他模块，尤其是<code>PowerShellGet</code>、<code>PackageManagement</code>。<br>
因为Windows PowerShell版本较老，可能不支持新版的模块，但目前<code>PSReadLine</code>还没有发现不支持的情况。</p>

</div>
<div class="clear"></div>

	</div>
	
	<div class="postfoot">
		posted on 
<span id="post-date" data-last-update-days="0.02508469803472222" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-02-13 16:01">2025-02-13 15:59</span>&nbsp;
<a href="https://www.cnblogs.com/pokersang">扑克子</a>&nbsp;
阅读(<span id="post_view_count">1</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18713798" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18713798);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18713798', targetLink: 'https://www.cnblogs.com/pokersang/p/18713798', title: '让Visual Studio的终端拥有命令补全（PSReadLine）' })">举报</a>

	</div>
