
<table cellspacing="0" cellpadding="0"><tbody><tr><td class="t_f" id="postmessage_52647556">
<i class="pstatus"> 本帖最后由 ddyy004 于 2025-3-18 14:00 编辑 </i><br>
<br>
WIN11打印总是各种问题，今天解决的是标题问题。财务的打印机跟着更新补丁一代补丁一代神啊。<br>
已经从WIN10虐到WIN11 找了无数方法，最终用这个办法解决的。<br>
<br>
神器下载地址： <a rel="nofollow noopener" href="https://pan.baidu.com/s/1cxmLzPvw_kXjQpUnPexGXw?pwd=ktaw" target="_blank">https://pan.baidu.com/s/1cxmLzPvw_kXjQpUnPexGXw?pwd=ktaw</a> 提取码: ktaw <br>
<br>
运行<font style="color:rgb(252, 85, 49)"><a rel="nofollow noopener" href="https://so.csdn.net/so/search?q=BAT%E6%96%87%E4%BB%B6&amp;spm=1001.2101.3001.7020" target="_blank">BAT文件</a></font>即可。<br>
<br>
解决这个问题认准系统版本。<br>
因为系统版本不同替换文件不同。<br>
以后有什么问题解答我会慢慢分享在这里。希望能给大家带来一些帮助。<br>
<br>
<div style="padding:15px 0;"><div style="font-size:12px;">[Asm] <em class="viewsource" style="cursor:pointer;font-size:12px;color:#369 !important;">纯文本查看</em> <em class="copycode" style="cursor:pointer;font-size:12px;color:#369 !important;">复制代码</em></div><pre class="brush: asm; gutter: true">@echo off
title 修复共享打印机
cd /d "%~dp0"
%1 %2
ver|find "5."&gt;nul&amp;&amp;goto :start
mshta vbscript:createobject("shell.application").shellexecute("%~s0","goto :start","","runas",1)(window.close)&amp;goto :eof
:start
title 修复共享打印机
echo 适用于修复共享打印机无法使用问题
echo 正在停止打印服务…………
net stop spooler
echo 正在获取打印文件权限…………
TAKEOWN /F C:\Windows\System32\localspl.dll /A
Icacls C:\windows\System32\localspl.dll /grant Administrators:F
TAKEOWN /F C:\Windows\System32\win32spl.dll /A
Icacls C:\windows\System32\win32spl.dll /grant Administrators:F
TAKEOWN /F C:\Windows\System32\spoolsv.exe /A
Icacls C:\windows\System32\spoolsv.exe /grant Administrators:F
echo 正在删除打印机文件…………
copy C:\windows\system32\localspl.dll C:\windows\system32\localspl-77bx.dll
copy C:\windows\system32\win32spl.dll C:\windows\system32\win32spl-77bx.dll
copy C:\windows\system32\spoolsv.exe C:\windows\system32\spoolsv-77bx.exe
del /F /Q C:\windows\system32\localspl.dll
del /F /Q C:\windows\system32\win32spl.dll
del /F /Q C:\windows\system32\spoolsv.exe
echo 正在重载打印机文件…………
copy localspl.dll C:\windows\system32\localspl.dll
copy win32spl.dll C:\windows\system32\win32spl.dll
copy spoolsv.exe C:\windows\system32\spoolsv.exe
echo 正在启动打印服务…………
net start spooler
Echo --------------------------------------------------------------------------
Echo 完成操作，请进行打印测试吧！
pause</pre></div><br>
</td></tr></tbody></table>


