
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xwz1024/p/19021699" title="发布于 2025-08-04 16:14">
    <span role="heading" aria-level="2">Django集成图片验证码功能：基于django-simple-captcha实现</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1565852/202508/1565852-20250804161416764-2017286929.png" alt="Django集成图片验证码功能：基于django-simple-captcha实现" class="desc_img">
        在Web应用开发中，验证码是防止恶意攻击、自动化脚本滥用的重要手段。本文将介绍如何使用django-simple-captcha库在Django项目中快速集成图片验证码功能，包括安装配置、核心实现代码及使用方法。
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="一验证码工具选择">一、验证码工具选择</h2>
<p><code>django-simple-captcha</code> 是一款轻量且高度可定制的 Django 验证码应用，具有以下优势</p>
<ul>
<li>多样化验证码类型：支持随机字符、数学运算、字典单词等多种验证形式</li>
<li>高度可定制：可自定义验证码样式、噪声效果和过滤规则</li>
<li>良好的交互性：支持 AJAX 动态刷新，无需重新加载页面</li>
<li>音频输出支持 ：提供音频输出功能，提升可访问性</li>
</ul>
<h2 id="二验证码工作流程">二、验证码工作流程</h2>
<p>一个完整的验证码验证流程如下：</p>
<ol>
<li>用户访问页面时，前端请求生成验证码</li>
<li>后端生成验证码图片和对应的验证 key，返回给前端</li>
<li>用户输入验证码并提交表单，前端将用户输入与验证 key 一同发送到后端</li>
<li>后端进行二次校验，验证用户输入的正确性</li>
<li>返回校验结果给前端，完成整个验证流程</li>
</ol>
<p><img alt="image-20250804151240511" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1565852/202508/1565852-20250804161305300-27550806.png" class="lazyload"></p>
<h2 id="三安装与基础配置">三、安装与基础配置</h2>
<h3 id="安装依赖包">安装依赖包</h3>
<p>安装</p>
<pre><code class="language-sh">pip install django-simple-captcha
</code></pre>
<h3 id="项目配置">项目配置</h3>
<p>配置 <code>settings.py</code></p>
<pre><code class="language-sh"># `INSTALLED_APPS` 中添加 `'captcha'`
INSTALLED_APPS = [
    # ...
    'captcha',
]

### 验证码配置
CAPTCHA_CHALLENGE_FUNCT = "captcha.helpers.math_challenge"  # 验证码生成方式
CAPTCHA_TIMEOUT = 1  # 验证码有效期，单位为分钟
</code></pre>
<p>迁移数据库（验证码需要存储验证记录）</p>
<pre><code class="language-sh">python manage.py migrate captcha
</code></pre>
<h2 id="四核心功能实现">四、核心功能实现</h2>
<h3 id="后端实现">后端实现</h3>
<p>下面通过一个视图集实现<strong>验证码的生成和验证功能</strong>，适用于前后端分离架构。<a href="https://gitee.com/zhulj993/mars-mgn/blob/master/mysite/myapp_system/captcha/views.py" target="_blank" rel="noopener nofollow">点击查看完整代码</a></p>
<p><img alt="image-20250804152223001" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1565852/202508/1565852-20250804161320119-421676208.png" class="lazyload"></p>
<p>配置<code>urls.py</code></p>
<pre><code class="language-python"># 管理后台 - 验证码
router.register(r"captcha", CaptchaViewSet, basename="captcha")
</code></pre>
<h3 id="前端实现">前端实现</h3>
<p>编写一个验证码Vue组件，主要功能包括：</p>
<ul>
<li>显示验证码：通过<code>img</code>标签展示验证码图片，点击可刷新</li>
<li>用户输入：提供输入框供用户输入验证码</li>
<li>数据存储：隐藏域存储验证码的hashkey</li>
<li>接口调用：调用API获取验证码图片和验证用户输入</li>
<li>验证功能：提供validateCaptcha方法供父组件调用验证</li>
</ul>
<pre><code class="language-vue">&lt;template&gt;
  &lt;div class="captcha-wrapper"&gt;
    &lt;!-- 用户输入框 --&gt;
    &lt;input type="text" v-model="userInput" placeholder="请输入验证码" class="captcha-input" /&gt;
    &lt;!-- 验证码图片（点击可刷新） --&gt;
    &lt;img :src="captchaImage" @click="refreshCaptcha" class="captcha-img" /&gt;
    &lt;!-- 隐藏域存储hashkey --&gt;
    &lt;input type="hidden" v-model="captchaHashKey" /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted } from 'vue'
import * as LoginApi from '@/api/login'

const captchaImage = ref('')
const captchaHashKey = ref('')
const userInput = ref('')

// 初始化获取验证码
const fetchCaptcha = async () =&gt; {
  try {
    const response = await LoginApi.getCode({})
    // console.log('验证码响应:', response) // 添加日志
    if (response.code === 0) {
      captchaImage.value = response.data.imageBase
      captchaHashKey.value = response.data.captchaKey
    } else {
      console.error('验证码加载失败:', response.msg)
    }
  } catch (error) {
    console.error('验证码加载失败:', error)
  }
}

// 点击刷新验证码
const refreshCaptcha = () =&gt; fetchCaptcha()

// 暴露验证方法
const validateCaptcha = async () =&gt; {
  try {
    const response = await LoginApi.reqCheck({
      captchaKey: captchaHashKey.value,
      captchaValue: userInput.value
    })
    return response.code === 0
  } catch (error) {
    console.error('验证码验证失败:', error)
    return false
  }
}

// 组件挂载时加载验证码
onMounted(() =&gt; {
  fetchCaptcha()
})

// 暴露接口给父组件
defineExpose({ validateCaptcha })
&lt;/script&gt;
</code></pre>
<h3 id="实现效果">实现效果</h3>
<p>可通过配置选项控制验证码是否开启，支持点击刷新验证码</p>
<p><img alt="image-20250804153105987" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1565852/202508/1565852-20250804161334159-20816127.png" class="lazyload"></p>
<p><a href="https://gitee.com/zhulj993/mars-mgn-vue/blob/master/src/views/Login/components/CaptchaComponent.vue" target="_blank" rel="noopener nofollow">点击查看完整代码</a></p>
<h2 id="五base64-图片格式说明">五、Base64 图片格式说明</h2>
<p>在上面的实现中，我们使用了 Base64 格式来传输图片，这是一种将二进制数据编码为可打印字符的方法</p>
<ul>
<li>图片的 Base64 格式通常以 <code>data:image/图片格式;base64,</code> 开头</li>
<li>示例：<code>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA...</code></li>
<li>优势：可以直接嵌入到 HTML 或 JSON 中，减少 HTTP 请求次数</li>
</ul>
<p>适用场景</p>
<ul>
<li>小型图片资源（如验证码、图标等）</li>
<li>需要跨平台传输二进制数据的场景</li>
</ul>
<hr>
<p>您正在阅读的是《<strong>Django从入门到实战</strong>》专栏！关注不迷路~</p>

</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-08-04 16:15">2025-08-04 16:14</span>&nbsp;
<a href="https://www.cnblogs.com/xwz1024">小王子1024</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19021699);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19021699', targetLink: 'https://www.cnblogs.com/xwz1024/p/19021699', title: 'Django集成图片验证码功能：基于django-simple-captcha实现' })">举报</a>
</div>
	