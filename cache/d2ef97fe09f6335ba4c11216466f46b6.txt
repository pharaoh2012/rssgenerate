
<table cellspacing="0" cellpadding="0"><tbody><tr><td class="t_f" id="postmessage_52543518">
<div class="parsedown-markdown"><p>使用之前的bat快速启动微信来多开的方法失效。</p>
<p>经过搜索查询后发现是"C:\Users\用户名\AppData\Roaming\Tencent\xwechat\lock\lock.ini"，存在这个文件的时候就不能再次打开微信。</p>
<p>然后删除这个文件无效，只能关闭微信删除，但是启动微信会自动生成这个文件，关闭文件夹的权限的话无法启动微信。所以只能在微信打开的时候删除这个文件，然后再次启动微信。</p>
<p>常规的删除方法无效，通过powershell的Remove-Item还有cmd的del都无效。以下是有效的方法：</p>
<p>下载<a rel="nofollow noopener" href="https://learn.microsoft.com/zh-cn/sysinternals/downloads/handle" target="_blank">Handle - Sysinternals | Microsoft Learn</a></p>
<p>解压其中的内容，移动到</p>
<p><code>C:\Windows\System32</code></p>
<p>或者其他目录也行，后面运行的时候记得写上路径</p>
<p>然后管理员打开powershell</p>
<pre><code>
#执行

handle64.exe "C:\Users\你的用户名\AppData\Roaming\Tencent\xwechat\lock\lock.ini"

# 存在这个文件的时候就不能打开，
</code></pre>
<p>输出如下：</p>
<pre><code>
Nthandle v5.0 - Handle viewer

Copyright (C) 1997-2022 Mark Russinovich

Sysinternals - www.sysinternals.com

Weixin.exe&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;pid: 20976&nbsp;&nbsp;type: File&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;30C: C:\Users\你的用户名\AppData\Roaming\Tencent\xwechat\lock\lock.ini
</code></pre>
<p>从中获取两部分内容：</p>
<p>pid后面的 20976 以及type:File后面的 30C</p>
<p>执行</p>
<pre><code>
# 这里需要替换成你自己的

handle64.exe -p 20976 -c 30C -y
</code></pre>
<p>输出</p>
<pre><code>
Nthandle v5.0 - Handle viewer

Copyright (C) 1997-2022 Mark Russinovich

Sysinternals - www.sysinternals.com

&nbsp;&nbsp;30C: File&nbsp;&nbsp;(RW-)&nbsp; &nbsp;C:\Users\你的用户名\AppData\Roaming\Tencent\xwechat\lock\lock.ini

Handle closed.
</code></pre>
<p>即可继续执行删除</p>
<pre><code>
Remove-Item -Path "C:\Users\你的用户名\AppData\Roaming\Tencent\xwechat\lock\lock.ini" -Force
</code></pre>
<p>如此可以删除文件，然后再点击微信的启动图标即可双开</p></div>
<div class="parsedown-markdown-end_FLAG_ZXSQ" style="display:none"></div></td></tr></tbody></table>


