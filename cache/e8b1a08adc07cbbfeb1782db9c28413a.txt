
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/fanliang11/p/18876872" title="发布于 2025-05-14 23:45">
    <span role="heading" aria-level="2">凯亚物联网增加MQTT设备功能测试</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h2>一、前言&nbsp;</h2>
<p>这几天一直在测试设备功能，并且搭建了线上分布式流媒体推送，内存还比较稳定，.NET 8.0 性能不错，内存控制已经赶上了C++了，大家闲暇时间可以玩玩设备功能以及其它功能，过几天会发布测试版提供下载，后续会把surging 升级基于.NET 8.0，spandotnetty 稳定版本</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202505/192878-20250514231843142-694509353.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>HttpFlv:<a href="http://117.72.121.2:281/httpflv.html" rel="noopener nofollow" target="_blank">http://117.72.121.2:281/httpflv.html</a>&nbsp; <a target="_blank">（黑衣人）</a></p>
<p>&nbsp;HttpFlv:<a href="http://117.72.121.2:281/httpflv1.html" rel="noopener nofollow" target="_blank">http://117.72.121.2:281/httpflv1.html&nbsp;</a> <a target="_blank">（大红包）</a></p>
<p>rtmp:<a target="_blank">rtmp://117.72.121.2:76/live1/livestream2&nbsp;&nbsp; （黑衣人）</a></p>
<p>rtmp:<a target="_blank">rtmp://117.72.121.2:76/live1/livestream3&nbsp;&nbsp; （大红包）</a></p>
<p>&nbsp; 凯亚 (Kayak) 是什么?</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 凯亚(Kayak)是基于.NET6.0软件环境下的surging微服务引擎进行开发的, 平台包含了微服务和物联网平台。支持异步和响应式编程开发，功能包含了物模型,设备,产品,网络组件的统一管理和微服务平台下的注册中心，服务路由，模块，中间服务等管理。还有多协议适配(TCP,MQTT,UDP,CoAP,HTTP,Grpc,websocket,rtmp,httpflv,webservice,等),通过灵活多样的配置适配能够接入不同厂家不同协议等设备。并且通过设备告警,消息通知,数据可视化等功能。能够让你能快速建立起微服务物联网平台系统。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; 凯亚物联网平台：<a href="http://117.72.121.2:3100" rel="noopener nofollow" target="_blank">http://117.72.121.2:3100</a>（用户名：fanly&nbsp; 密码：123456）</p>
<p>&nbsp; &nbsp; 链路跟踪Skywalking V8:<a href="http://117.72.121.2:8080/" rel="noopener nofollow" target="_blank">http://117.72.121.2:8080/</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; surging 微服务引擎开源地址：<a href="https://github.com/fanliang11/surging" rel="noopener nofollow" target="_blank">https://github.com/fanliang11/surging</a>（后面surging 会移动到<a href="https://github.com/microsurging/" rel="noopener nofollow" target="_blank">microsurging</a>进行维护）</p>
<h2>二、测试工具使用</h2>
<p>大家可以下载mqttclient 进行测试，直接点击连接服务器和订阅，都自动生成好了</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202505/192878-20250514232721192-161026087.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>通过网盘分享的文件：mqttclient.zip<br>链接: https://pan.baidu.com/s/1LsBTVtJdW7Qd24wc_cUYEg?pwd=m3g9 提取码: m3g9</p>
<p>&nbsp;</p>
<h2 class="postTitle">三、配置</h2>
<p>可以在产品中配置设备接入</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202504/192878-20250427215305869-74566803.png" alt="" class="medium-zoom-image"></p>
<p>配置MQTT认证配置</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202504/192878-20250427215635332-1164524694.png" alt="" class="medium-zoom-image"></p>
<p>功能定义</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233153794-392821647.png" alt="" loading="lazy"></p>
<p>&nbsp;配置输入参数</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233251847-357330321.png" alt="" loading="lazy"></p>
<p>&nbsp;配置输出参数</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233332894-122677502.png" alt="" loading="lazy"></p>
<h2>&nbsp;四、设备功能</h2>
<p>设备功能包括常规模式和窗口模式， 常规模式是文本框输入进行提交执行，窗口模式是json 提交执行，如果没有设备连接，点击执行会提示设备未在线</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233548598-1398039070.png" alt="" loading="lazy"></p>
<p>&nbsp;点击执行后，在MQTT客户端会接收一条消息，然后对于该命令消息进行回复通知服务端，表示设备已经执行， 对于消息回复需要发布主题为 /game-123/DJI-Mavic-v332x12/function/call/reply的消息，消息内容为</p>
<div class="cnblogs_code">
<pre>{<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Outputs</span><span style="color: rgba(128, 0, 0, 1)">"</span>:{<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Code</span><span style="color: rgba(128, 0, 0, 1)">"</span>:<span style="color: rgba(128, 0, 128, 1)">22</span>,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Success</span><span style="color: rgba(128, 0, 0, 1)">"</span>:<span style="color: rgba(0, 0, 255, 1)">true</span>,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Message</span><span style="color: rgba(128, 0, 0, 1)">"</span>:<span style="color: rgba(128, 0, 0, 1)">""</span>},<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">FunctionId</span><span style="color: rgba(128, 0, 0, 1)">"</span>:<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">close</span><span style="color: rgba(128, 0, 0, 1)">"</span>,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">MessageId</span><span style="color: rgba(128, 0, 0, 1)">"</span>:<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">932279d5f8a84b8881624ea9714bf9d7</span><span style="color: rgba(128, 0, 0, 1)">"</span>}</pre>
</div>
<p>注意：要与接收消息<span style="color: rgba(128, 0, 0, 1)">MessageId</span>保持一致，这样才知道这条消息为回复消息。</p>
<p><img src="https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233807757-1415559204.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.02075135538888889" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-14 23:49">2025-05-14 23:45</span>&nbsp;
<a href="https://www.cnblogs.com/fanliang11">fanly11</a>&nbsp;
阅读(<span id="post_view_count">3</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18876872);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18876872', targetLink: 'https://www.cnblogs.com/fanliang11/p/18876872', title: '凯亚物联网增加MQTT设备功能测试' })">举报</a>
</div>
        