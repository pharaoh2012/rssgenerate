
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/du-hong/p/18405731" title="å‘å¸ƒäº 2025-06-12 08:30">
    <span role="heading" aria-level="2">ğŸ”¥ã€Šåˆšåˆšé—®ä¸–ã€‹ç³»åˆ—åˆçª¥ç¯‡-Java+Playwrightè‡ªåŠ¨åŒ–æµ‹è¯•-17-  å¦‚ä½•ä¼˜é›…åœ°åˆ‡æ¢æµè§ˆå™¨å¤šçª—å£ï¼ˆè¯¦ç»†æ•™ç¨‹ï¼‰</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h3>1.ç®€ä»‹</h3>
<p>æœ‰æ—¶å€™æˆ‘ä»¬åœ¨ç½‘é¡µä¸Šç‚¹å‡»ä¸€äº›æŒ‰é’®æˆ–è¶…é“¾æ¥æ—¶ï¼Œæœ‰æ—¶ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„ç½‘é¡µçª—å£ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœä¸‹ä¸€æ­¥æ“ä½œæ˜¯åœ¨æ–°çš„ç½‘é¡µçª—å£ä¸Šï¼Œé‚£ä¹ˆå°±éœ€è¦åˆ‡æ¢ç½‘é¡µçª—å£ï¼Œåˆ‡æ¢åˆ°æ–°çš„ç½‘é¡µçª—å£åå†æ‰§è¡Œå…ƒç´ å®šä½ç­‰æ“ä½œã€‚Playwrightå¤„ç†æµè§ˆå™¨å¤šçª—å£åˆ‡æ¢ç›¸æ¯”è¾ƒäºSeleniumç®€å•å¿«æ·ã€‚ä¸‹è¾¹å®å“¥å°±ç»™å°ä¼™ä¼´ä»¬æˆ–è€…ç«¥é‹ä»¬ä»‹ç»ä¸€ä¸‹playwrighå¦‚ä½•ä¼˜é›…åœ°åˆ‡æ¢æµè§ˆå™¨å¤šä¸ªçª—å£ã€‚</p>
<h3>2.çª—å£åˆ‡æ¢æ­¥éª¤</h3>
<p>1ã€ context.pages(); //è·å–æ‰€æœ‰çš„pageå¯¹è±¡ï¼Œè¿”å›æ•°æ®ç±»å‹ä¸ºåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„ç½‘é¡µå¯¹è±¡çš„ç´¢å¼•æŒ‰ç…§æ‰“å¼€é¡ºåºä»0å¼€å§‹ä¾æ¬¡é€’å¢ã€‚<br>2ã€ page.bringToFront();&nbsp; //æ¿€æ´»ç½‘é¡µï¼Œå°†ç½‘é¡µæ˜¾ç¤ºåœ¨å±å¹•æœ€ä¸Šå±‚ï¼Œæœ¬è¡Œä»£ç ä¸å†™ä¹Ÿä¸å½±å“è„šæœ¬æ‰§è¡Œã€‚<br>3ã€ page.close();&nbsp; //å…³é—­ç½‘é¡µã€‚</p>
<h3 id="autoid-0-1-0">3.æµ‹è¯•åœºæ™¯</h3>
<p>æˆ‘ä»¬ä»¥è®¿é—®ç™¾åº¦ä¸ºä¾‹ï¼Œç™¾åº¦é¦–é¡µæœ‰å¤šä¸ªé€‰é¡¹ï¼Œæ–°é—»ï¼Œhao123ç½‘å€å¯¼èˆªï¼Œè´´å§ç­‰å¤šä¸ªé€‰é¡¹ï¼Œæˆ‘ä»¬ç‚¹å‡»ä¸åŒçš„é€‰é¡¹ï¼Œå°±ä¼šæ‰“å¼€ä¸åŒçš„æ–°æ ‡ç­¾é¡µã€‚å½“æ‰“å¼€å¤šä¸ªæ ‡ç­¾é¡µåï¼Œ å¦‚ä½•åˆ‡æ¢åˆ°è‡ªå·±æƒ³è¦çš„é¡µé¢ä¸Šæ“ä½œã€‚</p>
<p><img src="https://img2023.cnblogs.com/blog/1232840/202307/1232840-20230711153939685-482326488.png" alt="" class="medium-zoom-image" loading="lazy"></p>
<p>æ€è·¯ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡è„šæœ¬ï¼Œè¾“å‡ºç™¾åº¦é¦–é¡µå„é¡µé¢çš„æ ‡é¢˜ï¼Œé€šè¿‡context.pages();&nbsp;å¯ä»¥è·å–åˆ°æ‰€æœ‰çš„pageå¯¹è±¡ï¼Œæ¯ä¸€ä¸ªpageå¯¹è±¡å°±ä»£è¡¨ä¸€ä¸ªæ ‡ç­¾é¡µå®ä¾‹ã€‚</p>
<h4>3.1ä»£ç è®¾è®¡</h4>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910095542916-1877517521.png" alt="" loading="lazy"></p>
<h4>3.2å‚è€ƒä»£ç </h4>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">package</span><span style="color: rgba(0, 0, 0, 1)"> com.bjhg.playwright;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.List;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Browser;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.BrowserContext;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.BrowserType;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Locator;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Page;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Playwright;

</span><span style="color: rgba(0, 128, 0, 1)">/**</span><span style="color: rgba(0, 128, 0, 1)">
 * </span><span style="color: rgba(128, 128, 128, 1)">@author</span><span style="color: rgba(0, 128, 0, 1)"> åŒ—äº¬-å®å“¥
 * 
 * @å…¬ä¼—å·:åŒ—äº¬å®å“¥ï¼ˆå¾®ä¿¡æœç´¢ï¼Œå…³æ³¨å®å“¥ï¼Œæå‰è§£é”æ›´å¤šæµ‹è¯•å¹²è´§ï¼‰
 * 
 * ã€Šåˆšåˆšé—®ä¸–ã€‹ç³»åˆ—åˆçª¥ç¯‡-Java+Playwrightè‡ªåŠ¨åŒ–æµ‹è¯•-17-  å¦‚ä½•ä¼˜é›…åœ°åˆ‡æ¢æµè§ˆå™¨å¤šçª—å£ï¼ˆè¯¦ç»†æ•™ç¨‹ï¼‰
 *
 * 2024å¹´9æœˆ19æ—¥
 </span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> Test_Switch_Window {
    
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> main(String[] args) {
        </span><span style="color: rgba(0, 0, 255, 1)">try</span> (Playwright playwright =<span style="color: rgba(0, 0, 0, 1)"> Playwright.create()) {
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1.ä½¿ç”¨chromiumæµè§ˆå™¨ï¼Œ# æµè§ˆå™¨é…ç½®ï¼Œè®¾ç½®ä»¥GUIæ¨¡å¼å¯åŠ¨Chromeæµè§ˆå™¨ï¼ˆè¦æŸ¥çœ‹æµè§ˆå™¨UIï¼Œåœ¨å¯åŠ¨æµè§ˆå™¨æ—¶ä¼ é€’ headless=false æ ‡å¿—ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ slowMo æ¥å‡æ…¢æ‰§è¡Œé€Ÿåº¦ã€‚</span>
          Browser browser = playwright.chromium().launch(<span style="color: rgba(0, 0, 255, 1)">new</span> BrowserType.LaunchOptions().setHeadless(<span style="color: rgba(0, 0, 255, 1)">false</span>).setSlowMo(3000<span style="color: rgba(0, 0, 0, 1)">));
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2.åˆ›å»ºcontext</span>
          BrowserContext context =<span style="color: rgba(0, 0, 0, 1)"> browser.newContext();
         
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åˆ›å»ºpage</span>
          Page page =<span style="color: rgba(0, 0, 0, 1)"> context.newPage();
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">3.æµè§ˆå™¨æ‰“å¼€ç½‘ç«™</span>
          page.navigate("https://www.baidu.com"<span style="color: rgba(0, 0, 0, 1)">);
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">4.ç‚¹å‡»æ‰“å¼€å¤šä¸ªæ–°çš„æ ‡ç­¾é¡µ</span>
          List&lt;Locator&gt; links = page.locator("#s-top-left&gt;a"<span style="color: rgba(0, 0, 0, 1)">).all();
          </span><span style="color: rgba(0, 0, 255, 1)">for</span><span style="color: rgba(0, 0, 0, 1)">(Locator link:links){
              link.click();
          }
          
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">5.éå†pageå¯¹è±¡</span>
          List&lt;Page&gt; pages =<span style="color: rgba(0, 0, 0, 1)"> context.pages();
          </span><span style="color: rgba(0, 0, 255, 1)">for</span><span style="color: rgba(0, 0, 0, 1)">(Page i:pages){
              System.out.println(i.title());
          }
          
          System.out.println(</span>"Test Pass"<span style="color: rgba(0, 0, 0, 1)">);
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å…³é—­page</span>
<span style="color: rgba(0, 0, 0, 1)">          page.close();
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å…³é—­browser</span>
<span style="color: rgba(0, 0, 0, 1)">          browser.close();
        }
    }

}</span></pre>
</div>
<h4>3.3è¿è¡Œä»£ç </h4>
<p>1.è¿è¡Œä»£ç ï¼Œå³é”®Run As-&gt;Java Applicationï¼Œå°±å¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910095510938-1335319945.png" alt="" loading="lazy"></p>
<p>2.è¿è¡Œä»£ç åç”µè„‘ç«¯çš„æµè§ˆå™¨çš„åŠ¨ä½œã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910100337231-163763313.gif" alt="" loading="lazy"></p>
<h3 id="autoid-0-2-3">4.å¤šçª—å£åˆ‡æ¢æ–¹æ³•</h3>
<h4 id="autoid-0-3-0">4.1Titleåˆ‡æ¢</h4>
<p>ä»ä¸Šè¾¹å¯ä»¥çœ‹åˆ°å®å“¥å·²ç»å°†æ‰€æœ‰çš„æ ‡ç­¾çš„titleéƒ½å¾ªç¯å‡ºæ¥äº†ï¼Œå› æ­¤æˆ‘ä»¬åªè¦åˆ‡æ¢åˆ°æˆ‘ä»¬éœ€è¦æ“ä½œçš„titleæ ‡ç­¾é¡µå³å¯åˆ‡æ¢å¯¹åº”çª—å£ç„¶åå†è¿›è¡Œåç»­å®šä½æ“ä½œã€‚</p>
<h5>4.1.1ä»£ç è®¾è®¡</h5>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910141524285-112977954.png" alt="" loading="lazy"></p>
<h5>4.1.2å‚è€ƒä»£ç </h5>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">package</span><span style="color: rgba(0, 0, 0, 1)"> com.bjhg.playwright;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.List;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Browser;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.BrowserContext;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.BrowserType;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Locator;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Page;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Playwright;

</span><span style="color: rgba(0, 128, 0, 1)">/**</span><span style="color: rgba(0, 128, 0, 1)">
 * </span><span style="color: rgba(128, 128, 128, 1)">@author</span><span style="color: rgba(0, 128, 0, 1)"> åŒ—äº¬-å®å“¥
 * </span><span style="color: rgba(128, 128, 128, 1)">@param</span><span style="color: rgba(0, 128, 0, 1)"> &lt;context&gt;
 * 
 * @å…¬ä¼—å·:åŒ—äº¬å®å“¥ï¼ˆå¾®ä¿¡æœç´¢ï¼Œå…³æ³¨å®å“¥ï¼Œæå‰è§£é”æ›´å¤šæµ‹è¯•å¹²è´§ï¼‰
 * 
 * ã€Šåˆšåˆšé—®ä¸–ã€‹ç³»åˆ—åˆçª¥ç¯‡-Java+Playwrightè‡ªåŠ¨åŒ–æµ‹è¯•-17-  å¦‚ä½•ä¼˜é›…åœ°åˆ‡æ¢æµè§ˆå™¨å¤šçª—å£ï¼ˆè¯¦ç»†æ•™ç¨‹ï¼‰
 *
 * 2024å¹´9æœˆ19æ—¥
 </span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> Test_Switch_Window{
    
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span><span style="color: rgba(0, 0, 0, 1)"> Page switchToPage(BrowserContext context,String string){
        
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åˆ‡æ¢åˆ°æŒ‡å®štitle åç§°çš„æ ‡ç­¾é¡µ</span>
        List&lt;Page&gt; pages =<span style="color: rgba(0, 0, 0, 1)"> context.pages();
        
        </span><span style="color: rgba(0, 0, 255, 1)">for</span><span style="color: rgba(0, 0, 0, 1)">(Page i:pages){
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(string != <span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">){
                </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">(i.title().contains(string)){
                    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">æ¿€æ´»å½“å‰é€‰é¡¹å¡</span>
<span style="color: rgba(0, 0, 0, 1)">                    i.bringToFront();
                    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> i;
                }
            }</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">{
                System.out.println(</span>"not found title"<span style="color: rgba(0, 0, 0, 1)">);
            }
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">            return context.pages[0];        </span>
<span style="color: rgba(0, 0, 0, 1)">        }
        </span><span style="color: rgba(0, 0, 255, 1)">return</span> (Page) pages.listIterator(0<span style="color: rgba(0, 0, 0, 1)">); 
    }

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> main(String[] args) {
        </span><span style="color: rgba(0, 0, 255, 1)">try</span> (Playwright playwright =<span style="color: rgba(0, 0, 0, 1)"> Playwright.create()) {
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1.ä½¿ç”¨chromiumæµè§ˆå™¨ï¼Œ# æµè§ˆå™¨é…ç½®ï¼Œè®¾ç½®ä»¥GUIæ¨¡å¼å¯åŠ¨Chromeæµè§ˆå™¨ï¼ˆè¦æŸ¥çœ‹æµè§ˆå™¨UIï¼Œåœ¨å¯åŠ¨æµè§ˆå™¨æ—¶ä¼ é€’ headless=false æ ‡å¿—ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ slowMo æ¥å‡æ…¢æ‰§è¡Œé€Ÿåº¦ã€‚</span>
          Browser browser = playwright.chromium().launch(<span style="color: rgba(0, 0, 255, 1)">new</span> BrowserType.LaunchOptions().setHeadless(<span style="color: rgba(0, 0, 255, 1)">false</span>).setSlowMo(300<span style="color: rgba(0, 0, 0, 1)">));
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2.åˆ›å»ºcontext</span>
          BrowserContext context =<span style="color: rgba(0, 0, 0, 1)"> browser.newContext();
         
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åˆ›å»ºpage</span>
          Page page =<span style="color: rgba(0, 0, 0, 1)"> context.newPage();
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">3.æµè§ˆå™¨æ‰“å¼€ç½‘ç«™</span>
          page.navigate("https://www.baidu.com"<span style="color: rgba(0, 0, 0, 1)">);
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">4.ç‚¹å‡»æ‰“å¼€å¤šä¸ªæ–°çš„æ ‡ç­¾é¡µ</span>
          List&lt;Locator&gt; links = page.locator("#s-top-left&gt;a"<span style="color: rgba(0, 0, 0, 1)">).all();
          </span><span style="color: rgba(0, 0, 255, 1)">for</span><span style="color: rgba(0, 0, 0, 1)">(Locator link:links){
              link.click();
          }
          
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">5.æ‰“å¼€å¤šä¸ªtab æ ‡ç­¾é¡µï¼Œ åˆ‡æ¢åˆ°æ–°é—»é¡µ</span>
          Page page1 = switchToPage(context, "æ–°é—»"<span style="color: rgba(0, 0, 0, 1)">);
          System.out.println(page1.title());
          
          System.out.println(</span>"Test Pass"<span style="color: rgba(0, 0, 0, 1)">);
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å…³é—­page</span>
<span style="color: rgba(0, 0, 0, 1)">          page.close();
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å…³é—­browser</span>
<span style="color: rgba(0, 0, 0, 1)">          browser.close();
        }
    }

}</span></pre>
</div>
<h5>4.1.3è¿è¡Œä»£ç </h5>
<p>1.è¿è¡Œä»£ç ï¼Œå³é”®Run As-&gt;Java Applicationï¼Œå°±å¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910141722253-23663833.png" alt="" loading="lazy"></p>
<p>2.è¿è¡Œä»£ç åç”µè„‘ç«¯çš„æµè§ˆå™¨çš„åŠ¨ä½œã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910141933236-1385622907.gif" alt="" loading="lazy"></p>
<h4 id="autoid-0-3-1">4.2URLåˆ‡æ¢</h4>
<p>å’Œtitleçš„æ€è·¯ç±»ä¼¼ï¼šå‰è¾¹å·²ç»å°†æ‰€æœ‰çš„æ ‡ç­¾çš„titleéƒ½å¾ªç¯å‡ºæ¥äº†ï¼Œæˆ‘ä»¬åªè¦åˆ‡æ¢åˆ°æˆ‘ä»¬éœ€è¦æ“ä½œçš„urlæ ‡ç­¾é¡µå³å¯ã€‚</p>
<h5>4.2.1ä»£ç è®¾è®¡</h5>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910142732477-1653054037.png" alt="" loading="lazy"></p>
<h5>4.2.2å‚è€ƒä»£ç </h5>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">package</span><span style="color: rgba(0, 0, 0, 1)"> com.bjhg.playwright;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.List;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Browser;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.BrowserContext;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.BrowserType;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Locator;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Page;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> com.microsoft.playwright.Playwright;

</span><span style="color: rgba(0, 128, 0, 1)">/**</span><span style="color: rgba(0, 128, 0, 1)">
 * </span><span style="color: rgba(128, 128, 128, 1)">@author</span><span style="color: rgba(0, 128, 0, 1)"> åŒ—äº¬-å®å“¥
 * </span><span style="color: rgba(128, 128, 128, 1)">@param</span><span style="color: rgba(0, 128, 0, 1)"> &lt;context&gt;
 * 
 * @å…¬ä¼—å·:åŒ—äº¬å®å“¥ï¼ˆå¾®ä¿¡æœç´¢ï¼Œå…³æ³¨å®å“¥ï¼Œæå‰è§£é”æ›´å¤šæµ‹è¯•å¹²è´§ï¼‰
 * 
 * ã€Šåˆšåˆšé—®ä¸–ã€‹ç³»åˆ—åˆçª¥ç¯‡-Java+Playwrightè‡ªåŠ¨åŒ–æµ‹è¯•-17-  å¦‚ä½•ä¼˜é›…åœ°åˆ‡æ¢æµè§ˆå™¨å¤šçª—å£ï¼ˆè¯¦ç»†æ•™ç¨‹ï¼‰
 *
 * 2024å¹´9æœˆ19æ—¥
 </span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> Test_Switch_Window{
    
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span><span style="color: rgba(0, 0, 0, 1)"> Page switchToPage(BrowserContext context,String url){
        
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åˆ‡æ¢åˆ°æŒ‡å®š URL åç§°çš„æ ‡ç­¾é¡µ</span>
        List&lt;Page&gt; pages =<span style="color: rgba(0, 0, 0, 1)"> context.pages();
        
        </span><span style="color: rgba(0, 0, 255, 1)">for</span><span style="color: rgba(0, 0, 0, 1)">(Page i:pages){
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(url != <span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">){
                </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">(i.url().contains(url)){
                    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">æ¿€æ´»å½“å‰é€‰é¡¹å¡</span>
<span style="color: rgba(0, 0, 0, 1)">                    i.bringToFront();
                    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> i;
                }
            }</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">{
                System.out.println(</span>"not found url"<span style="color: rgba(0, 0, 0, 1)">);
            }
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">            return context.pages[0];        </span>
<span style="color: rgba(0, 0, 0, 1)">        }
        </span><span style="color: rgba(0, 0, 255, 1)">return</span> (Page) pages.listIterator(0<span style="color: rgba(0, 0, 0, 1)">); 
    }

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> main(String[] args) {
        </span><span style="color: rgba(0, 0, 255, 1)">try</span> (Playwright playwright =<span style="color: rgba(0, 0, 0, 1)"> Playwright.create()) {
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1.ä½¿ç”¨chromiumæµè§ˆå™¨ï¼Œ# æµè§ˆå™¨é…ç½®ï¼Œè®¾ç½®ä»¥GUIæ¨¡å¼å¯åŠ¨Chromeæµè§ˆå™¨ï¼ˆè¦æŸ¥çœ‹æµè§ˆå™¨UIï¼Œåœ¨å¯åŠ¨æµè§ˆå™¨æ—¶ä¼ é€’ headless=false æ ‡å¿—ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ slowMo æ¥å‡æ…¢æ‰§è¡Œé€Ÿåº¦ã€‚</span>
          Browser browser = playwright.chromium().launch(<span style="color: rgba(0, 0, 255, 1)">new</span> BrowserType.LaunchOptions().setHeadless(<span style="color: rgba(0, 0, 255, 1)">false</span>).setSlowMo(300<span style="color: rgba(0, 0, 0, 1)">));
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2.åˆ›å»ºcontext</span>
          BrowserContext context =<span style="color: rgba(0, 0, 0, 1)"> browser.newContext();
         
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åˆ›å»ºpage</span>
          Page page =<span style="color: rgba(0, 0, 0, 1)"> context.newPage();
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">3.æµè§ˆå™¨æ‰“å¼€ç½‘ç«™</span>
          page.navigate("https://www.baidu.com"<span style="color: rgba(0, 0, 0, 1)">);
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">4.ç‚¹å‡»æ‰“å¼€å¤šä¸ªæ–°çš„æ ‡ç­¾é¡µ</span>
          List&lt;Locator&gt; links = page.locator("#s-top-left&gt;a"<span style="color: rgba(0, 0, 0, 1)">).all();
          </span><span style="color: rgba(0, 0, 255, 1)">for</span><span style="color: rgba(0, 0, 0, 1)">(Locator link:links){
              link.click();
          }
          
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">5.æ‰“å¼€å¤šä¸ªtab æ ‡ç­¾é¡µï¼Œ åˆ‡æ¢åˆ°æ–°é—»é¡µ</span>
          Page page1 = switchToPage(context, "hao"<span style="color: rgba(0, 0, 0, 1)">);
          System.out.println(page1.title());
          
          System.out.println(</span>"Test Pass"<span style="color: rgba(0, 0, 0, 1)">);
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å…³é—­page</span>
<span style="color: rgba(0, 0, 0, 1)">          page.close();
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å…³é—­browser</span>
<span style="color: rgba(0, 0, 0, 1)">          browser.close();
        }
    }

}</span></pre>
</div>
<h5>4.2.3è¿è¡Œä»£ç </h5>
<p>1.è¿è¡Œä»£ç ï¼Œå³é”®Run As-&gt;Java Applicationï¼Œå°±å¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910142813720-299580334.png" alt="" loading="lazy"></p>
<p>2.è¿è¡Œä»£ç åç”µè„‘ç«¯çš„æµè§ˆå™¨çš„åŠ¨ä½œã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1232840/202409/1232840-20240910143008335-1424922429.gif" alt="" loading="lazy"></p>
<h3 id="autoid-0-3-2">4.å°ç»“</h3>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†playwrightå¦‚ä½•ä¼˜é›…åœ°åˆ‡æ¢æµè§ˆå™¨å¤šçª—å£ï¼Œplaywrightåˆ‡æ¢é¡µé¢çª—å£ä¸éœ€è¦è·å–é¡µé¢çª—å£çš„å¥æŸ„ï¼Œå®ç°æ¯”seleniumç®€å•ä¾¿æ·è®¸å¤šï¼Œæ˜¯playwrightç›¸å¯¹äºseleniumçš„ä¸€å¤§ä¼˜åŠ¿ã€‚</p>
</div>
<div id="MySignature" role="contentinfo">
    <div id="MySignature" style="display: block">
	<div style="font-size: 13px; border: 1px dashed rgb(45, 161, 45); padding: 10px 15px; background-color: rgb(248, 248, 248)">
		<label style="font-weight: bold">
			&nbsp;&nbsp;&nbsp;&nbsp;ä¸ºäº†æ–¹ä¾¿å¤§å®¶åœ¨ç§»åŠ¨ç«¯ä¹Ÿèƒ½çœ‹åˆ°æˆ‘åˆ†äº«çš„åšæ–‡ï¼Œç°å·²æ³¨å†Œä¸ªäººå¾®ä¿¡å…¬ä¼—å·ï¼Œæ‰«æå·¦ä¸‹æ–¹äºŒç»´ç å³å¯ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼Œæå‰è§£é”æ›´å¤šæµ‹è¯•å¹²è´§ï¼æœ‰æ—¶é—´ä¼šåŠæ—¶åˆ†äº«ç›¸å…³æŠ€æœ¯åšæ–‡ã€‚
		</label>
		<br>
		<label style="font-weight: bold">
			&nbsp;&nbsp;&nbsp;&nbsp;ä¸ºäº†æ–¹ä¾¿å¤§å®¶äº’åŠ¨è®¨è®ºç›¸å…³æŠ€æœ¯é—®é¢˜ï¼Œåˆšåˆšå»ºç«‹äº†å’±ä»¬çš„ä¸“é—¨çš„å¾®ä¿¡ç¾¤äº¤æµäº’åŠ¨ç¾¤ï¼Œç¾¤å†…ä¼šåˆ†äº«äº¤æµæµ‹è¯•é¢†åŸŸå‰æ²¿çŸ¥è¯†ã€‚  è¯·æ‚¨æ‰«æä¸­é—´çš„å¾®ä¿¡äºŒç»´ç è¿›ç¾¤ 
		</label>
		<br>
		<label style="font-weight: bold">
			&nbsp;&nbsp;&nbsp;&nbsp;ä¸ºäº†æ–¹ä¾¿å¤§å®¶äº’åŠ¨è®¨è®ºç›¸å…³æŠ€æœ¯é—®é¢˜ï¼Œç°å·²ç»„å»ºä¸“é—¨çš„å¾®ä¿¡ç¾¤ï¼Œç”±äºå¾®ä¿¡ç¾¤æ»¡100ï¼Œè¯·æ‚¨æ‰«æå³ä¸‹æ–¹å®å“¥ä¸ªäººå¾®ä¿¡äºŒç»´ç æ‹‰ä½ è¿›ç¾¤
			<label style="font-weight: bold; color: red; font-size: 15px">
				ï¼ˆè¯·åŠ¡å¿…å¤‡æ³¨ï¼šå·²å…³æ³¨å…¬ä¼—å·è¿›ç¾¤ï¼‰å¹³æ—¶ä¸Šç­å¿™ï¼ˆå’Œä½ ä¸€æ ·ï¼‰ï¼Œæ‰€ä»¥åŠ å¥½å‹ä¸åŠæ—¶ï¼Œè¯·ç¨å®‰å‹¿èº~
			</label>
			ï¼Œæ¬¢è¿å¤§å®¶åŠ å…¥è¿™ä¸ªå¤§å®¶åº­ï¼Œæˆ‘ä»¬ä¸€èµ·ç•…æ¸¸çŸ¥è¯†çš„æµ·æ´‹ã€‚
		</label>
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp;æ„Ÿè°¢æ‚¨èŠ±æ—¶é—´é˜…è¯»æ­¤ç¯‡æ–‡ç« ,å¦‚æœæ‚¨è§‰å¾—è¿™ç¯‡æ–‡ç« ä½ å­¦åˆ°äº†ä¸œè¥¿ä¹Ÿæ˜¯ä¸ºäº†çŠ’åŠ³ä¸‹åšä¸»çš„ç å­—ä¸æ˜“ä¸å¦¨æ‰“èµä¸€ä¸‹å§ï¼Œè®©åšä¸»èƒ½å–ä¸Šä¸€æ¯å’–å•¡ï¼Œåœ¨æ­¤è°¢è¿‡äº†ï¼
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp;å¦‚æœæ‚¨è§‰å¾—é˜…è¯»æœ¬æ–‡å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹ä¸€ä¸‹å·¦ä¸‹è§’
		<a id="recommend" style="font-weight: bold; color: red; font-size: 15px; text-decoration: underline">
			â€œæ¨èâ€
		</a>
		æŒ‰é’®ï¼Œæ‚¨çš„
		<label style="font-weight: bold; color: red; font-size: 15px">
			â€œæ¨èâ€
		</label>
		å°†æ˜¯æˆ‘æœ€å¤§çš„å†™ä½œåŠ¨åŠ›ï¼å¦å¤–æ‚¨ä¹Ÿå¯ä»¥é€‰æ‹©
		<a id="follow_me_btn" style="cursor: pointer; color: blue; text-decoration: underline">
			ã€
			<strong>
				å…³æ³¨æˆ‘
			</strong>
			ã€‘
		</a>
		ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿æ‰¾åˆ°æˆ‘ï¼
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp;æœ¬æ–‡ç‰ˆæƒå½’ä½œè€…å’Œåšå®¢å›­å…±æœ‰ï¼Œæ¥æºç½‘å€ï¼š
		<a href="https://www.cnblogs.com/du-hong" style="color: red; text-decoration: underline" target="_blank">
			https://www.cnblogs.com/du-hong
		</a>
		æ¬¢è¿å„ä½è½¬è½½ï¼Œä½†æ˜¯æœªç»ä½œè€…æœ¬äººåŒæ„ï¼Œè½¬è½½æ–‡ç« ä¹‹åå¿…é¡»åœ¨æ–‡ç« é¡µé¢æ˜æ˜¾ä½ç½®ç»™å‡ºä½œè€…å’ŒåŸæ–‡è¿æ¥ï¼Œå¦åˆ™ä¿ç•™è¿½ç©¶æ³•å¾‹è´£ä»»çš„æƒåˆ©ï¼
	</div>
	<div style="text-align: center; margin-top: 10px">
		<p style=" font-weight: bolder; color: red; ">
			å…¬ä¼—å·(å…³æ³¨å®å“¥)&nbsp; &nbsp;&nbsp;&nbsp;
			&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
			&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
			&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
			å¾®ä¿¡ç¾¤(æ‰«ç è¿›ç¾¤) &nbsp;&nbsp;&nbsp;
			&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
			&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
			&nbsp;&nbsp;&nbsp;&nbsp;
			&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
			&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;å®¢æœå¾®ä¿¡
		</p>
		<img style="width: 200px;padding-right: 50px;" alt="ä¸ªäººå¾®ä¿¡å…¬ä¼—å·" src="https://img2018.cnblogs.com/common/1741949/201911/1741949-20191119095948011-608816619.png">
		<img style="width: 200px;padding-right: 65px;" alt="å¾®ä¿¡ç¾¤" src="https://img2024.cnblogs.com/blog/1232840/202506/1232840-20250610113707419-637869921.png">
		<img style="width: 200px" alt="ä¸ªäººå¾®ä¿¡" src="https://img2018.cnblogs.com/common/1741949/201911/1741949-20191106101257091-849954564.png">
	</div>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.03819444444444445" data-date-updated="2025-06-12 09:25">2025-06-12 08:30</span>&nbsp;
<a href="https://www.cnblogs.com/du-hong">åŒ—äº¬-å®å“¥</a>&nbsp;
é˜…è¯»(<span id="post_view_count">71</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18405731);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18405731', targetLink: 'https://www.cnblogs.com/du-hong/p/18405731', title: '&amp;#128293;ã€Šåˆšåˆšé—®ä¸–ã€‹ç³»åˆ—åˆçª¥ç¯‡-Java+Playwrightè‡ªåŠ¨åŒ–æµ‹è¯•-17-  å¦‚ä½•ä¼˜é›…åœ°åˆ‡æ¢æµè§ˆå™¨å¤šçª—å£ï¼ˆè¯¦ç»†æ•™ç¨‹ï¼‰' })">ä¸¾æŠ¥</a>
</div>
        