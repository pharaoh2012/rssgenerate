
	<div class="postTitle">
		<h1><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/f2flow/p/18961322" title="发布于 2025-07-02 14:20">
    <span role="heading" aria-level="2">SpringBooot3.4集成Swagger knife4j-openapi3 Knife4j文档请求异常</span>
    

</a>
</h1>
	</div>
	<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>&nbsp;</p>
<p><img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702125942100-1164100309.png" alt="" width="1118" height="424"></p>
<p><span style="font-size: 18px">## Pom引入&nbsp;SpringBooot3.4的版本</span></p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">        &lt;dependency&gt;
            &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;
            &lt;artifactId&gt;knife4j-openapi3-jakarta-spring-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;4.5.0&lt;/version&gt;
        &lt;/dependency&gt;
</pre>
</div>
<p>　　</p>
<p>## 通常来说Knife4j文档请求异常是没有放通权限和资源导向，通过网上说的加了注册器放通</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">/**
 * @author f2bpm@f2bpm.com
 * @version 创建时间：2019年8月23日 下午6:14:59 可以扩展SpringMVC的功能
 */
@Configuration
// public class WebConfig extends WebMvcConfigurationSupport
public class WebConfig implements WebMvcConfigurer {
 
	@Bean
	public AuthenticationInterceptor authenticationInterceptor() {
		return new AuthenticationInterceptor();
	}
	/**
	 * 拦截器验证登录身份
	 *
	 * @param registry
	 */
	@Override
	public void addInterceptors(InterceptorRegistry registry) {
		// 拦截所有请求,但排除这些：excludePathPatterns
		registry.addInterceptor(authenticationInterceptor()).addPathPatterns("/**").excludePathPatterns("/resources/**").excludePathPatterns("/static/**")
				.excludePathPatterns("/api/cloud/upload")
				.excludePathPatterns("/v2/**").excludePathPatterns("/swagger-ui/**").excludePathPatterns("/swagger*/**").excludePathPatterns("/doc.html").excludePathPatterns("*.html").excludePathPatterns("*.js").excludePathPatterns("*.css").excludePathPatterns("/webjars/**")
				.excludePathPatterns("/favicon.ico").excludePathPatterns("/ureport/**")
				.excludePathPatterns("/resources/**").excludePathPatterns("/error/**").excludePathPatterns("/workflow/public/**").excludePathPatterns("/error").excludePathPatterns("/login/**");
	}


	/**
	 * 添加特殊的访问路由映射资源到webjars
	 */
	@Override
	public void addResourceHandlers(ResourceHandlerRegistry registry) {
		registry.addResourceHandler("/resources/**").addResourceLocations("classpath:/resources/");
		registry.addResourceHandler("swagger-ui.html").addResourceLocations("classpath:/META-INF/resources/");
		registry.addResourceHandler("doc.html").addResourceLocations("classpath:/META-INF/resources/");
		registry.addResourceHandler("/webjars/**").addResourceLocations("classpath:/META-INF/resources/webjars/");
	}
}&nbsp;</pre>
</div>
<p>F12依然报错如下图：</p>
<p><img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702130526324-964446910.png" alt="" width="1252" height="445" loading="lazy"></p>
<p>&nbsp;## 报http://127.0.0.1:18090/v3/api-docs/swagger-config 500错误</p>
<p>&nbsp;## 后端报错：Knife4j SpringBooot3.4 No converter for [class java.util.LinkedHashMap] with preset Content-Type 'text/html;charset=UTF-8'</p>
<p>&nbsp;找遍全网，没能解决，好吧，只能尝试从了的源代码调试了。</p>
<p>通过跟踪报错的代码位置：</p>
<p><img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702131157508-1619073977.png" alt="" width="1066" height="384" loading="lazy"></p>
<p>&nbsp;最后下载官网的示例代码跟踪发现：</p>
<p>&nbsp;官网：https://doc.xiaominfo.com/docs/quick-start 代码：knife4j-spring-boot3-demo</p>
<p>在同一位置对比排查，官网的的执行是正常的。</p>
<p><img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702131439382-1211193975.png" alt="" width="976" height="331" loading="lazy"></p>
<p>&nbsp;检查各种配置都没有问题。</p>
<p>官网的代码输入这个的是，显然它是一个Html内容的输出。</p>
<p><img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702131551772-1594086539.png" alt="" width="735" height="521" loading="lazy"></p>
<p>通过自己的代码工程和官方的代码工程Debug到org.springframework:Spring-webmvc这个AsyncTaskMethodReturnValueHandler.class</p>
<p><img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702131840600-1881550079.png" alt="" width="798" height="477" loading="lazy"></p>
<p>&nbsp;发现问题所在了：在<span style="font-family: &quot;Courier New&quot;; font-size: 12px; font-style: italic">EncodingFilter</span>过滤器filter中response的contenttype是</p>
<div>
<pre>"text/html;charset=UTF-8"</pre>
</div>
<p>&nbsp;<img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702141546329-587002344.png" alt="" width="776" height="580" loading="lazy"></p>
<p>把这行删除或修改为<span style="font-family: &quot;Courier New&quot;; font-size: 12px; font-style: italic">"application/json;charset=UTF-8"即可。</span></p>
<p>&nbsp;然后问题解决，如下图：</p>
<p><img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702141848812-1436610518.png" alt="" width="690" height="240" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/99882/202507/99882-20250702141922755-1885714403.png" alt="" width="841" height="196" loading="lazy"></p>
<p>&nbsp;</p>
</div>
<div id="MySignature" role="contentinfo">
    <div style="padding: 20px; background-color: #FFF7DC; border: 1px solid #FFBFBF; font-size: 14px; color: #00536A;">
    专注写好每一篇精品博文的热情离不开您的肯定与支持<br>
    您认为阅读这篇博客让您有些收获，不妨点击一下右下角的【推荐】按钮。<br>
    如果你想及时关注到工作流引擎相关博文，请继续关注我的后续博客，不妨点击正下面【关注我】
    <br>
    <br>
    <div style="padding: 6px; font-size: 12px; background-color: #fff;">
   版权声明：本文原创发表于 博客园，作者为 <a href="http://www.cnblogs.com/f2flow">F2BPM工作流引擎</a> 转载时未经作者同意必须保留此段声明，
       且在文章页面明显位置给出原文连接，否则视为侵权。 
      </div>
</div>
</div>
<div class="clear"></div>

	<div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-02 14:20">2025-07-02 14:20</span>&nbsp;
<a href="https://www.cnblogs.com/f2flow">F2BPM工作流</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18961322);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18961322', targetLink: 'https://www.cnblogs.com/f2flow/p/18961322', title: 'SpringBooot3.4集成Swagger knife4j-openapi3 Knife4j文档请求异常' })">举报</a>
</div>
