
    <h2 class="postTitle"><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ccjt/p/18745962" title="发布于 2025-03-02 12:09">
    <span role="heading" aria-level="2">使用cy7c68013调试mt9v011  ov7670 mt9v034 摄像头测试  icamera视频采集调试</span>
    

</a>
</h2>
    <div class="postText"><div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>使用cy7c68013调试mt9v011&nbsp; ov7670 摄像头测试&nbsp; icamera视频采集调试</p>
<p>&nbsp;采集底板选用cp601d，原理图参考icamera设计，使用cy7c68013a芯片设计，固件刷icamera-106.iic（106后的版本均兼容）</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302115906454-1036269594.jpg" alt="" width="455" height="607"></p>
<p>&nbsp;</p>
<p>注意好管脚顺序</p>
<p>OE接地使能，</p>
<p>复位管脚接高电平，处于正常工作</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302120121006-990229687.png" alt=""><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302115808153-1424635916.png" alt="" width="808" height="512"></p>
<p>编写配置文件</p>
<p>iic配置地址为0xba</p>
<p>0x1a, 0x00, 0xBA, // 42 0x5A // sensor slave id<br>0x1a, 0x01, 0x00,	// pwdn low<br>0x1a, 0x02, 0x01, // wordwide &lt;1:8 bit, else:16 bit&gt;<br>0x1a, 0x03, 0x01,	// register address length 2byte<br>0x1a, 0x04, 0x02,	// register value length   1byte<br>//0x1a, 0x05, 0x01,	// reset pin(PC2)<br>0x1a, 0x06, 0x01,	// IFCLK polarity<br>0x1a, 0x0D, 0x02,	// IFCLK 24</p>
<p>0x22,0x09,0x005f,<br>0x22,0x35,0x0313,<br>0x22,0x01,0x000b,<br>0x22,0x02,0x0012,<br>0x22,0x05,0x0083,<br>0x22,0x06,0x001c,<br>0x22,0x20,0x1000,</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302120217740-758216687.png" alt=""></p>
<p>参考芯片手册调整好配置文件，即可出图</p>
<p>视频显示</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302120511939-1211756822.png" alt=""></p>
<p>调整rgb各个通道增益和曝光，可以让图像更柔和，亮度更合适。</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302120556922-947010668.png" alt=""></p>
<p>这就是所谓的白平衡和曝光调节，可以实时看效果</p>
<p>&nbsp;调试ov7670</p>
<p>线序定义</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302123223064-1718019401.png" alt=""></p>
<p>安装效果如下，两类摄像头设计的时候线序有所不同，所以装不同位置区分</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302123201174-1959642346.jpg" alt=""></p>
<p>寄存器配置</p>
<p>0x12, 0x12, 0x80<br>0x12, 0x11, 0x01<br>0x12, 0x3a, 0x04<br>0x12, 0x12, 0x01<br>0x12, 0x17, 0x13<br>0x12, 0x18, 0x01<br>0x12, 0x32, 0xb6<br>0x12, 0x19, 0x02<br>0x12, 0x1a, 0x7a<br>0x12, 0x03, 0x0a<br>0x12, 0x0c, 0x00<br>0x12, 0x3e, 0x00<br>0x12, 0x70, 0x3a<br>0x12, 0x71, 0x35<br>0x12, 0x72, 0x11<br>0x12, 0x73, 0xf0<br>0x12, 0xa2, 0x02<br>0x12, 0x7a, 0x29<br>0x12, 0x7b, 0x04<br>0x12, 0x7c, 0x19<br>0x12, 0x7d, 0x30<br>0x12, 0x7e, 0x56<br>0x12, 0x7f, 0x65<br>0x12, 0x80, 0x72<br>0x12, 0x81, 0x7d<br>0x12, 0x82, 0x86<br>0x12, 0x83, 0x8c<br>0x12, 0x84, 0x95<br>0x12, 0x85, 0xa2<br>0x12, 0x86, 0xac<br>0x12, 0x87, 0xbe<br>0x12, 0x88, 0xcf<br>0x12, 0x89, 0xe1<br>0x12, 0x13, 0xe0<br>0x12, 0x00, 0x00<br>0x12, 0x10, 0x00<br>0x12, 0x0d, 0x40<br>0x12, 0x14, 0x38<br>0x12, 0xa5, 0x05<br>0x12, 0xab, 0x07<br>0x12, 0x24, 0x95<br>0x12, 0x25, 0x33<br>0x12, 0x26, 0xe3<br>0x12, 0x9f, 0x72<br>0x12, 0xa0, 0x62<br>0x12, 0xa1, 0x0b<br>0x12, 0xa6, 0xe5<br>0x12, 0xa7, 0xe5<br>0x12, 0xa8, 0xf0<br>0x12, 0xa9, 0x90<br>0x12, 0xaa, 0x94<br>0x12, 0x13, 0xe5<br>0x12, 0x0e, 0x61<br>0x12, 0x0f, 0x4b<br>0x12, 0x16, 0x02<br>0x12, 0x21, 0x02<br>0x12, 0x22, 0x91<br>0x12, 0x29, 0x07<br>0x12, 0x33, 0x0b<br>0x12, 0x35, 0x33<br>0x12, 0x37, 0x1c<br>0x12, 0x38, 0x71<br>0x12, 0x39, 0x3d<br>0x12, 0x3c, 0x78<br>0x12, 0x4d, 0x40<br>0x12, 0x4e, 0x20<br>0x12, 0x69, 0x55<br>0x12, 0x6b, 0x4a<br>0x12, 0x74, 0x19<br>0x12, 0x8d, 0x4f<br>0x12, 0x8e, 0x00<br>0x12, 0x8f, 0x00<br>0x12, 0x90, 0x00<br>0x12, 0x91, 0x00<br>0x12, 0x96, 0x00<br>0x12, 0x9a, 0x80<br>0x12, 0xb0, 0x8c<br>0x12, 0xb1, 0x0c<br>0x12, 0xb2, 0x0e<br>0x12, 0xb3, 0x82<br>0x12, 0xb8, 0x0a<br>0x12, 0x43, 0x14<br>0x12, 0x44, 0xf0<br>0x12, 0x45, 0x34<br>0x12, 0x46, 0x58<br>0x12, 0x47, 0x28<br>0x12, 0x48, 0x3a<br>0x12, 0x59, 0x88<br>0x12, 0x5a, 0x88<br>0x12, 0x5b, 0x44<br>0x12, 0x5c, 0x67<br>0x12, 0x5d, 0x49<br>0x12, 0x5e, 0x0e<br>0x12, 0x6c, 0x0a<br>0x12, 0x6d, 0x55<br>0x12, 0x6e, 0x11<br>0x12, 0x6f, 0x9f<br>0x12, 0x6a, 0x40<br>0x12, 0x01, 0x40<br>0x12, 0x02, 0x40<br>0x12, 0x13, 0xe7<br>0x12, 0x4f, 0x78<br>0x12, 0x50, 0x73<br>0x12, 0x51, 0x05<br>0x12, 0x52, 0x17<br>0x12, 0x53, 0x69<br>0x12, 0x54, 0x7f<br>0x12, 0x58, 0x9e<br>0x12, 0x41, 0x08<br>0x12, 0x3f, 0x00<br>0x12, 0x75, 0x05<br>0x12, 0x76, 0x60<br>0x12, 0x4c, 0x00<br>0x12, 0x77, 0x02<br>0x12, 0x3d, 0x08<br>0x12, 0x4b, 0x09<br>0x12, 0xc9, 0x60<br>0x12, 0x41, 0x38<br>0x12, 0x56, 0x40<br>0x12, 0x62, 0x00<br>0x12, 0x63, 0x00<br>0x12, 0x64, 0x04<br>0x12, 0x65, 0x00<br>0x12, 0x66, 0x01<br>0x12, 0x34, 0x11<br>0x12, 0x3b, 0xba<br>0x12, 0xa4, 0x88<br>0x12, 0x96, 0x00<br>0x12, 0x97, 0x30<br>0x12, 0x98, 0x20<br>0x12, 0x99, 0x20<br>0x12, 0x9a, 0x84<br>0x12, 0x9b, 0x29<br>0x12, 0x9c, 0x03<br>0x12, 0x9d, 0x99<br>0x12, 0x9e, 0x7f<br>0x12, 0x78, 0x04<br>0x12, 0x79, 0x01<br>0x12, 0xc8, 0xf0<br>0x12, 0x79, 0x0f<br>0x12, 0xc8, 0x20<br>0x12, 0x79, 0x10<br>0x12, 0xc8, 0x7e<br>0x12, 0xc8, 0x20<br>0x12, 0x79, 0x09<br>0x12, 0xc8, 0x80<br>0x12, 0x79, 0x02<br>0x12, 0xc8, 0xc0<br>0x12, 0x79, 0x03<br>0x12, 0xc8, 0x40<br>0x12, 0x79, 0x05<br>0x12, 0xc8, 0x30<br>0x12, 0x79, 0x26</p>
<p>拍照效果</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302123614445-811860058.png" alt=""></p>
<p>启用ov7670的内部自动增益，自动曝光，自动白平衡，采集效果显著比人为手工初步简单配置的效果会好，</p>
<p>配置测试mt9v034（管脚顺序与ov7670兼容）</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302124312466-162931284.jpg" alt=""></p>
<p>没有镜头，仍然不影响测试</p>
<p>&nbsp;</p>
<p>配置寄存器</p>
<p>mt9v034_VGA_RAW<br>mode=Video<br>iface=Cypress<br>format=Raw<br>Type=RGGB<br>imagesize=640x480<br>afmode=CYPRESS_IIC<br>afsubmode=0<br>simmian<br>fPll=0<br>nPClkInvert=0<br>nRemoveFirst=0<br>n2Cut= 0<br>nSlaveID=0<br>nSensorCtrl=0<br>nBits=0<br>nIICSpeed=0<br>[SENSOR]<br>; VENDOR 0x1a for configuration <br>; VENDOR 0x1e for vcm<br>; VENDOR 0x12 for 1 byte  address and 1 byte  data<br>; VENDOR 0x22 for 1 byte  address and 2 bytes data<br>; VENDOR 0x32 for 2 bytes address and 1 byte  data<br>; VENDOR 0x42 for 2 bytes address and 2 bytes data<br>; VENDOR 0x52 for 1 byte  address and sequence datas<br>; VENDOR 0x62 for 2 bytes address and sequence datas</p>
<p>0x1a, 0x00, 0x90,	// 42 0x5A // sensor slave id<br>0x1a, 0x01, 0x00,	// pwdn low<br>0x1a, 0x02, 0x01, // wordwide &lt;1:8 bit, else:16 bit&gt;<br>0x1a, 0x03, 0x01,	// register address length 2byte<br>0x1a, 0x04, 0x02,	// register value length   1byte<br>//0x1a, 0x05, 0x01	// reset pin(PC2)<br>0x1a, 0x06, 0x01,	// IFCLK polarity</p>
<p>0x22,0x03,0x1e0,<br>0x22,0x04,0x280,</p>
<p><br>0x1a, 0x0e, 0x01,	// external clock</p>
<p>0x1a, 0x0f, 0x00,	// sync</p>
<p>&nbsp;</p>
<p>配置完成后，直接操控icamera上位机采集视频图像</p>
<p><img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302124425945-1670701657.png" alt=""></p>
<p>可以观测到，帧率达到62fps，图像正常，通过直方图看到摄像头的噪声非常低。</p>
<p>&nbsp;</p>
<p>此致所有摄像头测试已经完毕</p>
<p>&nbsp;<img src="https://img2024.cnblogs.com/blog/724662/202503/724662-20250302125429774-1960318989.jpg" alt=""></p>
<p>下一期分享下，使用fpga驱动hdmi显示器</p>
</div>
<div class="clear"></div>
</div>
    <p class="postfoot">posted on 
<span id="post-date" data-last-update-days="0.8439469095474537" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-02 12:55">2025-03-02 12:09</span>&nbsp;
<a href="https://www.cnblogs.com/ccjt">层层惊涛</a>&nbsp;
阅读(<span id="post_view_count">31</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18745962" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18745962);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18745962', targetLink: 'https://www.cnblogs.com/ccjt/p/18745962', title: '使用cy7c68013调试mt9v011  ov7670 mt9v034 摄像头测试  icamera视频采集调试' })">举报</a>
</p>
