
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/risheng/p/18816491" title="å‘å¸ƒäº 2025-04-09 13:51">
    <span role="heading" aria-level="2">æ—¶åŒºè½¬æ¢å·¥å…·+PWAç¦»çº¿ç½‘é¡µ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3373677/202504/3373677-20250409135124424-1301859887.png" alt="æ—¶åŒºè½¬æ¢å·¥å…·+PWAç¦»çº¿ç½‘é¡µ" class="desc_img">
        æœ¬é¡¹ç›®å¯¹æ¯”å¹¶é€‰ç”¨ Luxon å®ç°å¤šæ—¶åŒºè½¬æ¢ï¼Œæ”¯æŒå„æ—¶åŒºæ—¶é—´äº’è½¬ã€‚
æä¾› NodeJS ä¸ Python è„šæœ¬ã€ç½‘é¡µå°å·¥å…·åŠ PWA åº”ç”¨ï¼ŒåŠŸèƒ½å®Œæ•´ã€ç»“æ„æ¸…æ™°ã€‚
é€‚ç”¨äºå¿«é€Ÿä½¿ç”¨ã€ç³»ç»Ÿé›†æˆæˆ–ç¦»çº¿è®¿é—®ï¼Œå…·å¤‡è‰¯å¥½æ‰©å±•æ€§ã€‚
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="æ—¶åŒºè½¬æ¢å·¥å…·pwaç¦»çº¿ç½‘é¡µ">æ—¶åŒºè½¬æ¢å·¥å…·+PWAç¦»çº¿ç½‘é¡µ</h1>
<h2 id="ä¸€æ—¶åŒºè½¬æ¢å·¥å…·å¯¹æ¯”"><strong>ä¸€ã€æ—¶åŒºè½¬æ¢å·¥å…·å¯¹æ¯”</strong></h2>
<table>
<thead>
<tr>
<th><strong>å·¥å…·</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Date</td>
<td>åŸç”Ÿ JS APIï¼Œæœ‰é™çš„æ—¶åŒºæ”¯æŒï¼Œæ— æ³•æŒ‡å®šæ—¶åŒºï¼Œä»…ä½¿ç”¨æœ¬åœ°æ—¶åŒºã€‚</td>
</tr>
<tr>
<td>Intl.DateTimeFormat</td>
<td>åŸç”Ÿæ ¼å¼åŒ–æ˜¾ç¤ºï¼Œå¯æŒ‡å®šæ—¶åŒºï¼Œä½†ä¸èƒ½ä¿®æ”¹æ—¶åŒºé€»è¾‘ã€‚</td>
</tr>
<tr>
<td>luxon</td>
<td>å¼ºçƒˆæ¨èï¼Œç°ä»£ã€è½»é‡ã€åŠŸèƒ½å¼ºï¼ŒåŸç”Ÿæ”¯æŒæ—¶åŒºã€æ—¶é—´æˆ³ã€æ ¼å¼åŒ–ç­‰ã€‚</td>
</tr>
<tr>
<td>dayjs + timezone æ’ä»¶</td>
<td>ç±»ä¼¼ momentï¼Œæ›´ç°ä»£ï¼Œä½†æ—¶åŒºæ”¯æŒéœ€æ’ä»¶ã€‚</td>
</tr>
<tr>
<td>moment-timezone</td>
<td>åŠŸèƒ½å…¨é¢ä½†ä½“ç§¯å¤§ï¼Œmoment å®˜æ–¹å·²ä¸æ¨èç”¨äºæ–°é¡¹ç›®ã€‚</td>
</tr>
</tbody>
</table>
<h2 id="äºŒluxon-ä½¿ç”¨ç¤ºä¾‹">äºŒã€<strong>Luxon ä½¿ç”¨ç¤ºä¾‹</strong></h2>
<h3 id="1-ç¾å›½æ—¶é—´---ä¸­å›½æ—¶é—´">1. ç¾å›½æ—¶é—´ -&gt; ä¸­å›½æ—¶é—´</h3>
<pre><code class="language-javascript">import { DateTime } from 'luxon'

const usTime = DateTime.fromISO('2025-04-01T11:11:00', { zone: 'America/Los_Angeles' })

const timestamp = usTime.toMillis()

const cnTime = usTime.setZone('Asia/Shanghai')

console.log('ç¾å›½æ—¶é—´ï¼š', usTime.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ'))
console.log('æ—¶é—´æˆ³ï¼š', timestamp)
console.log('å¯¹åº”çš„ä¸­å›½æ—¶é—´ï¼š', cnTime.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ'))
</code></pre>
<pre><code class="language-shell">ç¾å›½æ—¶é—´ï¼š2025-04-01 11:11:00 GMT-7
æ—¶é—´æˆ³ï¼š1743521460000
å¯¹åº”çš„ä¸­å›½æ—¶é—´ï¼š2025-04-02 02:11:00 GMT+8
</code></pre>
<h3 id="2-ä¸­å›½æ—¶é—´---ç¾å›½æ—¶é—´">2. ä¸­å›½æ—¶é—´ -&gt; ç¾å›½æ—¶é—´</h3>
<pre><code class="language-javascript">const cn = DateTime.fromISO('2025-04-01T11:11:00', { zone: 'Asia/Shanghai' })

const us = cn.setZone('America/Los_Angeles')

console.log('ä¸­å›½æ—¶é—´ï¼š', cn.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ'))
console.log('å¯¹åº”çš„ç¾å›½æ—¶é—´ï¼š', us.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ'))
console.log('æ—¶é—´æˆ³ï¼ˆUTCï¼‰ï¼š', cn.toMillis())
</code></pre>
<h3 id="3-è½¬æ¢é€»è¾‘æ€»ç»“">3. è½¬æ¢é€»è¾‘æ€»ç»“</h3>
<table>
<thead>
<tr>
<th><strong>åœºæ™¯</strong></th>
<th><strong>æ–¹æ³•</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>æŒ‡å®šæ—¶åŒºçš„æ—¶é—´ â†’ æ—¶é—´æˆ³</td>
<td>DateTime.fromISO(...).toMillis()</td>
</tr>
<tr>
<td>æ—¶é—´æˆ³ â†’ æŒ‡å®šæ—¶åŒºæ—¶é—´</td>
<td>DateTime.fromMillis(...).setZone(...)</td>
</tr>
<tr>
<td>ä¸åŒæ—¶åŒºä¹‹é—´è½¬æ¢</td>
<td>.setZone(...)</td>
</tr>
<tr>
<td>æ—¶é—´æ ¼å¼åŒ–</td>
<td>.toFormat('yyyy-MM-dd HH:mm:ss') ç­‰</td>
</tr>
</tbody>
</table>
<h3 id="4-å¸¸ç”¨æ—¶åŒº-id-è¡¨">4. å¸¸ç”¨æ—¶åŒº ID è¡¨</h3>
<table>
<thead>
<tr>
<th style="text-align: left"><font style="color: rgba(255, 255, 255, 1)">åç§°</font></th>
<th style="text-align: left"><font style="color: rgba(255, 255, 255, 1)">IANA æ—¶åŒº ID</font></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">åŒ—äº¬/ä¸Šæµ·ï¼ˆAsia/Shanghaiï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Asia/Shanghai</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">é¦™æ¸¯ï¼ˆAsia/Hong_Kongï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Asia/Hong_Kong</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">æ—¥æœ¬ï¼ˆAsia/Tokyoï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Asia/Tokyo</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">éŸ©å›½ï¼ˆAsia/Seoulï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Asia/Seoul</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">æ–°åŠ å¡ï¼ˆAsia/Singaporeï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Asia/Singapore</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">å°åº¦ï¼ˆAsia/Kolkataï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Asia/Kolkata</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">ç¾å›½è¥¿éƒ¨ - æ´›æ‰çŸ¶ï¼ˆAmerica/Los_Angelesï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">America/Los_Angeles</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">ç¾å›½ä¸­éƒ¨ - èŠåŠ å“¥ï¼ˆAmerica/Chicagoï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">America/Chicago</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">ç¾å›½ä¸œéƒ¨ - çº½çº¦ï¼ˆAmerica/New_Yorkï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">America/New_York</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">è‹±å›½ï¼ˆEurope/Londonï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Europe/London</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">å¾·å›½ï¼ˆEurope/Berlinï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Europe/Berlin</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">æ³•å›½ï¼ˆEurope/Parisï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Europe/Paris</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">æ¾³å¤§åˆ©äºš - æ‚‰å°¼ï¼ˆAustralia/Sydneyï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Australia/Sydney</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">æ–°è¥¿å…°ï¼ˆPacific/Aucklandï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Pacific/Auckland</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">å¤å¨å¤·ï¼ˆPacific/Honoluluï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">Pacific/Honolulu</font></td>
</tr>
<tr>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">UTCï¼ˆåè°ƒä¸–ç•Œæ—¶ï¼‰</font></td>
<td style="text-align: left"><font style="color: rgba(0, 0, 0, 1)">UTC</font></td>
</tr>
</tbody>
</table>
<h2 id="ä¸‰æ—¶åŒºè½¬æ¢è„šæœ¬">ä¸‰ã€æ—¶åŒºè½¬æ¢è„šæœ¬</h2>
<h3 id="1-nodejs-è„šæœ¬ä½¿ç”¨-luxon">1. NodeJS è„šæœ¬ï¼ˆä½¿ç”¨ luxonï¼‰</h3>
<pre><code class="language-javascript">const { DateTime } = require('luxon')

function convertTime({
  timeStr = '2025-04-01 11:11:00',
  fromZone = 'America/Los_Angeles',
  toZone = 'Asia/Shanghai'
}) {
  const fromTime = DateTime.fromFormat(timeStr, 'yyyy-MM-dd HH:mm:ss', { zone: fromZone })

  const toTime = fromTime.setZone(toZone)

  console.log(`åŸå§‹æ—¶é—´ (${fromZone}):`, fromTime.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ'))
  console.log(`æ—¶é—´æˆ³ï¼ˆUTC æ¯«ç§’ï¼‰:`, fromTime.toMillis())
  console.log(`è½¬æ¢å (${toZone}):`, toTime.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ'))
}

// ä¿®æ”¹è¿™é‡Œçš„å‚æ•°å³å¯
convertTime({
  timeStr: '2025-04-01 11:11:00',
  fromZone: 'America/Los_Angeles',
  toZone: 'Asia/Shanghai'
})
</code></pre>
<h3 id="2-python-è„šæœ¬ä½¿ç”¨-pytz">2. Python è„šæœ¬ï¼ˆä½¿ç”¨ pytzï¼‰</h3>
<pre><code class="language-shell">pip install pytz
</code></pre>
<pre><code class="language-python">from datetime import datetime
import pytz

def convert_time(time_str='2025-04-01 11:11:00', from_zone='America/Los_Angeles', to_zone='Asia/Shanghai'):
    from_tz = pytz.timezone(from_zone)
    to_tz = pytz.timezone(to_zone)

    naive_dt = datetime.strptime(time_str, '%Y-%m-%d %H:%M:%S')
    from_dt = from_tz.localize(naive_dt)

    to_dt = from_dt.astimezone(to_tz)

    print(f'åŸå§‹æ—¶é—´ ({from_zone}): {from_dt.strftime("%Y-%m-%d %H:%M:%S %Z%z")}')
    print(f'æ—¶é—´æˆ³ï¼ˆUTC ç§’ï¼‰: {int(from_dt.timestamp())}')
    print(f'è½¬æ¢å ({to_zone}): {to_dt.strftime("%Y-%m-%d %H:%M:%S %Z%z")}')

# ä¿®æ”¹å‚æ•°å³å¯
convert_time(
    time_str='2025-04-01 11:11:00',
    from_zone='America/Los_Angeles',
    to_zone='Asia/Shanghai'
)
</code></pre>
<h2 id="å››ç½‘é¡µå°å·¥å…·">å››ã€ç½‘é¡µå°å·¥å…·</h2>
<p>ä½¿ç”¨ Luxon + HTML åŸç”Ÿæ§ä»¶åˆ¶ä½œçš„å°å·¥å…·ï¼Œæ”¯æŒï¼š</p>
<ul>
<li>è¾“å…¥æ—¶é—´</li>
<li>åŸå§‹/ç›®æ ‡æ—¶åŒºé€‰æ‹©</li>
<li>æ—¶é—´æˆ³æ˜¾ç¤º</li>
<li>ä¸€é”®å¤åˆ¶</li>
</ul>
<h3 id="1-ä»£ç å±•ç¤º">1. ä»£ç å±•ç¤º</h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="zh"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8" /&gt;
  &lt;title&gt;ğŸŒ æ—¶åŒºæ—¶é—´è½¬æ¢å·¥å…·&lt;/title&gt;
  &lt;script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"&gt;&lt;/script&gt;
  &lt;style&gt;
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 2rem;
      max-width: 700px;
      margin: auto;
      background: #f8f9fa;
    }
    h2 {
      text-align: center;
      margin-bottom: 2rem;
    }
    label {
      font-weight: bold;
      margin-top: 1rem;
      display: block;
    }
    input, select, button {
      width: 100%;
      padding: 0.6rem;
      margin: 0.4rem 0 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
    }
    button {
      background: #007bff;
      color: white;
      cursor: pointer;
      border: none;
      transition: background 0.3s;
    }
    button:hover {
      background: #0056b3;
    }
    .result {
      background: #fff;
      border-left: 5px solid #007bff;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 5px;
      white-space: pre-wrap;
      font-size: 0.95rem;
    }
    .error {
      color: red;
      margin-top: 1rem;
    }
    .copy-btn {
      margin-top: 0.5rem;
      background: #28a745;
    }
    .copy-btn:hover {
      background: #1e7e34;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
      background: #fff;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 0.6rem;
      text-align: left;
    }
    th {
      background-color: #007bff;
      color: white;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h2&gt;ğŸ•’ æ—¶åŒºè½¬æ¢å°å·¥å…·&lt;/h2&gt;

  &lt;label for="inputDate"&gt;é€‰æ‹©æ—¶é—´&lt;/label&gt;
  &lt;input type="datetime-local" id="inputDate" /&gt;

  &lt;label for="fromZone"&gt;åŸå§‹æ—¶åŒº&lt;/label&gt;
  &lt;select id="fromZone"&gt;&lt;/select&gt;

  &lt;label for="toZone"&gt;ç›®æ ‡æ—¶åŒº&lt;/label&gt;
  &lt;select id="toZone"&gt;&lt;/select&gt;

  &lt;button onclick="convertTime()"&gt;è½¬æ¢æ—¶é—´&lt;/button&gt;

  &lt;div class="result" id="output"&gt;ğŸ‘‡ è½¬æ¢ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º&lt;/div&gt;
  &lt;button class="copy-btn" onclick="copyResult()"&gt;ğŸ“‹ å¤åˆ¶ç»“æœ&lt;/button&gt;
  &lt;div class="error" id="error"&gt;&lt;/div&gt;

  &lt;script&gt;
    const { DateTime } = luxon

    const timezones = [
      { label: 'åŒ—äº¬ï¼ˆAsia/Shanghaiï¼‰', value: 'Asia/Shanghai' },
      { label: 'é¦™æ¸¯ï¼ˆAsia/Hong_Kongï¼‰', value: 'Asia/Hong_Kong' },
      { label: 'æ—¥æœ¬ï¼ˆAsia/Tokyoï¼‰', value: 'Asia/Tokyo' },
      { label: 'éŸ©å›½ï¼ˆAsia/Seoulï¼‰', value: 'Asia/Seoul' },
      { label: 'æ–°åŠ å¡ï¼ˆAsia/Singaporeï¼‰', value: 'Asia/Singapore' },
      { label: 'å°åº¦ï¼ˆAsia/Kolkataï¼‰', value: 'Asia/Kolkata' },
      { label: 'ç¾å›½è¥¿éƒ¨ - æ´›æ‰çŸ¶ï¼ˆAmerica/Los_Angelesï¼‰', value: 'America/Los_Angeles' },
      { label: 'ç¾å›½ä¸­éƒ¨ - èŠåŠ å“¥ï¼ˆAmerica/Chicagoï¼‰', value: 'America/Chicago' },
      { label: 'ç¾å›½ä¸œéƒ¨ - çº½çº¦ï¼ˆAmerica/New_Yorkï¼‰', value: 'America/New_York' },
      { label: 'è‹±å›½ï¼ˆEurope/Londonï¼‰', value: 'Europe/London' },
      { label: 'å¾·å›½ï¼ˆEurope/Berlinï¼‰', value: 'Europe/Berlin' },
      { label: 'æ³•å›½ï¼ˆEurope/Parisï¼‰', value: 'Europe/Paris' },
      { label: 'æ¾³å¤§åˆ©äºš - æ‚‰å°¼ï¼ˆAustralia/Sydneyï¼‰', value: 'Australia/Sydney' },
      { label: 'æ–°è¥¿å…°ï¼ˆPacific/Aucklandï¼‰', value: 'Pacific/Auckland' },
      { label: 'å¤å¨å¤·ï¼ˆPacific/Honoluluï¼‰', value: 'Pacific/Honolulu' },
      { label: 'UTCï¼ˆåè°ƒä¸–ç•Œæ—¶ï¼‰', value: 'UTC' },
    ]

    function renderTimezoneOptions() {
      const fromSelect = document.getElementById('fromZone')
      const toSelect = document.getElementById('toZone')
      const tableBody = document.getElementById('timezoneTable')

      timezones.forEach(({ label, value }) =&gt; {
        const opt1 = new Option(label, value)
        const opt2 = new Option(label, value)
        fromSelect.appendChild(opt1)
        toSelect.appendChild(opt2)
      })

      fromSelect.value = 'Asia/Shanghai'
      toSelect.value = 'America/Los_Angeles'
    }

    document.addEventListener('DOMContentLoaded', () =&gt; {
      renderTimezoneOptions()
      const now = new Date()
      const local = now.toISOString().slice(0, 16)
      document.getElementById('inputDate').value = local
    })

    function convertTime() {
      const input = document.getElementById('inputDate').value
      const fromZone = document.getElementById('fromZone').value
      const toZone = document.getElementById('toZone').value
      const output = document.getElementById('output')
      const error = document.getElementById('error')

      error.textContent = ''

      if (!input) {
        error.textContent = 'âŒ è¯·é€‰æ‹©ä¸€ä¸ªæ—¶é—´'
        return
      }

      try {
        const dt = DateTime.fromISO(input, { zone: fromZone })
        const toTime = dt.setZone(toZone)

        const result = `
ğŸŒ åŸå§‹æ—¶é—´ï¼ˆ${fromZone}ï¼‰:
    ${dt.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ')}

ğŸ•— æ—¶é—´æˆ³ï¼ˆUTC æ¯«ç§’ï¼‰:
    ${dt.toMillis()}

â¡ï¸ è½¬æ¢åæ—¶é—´ï¼ˆ${toZone}ï¼‰:
    ${toTime.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ')}
            `.trim()

        output.textContent = result
      }
      catch (e) {
        error.textContent = 'âŒ è½¬æ¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¾“å…¥'
      }
    }

    function copyResult() {
      const result = document.getElementById('output').textContent
      if (!result || result.includes('å°†åœ¨è¿™é‡Œæ˜¾ç¤º'))
        return
      navigator.clipboard.writeText(result).then(() =&gt; {
        alert('âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼')
      })
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="2-ç¤ºä¾‹æˆªå›¾">2. ç¤ºä¾‹æˆªå›¾</h3>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/340359/1743581698484-c5b6aef3-aba1-4f5f-9742-10959f558f46.png" alt="" loading="lazy"></p>
<h2 id="äº”pwa-åº”ç”¨æ”¯æŒ">äº”ã€PWA åº”ç”¨æ”¯æŒ</h2>
<h3 id="1-pwa-ç»“æ„">1. PWA ç»“æ„</h3>
<pre><code class="language-shell">.
â”œâ”€â”€ icons
â”‚   â”œâ”€â”€ time_192.png
â”‚   â””â”€â”€ time_512.png
â”œâ”€â”€ index.html
â”œâ”€â”€ luxon.min.js
â”œâ”€â”€ manifest.json
â””â”€â”€ service-worker.js
</code></pre>
<h3 id="2-manifestjson">2. manifest.json</h3>
<p>ç”¨äºå®šä¹‰åç§°ã€å›¾æ ‡ã€å¯åŠ¨æ–¹å¼ç­‰ï¼š</p>
<pre><code class="language-json">{
  "name": "æ—¶åŒºæ—¶é—´è½¬æ¢å·¥å…·",
  "short_name": "æ—¶åŒºè½¬æ¢",
  "start_url": "./index.html",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#007bff",
  "description": "æ”¯æŒå¤šæ—¶åŒºæ—¶é—´äº’è½¬ã€æ—¶é—´æˆ³ç”Ÿæˆçš„è½»é‡å·¥å…·",
  "icons": [
    {
      "src": "icons/time_192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "icons/time_512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
</code></pre>
<h3 id="3-service-workerjs">3. service-worker.js</h3>
<p>å®ç°æ ¸å¿ƒç¼“å­˜åŠŸèƒ½ï¼Œæ”¯æŒç¦»çº¿è®¿é—®ï¼š</p>
<pre><code class="language-javascript">const CACHE_NAME = 'timezone-converter-0.0.1'
const urlsToCache = [
  './',
  './index.html',
  './manifest.json',
  './service-worker.js',
  './icons/time_192.png',
  './icons/time_512.png',
  './luxon.min.js'
]

// å®‰è£…æ—¶é¢„ç¼“å­˜æ ¸å¿ƒèµ„æº
self.addEventListener('install', event =&gt; {
  self.skipWaiting()
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache =&gt; cache.addAll(urlsToCache))
  )
})

// æ¿€æ´»æ—¶æ¸…é™¤æ—§ç¼“å­˜
self.addEventListener('activate', event =&gt; {
  event.waitUntil(
    caches.keys().then(keys =&gt;
      Promise.all(keys.filter(k =&gt; k !== CACHE_NAME).map(k =&gt; caches.delete(k)))
    )
  )
  self.clients.claim()
})

// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œä¼˜å…ˆä»ç¼“å­˜è¯»å–ï¼Œå¤±è´¥åˆ™ç½‘ç»œè¯·æ±‚
self.addEventListener('fetch', event =&gt; {
  const request = event.request

  event.respondWith(
    caches.match(request).then(cachedResponse =&gt; {
      if (cachedResponse) return cachedResponse

      return fetch(request)
        .then(networkResponse =&gt; {
          if (
            networkResponse &amp;&amp;
            networkResponse.status === 200 &amp;&amp;
            request.url.startsWith(self.location.origin)
          ) {
            const cloned = networkResponse.clone()
            caches.open(CACHE_NAME).then(cache =&gt; {
              cache.put(request, cloned)
            })
          }
          return networkResponse
        })
        .catch(() =&gt; {
          if (request.headers.get('accept')?.includes('text/html')) {
            return caches.match('./index.html')
          }
        })
    })
  )
})
</code></pre>
<h3 id="4-html-æ–‡ä»¶">4. html æ–‡ä»¶</h3>
<p>æ•´åˆ Luxon + PWA æ³¨å†Œé€»è¾‘</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="zh"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8" /&gt;
  &lt;title&gt;ğŸŒ æ—¶åŒºæ—¶é—´è½¬æ¢å·¥å…·1&lt;/title&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;
  &lt;meta name="theme-color" content="#007bff" /&gt;

  &lt;link rel="manifest" href="manifest.json" /&gt;
  &lt;link rel="icon" href="icons/time_192.png" /&gt;
  &lt;link rel="apple-touch-icon" href="icons/time_512.png" /&gt;

  &lt;script src="./luxon.min.js"&gt;&lt;/script&gt;

  &lt;style&gt;
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 2rem;
      max-width: 700px;
      margin: auto;
      background: #f8f9fa;
    }
    h2 {
      text-align: center;
      margin-bottom: 2rem;
    }
    label {
      font-weight: bold;
      margin-top: 1rem;
      display: block;
    }
    input, select, button {
      width: 100%;
      padding: 0.6rem;
      margin: 0.4rem 0 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
    }
    button {
      background: #007bff;
      color: white;
      cursor: pointer;
      border: none;
      transition: background 0.3s;
    }
    button:hover {
      background: #0056b3;
    }
    .result {
      background: #fff;
      border-left: 5px solid #007bff;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 5px;
      white-space: pre-wrap;
      font-size: 0.95rem;
    }
    .error {
      color: red;
      margin-top: 1rem;
    }
    .copy-btn {
      margin-top: 0.5rem;
      background: #28a745;
    }
    .copy-btn:hover {
      background: #1e7e34;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
      background: #fff;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 0.6rem;
      text-align: left;
    }
    th {
      background-color: #007bff;
      color: white;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h2&gt;ğŸ•’ æ—¶åŒºè½¬æ¢å°å·¥å…·&lt;/h2&gt;

  &lt;label for="inputDate"&gt;é€‰æ‹©æ—¶é—´&lt;/label&gt;
  &lt;input type="datetime-local" id="inputDate" /&gt;

  &lt;label for="fromZone"&gt;åŸå§‹æ—¶åŒº&lt;/label&gt;
  &lt;select id="fromZone"&gt;&lt;/select&gt;

  &lt;label for="toZone"&gt;ç›®æ ‡æ—¶åŒº&lt;/label&gt;
  &lt;select id="toZone"&gt;&lt;/select&gt;

  &lt;button onclick="convertTime()"&gt;è½¬æ¢æ—¶é—´&lt;/button&gt;

  &lt;div class="result" id="output"&gt;ğŸ‘‡ è½¬æ¢ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º&lt;/div&gt;
  &lt;button class="copy-btn" onclick="copyResult()"&gt;ğŸ“‹ å¤åˆ¶ç»“æœ&lt;/button&gt;
  &lt;div class="error" id="error"&gt;&lt;/div&gt;

  &lt;script&gt;
    const { DateTime } = luxon

    const timezones = [
      { label: 'åŒ—äº¬ï¼ˆAsia/Shanghaiï¼‰', value: 'Asia/Shanghai' },
      { label: 'é¦™æ¸¯ï¼ˆAsia/Hong_Kongï¼‰', value: 'Asia/Hong_Kong' },
      { label: 'æ—¥æœ¬ï¼ˆAsia/Tokyoï¼‰', value: 'Asia/Tokyo' },
      { label: 'éŸ©å›½ï¼ˆAsia/Seoulï¼‰', value: 'Asia/Seoul' },
      { label: 'æ–°åŠ å¡ï¼ˆAsia/Singaporeï¼‰', value: 'Asia/Singapore' },
      { label: 'å°åº¦ï¼ˆAsia/Kolkataï¼‰', value: 'Asia/Kolkata' },
      { label: 'ç¾å›½è¥¿éƒ¨ - æ´›æ‰çŸ¶ï¼ˆAmerica/Los_Angelesï¼‰', value: 'America/Los_Angeles' },
      { label: 'ç¾å›½ä¸­éƒ¨ - èŠåŠ å“¥ï¼ˆAmerica/Chicagoï¼‰', value: 'America/Chicago' },
      { label: 'ç¾å›½ä¸œéƒ¨ - çº½çº¦ï¼ˆAmerica/New_Yorkï¼‰', value: 'America/New_York' },
      { label: 'è‹±å›½ï¼ˆEurope/Londonï¼‰', value: 'Europe/London' },
      { label: 'å¾·å›½ï¼ˆEurope/Berlinï¼‰', value: 'Europe/Berlin' },
      { label: 'æ³•å›½ï¼ˆEurope/Parisï¼‰', value: 'Europe/Paris' },
      { label: 'æ¾³å¤§åˆ©äºš - æ‚‰å°¼ï¼ˆAustralia/Sydneyï¼‰', value: 'Australia/Sydney' },
      { label: 'æ–°è¥¿å…°ï¼ˆPacific/Aucklandï¼‰', value: 'Pacific/Auckland' },
      { label: 'å¤å¨å¤·ï¼ˆPacific/Honoluluï¼‰', value: 'Pacific/Honolulu' },
      { label: 'UTCï¼ˆåè°ƒä¸–ç•Œæ—¶ï¼‰', value: 'UTC' }
    ]

    function renderTimezoneOptions() {
      const fromSelect = document.getElementById('fromZone')
      const toSelect = document.getElementById('toZone')

      timezones.forEach(({ label, value }) =&gt; {
        const opt1 = new Option(label, value)
        const opt2 = new Option(label, value)
        fromSelect.appendChild(opt1)
        toSelect.appendChild(opt2)

      })

      fromSelect.value = 'Asia/Shanghai'
      toSelect.value = 'America/Los_Angeles'
    }

    function convertTime() {
      const input = document.getElementById('inputDate').value
      const fromZone = document.getElementById('fromZone').value
      const toZone = document.getElementById('toZone').value
      const output = document.getElementById('output')
      const error = document.getElementById('error')

      error.textContent = ''

      if (!input) {
        error.textContent = 'âŒ è¯·é€‰æ‹©ä¸€ä¸ªæ—¶é—´'
        return
      }

      try {
        const dt = DateTime.fromISO(input, { zone: fromZone })
        const toTime = dt.setZone(toZone)

        const result = `
ğŸŒ åŸå§‹æ—¶é—´ï¼ˆ${fromZone}ï¼‰:
${dt.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ')}

ğŸ•— æ—¶é—´æˆ³ï¼ˆUTC æ¯«ç§’ï¼‰:
${dt.toMillis()}

â¡ï¸ è½¬æ¢åæ—¶é—´ï¼ˆ${toZone}ï¼‰:
${toTime.toFormat('yyyy-MM-dd HH:mm:ss ZZZZ')}
        `.trim()

        output.textContent = result
      } catch (e) {
        error.textContent = 'âŒ è½¬æ¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¾“å…¥'
      }
    }

    function copyResult() {
      const result = document.getElementById('output').textContent
      if (!result || result.includes('å°†åœ¨è¿™é‡Œæ˜¾ç¤º')) return
      navigator.clipboard.writeText(result).then(() =&gt; {
        alert('âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼')
      })
    }

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () =&gt; {
      renderTimezoneOptions()
      const now = new Date()
      const local = now.toISOString().slice(0, 16)
      document.getElementById('inputDate').value = local
    })

    // æ³¨å†Œ PWA service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () =&gt; {
        navigator.serviceWorker.register('service-worker.js')
          .then(() =&gt; console.log('âœ… Service Worker æ³¨å†ŒæˆåŠŸ'))
          .catch(err =&gt; console.log('âŒ æ³¨å†Œå¤±è´¥:', err))
      })
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="5-live-server-å¯åŠ¨">5. Live server å¯åŠ¨</h3>
<p>å¯åŠ¨å®Œæˆå®‰è£…åˆ°æœ¬åœ°å³å¯</p>
<h2 id="å…­æ€»ç»“">å…­ã€æ€»ç»“</h2>
<p>æœ¬é¡¹ç›®å¯¹æ¯”å¹¶é€‰ç”¨ Luxon å®ç°å¤šæ—¶åŒºè½¬æ¢ï¼Œæ”¯æŒå„æ—¶åŒºæ—¶é—´äº’è½¬ã€‚<br>
æä¾› NodeJS ä¸ Python è„šæœ¬ã€ç½‘é¡µå°å·¥å…·åŠ PWA åº”ç”¨ï¼ŒåŠŸèƒ½å®Œæ•´ã€ç»“æ„æ¸…æ™°ã€‚<br>
é€‚ç”¨äºå¿«é€Ÿä½¿ç”¨ã€ç³»ç»Ÿé›†æˆæˆ–ç¦»çº¿è®¿é—®ï¼Œå…·å¤‡è‰¯å¥½æ‰©å±•æ€§ã€‚</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.5206651135509259" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-04-09 13:52">2025-04-09 13:51</span>&nbsp;
<a href="https://www.cnblogs.com/risheng">æ—¥å‡_rs</a>&nbsp;
é˜…è¯»(<span id="post_view_count">90</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18816491" rel="nofollow">ç¼–è¾‘</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18816491);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18816491', targetLink: 'https://www.cnblogs.com/risheng/p/18816491', title: 'æ—¶åŒºè½¬æ¢å·¥å…·+PWAç¦»çº¿ç½‘é¡µ' })">ä¸¾æŠ¥</a>
</div>
        