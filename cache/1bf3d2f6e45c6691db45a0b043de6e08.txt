
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/vipsoft/p/18674944" title="发布于 2025-01-17 10:00">
    <span role="heading" aria-level="2">C# Winform 通过 NAudio 获取控制电脑操作系统音量</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p><a href="https://github.com/naudio/NAudio" target="_blank" rel="noopener nofollow">https://github.com/naudio/NAudio</a><br>
NAudio 是一个开源的 .NET 音频库，由 Mark Heath 开发，开源地址：<a href="https://github.com/naudio/NAudio" target="_blank" rel="noopener nofollow">https://github.com/naudio/NAudio</a> 支持多种音频操作，可实现多种API播放与录制、多种不同音频格式、音频格式转换（重采样、位深、声道等）、音频编码、多通道播放、音频效果处理等等。</p>
<p>比如，把系统禁音了，系统预警声音发不出，这时候通过 NAudio 可以控制，将声音启用，而且可以调整音量的大小，这样，软件的预警就不受人为改变系统音量而受影响</p>
<h2 id="naudio安装">NAudio安装</h2>
<p><font color="red">注意程序的版本号 </font></p>
<h3 id="手动安装">手动安装</h3>
<p>我的程序是 .Net Framework 4.6 的，NuGET 没安装成功。所以下了 NAudio-<br>
1.10.0 的代码进行了编辑：DLL 下载地址：<a href="https://files.cnblogs.com/files/vipsoft/NAudio-1.10.0.zip?t=1737014955&amp;download=true" target="_blank">https://files.cnblogs.com/files/vipsoft/NAudio-1.10.0.zip?t=1737014955&amp;download=true</a></p>
<h3 id="nuget安装">Nuget安装</h3>
<p><img src="https://img2024.cnblogs.com/blog/80824/202501/80824-20250116142021113-1959179808.png" alt="image" loading="lazy"></p>
<p>常用类：</p>
<ul>
<li>WaveIn 表示波形输入, 继承了 IWaveIn, 例如麦克风输入, 或者计算机正在播放的音频流。</li>
<li>WaveOut 表示波形输出, 继承了 IWavePlayer, 用来播放音频, 以 IWaveProvider 作为播放源播放音频, 通过拓展方法也支持以 - ISampleProvider 作为播放源播放音频。</li>
<li>WaveStream 表示波形流, 它继承了 IWaveProvider, 可以用来作为播放源。</li>
<li>WaveFileReader 继承了 WaveStream, 用来读取波形文件。</li>
<li>WaveFileWriter 继承了Stream, 用来写入文件, 常用于保存音频录制的数据。</li>
<li>AudioFileReader 通用的音频文件读取器, 可以读取波形文件, 也可以读取其他类型的音频文件例如 Aiff, MP3</li>
</ul>
<p>常用接口：</p>
<ul>
<li>IWaveProvider 波形提供者, 上面已经提到, 是音频播放的提供者, 通过拓展方法可以转换为 ISampleProvider。</li>
<li>ISampleProvider 采样提供者, 上面已经提到, 通过拓展方法可以作为 WaveOut 的播放源。</li>
</ul>
<h2 id="代码示例">代码示例</h2>
<p>获取系统是否禁音、当前的系统音量、设置新的音量</p>
<pre><code class="language-c#">using NAudio.CoreAudioApi;

private void CheckSystemMuteState()
{
    using (var enumerator = new MMDeviceEnumerator())
    {
        using (var device = enumerator.GetDefaultAudioEndpoint(DataFlow.Render, Role.Console))
        {
            var audioEndpointVolume = device.AudioEndpointVolume;
            // 获取当前主音量级别（范围0.0到1.0）
            float masterVolumeLevel = audioEndpointVolume.MasterVolumeLevelScalar;
            bool isMuted = audioEndpointVolume.Mute;
            string msg=$"系统音频是否静音: {isMuted} 当前系统音量{(masterVolumeLevel * 100).ToString("F2")}%";
            MessageBox.Show(msg);

            //设置音量为 60%
            float newVolumeLevel = 0.6f;
            audioEndpointVolume.MasterVolumeLevelScalar = newVolumeLevel;
            string msg= = $"系统音频是否静音: {isMuted} 当前系统音量{(masterVolumeLevel * 100).ToString("F2")}%";
            MessageBox.Show(msg);
        }
    }
}
</code></pre>

</div>
<div id="MySignature" role="contentinfo">
    <p>本文来自博客园，作者：<a href="https://www.cnblogs.com/vipsoft/" target="_blank">VipSoft</a>  转载请注明原文链接：<a href="https://www.cnblogs.com/vipsoft/p/18674944" target="_blank">https://www.cnblogs.com/vipsoft/p/18674944</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.5089297529039352" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-01-17 10:01">2025-01-17 10:00</span>&nbsp;
<a href="https://www.cnblogs.com/vipsoft">VipSoft</a>&nbsp;
阅读(<span id="post_view_count">194</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18674944" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18674944);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18674944', targetLink: 'https://www.cnblogs.com/vipsoft/p/18674944', title: 'C# Winform 通过 NAudio 获取控制电脑操作系统音量' })">举报</a>
</div>
        