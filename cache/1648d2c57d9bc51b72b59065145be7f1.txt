
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/tpen/p/18663278" title="发布于 2025-01-10 09:14">
    <span role="heading" aria-level="2">C# WinForm 检查目标IP端口是否可连接</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/2440132/202501/2440132-20250110091352403-37969978.png" alt="C# WinForm 检查目标IP端口是否可连接" class="desc_img">
        检查目前IP端口是否可连接的一个小工具。一开始开线程的时间会比较长，后面检查端口的频率大概稳定在65/s。本地检查快很多，但也要1分多钟。
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<ul>
<li>一个小工具。</li>
</ul>
<p><img src="https://img2024.cnblogs.com/blog/2440132/202501/2440132-20250110091036218-1509578231.gif" alt=""></p>
<p>&nbsp;</p>
<ul>
<li>WinForm UI Code</li>
</ul>
<div class="cnblogs_code"><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" id="code_img_closed_db3fd55f-aebb-4213-9fa2-fb490d3dba0e" class="code_img_closed"><img src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" id="code_img_opened_db3fd55f-aebb-4213-9fa2-fb490d3dba0e" class="code_img_opened" style="display: none">
<div id="cnblogs_code_open_db3fd55f-aebb-4213-9fa2-fb490d3dba0e" class="cnblogs_code_hide">
<pre><span style="color: rgba(0, 0, 255, 1)">namespace</span><span style="color: rgba(0, 0, 0, 1)"> IPPort_CheckTool
{
    </span><span style="color: rgba(0, 0, 255, 1)">partial</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> MainForm
    {
        </span><span style="color: rgba(128, 128, 128, 1)">///</span> <span style="color: rgba(128, 128, 128, 1)">&lt;summary&gt;</span>
        <span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 必需的设计器变量。
        </span><span style="color: rgba(128, 128, 128, 1)">///</span> <span style="color: rgba(128, 128, 128, 1)">&lt;/summary&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">private</span> System.ComponentModel.IContainer components = <span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">;

        </span><span style="color: rgba(128, 128, 128, 1)">///</span> <span style="color: rgba(128, 128, 128, 1)">&lt;summary&gt;</span>
        <span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 清理所有正在使用的资源。
        </span><span style="color: rgba(128, 128, 128, 1)">///</span> <span style="color: rgba(128, 128, 128, 1)">&lt;/summary&gt;</span>
        <span style="color: rgba(128, 128, 128, 1)">///</span> <span style="color: rgba(128, 128, 128, 1)">&lt;param name="disposing"&gt;</span><span style="color: rgba(0, 128, 0, 1)">如果应释放托管资源，为 true；否则为 false。</span><span style="color: rgba(128, 128, 128, 1)">&lt;/param&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">protected</span> <span style="color: rgba(0, 0, 255, 1)">override</span> <span style="color: rgba(0, 0, 255, 1)">void</span> Dispose(<span style="color: rgba(0, 0, 255, 1)">bool</span><span style="color: rgba(0, 0, 0, 1)"> disposing)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">if</span> (disposing &amp;&amp; (components != <span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">))
            {
                components.Dispose();
            }
            </span><span style="color: rgba(0, 0, 255, 1)">base</span><span style="color: rgba(0, 0, 0, 1)">.Dispose(disposing);
        }

        </span><span style="color: rgba(0, 0, 255, 1)">#region</span> Windows 窗体设计器生成的代码

        <span style="color: rgba(128, 128, 128, 1)">///</span> <span style="color: rgba(128, 128, 128, 1)">&lt;summary&gt;</span>
        <span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 设计器支持所需的方法 - 不要修改
        </span><span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 使用代码编辑器修改此方法的内容。
        </span><span style="color: rgba(128, 128, 128, 1)">///</span> <span style="color: rgba(128, 128, 128, 1)">&lt;/summary&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> InitializeComponent()
        {
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1 = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.GroupBox();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Time = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Active = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_NoActive = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.btn_Start = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Button();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label3 = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label2 = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label1 = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortEnd = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.TextBox();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortStart = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.TextBox();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_IP = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.TextBox();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.ListBox();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.ListBox();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.progressBar = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.ProgressBar();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.groupBox1.SuspendLayout();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.SuspendLayout();
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> groupBox1
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.progressBar);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_Time);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_CoreNum);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_Active);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_NoActive);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.btn_Start);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.label3);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.label2);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.label1);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_PortEnd);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_PortStart);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_IP);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Dock =<span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.DockStyle.Top;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">3</span>, <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Margin = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Windows.Forms.Padding(<span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">groupBox1</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Padding = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Windows.Forms.Padding(<span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">1058</span>, <span style="color: rgba(128, 0, 128, 1)">127</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.TabIndex = <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.TabStop = <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">配置：</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> txt_Time
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Time.AutoSize = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Time.ForeColor =<span style="color: rgba(0, 0, 0, 1)"> System.Drawing.Color.Green;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Time.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">844</span>, <span style="color: rgba(128, 0, 128, 1)">101</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Time.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">txt_Time</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Time.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">74</span>, <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Time.TabIndex = <span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Time.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">耗时：0s</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> txt_CoreNum
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum.AutoSize = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum.ForeColor =<span style="color: rgba(0, 0, 0, 1)"> System.Drawing.Color.Green;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">610</span>, <span style="color: rgba(128, 0, 128, 1)">101</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">txt_CoreNum</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">120</span>, <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum.TabIndex = <span style="color: rgba(128, 0, 128, 1)">9</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">CPU核心总数:0</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> txt_Active
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Active.AutoSize = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Active.ForeColor =<span style="color: rgba(0, 0, 0, 1)"> System.Drawing.Color.Green;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Active.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">389</span>, <span style="color: rgba(128, 0, 128, 1)">101</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Active.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">txt_Active</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Active.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">119</span>, <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Active.TabIndex = <span style="color: rgba(128, 0, 128, 1)">8</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_Active.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">激活端口总数:0</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> txt_NoActive
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.txt_NoActive.AutoSize = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_NoActive.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">3</span>, <span style="color: rgba(128, 0, 128, 1)">101</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_NoActive.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">txt_NoActive</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_NoActive.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">135</span>, <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_NoActive.TabIndex = <span style="color: rgba(128, 0, 128, 1)">7</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_NoActive.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">未激活端口总数:0</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> btn_Start
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.btn_Start.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">915</span>, <span style="color: rgba(128, 0, 128, 1)">30</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.btn_Start.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">btn_Start</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.btn_Start.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">123</span>, <span style="color: rgba(128, 0, 128, 1)">56</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.btn_Start.TabIndex = <span style="color: rgba(128, 0, 128, 1)">6</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.btn_Start.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">开始测试端口是否激活</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.btn_Start.UseVisualStyleBackColor = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.btn_Start.Click += <span style="color: rgba(0, 0, 255, 1)">new</span> System.EventHandler(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.btn_Start_Click);
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> label3
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.label3.AutoSize = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label3.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">530</span>, <span style="color: rgba(128, 0, 128, 1)">41</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label3.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">label3</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label3.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">78</span>, <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label3.TabIndex = <span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label3.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">结束端口:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> label2
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.label2.AutoSize = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label2.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">252</span>, <span style="color: rgba(128, 0, 128, 1)">41</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label2.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">label2</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label2.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">78</span>, <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label2.TabIndex = <span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label2.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">开始端口:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> label1
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.label1.AutoSize = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label1.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">23</span>, <span style="color: rgba(128, 0, 128, 1)">41</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label1.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">label1</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label1.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">29</span>, <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label1.TabIndex = <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.label1.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">IP:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> txt_PortEnd
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortEnd.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">633</span>, <span style="color: rgba(128, 0, 128, 1)">41</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortEnd.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">txt_PortEnd</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortEnd.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">150</span>, <span style="color: rgba(128, 0, 128, 1)">29</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortEnd.TabIndex = <span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> txt_PortStart
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortStart.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">355</span>, <span style="color: rgba(128, 0, 128, 1)">41</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortStart.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">txt_PortStart</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortStart.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">150</span>, <span style="color: rgba(128, 0, 128, 1)">29</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortStart.TabIndex = <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> txt_IP
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.txt_IP.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">77</span>, <span style="color: rgba(128, 0, 128, 1)">41</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_IP.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">txt_IP</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_IP.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">150</span>, <span style="color: rgba(128, 0, 128, 1)">29</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_IP.TabIndex = <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> listBox_NoActive
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive.Dock =<span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.DockStyle.Left;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive.ForeColor =<span style="color: rgba(0, 0, 0, 1)"> System.Drawing.Color.Gray;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive.FormattingEnabled = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive.ItemHeight = <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">3</span>, <span style="color: rgba(128, 0, 128, 1)">130</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">listBox_NoActive</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">383</span>, <span style="color: rgba(128, 0, 128, 1)">548</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_NoActive.TabIndex = <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> listBox_ActivePort
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort.Dock =<span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.DockStyle.Fill;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort.ForeColor =<span style="color: rgba(0, 0, 0, 1)"> System.Drawing.Color.Green;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort.FormattingEnabled = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort.ItemHeight = <span style="color: rgba(128, 0, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">386</span>, <span style="color: rgba(128, 0, 128, 1)">130</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">listBox_ActivePort</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">675</span>, <span style="color: rgba(128, 0, 128, 1)">548</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listBox_ActivePort.TabIndex = <span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> progressBar
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.progressBar.Location = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Point(<span style="color: rgba(128, 0, 128, 1)">798</span>, <span style="color: rgba(128, 0, 128, 1)">41</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.progressBar.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">progressBar</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.progressBar.Size = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">100</span>, <span style="color: rgba(128, 0, 128, 1)">29</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.progressBar.TabIndex = <span style="color: rgba(128, 0, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> MainForm
            </span><span style="color: rgba(0, 128, 0, 1)">//</span> 
            <span style="color: rgba(0, 0, 255, 1)">this</span>.AutoScaleDimensions = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.Drawing.SizeF(10F, 21F);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.AutoScaleMode =<span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.AutoScaleMode.Font;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.ClientSize = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Size(<span style="color: rgba(128, 0, 128, 1)">1064</span>, <span style="color: rgba(128, 0, 128, 1)">681</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.listBox_ActivePort);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.listBox_NoActive);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Controls.Add(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.groupBox1);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Font = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Drawing.Font(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">微软雅黑</span><span style="color: rgba(128, 0, 0, 1)">"</span>, 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((<span style="color: rgba(0, 0, 255, 1)">byte</span>)(<span style="color: rgba(128, 0, 128, 1)">134</span><span style="color: rgba(0, 0, 0, 1)">)));
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Margin = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Windows.Forms.Padding(<span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Name = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">MainForm</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Padding = <span style="color: rgba(0, 0, 255, 1)">new</span> System.Windows.Forms.Padding(<span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.StartPosition =<span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.FormStartPosition.CenterScreen;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Text = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Hello!</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.groupBox1.ResumeLayout(<span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.groupBox1.PerformLayout();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.ResumeLayout(<span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">);

        }

        </span><span style="color: rgba(0, 0, 255, 1)">#endregion</span>

        <span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.GroupBox groupBox1;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label label1;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.TextBox txt_PortEnd;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.TextBox txt_PortStart;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.TextBox txt_IP;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label label2;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label label3;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Button btn_Start;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.ListBox listBox_NoActive;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.ListBox listBox_ActivePort;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label txt_NoActive;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label txt_Active;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label txt_CoreNum;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.Label txt_Time;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms.ProgressBar progressBar;
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">Winform UI Code</span></div>
<p>&nbsp;</p>
<ul>
<li>&nbsp;Main Code</li>
</ul>
<div class="cnblogs_code"><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" id="code_img_closed_c80adedf-571c-498a-8a0c-3dd6e61da1a1" class="code_img_closed"><img src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" id="code_img_opened_c80adedf-571c-498a-8a0c-3dd6e61da1a1" class="code_img_opened" style="display: none">
<div id="cnblogs_code_open_c80adedf-571c-498a-8a0c-3dd6e61da1a1" class="cnblogs_code_hide">
<pre><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System.Configuration;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System.Linq;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System.Net;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System.Net.NetworkInformation;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System.Net.Sockets;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System.Threading.Tasks;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms;

</span><span style="color: rgba(0, 0, 255, 1)">namespace</span><span style="color: rgba(0, 0, 0, 1)"> IPPort_CheckTool
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">partial</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> MainForm : Form
    {
        </span><span style="color: rgba(0, 0, 255, 1)">private</span> Configuration config =<span style="color: rgba(0, 0, 0, 1)"> ConfigurationManager.OpenExeConfiguration(Application.ExecutablePath);
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> DateTime startTime;
        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> Task[] tasks;

        </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> NotifyIcon notifyIcon;

        </span><span style="color: rgba(0, 0, 255, 1)">public</span><span style="color: rgba(0, 0, 0, 1)"> MainForm()
        {
            InitializeComponent();

            </span><span style="color: rgba(0, 0, 255, 1)">var</span> now =<span style="color: rgba(0, 0, 0, 1)"> DateTime.Now;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.Text = $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Hello 今天是{now.ToString(</span><span style="color: rgba(128, 0, 0, 1)">"</span>dddd<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">)}哟 🤭</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;

            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_IP.Text = ConfigurationManager.AppSettings[<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">IP</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">].ToString();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortStart.Text = ConfigurationManager.AppSettings[<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">MinPortStart</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">].ToString();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_PortEnd.Text = ConfigurationManager.AppSettings[<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">MaxPortEnd</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">].ToString();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.txt_CoreNum.Text = $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">CPU核心总数：{Environment.ProcessorCount}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;

            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.components = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> System.ComponentModel.Container();
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.notifyIcon = <span style="color: rgba(0, 0, 255, 1)">new</span> NotifyIcon(<span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.components);
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.notifyIcon.Visible = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>.notifyIcon.MouseClick += (sn, en) =&gt; { <span style="color: rgba(0, 0, 255, 1)">if</span> (en.Button == MouseButtons.Left) <span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.Show(); };
            </span><span style="color: rgba(0, 0, 255, 1)">var</span> menus = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> ContextMenu();
            </span><span style="color: rgba(0, 0, 255, 1)">var</span> menu1= <span style="color: rgba(0, 0, 255, 1)">new</span> MenuItem(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">退出软件</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            menu1.Click </span>+= (s1, e1) =&gt; { <span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.Close(); };
            menus.MenuItems.Add(menu1);
            notifyIcon.ContextMenu</span>=<span style="color: rgba(0, 0, 0, 1)"> menus;
        }

        </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> btn_Start_Click(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, EventArgs e)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">string</span> ip = <span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_IP.Text.Trim();
            </span><span style="color: rgba(0, 0, 255, 1)">string</span> min = <span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_PortStart.Text.Trim();
            </span><span style="color: rgba(0, 0, 255, 1)">string</span> max = <span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.txt_PortEnd.Text.Trim();

            </span><span style="color: rgba(0, 0, 255, 1)">if</span> (<span style="color: rgba(0, 0, 255, 1)">string</span>.IsNullOrWhiteSpace(ip) || <span style="color: rgba(0, 0, 255, 1)">string</span>.IsNullOrWhiteSpace(min) || <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)">.IsNullOrWhiteSpace(max))
            {
                MessageBox.Show(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">不能为空！</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
            }

            </span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 255, 1)">int</span>.TryParse(min, <span style="color: rgba(0, 0, 255, 1)">out</span> <span style="color: rgba(0, 0, 255, 1)">var</span> minPort) || !<span style="color: rgba(0, 0, 255, 1)">int</span>.TryParse(max, <span style="color: rgba(0, 0, 255, 1)">out</span> <span style="color: rgba(0, 0, 255, 1)">var</span><span style="color: rgba(0, 0, 0, 1)"> maxPort))
            {
                MessageBox.Show(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">端口不是整数！</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
            }

            config.AppSettings.Settings[</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">IP</span><span style="color: rgba(128, 0, 0, 1)">"</span>].Value =<span style="color: rgba(0, 0, 0, 1)"> ip;
            config.AppSettings.Settings[</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">MinPortStart</span><span style="color: rgba(128, 0, 0, 1)">"</span>].Value =<span style="color: rgba(0, 0, 0, 1)"> min;
            config.AppSettings.Settings[</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">MaxPortEnd</span><span style="color: rgba(128, 0, 0, 1)">"</span>].Value =<span style="color: rgba(0, 0, 0, 1)"> max;
            config.Save();
            ConfigurationManager.RefreshSection(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">appSettings</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

            IPAddress targetIpAddress </span>=<span style="color: rgba(0, 0, 0, 1)"> IPAddress.Parse(ip);
            </span><span style="color: rgba(0, 0, 255, 1)">var</span> ipadrlist =<span style="color: rgba(0, 0, 0, 1)"> Dns.GetHostAddresses(Dns.GetHostName()).ToList();
            ipadrlist.Add(IPAddress.Parse(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">127.0.0.1</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
            ipadrlist.Add(IPAddress.Parse(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">0.0.0.0</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
            </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (ipadrlist.Contains(targetIpAddress))
            {
                CheckLocalPort(minPort, maxPort);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">本地IP</span>
<span style="color: rgba(0, 0, 0, 1)">            }
            </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">
            {
                CheckRemotePort(ip, minPort, maxPort);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">远程IP</span>
<span style="color: rgba(0, 0, 0, 1)">            }
        }

        </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> CheckLocalPort(<span style="color: rgba(0, 0, 255, 1)">int</span> minPort, <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> maxPort)
        {
            btn_Start.Enabled </span>= <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">;

            listBox_NoActive.Items.Clear();
            listBox_ActivePort.Items.Clear();
            startTime </span>=<span style="color: rgba(0, 0, 0, 1)"> DateTime.Now;
            </span><span style="color: rgba(0, 0, 255, 1)">int</span> length = maxPort - minPort + <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
            progressBar.Maximum </span>=<span style="color: rgba(0, 0, 0, 1)"> length;
            progressBar.Minimum </span>= <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;

            </span><span style="color: rgba(0, 0, 255, 1)">var</span> ips =<span style="color: rgba(0, 0, 0, 1)"> IPGlobalProperties.GetIPGlobalProperties();
            </span><span style="color: rgba(0, 0, 255, 1)">var</span> activeIps = ips.GetActiveTcpListeners().Select(p =&gt;<span style="color: rgba(0, 0, 0, 1)"> p.Port).ToHashSet();

            Task.Factory.StartNew(</span><span style="color: rgba(0, 0, 255, 1)">new</span> Action(() =&gt;<span style="color: rgba(0, 0, 0, 1)">
            {
                </span><span style="color: rgba(0, 0, 255, 1)">for</span> (<span style="color: rgba(0, 0, 255, 1)">int</span> i = minPort; i &lt;= maxPort; i++<span style="color: rgba(0, 0, 0, 1)">)
                {
                    </span><span style="color: rgba(0, 0, 255, 1)">int</span> port =<span style="color: rgba(0, 0, 0, 1)"> i;
                    </span><span style="color: rgba(0, 0, 255, 1)">this</span>?.Invoke(<span style="color: rgba(0, 0, 255, 1)">new</span> Action(() =&gt;<span style="color: rgba(0, 0, 0, 1)">
                    {
                        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (activeIps.Contains(port))
                        {
                            listBox_ActivePort.Items.Insert(</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">, port);
                            txt_Active.Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">激活端口总数：{listBox_ActivePort.Items.Count}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
                        }
                        </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">
                        {
                            listBox_NoActive.Items.Insert(</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">, port);
                            txt_NoActive.Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">未激活端口总数：{listBox_NoActive.Items.Count}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
                        }
                        progressBar.Value </span>= listBox_ActivePort.Items.Count +<span style="color: rgba(0, 0, 0, 1)"> listBox_NoActive.Items.Count;
                        txt_Time.Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">耗时：{(DateTime.Now - startTime).TotalSeconds.ToString()}s</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;

                        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">耗时操作卡死UI 处理方法</span>
<span style="color: rgba(0, 0, 0, 1)">                        Application.DoEvents();
                    }));
                }

            })).ContinueWith(p </span>=&gt;<span style="color: rgba(0, 0, 0, 1)"> InitUI());

        }

        </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> CheckRemotePort(<span style="color: rgba(0, 0, 255, 1)">string</span> ip, <span style="color: rgba(0, 0, 255, 1)">int</span> minPort, <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> maxPort)
        {
            btn_Start.Enabled </span>= <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">;

            listBox_NoActive.Items.Clear();
            listBox_ActivePort.Items.Clear();
            startTime </span>=<span style="color: rgba(0, 0, 0, 1)"> DateTime.Now;
            </span><span style="color: rgba(0, 0, 255, 1)">int</span> length = maxPort - minPort + <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
            tasks </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Task[length];
            progressBar.Maximum </span>=<span style="color: rgba(0, 0, 0, 1)"> length;
            progressBar.Minimum </span>= <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;

            Task.Run(() </span>=&gt;<span style="color: rgba(0, 0, 0, 1)">
            {
                </span><span style="color: rgba(0, 0, 255, 1)">for</span> (<span style="color: rgba(0, 0, 255, 1)">int</span> i = minPort; i &lt;= maxPort; i++<span style="color: rgba(0, 0, 0, 1)">)
                {
                    </span><span style="color: rgba(0, 0, 255, 1)">int</span> port =<span style="color: rgba(0, 0, 0, 1)"> i;
                    </span><span style="color: rgba(0, 0, 255, 1)">var</span> task = Task.Factory.StartNew(<span style="color: rgba(0, 0, 255, 1)">new</span> Action(() =&gt;<span style="color: rgba(0, 0, 0, 1)">
                    {
                        </span><span style="color: rgba(0, 0, 255, 1)">var</span> res =<span style="color: rgba(0, 0, 0, 1)"> CheckRemotePortCanConnect(ip, port);
                        </span><span style="color: rgba(0, 0, 255, 1)">this</span>?.Invoke(<span style="color: rgba(0, 0, 255, 1)">new</span> Action(() =&gt;<span style="color: rgba(0, 0, 0, 1)">
                        {
                            </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (res.Item1)
                            {
                                listBox_ActivePort.Items.Insert(</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">, res.Item2);
                                txt_Active.Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">激活端口总数：{listBox_ActivePort.Items.Count}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
                            }
                            </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">
                            {
                                listBox_NoActive.Items.Insert(</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">, res.Item2);
                                txt_NoActive.Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">未激活端口总数：{listBox_NoActive.Items.Count}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
                            }
                            progressBar.Value </span>= listBox_ActivePort.Items.Count +<span style="color: rgba(0, 0, 0, 1)"> listBox_NoActive.Items.Count;
                            txt_Time.Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">耗时：{(DateTime.Now - startTime).TotalSeconds.ToString()}s</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;

                            </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">耗时操作卡死UI 处理方法</span>
<span style="color: rgba(0, 0, 0, 1)">                            Application.DoEvents();
                        }));
                    }));
                    tasks[i </span>- minPort] =<span style="color: rgba(0, 0, 0, 1)"> task;
                }

                Task.WaitAll(tasks);

            }).ContinueWith(p </span>=&gt;<span style="color: rgba(0, 0, 0, 1)"> InitUI());
        }

        </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> InitUI()
        {
            </span><span style="color: rgba(0, 0, 255, 1)">this</span>?.Invoke(<span style="color: rgba(0, 0, 255, 1)">new</span> Action(() =&gt; { btn_Start.Enabled = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">; }));
        }

        </span><span style="color: rgba(0, 0, 255, 1)">private</span> (<span style="color: rgba(0, 0, 255, 1)">bool</span>,<span style="color: rgba(0, 0, 255, 1)">int</span>) CheckRemotePortCanConnect(<span style="color: rgba(0, 0, 255, 1)">string</span> ipString, <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> port)
        {
            IPAddress ip </span>=<span style="color: rgba(0, 0, 0, 1)"> IPAddress.Parse(ipString);

            </span><span style="color: rgba(0, 0, 255, 1)">bool</span> isConnect = <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">;

            TcpClient tcp </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> TcpClient();
            </span><span style="color: rgba(0, 0, 255, 1)">try</span><span style="color: rgba(0, 0, 0, 1)">
            {
                tcp.Connect(ip, port);
                isConnect </span>=<span style="color: rgba(0, 0, 0, 1)"> tcp.Connected;
            }
            </span><span style="color: rgba(0, 0, 255, 1)">catch</span><span style="color: rgba(0, 0, 0, 1)"> (Exception)
            {
                isConnect </span>= <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">;
            }
            </span><span style="color: rgba(0, 0, 255, 1)">finally</span><span style="color: rgba(0, 0, 0, 1)">
            {
                tcp</span>?<span style="color: rgba(0, 0, 0, 1)">.Close();
                tcp</span>?<span style="color: rgba(0, 0, 0, 1)">.Dispose();
            }
            </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> (isConnect, port);
        }
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">Main Code</span></div>
<p>&nbsp;</p>
<ul>
<li>
<p>引用</p>
</li>
</ul>
<ol>
<li style="text-align: left"><a href="https://blog.csdn.net/u011511086/article/details/114299800" rel="noopener nofollow">C#检查服务器ip和端口是否通畅，是否可访问_c#winform如何判断端口和ip为空-CSDN博客</a></li>
</ol>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="1.0301786303275462" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-01-10 19:41">2025-01-10 09:14</span>&nbsp;
<a href="https://www.cnblogs.com/tpen">tpen</a>&nbsp;
阅读(<span id="post_view_count">133</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18663278" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18663278);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18663278', targetLink: 'https://www.cnblogs.com/tpen/p/18663278', title: 'C# WinForm 检查目标IP端口是否可连接' })">举报</a>
</div>
        