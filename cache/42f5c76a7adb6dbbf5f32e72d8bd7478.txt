
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/dawnkylin/p/18758759" title="发布于 2025-03-07 23:17">
    <span role="heading" aria-level="2">使用 Trae 辅助开发一个网页文本高亮插件</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p><img src="https://img2024.cnblogs.com/blog/3396972/202503/3396972-20250307231450514-1486674626.png" alt="" loading="lazy"></p>
<blockquote>
<p>新手第一次开发浏览器插件，抖音刷到了 <strong>Trae</strong>，这几天就使用它开发了一个浏览器文本高亮插件。做了个七七八八，肯定还有不少 Bug。</p>
</blockquote>
<h2 id="项目概述">项目概述</h2>
<p>本插件是一个用于在网页上高亮显示选中文本的工具，支持多种颜色选择、高亮复制和删除等功能。插件基于 Edge 扩展测试开发。</p>
<p>目前只大致开发了内容交互脚本和插件弹出页，后台管理页暂未开发。</p>
<h2 id="项目结构">项目结构</h2>
<pre><code>c:\Users\lc\Documents\前端项目代码\Egde高亮插件
├── content/
│   ├── content.js        // 核心逻辑代码
│   └── highlight.css     // 高亮样式
├── popup/
│   ├── popup.css         // 弹出页样式
│   ├── popup.html        // 弹出页HTML
│   └── popup.js          // 弹出页逻辑
└── manifest.json         // 插件配置文件
</code></pre>
<h2 id="功能概览">功能概览</h2>
<h3 id="存储结构">存储结构</h3>
<p>使用 chrome.storage.local 管理高亮的存储信息，其存储结构如下</p>
<pre><code>[url]
├── item
│ 	├── id
│ 	├── color
│ 	├── startXPath
│ 	├── endXPath
│ 	├── textFingerprint
│ 	├── contextFingerprint
│ 		├── before
│ 		├── after
</code></pre>
<blockquote>
<p>startXPath、endXPath 是之前尝试使用 startConatiner、endContainer 的 XPath 以及它们的偏移量来确定 Range 的时候添加的，这个方法是不准确的，因为偏移量会受其它高亮的影响。所以它两可以删除。</p>
</blockquote>
<p><img src="https://img2024.cnblogs.com/blog/3396972/202503/3396972-20250307231500651-2114138444.png" alt="" loading="lazy"></p>
<h3 id="核心功能">核心功能</h3>
<ol>
<li>高亮管理
<ul>
<li>通过 <code>PageHighlightStorage</code> 类管理高亮信息
<ul>
<li>使用 chrome.storage.local 实现数据持久化</li>
<li>支持添加、删除、更新和查询高亮记录</li>
</ul>
</li>
</ul>
</li>
<li>高亮创建
<ul>
<li>通过 <code>saveHighlightInfo</code> 保存高亮信息
<ul>
<li>使用 <code>getXPath</code> 获取元素路径</li>
<li>通过 <code>generateTextFingerprint</code> 和 <code>generateContextFingerprint</code> 生成文本指纹和上下文指纹</li>
</ul>
</li>
</ul>
</li>
<li>高亮恢复
<ul>
<li>通过 <code>restoreHighlights</code> 恢复已保存的高亮
<ul>
<li>使用 <code>createRangeByFingerprint</code> 根据指纹重新创建Range对象，能处理跨节点的高亮，匹配算法确保高亮位置准确</li>
<li>采用Levenshtein算法进行文本匹配</li>
</ul>
</li>
</ul>
</li>
<li>高亮操作
<ul>
<li>通过 <code>createToolbox</code> 创建操作工具框
<ul>
<li>支持颜色切换、删除和复制高亮内容</li>
<li>使用 <code>applyHighlightToRange</code> 将高亮应用到文本范围</li>
</ul>
</li>
</ul>
</li>
<li>与插件弹出页交互
<ul>
<li>通过 chrome.tabs.query、chrome.tabs.sendMessage 和 通过 chrome.tabs.onMessage 建立消息通信，实现清除页面全部功能的按钮</li>
</ul>
</li>
<li>错误处理
<ul>
<li>自动清理无效的高亮记录</li>
<li>处理各种边界情况</li>
<li>提供详细的日志输出</li>
</ul>
</li>
</ol>
<p><a href="https://github.com/dawnkylin/edge-ext-text-highlighter" target="_blank" rel="noopener nofollow">dawnkylin/edge-ext-text-highlighter: A web extension for highlighting text</a></p>

</div>
<div id="MySignature" role="contentinfo">
    <b>如有错误和建议，欢迎在评论区告知！</b>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.02266789507986111" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-07 23:46">2025-03-07 23:17</span>&nbsp;
<a href="https://www.cnblogs.com/dawnkylin">dawnkylin</a>&nbsp;
阅读(<span id="post_view_count">3</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18758759" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18758759);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18758759', targetLink: 'https://www.cnblogs.com/dawnkylin/p/18758759', title: '使用 Trae 辅助开发一个网页文本高亮插件' })">举报</a>
</div>
        