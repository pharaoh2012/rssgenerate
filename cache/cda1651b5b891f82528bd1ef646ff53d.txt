
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/dennyLee2025/p/18919268" title="å‘å¸ƒäº 2025-06-09 07:59">
    <span role="heading" aria-level="2">Javaé›†åˆæºç --ArrayListçš„å¯è§†åŒ–æ“ä½œè¿‡ç¨‹</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>å…³äºArrayListçš„å…ƒç´ æ’å…¥ã€æ£€ç´¢ã€ä¿®æ”¹ã€åˆ é™¤ã€æ‰©å®¹ç­‰å¯è§†åŒ–æ“ä½œè¿‡ç¨‹</p>
<p>è¿˜æœ‰å…³äºArrayListçš„è¿­ä»£å™¨ã€çº¿ç¨‹å®‰å…¨å’Œæ—¶é—´å¤æ‚åº¦</p>
</blockquote>
<h2 id="1-åº•å±‚æ•°æ®ç»“æ„">ğŸ“1. åº•å±‚æ•°æ®ç»“æ„</h2>
<p>åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œå†…éƒ¨ç»´æŠ¤ä¸€ä¸ª<code>Object[]</code>æ•°ç»„ã€‚æœ¬è´¨æ˜¯<strong>æ•°ç»„æ•°æ®ç»“æ„</strong>ï¼Œåº•å±‚é€šè¿‡æ‹·è´æ‰©å®¹ä½¿å¾—æ•°ç»„å…·å¤‡äº†åŠ¨æ€å¢å¤§çš„ç‰¹æ€§ã€‚</p>
<p><strong>æ•°ç»„</strong>æ‰€å…·å¤‡çš„ä¸€äº›<strong>ç‰¹æ€§</strong>ï¼Œ<code>ArrayList</code>ä¹ŸåŒæ ·å…·å¤‡ï¼Œæ¯”å¦‚ã€æ’å…¥å…ƒç´ çš„æœ‰åºæ€§ã€è®¿é—®å…ƒç´ çš„åœ°å€è®¡ç®—ç­‰ã€‚<code>ArrayList</code>ä¸æ™®é€šæ•°ç»„çš„æœ¬è´¨åŒºåˆ«å°±åœ¨äºå®ƒçš„åŠ¨æ€æ‰©å®¹ç‰¹æ€§ã€‚</p>
<p><strong>é›†åˆå†…å¯ä»¥ä¿å­˜ä»€ä¹ˆç±»å‹å…ƒç´ ï¼Ÿä¿å­˜çš„æ˜¯ä»€ä¹ˆï¼Ÿ</strong> è¿™ç‚¹å¿…é¡»æ˜ç¡®çŸ¥é“<strong>é›†åˆå¿…é¡»ä¿å­˜å¼•ç”¨ç±»å‹</strong>çš„å…ƒç´ ï¼Œå¯¹äºåŸºæœ¬ç±»å‹æ˜¯æ— æ³•ä¿å­˜çš„ï¼Œæ¯”å¦‚ã€intã€longç±»å‹ï¼Œä½†å¯ä»¥ä¿æŒå¯¹åº”çš„åŸºæœ¬ç±»å‹çš„å°è£…ç±»ï¼Œæ¯”å¦‚ï¼Œ<code>Integer</code>ã€<code>Long</code>ã€‚é›†åˆå†…ä¿å­˜çš„æ˜¯<strong>å¯¹è±¡çš„å¼•ç”¨</strong>ï¼Œè€Œéå¯¹è±¡æœ¬èº«ã€‚</p>
<h3 id="11-arraylistçš„ç‰¹æ€§">1.1. ArrayListçš„ç‰¹æ€§</h3>
<p>æœ‰åº•å±‚æ•°æ®ç»“æ„æ‰€å†³å®šçš„ç‰¹æ€§</p>
<ul>
<li>
<p>æ’å…¥å…ƒç´ çš„æœ‰åºæ€§ï¼Œè€Œéæ’åºï¼Œä¸ä¼šè‡ªåŠ¨æ ¹æ®å€¼æ’åºï¼›</p>
</li>
<li>
<p>å…ƒç´ è®¿é—®ï¼šé€šè¿‡æ•°ç»„â€œ<strong>é¦–åœ°å€+ä¸‹æ ‡</strong>â€æ¥è®¡ç®—å…ƒç´ çš„å­˜å‚¨åœ°å€ï¼Œå†é€šè¿‡å…ƒç´ åœ°å€<strong>ç›´æ¥è®¿é—®</strong>ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ï¼›</p>
</li>
<li>
<p><strong>æ•°ç»„</strong>ä¸€ä½†ç”³è¯·ç©ºé—´å°±ç¡®å®š<strong>ä¸å¯å˜</strong>ï¼Œæ‰€ä»¥ArrayListéœ€è¦åœ¨æ·»åŠ å…ƒç´ æ“ä½œæ—¶ï¼Œå®ç°<strong>è‡ªåŠ¨æ‰©å®¹</strong>ã€‚</p>
</li>
</ul>
<h3 id="12-å¦‚ä½•è®¾è®¡çš„æ•°æ®ç»“æ„">1.2. å¦‚ä½•è®¾è®¡çš„æ•°æ®ç»“æ„</h3>
<p>ä»¥ä¸‹æ˜¯<code>ArrayList</code>ç±»ç»“æ„ä¸å­—æ®µ</p>
<pre><code class="language-java">public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt;
    implements List&lt;E&gt;, RandomAccess, Cloneable, Serializable {
    private static final long serialVersionUID = 8683452581122892189L;

    /** é»˜è®¤åˆå§‹å®¹é‡ */ 
    private static final int DEFAULT_CAPACITY = 10;
    /** ç©ºå®ä¾‹æ•°ç»„ï¼ˆæ— å»¶è¿Ÿæ‰©å®¹ï¼‰ */
    private static final Object[] EMPTY_ELEMENTDATA = {};
    /** é»˜è®¤æ„é€ åé¦–æ¬¡æ‰©å®¹ä½¿ç”¨çš„ç©ºæ•°ç»„ */
    private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
    /** é˜ˆå€¼ï¼šæœ€å¤§æ•°ç»„å¤§å° */
    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;

    /** çœŸæ­£å­˜å‚¨å…ƒç´ çš„æ•°ç»„ï¼›æ„é€ æ—¶æˆ–èµ‹äºˆ EMPTY_* å…±äº«æ•°ç»„ */
    transient Object[] elementData;
    /** å½“å‰å…ƒç´ ä¸ªæ•° */
    private int size;
    /** ç”¨äº Fail-Fast çš„ä¿®æ”¹è®¡æ•°å™¨ */
    protected transient int modCount;
    // â€¦
}
</code></pre>
<p>çœŸæ­£å­˜å‚¨å…ƒç´ çš„æˆå‘˜å˜é‡<code>Object[] elementData</code>å’Œä¿å­˜æ•°ç»„å¤§å°çš„<code>size</code>ï¼Œå…¶å®ƒå­—æ®µå¤šåŠæœåŠ¡äº<strong>åŠ¨æ€æ‰©å®¹</strong>ã€‚</p>
<p><img src="https://img2024.cnblogs.com/blog/1209017/202506/1209017-20250608124810760-1826254169.jpg" alt="image" loading="lazy"></p>
<p><code>MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8</code> ä¸ºä»€ä¹ˆå‡8ï¼Ÿå› ä¸ºæ•°ç»„å¤´éœ€è¦å ç”¨ä¸€äº›ç©ºé—´ï¼Œ8ä½åˆšå¥½ä¸€ä¸ªå­—èŠ‚ï¼Œæ•…æœ€å°å‡8ï¼Œä½¿å¾—ArrayListå°½å¯èƒ½å­˜å‚¨æ›´å¤šæ•°æ®ï¼Œä½†æ­£å¸¸å¼€å‘ä¸å¯èƒ½ä¿å­˜è¿™ä¹ˆå¤§æ•°æ®é›†åˆï¼Œ<code>Integer.MAX_VALUE</code>å¯ä»¥ä¿æŒåäº¿çº§äº†ï¼Œä½ å‡ä¸ª1024éƒ½æ²¡é—®é¢˜ã€‚</p>
<p><code>modCount</code>ç”¨äºè®°å½•æ‰©å®¹æ¬¡æ•°ï¼Œåœ¨è¿­ä»£å™¨ä¸­è‹¥å­˜åœ¨å¹¶å‘ä¿®æ”¹ï¼Œåˆ™å¿«é€Ÿå¤±æ•ˆæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>æˆ‘ä»¬ä»æœ¬è´¨å»å­¦ä¹ æŠ€æœ¯ï¼š<strong>é›†åˆçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>é›†åˆçš„ä½œç”¨æ˜¯å°†æ•°æ®ä»¥ç‰¹å®šç»“æ„<strong>å­˜å‚¨</strong>åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”æ–¹ä¾¿å¼€å‘è€…è¿›è¡Œ<strong>æ“ä½œ</strong>ã€‚</p>
<ul>
<li>
<p><strong>å­˜å‚¨</strong>ï¼šå¼€è¾Ÿå†…å­˜ç©ºé—´ï¼Œå†™å…¥æ•°æ®ï¼›åœ¨Javaè¯­è¨€ä¸­æ— éœ€å¼€å‘è€…æ‰‹åŠ¨ç”³è¯·å†…å­˜ç©ºé—´ï¼Œåªéœ€è¦å…³æ³¨æ•°æ®å†™å…¥å³å¯ï¼›</p>
</li>
<li>
<p><strong>æ“ä½œ</strong>ï¼šæ— éå°±æ˜¯<strong>å¢åˆ æŸ¥æ”¹</strong>ï¼Œåªä¸è¿‡ç°åœ¨æ“ä½œçš„æ˜¯å†…å­˜ä¸­çš„æ•°æ®ç½¢äº†ã€‚</p>
</li>
</ul>
<h2 id="2-å…ƒç´ æ’å…¥å¢">ğŸš€2. å…ƒç´ æ’å…¥ï¼ˆå¢ï¼‰</h2>
<p>æ–¹æ³•åˆ†ç±»</p>
<p><code>ArrayList</code> çš„ <code>add</code> æ–¹æ³•æœ‰ä¸¤ä¸ªé‡è½½ç‰ˆæœ¬ï¼Œå¯¹åº”ä¸åŒçš„ç”¨æ³•ï¼š</p>
<ul>
<li>
<p><code>add(E e)</code> â€”â€” <strong>åœ¨æ•°ç»„æœ«å°¾æ’å…¥</strong>ï¼›</p>
</li>
<li>
<p><code>add(int index, E element)</code> â€”â€” <strong>åœ¨æŒ‡å®šç´¢å¼•ä¸‹æ ‡æ’å…¥</strong>ã€‚</p>
</li>
</ul>
<h3 id="21-åœ¨æ•°ç»„æœ«å°¾æ’å…¥">2.1. åœ¨æ•°ç»„æœ«å°¾æ’å…¥</h3>
<p>ä½¿ç”¨æ–¹æ³• <code>add(E e)</code>ï¼Œä»¥ä¸‹æ˜¯jdk8çš„æºç </p>
<pre><code class="language-java">public boolean add(E e) {
    ensureCapacityInternal(size + 1);
    elementData[size++] = e;
    return true;
}
</code></pre>
<p>æ’å…¥æ•°æ®çš„è¿‡ç¨‹</p>
<ol>
<li>
<p>è°ƒç”¨ <code>ensureCapacityInternal</code> ç¡®ä¿æ•°ç»„è¶³å¤Ÿå¤§ï¼›</p>
</li>
<li>
<p>å°†å…ƒç´ å†™å…¥ <code>elementData[size]</code>ï¼›</p>
</li>
<li>
<p><code>size++</code> å¹¶è¿”å›ã€‚</p>
</li>
</ol>
<p>å¯è§†åŒ–æ„Ÿå—ä¸‹ï¼šæ— å‚æ„é€ åˆ›å»ºArrayListé›†åˆï¼Œç„¶åæ’å…¥äº”ä¸ªå…ƒç´ ï¼Œé¦–æ¬¡addéœ€è¦æ‰©å®¹æ•°ç»„ä¸º10ï¼ˆè¯¦ç»†çš„æ‰©å®¹æµç¨‹çœ‹åé¢ç« èŠ‚ï¼‰ï¼Œæ•ˆæœå¦‚å›¾</p>
<p><img src="https://img2024.cnblogs.com/blog/1209017/202506/1209017-20250608124826160-1842514666.gif" alt="image" loading="lazy"></p>
<h3 id="22-æŒ‡å®šç´¢å¼•ä¸‹æ ‡æ’å…¥">2.2. æŒ‡å®šç´¢å¼•ä¸‹æ ‡æ’å…¥</h3>
<p>ä½¿ç”¨æ–¹æ³•ï¼š <code>add(int index, E element)</code></p>
<pre><code class="language-java">public void add(int index, E element) {
    rangeCheckForAdd(index);

    ensureCapacityInternal(size + 1);  // Increments modCount!!
    System.arraycopy(elementData, index, elementData, index + 1,
                     size - index);
    elementData[index] = element;
    size++;
}
</code></pre>
<p>æ’å…¥æ•°æ®çš„è¿‡ç¨‹</p>
<ol>
<li>
<p>æ£€æŸ¥æ˜¯å¦è¶Šç•Œï¼›</p>
</li>
<li>
<p>è°ƒç”¨ <code>ensureCapacityInternal</code> ç¡®ä¿æ•°ç»„è¶³å¤Ÿå¤§ï¼›</p>
</li>
<li>
<p>å°†åæ ‡<code>index</code>åçš„å…ƒç´ éƒ½å¾€åç§»åŠ¨ä¸€ä½ï¼›</p>
</li>
<li>
<p>å°†å…ƒç´ å†™å…¥ <code>elementData[size]</code>ï¼›</p>
</li>
<li>
<p><code>size++</code> ã€‚</p>
</li>
</ol>
<p>æ¼”ç¤ºåœ¨ç´¢å¼•ä¸‹æ ‡æ’å…¥å…ƒç´ ï¼Œæ•ˆæœå¦‚å›¾ï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1209017/202506/1209017-20250608124841367-1862326572.gif" alt="image" loading="lazy"></p>
<h3 id="23-ensurecapacityinternal-ä¸-grow-æ‰©å®¹æµç¨‹">2.3. ensureCapacityInternal ä¸ grow æ‰©å®¹æµç¨‹</h3>
<p>ä¸ºäº†å¥½æŸ¥é˜…æºç ï¼Œç®€å•è°ƒæ•´äº†ä¸‹ï¼Œjdkæºç åŸºæœ¬å¦‚ä¸‹</p>
<pre><code class="language-java">private void ensureCapacityInternal(int minCapacity) {
    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
        // å»¶è¿Ÿåˆå§‹åŒ–ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨ ensureCapacity æ—¶ï¼Œå°†å®¹é‡è‡³å°‘è®¾ç½®ä¸º DEFAULT_CAPACITYï¼ˆ10ï¼‰
        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);
    }
    ensureExplicitCapacity(minCapacity);
}

private void ensureExplicitCapacity(int minCapacity) {
    modCount++; // ç”¨äºè¿­ä»£æ—¶å¿«é€Ÿå¤±è´¥
    if (minCapacity - elementData.length &gt; 0)
        grow(minCapacity);
}

private void grow(int minCapacity) {
    // æ—§å®¹é‡
    int oldCapacity = elementData.length;
    // æ–°å®¹é‡ = æ—§å®¹é‡ + æ—§å®¹é‡&gt;&gt;1 ï¼ˆ1.5 å€æ‰©å®¹ï¼‰
    int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);
    if (newCapacity - minCapacity &lt; 0)
        newCapacity = minCapacity;
    // æœ€å¤§å®¹é‡æ£€æŸ¥ï¼ˆé˜²æ­¢æº¢å‡ºï¼‰
    if (newCapacity - MAX_ARRAY_SIZE &gt; 0)
        newCapacity = hugeCapacity(minCapacity);
    elementData = Arrays.copyOf(elementData, newCapacity);
}
</code></pre>
<ul>
<li>
<p><strong>å»¶è¿Ÿåˆå§‹åŒ–</strong>ï¼šæ— å‚æ„é€ å <code>elementData</code> å¼•ç”¨ä¸€ä¸ªé•¿åº¦ä¸º 0 çš„å…±äº«å¸¸é‡æ•°ç»„ã€‚</p>
</li>
<li>
<p><strong>modCount</strong>ï¼šæ¯æ¬¡ç»“æ„ä¿®æ”¹ï¼ˆå¦‚æ‰©å®¹ã€å¢åˆ ï¼‰éƒ½ä¼šè‡ªå¢ï¼Œé…åˆè¿­ä»£å™¨æ£€æŸ¥å¹¶å‘ä¿®æ”¹ã€‚</p>
</li>
<li>
<p><strong>æ‰©å®¹ç­–ç•¥</strong>ï¼š<code>oldCapacity + (oldCapacity &gt;&gt; 1)</code>ï¼Œå³ç§»ä¸€ä½ç­‰äºé™¤äº2ï¼Œæ‰€ä»¥<code>newCapacity</code>ä¸ºåŸæ¥çš„1.5 å€ï¼Œä»¥æƒè¡¡ç©ºé—´å’Œæ‹·è´æˆæœ¬ã€‚</p>
</li>
</ul>
<p><code>ArrayList</code>å¦‚æœä¸æŒ‡å®šå¤§å°åˆå§‹å¤§å°ä¸º0ï¼Œé¦–æ¬¡<code>add</code>æ‰è¿›è¡Œé¦–æ¬¡æ‰©å®¹ï¼Œæ‰©å®¹å¤§å°ä¸º10ï¼Œè¿™ä¸ªé»˜è®¤çš„åˆå§‹å®¹é‡<code>DEFAULT_CAPACITY</code>åœ¨é¦–å±‚æ’å…¥æ•°æ®æ‰ä¼šä½¿ç”¨åˆ°ã€‚æ•…æ­¤ï¼Œåœ¨åˆ›å»º<code>ArrayList</code>æ—¶æœ€å¥½æŒ‡å®šå¤§å°ï¼Œæœ€ä½³æƒ…å†µæ˜¯åˆ›å»ºæ—¶å°±çŸ¥é“é›†åˆçš„å¤§å°ã€‚</p>
<p>è¯¦ç»†å¯è§æ„é€ æ–¹æ³•æºç </p>
<pre><code class="language-java">public ArrayList(int initialCapacity) {
    if (initialCapacity &gt; 0) {
        // æŒ‡å®šåˆå§‹å®¹é‡å¤§äº0æ—¶
        this.elementData = new Object[initialCapacity];
    } else if (initialCapacity == 0) {
        this.elementData = EMPTY_ELEMENTDATA;
    } else {
        throw new IllegalArgumentException("Illegal Capacity: "+
                                           initialCapacity);
    }
}

// æ— å‚æ„é€ æ–¹æ³•
public ArrayList() {
    this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
}
</code></pre>
<p>æ‰©å®¹å¯è§†åŒ–è¿‡ç¨‹ï¼šæ’å…¥ç¬¬11ä¸ªå…ƒç´ çš„æ‰©å®¹è¿‡ç¨‹</p>
<p><img src="https://img2024.cnblogs.com/blog/1209017/202506/1209017-20250608124859776-183520420.gif" alt="image" loading="lazy"></p>
<h3 id="24-æ‰©å®¹æ—¶æ‰å¯¹modcount-è‡ªå¢åˆç†å—">2.4. æ‰©å®¹æ—¶æ‰å¯¹modCount è‡ªå¢åˆç†å—ï¼Ÿ</h3>
<p>ä¸åˆç†ã€‚å› ä¸ºä½ æ’å…¥æ–°çš„æ•°æ®æ²¡æœ‰æ‰©å®¹çš„æƒ…å†µä¸‹ï¼Œé›†åˆç”³è¯·çš„å†…å­˜ç©ºé—´ä¸å˜ï¼Œä½†æ˜¯é›†åˆä¿å­˜å…ƒç´ çš„å¤§å°å‘ç”Ÿäº†å˜åŒ–ï¼Œè¿™å’Œç§»é™¤å…ƒç´ ä¸€æ ·ï¼Œé›†åˆä¹Ÿæ˜¯å‘ç”Ÿäº†å˜åŒ–çš„ï¼Œæ‰€ä»¥åœ¨åç»­çš„jdkç‰ˆæœ¬ä¸­ï¼Œ<code>add</code>æ“ä½œåŠ å…¥äº†<code>modCount++;</code>ã€‚</p>
<p>ä»¥ä¸‹æ˜¯jdk11çš„<code>add</code>æºç ï¼šé¦–è¡Œå°±å¯¹<code>modCount</code>åšäº†è‡ªå¢</p>
<pre><code class="language-java">public boolean add(E e) {
    modCount++;
    add(e, elementData, size);
    return true;
}
</code></pre>
<h3 id="25-å…è®¸nullå’Œå¯é‡å¤æ’å…¥">2.5. å…è®¸nullå’Œå¯é‡å¤æ’å…¥ï¼Ÿ</h3>
<p><code>ArrayList</code>é›†åˆå†…ä¿å­˜çš„æ˜¯<strong>å¯¹è±¡çš„å¼•ç”¨</strong>ï¼Œåœ¨Javaè¯­è¨€ä¸­ï¼Œå¼•ç”¨æ˜¯å¯ä»¥æŒ‡å‘nullçš„ï¼Œæ•…<code>ArrayList</code>é›†åˆå¯ä»¥ä¿å­˜nullã€‚åœ¨å…ƒç´ æ’å…¥æ—¶å¹¶æ²¡æœ‰å¯¹å…ƒç´ è¿›è¡Œé‡å¤æ£€æŸ¥ï¼Œæ•…å¯ä»¥ä¿å­˜é‡å¤æ•°æ®ï¼ŒåŒ…æ‹¬é‡å¤çš„nullã€‚</p>
<p><code>List</code> æ¥å£åœ¨ javadoc é‡Œå°±æ˜ç¡®è¯´äº†ï¼š</p>
<blockquote>
<p>å…è®¸æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…æ‹¬ <code>null</code>ï¼‰ï¼Œå…è®¸é‡å¤æ’å…¥ï¼›<br>
å¦‚æœä½ éœ€è¦â€œå…ƒç´ å”¯ä¸€â€æˆ–â€œç¦æ­¢ç©ºå€¼â€ï¼ŒJava æä¾›äº†å…¶ä»–é›†åˆç±»å‹ï¼ˆå¦‚å®ç°äº† <code>Set</code> æ¥å£çš„ <code>HashSet</code>/<code>LinkedHashSet</code>/<code>TreeSet</code>ï¼Œæˆ–è€…åœ¨ Java 9+ å¯ä»¥ç”¨ <code>List.of(...)</code> æ„é€ çš„ä¸å¯ç©ºã€ä¸å¯å˜çš„åˆ—è¡¨ï¼‰</p>
</blockquote>
<p><strong>å®ç°ç®€å•é«˜æ•ˆ</strong><br>
<code>ArrayList</code> åº•å±‚ç”¨ä¸€å—è¿ç»­çš„ <code>Object[]</code> æ•°ç»„å­˜å‚¨å…ƒç´ ï¼š</p>
<ul>
<li>
<p>æ’å…¥ <code>null</code> åªä¸è¿‡æ˜¯å¾€æ•°ç»„é‡Œèµ‹ä¸€ä¸ª <code>null</code>ï¼Œè·Ÿå­˜ä»»ä½•å…¶ä»–å¯¹è±¡æ²¡åŒºåˆ«ï¼›</p>
</li>
<li>
<p>é‡å¤æ’å…¥åªæ˜¯æŠŠåŒä¸€ä¸ªå¼•ç”¨èµ‹ç»™ä¸åŒç´¢å¼•ï¼Œä¹Ÿæ²¡æœ‰é¢å¤–å¼€é”€ï¼›<br>
å¦‚æœå¼ºè¡Œåœ¨ <code>add()</code> é‡Œåšâ€œéç©ºæ£€æŸ¥â€æˆ–â€œå»é‡â€ï¼Œä¸ä»…ä¼šå¢åŠ æ¯æ¬¡æ’å…¥çš„å¼€é”€ï¼Œè¿˜ä¼šç ´åå®ƒä½œä¸ºé€šç”¨ã€è½»é‡åˆ—è¡¨çš„è®¾è®¡åˆè¡·ã€‚</p>
</li>
</ul>
<h2 id="3-ä¿®æ”¹å…ƒç´ æ”¹">ğŸ“Œ3. ä¿®æ”¹å…ƒç´ ï¼ˆæ”¹ï¼‰</h2>
<p>æ ¹æ®æŒ‡å®šç´¢å¼•è¿›è¡Œè¦†ç›–<code>E set(int index, E element)</code></p>
<pre><code class="language-java">public E set(int index, E element) {
    rangeCheck(index);

    E oldValue = elementData(index);
    elementData[index] = element;
    return oldValue;
}
</code></pre>
<p>è¿™ä¸ªå¾ˆç®€å•ï¼Œæ£€æŸ¥æ˜¯å¦è¶Šç•Œï¼Œæš‚å­˜æ—§å€¼ï¼Œè¦†ç›–æ•°ç»„å¯¹åº”ä¸‹æ ‡çš„å€¼ï¼Œè¿”å›æ—§å€¼ã€‚</p>
<p>ä¿®æ”¹ç´¢å¼•å…ƒç´ å¯è§†åŒ–è¿‡ç¨‹ï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1209017/202506/1209017-20250608124757138-817042345.gif" alt="image" loading="lazy"></p>
<h2 id="4-ç§»é™¤å…ƒç´ åˆ ">ğŸ“4. ç§»é™¤å…ƒç´ ï¼ˆåˆ ï¼‰</h2>
<p>æ–¹æ³•åˆ†ç±»</p>
<p><code>ArrayList</code> çš„ <code>remove</code> æ–¹æ³•æœ‰ä¸¤ä¸ªé‡è½½ç‰ˆæœ¬ï¼Œå¯¹åº”ä¸åŒçš„ç”¨æ³•ï¼š</p>
<ol>
<li>
<p><code>remove(int index)</code> â€”â€” <strong>æŒ‰ç´¢å¼•åˆ é™¤</strong>ï¼›</p>
</li>
<li>
<p><code>remove(Object o)</code> â€”â€” <strong>æŒ‰å¯¹è±¡å€¼åˆ é™¤</strong>ã€‚</p>
</li>
</ol>
<h3 id="41-æŒ‡å®šç´¢å¼•åˆ é™¤">4.1. æŒ‡å®šç´¢å¼•åˆ é™¤</h3>
<p>ä½¿ç”¨åˆ°çš„æ–¹æ³•ï¼š<code>remove(int index)</code></p>
<pre><code class="language-java">public E remove(int index) {
    rangeCheck(index); // æ£€æŸ¥ç´¢å¼•æ˜¯å¦åˆæ³•
    modCount++;        // ä¿®æ”¹æ¬¡æ•°+1ï¼Œæ”¯æŒ fail-fast
    E oldValue = elementData(index); // è·å–æ—§å€¼
    int numMoved = size - index - 1;
    if (numMoved &gt; 0)
        System.arraycopy(elementData, index + 1, elementData, index, numMoved);
    elementData[--size] = null; // clear to let GC do its work
    return oldValue;
}
</code></pre>
<p><strong>åˆ†æ</strong>ï¼š</p>
<ul>
<li>
<p>ä½¿ç”¨ <code>System.arraycopy()</code> å°†åé¢æ‰€æœ‰å…ƒç´ å‘å‰ç§»åŠ¨ä¸€ä½ï¼›</p>
</li>
<li>
<p>æœ€åæƒ…å†µæ˜¯åˆ é™¤ç´¢å¼• 0ï¼Œç§»åŠ¨ n-1 ä¸ªå…ƒç´ ï¼›</p>
</li>
<li>
<p>ä¿®æ”¹ sizeï¼Œæ¸…é™¤æœ€åä¸€ä¸ªå…ƒç´ å¼•ç”¨ã€‚</p>
</li>
</ul>
<p>åˆ é™¤ç´¢å¼•å…ƒç´ çš„å¯è§†åŒ–è¿‡ç¨‹ï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1209017/202506/1209017-20250608124915189-1908897366.gif" alt="image" loading="lazy"></p>
<h3 id="42-æŒ‰ç…§å¯¹è±¡å€¼åˆ é™¤">4.2. æŒ‰ç…§å¯¹è±¡å€¼åˆ é™¤</h3>
<p>ä½¿ç”¨åˆ°çš„æ–¹æ³•ï¼š<code>remove(Object o)</code></p>
<pre><code class="language-java">public boolean remove(Object o) {
    if (o == null) {
        for (int index = 0; index &lt; size; index++)
            if (elementData[index] == null) {
                fastRemove(index);
                return true;
            }
    } else {
        for (int index = 0; index &lt; size; index++)
            if (o.equals(elementData[index])) {
                fastRemove(index);
                return true;
            }
    }
    return false;
}
</code></pre>
<p>é…å¥—çš„ <code>fastRemove(int index)</code> å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">private void fastRemove(int index) {
    modCount++;
    int numMoved = size - index - 1;
    if (numMoved &gt; 0)
        System.arraycopy(elementData, index + 1, elementData, index, numMoved);
    elementData[--size] = null;
}
</code></pre>
<p><strong>åˆ†æ</strong>ï¼š</p>
<ul>
<li>
<p>å…ˆçº¿æ€§æŸ¥æ‰¾ç›®æ ‡å…ƒç´ ï¼Œæœ€å¤šæ¯”è¾ƒ <code>n</code> æ¬¡ï¼›</p>
</li>
<li>
<p>ç„¶åç§»é™¤å…ƒç´ ï¼Œæœ€å¤šç§»åŠ¨ <code>n-1</code> ä¸ªï¼›</p>
</li>
<li>
<p>æ‰€ä»¥æ€»æ“ä½œæ˜¯ä¸€æ¬¡â€œ<strong>çº¿æ€§æŸ¥æ‰¾ + çº¿æ€§ç§»åŠ¨</strong>â€ã€‚</p>
</li>
</ul>
<p>é¿å…åœ¨å¤§åˆ—è¡¨ä¸­é¢‘ç¹åˆ é™¤ä¸­é—´å…ƒç´ ï¼ˆå°¤å…¶åœ¨å¾ªç¯ä¸­åˆ é™¤ï¼‰ï¼Œå¦åˆ™å®¹æ˜“é€€åŒ–ä¸º O(nÂ²)ã€‚</p>
<p>å¯¹æ¯”æŒ‰ç…§ç´¢å¼•åˆ é™¤ï¼Œå¤šäº†ä¸€æ­¥<strong>å…ƒç´ æŸ¥æ‰¾å¯¹æ¯”</strong>ï¼Œå…¶å®ƒåŸºæœ¬ä¸€è‡´ã€‚</p>
<p>æŒ‰ç…§å¯¹è±¡å€¼åˆ é™¤å…ƒç´ çš„å¯è§†åŒ–è¿‡ç¨‹ï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1209017/202506/1209017-20250608124933157-80637064.gif" alt="image" loading="lazy"></p>
<h2 id="5-è·å–å’Œæ£€ç´¢å…ƒç´ æŸ¥">ğŸ¯5. è·å–å’Œæ£€ç´¢å…ƒç´ ï¼ˆæŸ¥ï¼‰</h2>
<h3 id="51-è·å–å…ƒç´ ">5.1. è·å–å…ƒç´ </h3>
<p>æ ¹æ®ç´¢å¼•è·å–å…ƒç´ ï¼š<code>get(int index)</code></p>
<pre><code class="language-java">public E get(int index) {
    rangeCheck(index);
    return elementData(index);
}
</code></pre>
<p>æ£€æŸ¥æ˜¯å¦è¶Šç•Œï¼Œç„¶åæ ¹æ®ä¸‹æ ‡ç´¢å¼•è·å–å…ƒç´ ã€‚</p>
<h3 id="52-æ£€ç´¢å…ƒç´ ">5.2. æ£€ç´¢å…ƒç´ </h3>
<p>åœ¨ <code>ArrayList</code> ä¸­ï¼Œ<strong>æ£€ç´¢æŸä¸ªå…ƒç´ </strong>ï¼ˆä¸æ˜¯é€šè¿‡ç´¢å¼•ï¼Œè€Œæ˜¯æŸ¥æ‰¾æŸä¸ªå€¼æ˜¯å¦å­˜åœ¨ï¼Œæˆ–å…¶ä½ç½®ï¼‰ä¸»è¦é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•å®Œæˆï¼š</p>
<h4 id="1-åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ ">1) åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ </h4>
<p>æ ¹æ®å¯¹è±¡å€¼åˆ¤æ–­é›†åˆä¸­æ˜¯å¦å­˜åœ¨ï¼š<code>contains(Object o)</code></p>
<pre><code class="language-java">public boolean contains(Object o) {
    return indexOf(o) &gt;= 0;
}
</code></pre>
<p>è¿™ä¸ªæ–¹æ³•å†…éƒ¨è°ƒç”¨äº† <code>indexOf</code> æ–¹æ³•ã€‚å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºåˆ—è¡¨ä¸­ã€‚</p>
<h4 id="2-è¿”å›å…ƒç´ é¦–æ¬¡å‡ºç°çš„ç´¢å¼•">2) è¿”å›å…ƒç´ é¦–æ¬¡å‡ºç°çš„ç´¢å¼•</h4>
<p>æ ¹æ®å¯¹è±¡å€¼æ£€ç´¢é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼š<code>indexOf(Object o)</code></p>
<p>è·ŸæŒ‰ç…§å¯¹è±¡å€¼åˆ é™¤çš„æ£€ç´¢è¿‡ç¨‹ä¸€è‡´ï¼Œå¯æŸ¥çœ‹ä¸Šé¢çš„å¯è§†åŒ–è¿‡ç¨‹åŠ¨å›¾ã€‚</p>
<pre><code class="language-java">public int indexOf(Object o) {
    if (o == null) {
        for (int i = 0; i &lt; size; i++)
            if (elementData[i] == null)
                return i;
    } else {
        for (int i = 0; i &lt; size; i++)
            if (o.equals(elementData[i]))
                return i;
    }
    return -1;
}
</code></pre>
<p>å¦‚æœæŸ¥æ‰¾çš„æ˜¯ <code>null</code>ï¼Œå°±ç”¨ <code>==</code> æ¯”è¾ƒï¼›å¦‚æœæ˜¯é <code>null</code> å¯¹è±¡ï¼Œåˆ™ç”¨ <code>equals()</code> æ–¹æ³•é€ä¸ªæ¯”è¾ƒã€‚ä»å¤´éå†ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ç´¢å¼•ã€‚</p>
<h4 id="3-è¿”å›å…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•">3) è¿”å›å…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•</h4>
<p>æ ¹æ®å¯¹è±¡å€¼æ£€ç´¢æœ€åå‡ºç°çš„ä½ç½®ï¼š<code>lastIndexOf(Object o)</code></p>
<pre><code class="language-java">public int lastIndexOf(Object o) {
    if (o == null) {
        for (int i = size - 1; i &gt;= 0; i--)
            if (elementData[i] == null)
                return i;
    } else {
        for (int i = size - 1; i &gt;= 0; i--)
            if (o.equals(elementData[i]))
                return i;
    }
    return -1;
}
</code></pre>
<p>ä¸ <code>indexOf</code> ç±»ä¼¼ï¼Œä½†ä»<strong>å°¾éƒ¨å¼€å§‹</strong>å‘å‰æŸ¥æ‰¾ã€‚</p>
<h2 id="6-arraylist-çš„è¿­ä»£å™¨iterator">6. ArrayList çš„è¿­ä»£å™¨ï¼ˆIteratorï¼‰</h2>
<h3 id="61-ä»€ä¹ˆæ˜¯è¿­ä»£å™¨">6.1. ä»€ä¹ˆæ˜¯è¿­ä»£å™¨ï¼Ÿ</h3>
<p>è¿­ä»£å™¨ï¼ˆ<code>Iterator</code>ï¼‰æ˜¯ Java é›†åˆæ¡†æ¶ä¸­ç”¨äºéå†é›†åˆå…ƒç´ çš„å·¥å…·ã€‚<br>
<code>ArrayList</code> æä¾›äº†ä¸¤ç§ä¸»è¦çš„è¿­ä»£æ–¹å¼ï¼š</p>
<ul>
<li>
<p><code>Iterator&lt;E&gt;</code>ï¼šåŸºç¡€çš„è¿­ä»£å™¨æ¥å£ï¼ˆåªæ”¯æŒå•å‘éå†ï¼‰</p>
</li>
<li>
<p><code>ListIterator&lt;E&gt;</code>ï¼šæ˜¯ <code>Iterator</code> çš„å­æ¥å£ï¼Œ<strong>æ”¯æŒåŒå‘éå†ã€ä¿®æ”¹å…ƒç´ ã€è·å–ç´¢å¼•ç­‰é«˜çº§åŠŸèƒ½</strong></p>
</li>
</ul>
<h3 id="62-iteratorè¿­ä»£å™¨">6.2. iteratorè¿­ä»£å™¨</h3>
<p>æºç ï¼ˆä½äº <code>ArrayList.java</code>ï¼‰ï¼š</p>
<pre><code class="language-java">public Iterator&lt;E&gt; iterator() {
    return new Itr();
}
</code></pre>
<p>è¿™ä¼šè¿”å›ä¸€ä¸ªå†…éƒ¨ç±» <code>Itr</code> çš„å®ä¾‹ã€‚</p>
<h4 id="1-itr-å†…éƒ¨ç±»çš„æ ¸å¿ƒæºç ç®€åŒ–ç‰ˆ">1) Itr å†…éƒ¨ç±»çš„æ ¸å¿ƒæºç ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</h4>
<pre><code class="language-java">private class Itr implements Iterator&lt;E&gt; {
    int cursor = 0;       // ä¸‹ä¸€ä¸ªè¦è¿”å›çš„å…ƒç´ ç´¢å¼•
    int lastRet = -1;     // ä¸Šä¸€ä¸ªè¿”å›çš„å…ƒç´ ç´¢å¼•ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸º -1
    int expectedModCount = modCount;  // ç”¨äºæ£€æµ‹å¹¶å‘ä¿®æ”¹

    public boolean hasNext() {
        return cursor != size;
    }

    public E next() {
        checkForComodification();
        int i = cursor;
        if (i &gt;= size)
            throw new NoSuchElementException();
        cursor = i + 1;
        return (E) elementData[lastRet = i];
    }

    public void remove() {
        if (lastRet &lt; 0)
            throw new IllegalStateException();
        checkForComodification();

        ArrayList.this.remove(lastRet);
        cursor = lastRet;
        lastRet = -1;
        expectedModCount = modCount;
    }

    final void checkForComodification() {
        if (modCount != expectedModCount)
            throw new ConcurrentModificationException();
    }
}
</code></pre>
<h4 id="2-modcount-ä¸å¹¶å‘ä¿®æ”¹æ£€æŸ¥fail-fast">2) <code>modCount</code> ä¸å¹¶å‘ä¿®æ”¹æ£€æŸ¥ï¼ˆfail-fastï¼‰</h4>
<ul>
<li>
<p><code>modCount</code> æ˜¯ <code>ArrayList</code> ä¸­ç”¨äºè®°å½•ç»“æ„æ€§ä¿®æ”¹ï¼ˆå¦‚æ·»åŠ ã€åˆ é™¤å…ƒç´ ï¼‰æ¬¡æ•°çš„å­—æ®µã€‚</p>
</li>
<li>
<p>è¿­ä»£å™¨åˆ›å»ºæ—¶ä¿å­˜äº†å½“å‰çš„ <code>modCount</code> åˆ° <code>expectedModCount</code>ã€‚</p>
</li>
<li>
<p>å¦‚æœåœ¨è¿­ä»£æœŸé—´é›†åˆå‘ç”Ÿç»“æ„æ€§ä¿®æ”¹ï¼Œ<code>modCount != expectedModCount</code>ï¼Œå°±ä¼šæŠ›å‡º <code>ConcurrentModificationException</code>ã€‚</p>
</li>
</ul>
<p>è¿™å°±æ˜¯æ‰€è°“çš„ <strong>fail-fastæœºåˆ¶</strong>ã€‚</p>
<h4 id="3-ç¤ºä¾‹ä»£ç ">3) ç¤ºä¾‹ä»£ç </h4>
<pre><code class="language-java">List&lt;String&gt; list = new ArrayList&lt;&gt;();
list.add("A");
list.add("B");
list.add("C");

Iterator&lt;String&gt; it = list.iterator();
while (it.hasNext()) {
    String s = it.next();
    System.out.println(s);
}
</code></pre>
<h3 id="63-listiteratoræ›´å¼ºå¤§çš„åŒå‘è¿­ä»£å™¨">6.3. ListIteratoræ›´å¼ºå¤§çš„åŒå‘è¿­ä»£å™¨</h3>
<h4 id="1-å¢å¼ºç‰ˆè¿­ä»£å™¨ç®€è¿°">1) å¢å¼ºç‰ˆè¿­ä»£å™¨ç®€è¿°</h4>
<p>é€šè¿‡ <code>list.listIterator()</code> æˆ–è€…<code>listIterator(int index)</code>æ¥è·å–ï¼Œæœ¬è´¨éƒ½æ˜¯è¿”å›<code>new ListItr(index)</code>å¯¹è±¡ã€‚<code>ListItr</code>æ˜¯<code>Itr</code>çš„å­ç±»ï¼‰<code>private class ListItr extends Itr implements ListIterator&lt;E&gt;</code>ï¼Œæ˜¯å¢å¼ºç‰ˆè¿­ä»£å™¨ã€‚</p>
<pre><code class="language-java">ListIterator&lt;String&gt; it = list.listIterator();
while (it.hasNext()) {
    System.out.println(it.next());
}
while (it.hasPrevious()) {
    System.out.println(it.previous());
}
</code></pre>
<p>é¢å¤–æ”¯æŒï¼š</p>
<ul>
<li>
<p><code>hasPrevious()</code>, <code>previous()</code></p>
</li>
<li>
<p><code>add(E e)</code>, <code>remove()</code>, <code>set(E e)</code></p>
</li>
<li>
<p><code>nextIndex()</code>, <code>previousIndex()</code></p>
</li>
</ul>
<h4 id="2-ç¤ºä¾‹ä»£ç ">2) ç¤ºä¾‹ä»£ç </h4>
<p>ååºéå†æ¡ˆä¾‹</p>
<pre><code class="language-java">import java.util.ArrayList;
import java.util.List;
import java.util.ListIterator;

public class ListIteratorReverseDemo {
    public static void main(String[] args) {
        List&lt;String&gt; list = new ArrayList&lt;&gt;();
        list.add("Dog");
        list.add("Cat");
        list.add("Bird");
        list.add("Fish");

        System.out.println("åŸå§‹åˆ—è¡¨: " + list);

        ListIterator&lt;String&gt; iterator = list.listIterator(list.size()); // ä»æœ«å°¾å¼€å§‹

        while (iterator.hasPrevious()) {
            String animal = iterator.previous();

            // æ›¿æ¢å…ƒç´ 
            if (animal.equals("Cat")) {
                iterator.set("Tiger"); // å°† Cat æ›¿æ¢ä¸º Tiger
            }

            // åˆ é™¤å…ƒç´ 
            if (animal.equals("Bird")) {
                iterator.remove(); // åˆ é™¤ Bird
            }

            // åœ¨ Fish å‰æ’å…¥ä¸€ä¸ªå…ƒç´ 
            if (animal.equals("Fish")) {
                iterator.add("Whale"); // æ’å…¥ Whaleï¼ˆåœ¨ Fish ä¹‹å‰ï¼‰
            }
        }

        System.out.println("ä¿®æ”¹åçš„åˆ—è¡¨: " + list);
    }
}
</code></pre>
<h3 id="64-æ—¶é—´å¤æ‚åº¦">6.4. æ—¶é—´å¤æ‚åº¦</h3>
<ul>
<li>
<p>æ¯ä¸ªè¿­ä»£å™¨çš„ <code>next()</code>ã€<code>hasNext()</code> æ“ä½œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ <strong>O(1)</strong>ã€‚</p>
</li>
<li>
<p>ä½†æ˜¯è‹¥åœ¨ <code>remove()</code> ä¸­è§¦å‘ <code>ArrayList</code> çš„ <code>remove(index)</code>ï¼Œé‚£æ˜¯ <strong>O(n)</strong>ï¼Œå› ä¸ºåé¢çš„å…ƒç´ è¦ç§»åŠ¨ã€‚</p>
</li>
</ul>
<h3 id="65-æ³¨æ„äº‹é¡¹">6.5. æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>
<p>åœ¨ä½¿ç”¨ <code>for-each</code> æˆ– <code>iterator</code> éå†æ—¶ï¼Œ<strong>ä¸è¦ç›´æ¥ä¿®æ”¹åŸå§‹é›†åˆ</strong>ï¼ˆå¦‚è°ƒç”¨ <code>add()</code>ã€<code>remove()</code>ï¼‰ï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>ConcurrentModificationException</code>ã€‚</p>
</li>
<li>
<p>å¦‚æœéœ€è¦åœ¨éå†ä¸­å®‰å…¨åœ°ä¿®æ”¹é›†åˆï¼Œå¯ä»¥ä½¿ç”¨ <strong><code>ListIterator</code> çš„ <code>remove()</code> æˆ– <code>add()</code> æ–¹æ³•</strong>ï¼Œå®ƒæ˜¯æ”¯æŒä¿®æ”¹çš„ã€‚</p>
</li>
</ul>
<h2 id="7-çº¿ç¨‹å®‰å…¨é—®é¢˜">7. çº¿ç¨‹å®‰å…¨é—®é¢˜</h2>
<p><code>ArrayList</code>æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­</p>
<pre><code class="language-java">List&lt;Integer&gt; list = new ArrayList&lt;&gt;();

Runnable task = () -&gt; {
    for (int i = 0; i &lt; 1000; i++) {
        list.add(i);  // éçº¿ç¨‹å®‰å…¨
    }
};

Thread t1 = new Thread(task);
Thread t2 = new Thread(task);

t1.start();
t2.start();
t1.join();
t2.join();

System.out.println("æœ€ç»ˆå¤§å°: " + list.size()); // ä¸ä¸€å®šæ˜¯ 2000
</code></pre>
<p>ä¸è¿‡åªæœ‰ <code>ArrayList</code> ä½œä¸º<strong>å…±äº«å˜é‡</strong>æ—¶ï¼Œæ‰éœ€è¦<strong>è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ï¼Œå½“ <code>ArrayList</code> é›†åˆä½œä¸ºæ–¹æ³•å†…çš„å±€éƒ¨å˜é‡æ—¶ï¼Œæ— éœ€è€ƒè™‘çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ã€‚</p>
<h3 id="è§£å†³å®‰å…¨é—®é¢˜çš„ä¸€äº›æ–¹æ³•">è§£å†³å®‰å…¨é—®é¢˜çš„ä¸€äº›æ–¹æ³•</h3>
<p>ç±»æ³¨é‡Šä¸­æ¨èæˆ‘ä»¬ä½¿ç”¨ <code>Collections#synchronizedList</code> æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼ŒSynchronizedList æ˜¯é€šè¿‡åœ¨æ¯ä¸ªæ–¹æ³•ä¸Šé¢åŠ ä¸Šé”æ¥å®ç°ï¼Œè™½ç„¶å®ç°äº†çº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯æ€§èƒ½å¤§å¤§é™ä½ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼</p>
<pre><code class="language-java">List&lt;Integer&gt; syncList = Collections.synchronizedList(new ArrayList&lt;&gt;());
// éå†æ—¶æ‰‹åŠ¨åŠ é”
synchronized(syncList) {
    for (Integer i : syncList) {
        // å®‰å…¨éå†
    }
}
</code></pre>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªé›†åˆï¼š<code>CopyOnWriteArrayList</code>ï¼ˆæ¨èç”¨äºè¯»å¤šå†™å°‘ï¼‰</p>
<pre><code class="language-java">List&lt;String&gt; cowList = new CopyOnWriteArrayList&lt;&gt;();
</code></pre>
<p>ç‰¹æ€§ï¼š</p>
<ul>
<li>
<p>æ‰€æœ‰å†™æ“ä½œï¼ˆadd/remove/setï¼‰éƒ½ä¼šå¤åˆ¶ä¸€ä»½æ•°ç»„å†ä¿®æ”¹ï¼›</p>
</li>
<li>
<p>ä¸ä¼šæŠ›å‡º <code>ConcurrentModificationException</code>ï¼›</p>
</li>
<li>
<p>éå¸¸é€‚åˆ<strong>è¯»å¤šå†™å°‘</strong>çš„åœºæ™¯ã€‚</p>
</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å†™æ“ä½œå¼€é”€å¤§ï¼Œæ€§èƒ½æ¯” <code>ArrayList</code> å·®å¾ˆå¤šã€‚</li>
</ul>
<h2 id="8-æ—¶é—´å¤æ‚åº¦æ±‡æ€»">8. æ—¶é—´å¤æ‚åº¦æ±‡æ€»</h2>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>æ—¶é—´å¤æ‚åº¦</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ’å…¥å…ƒç´ </td>
<td>O(1)ï¼Œæ‰©å®¹<strong>å•æ¬¡</strong>ä¸º O(n)</td>
<td><code>add(E)</code></td>
</tr>
<tr>
<td>éšæœºæ’å…¥</td>
<td>O(n)ï¼Œå…ƒç´ æ‹·è´</td>
<td><code>add(index,E)</code></td>
</tr>
<tr>
<td>æŒ‡å®šç´¢å¼•åˆ é™¤</td>
<td>O(n)ï¼ŒæŒ‡å®šç´¢å¼•åˆ é™¤</td>
<td><code>remove(index)</code></td>
</tr>
<tr>
<td>æŒ‡å®šå¯¹è±¡å€¼åˆ é™¤</td>
<td>O(n)ï¼ŒæŸ¥æ‰¾ + ç§»åŠ¨</td>
<td><code>remove(Object)</code></td>
</tr>
<tr>
<td>æŒ‡å®šç´¢å¼•ä¿®æ”¹</td>
<td>O(1)</td>
<td><code>set(index,E)</code></td>
</tr>
<tr>
<td>è·å–å…ƒç´ </td>
<td>O(1)</td>
<td><code>get(index)</code></td>
</tr>
<tr>
<td>æ£€ç´¢å…ƒç´ </td>
<td>éƒ½ä¸º<code>O(n)</code></td>
<td><code>indexOf(Object)</code>/&nbsp;<code>lastIndexOf(Object)</code></td>
</tr>
</tbody>
</table>
<h2 id="9-æ€»ç»“">9. æ€»ç»“</h2>
<p>åœ¨ä½¿ç”¨ArrayListé›†åˆæ—¶ï¼Œéœ€è¦å…³æ³¨ä»¥ä¸‹ç‰¹æ€§ï¼šéšæœºè·å–/ä¿®æ”¹å¿«ã€æ’å…¥/åˆ é™¤æ…¢ã€æ‰©å®¹æ€§èƒ½é—®é¢˜ã€å¹¶å‘çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p>
<p>å…³äºå…ƒç´ æ’å…¥ã€æ£€ç´¢ã€ä¿®æ”¹ã€åˆ é™¤ã€æ‰©å®¹è¿‡ç¨‹ç­‰æ“ä½œè¿‡ç¨‹ï¼Œå®Œæ•´çš„è§†é¢‘é“¾æ¥ï¼š<a href="https://www.bilibili.com/video/BV1KET2zGEm4/" target="_blank" rel="noopener nofollow">https://www.bilibili.com/video/BV1KET2zGEm4/</a></p>
<p><img src="https://img2024.cnblogs.com/blog/1209017/202506/1209017-20250608124619317-1056953506.gif" alt="image" loading="lazy"></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&amp;mid=2247486720&amp;idx=1&amp;sn=739bdfc99dc52128f9d9eb31a70a4c03&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">æŒæ¡è®¾è®¡æ¨¡å¼çš„ä¸¤ä¸ªç§˜ç±</a></p>
<p>æŸ¥çœ‹å¾€æœŸè®¾è®¡æ¨¡å¼æ–‡ç« çš„ï¼š<a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5NDM5NDM1NA==&amp;action=getalbum&amp;album_id=3572346739375538182#wechat_redirect" target="_blank" rel="noopener nofollow">è®¾è®¡æ¨¡å¼</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&amp;mid=2247486066&amp;idx=1&amp;sn=e8c7423105ddd0562f50892010941efc&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">è¶…å®ç”¨çš„SpringAOPå®æˆ˜ä¹‹æ—¥å¿—è®°å½•</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&amp;mid=2247485873&amp;idx=1&amp;sn=08b58de61c716e5c57ff2fddb947f0d8&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">2023å¹´ä¸‹åŠå¹´è½¯è€ƒè€ƒè¯•é‡ç£…æ¶ˆæ¯</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&amp;mid=2247485909&amp;idx=1&amp;sn=e20f3b7b413310ca78f90c13305972ab&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">é€šè¿‡è½¯è€ƒåå´é¢†å–ä¸åˆ°å®ä½“è¯ä¹¦ï¼Ÿ</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&amp;mid=2247485802&amp;idx=1&amp;sn=863cf239124b98d39ec551b6cb67845c&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">è®¡ç®—æœºç®—æ³•è®¾è®¡ä¸åˆ†æï¼ˆç¬¬5ç‰ˆï¼‰</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&amp;mid=2247485015&amp;idx=1&amp;sn=862bc2b379726b89cdb396ec0d325cc0&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">Javaå…¨æ ˆå­¦ä¹ è·¯çº¿ã€å­¦ä¹ èµ„æºå’Œé¢è¯•é¢˜ä¸€æ¡é¾™</a></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&amp;mid=2247485956&amp;idx=1&amp;sn=57407d9f7921254ba19ed70fa3bd6a2d&amp;chksm=ec62ca99db15438f13f2cf96d17a3e282028fa7960af56126caec68fb6eafd46d6e04a10ad0c&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">è½¯è€ƒè¯ä¹¦=èŒç§°è¯ä¹¦ï¼Ÿ</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&amp;mid=2247485837&amp;idx=1&amp;sn=b9b17dfd252882468b8eea31012df6fc&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">è½¯è€ƒä¸­çº§--è½¯ä»¶è®¾è®¡å¸ˆæ¯«æ— ä¿ç•™çš„å¤‡è€ƒåˆ†äº«</a></p>
<p>è§‰å¾—è¿˜ä¸é”™çš„ï¼Œä¸‰è¿æ”¯æŒï¼šç‚¹èµã€åˆ†äº«ã€æ¨èâ†“</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.18717846527199075" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-06-09 07:59">2025-06-09 07:59</span>&nbsp;
<a href="https://www.cnblogs.com/dennyLee2025">æ¸Šæ¸Ÿå²³</a>&nbsp;
é˜…è¯»(<span id="post_view_count">12</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18919268);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18919268', targetLink: 'https://www.cnblogs.com/dennyLee2025/p/18919268', title: 'Javaé›†åˆæºç --ArrayListçš„å¯è§†åŒ–æ“ä½œè¿‡ç¨‹' })">ä¸¾æŠ¥</a>
</div>
        