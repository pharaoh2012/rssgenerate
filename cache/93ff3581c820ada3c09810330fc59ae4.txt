
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/TwilightLemon/p/18714544" title="发布于 2025-02-13 22:48">
    <span role="heading" aria-level="2">C++ 使用MIDI库演奏《晴天》</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<div style="text-align: center">那些在MIDI库里徘徊的十六分音符</div>
<div style="text-align: center">终究没能拼成告白的主歌</div>
<div style="text-align: center">&nbsp;</div>
<div style="text-align: center">我把周杰伦的《晴天》写成C++的类<br>在每个midiEvent里埋藏故事的小黄花</div>
<div style="text-align: center">&nbsp;</div>
<div style="text-align: center">调试器的断点比初恋更漫长<br>而青春不过是一串未导出的cmake工程文件</div>
<div style="text-align: center">&nbsp;</div>
<div style="text-align: center">在堆栈溢出的夜晚<br>终将明白<br>有些旋律永远停在#pragma once的注释里<br>有些人永远停在未定义的引用里</div>
<div style="text-align: center">&nbsp;</div>
<div style="text-align: center">或许你我的心跳终归运行在不同的时钟频率<br>却愿始终记得如何编译出一场永不落幕的晴天</div>
<div style="text-align: center">　　　　　　　　　　　　　　　　　　--题记</div>
<div style="text-align: left">&nbsp;</div>
<div style="text-align: left"><hr></div>
<div style="text-align: left">就像在题记里说的一样，这是一个从未导出成功的工程文件。<br>所以如果你也想听听，可以在PowerShell里运行以下指令：</div>
<div style="text-align: left">
<div class="cnblogs_code">
<pre>git clone https://github.com/TwilightLemon/<span style="color: rgba(0, 0, 0, 1)">SunnyDays
cd SunnyDays
mkdir build
cd build
cmake .. </span>-G <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">MinGW Makefiles</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
mingw32</span>-<span style="color: rgba(0, 0, 0, 1)">make
.</span>/SunnyDays.exe</pre>
</div>
<p><span style="text-decoration: line-through">没环境？巧了，她也如是说。</span></p>
<p>幸运的话能得到以下效果：</p>
<p><img src="https://img2024.cnblogs.com/blog/1188749/202502/1188749-20250213224018232-1965791702.png" alt="" width="543" height="599"></p>
<p>下面来简单讲讲如何使用C++和MIDI库作曲吧。</p>
<h2 id="一开始工作">一、开始工作<a class="anchor" href="https://blog.twlmgatito.cn/posts/cpp-midi-sunnydays/#%E4%B8%80%E5%BC%80%E5%A7%8B%E5%B7%A5%E4%BD%9C" rel="noopener nofollow"><span class="anchor-icon" data-pagefind-ignore=""><br></span></a></h2>
<h3 id="引入midi库和相关控制类">1. 引入MIDI库和相关控制类</h3>
<p>在<code>CMakeLists.txt</code>中：</p>
<div class="cnblogs_code">
<pre>target_link_libraries(SunnyDays winmm)</pre>
</div>
<p>在<code>MIDIHelper.h</code>中：</p>
<div class="cnblogs_code">
<pre>#include &lt;windows.h&gt;
<span style="color: rgba(0, 0, 255, 1)">#pragma</span> comment(lib,"winmm.lib")</pre>
</div>
<p>定义Scale(音阶), Instrument(乐器, 仅包括部分)等枚举。我把Drum单独提了出来。</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">enum</span><span style="color: rgba(0, 0, 0, 1)"> Scale
{
    X1 </span>= <span style="color: rgba(128, 0, 128, 1)">36</span>, X2 = <span style="color: rgba(128, 0, 128, 1)">38</span>, X3 = <span style="color: rgba(128, 0, 128, 1)">40</span>, X4 = <span style="color: rgba(128, 0, 128, 1)">41</span>, X5 = <span style="color: rgba(128, 0, 128, 1)">43</span>, X6 = <span style="color: rgba(128, 0, 128, 1)">45</span>, X7 = <span style="color: rgba(128, 0, 128, 1)">47</span><span style="color: rgba(0, 0, 0, 1)">,
    L1 </span>= <span style="color: rgba(128, 0, 128, 1)">48</span>, L2 = <span style="color: rgba(128, 0, 128, 1)">50</span>, L3 = <span style="color: rgba(128, 0, 128, 1)">52</span>, L4 = <span style="color: rgba(128, 0, 128, 1)">53</span>, L5 = <span style="color: rgba(128, 0, 128, 1)">55</span>, L6 = <span style="color: rgba(128, 0, 128, 1)">57</span>, L7 = <span style="color: rgba(128, 0, 128, 1)">59</span><span style="color: rgba(0, 0, 0, 1)">,
    M1 </span>= <span style="color: rgba(128, 0, 128, 1)">60</span>, M2 = <span style="color: rgba(128, 0, 128, 1)">62</span>, M3 = <span style="color: rgba(128, 0, 128, 1)">64</span>, M4 = <span style="color: rgba(128, 0, 128, 1)">65</span>, M5 = <span style="color: rgba(128, 0, 128, 1)">67</span>, M6 = <span style="color: rgba(128, 0, 128, 1)">69</span>, M7 = <span style="color: rgba(128, 0, 128, 1)">71</span><span style="color: rgba(0, 0, 0, 1)">,
    H1 </span>= <span style="color: rgba(128, 0, 128, 1)">72</span>, H2 = <span style="color: rgba(128, 0, 128, 1)">74</span>, H3 = <span style="color: rgba(128, 0, 128, 1)">76</span>, H4 = <span style="color: rgba(128, 0, 128, 1)">77</span>, H5 = <span style="color: rgba(128, 0, 128, 1)">79</span>, H6 = <span style="color: rgba(128, 0, 128, 1)">81</span>, H7 = <span style="color: rgba(128, 0, 128, 1)">83</span><span style="color: rgba(0, 0, 0, 1)">,
    LOW_SPEED </span>= <span style="color: rgba(128, 0, 128, 1)">500</span>, MIDDLE_SPEED = <span style="color: rgba(128, 0, 128, 1)">400</span>, HIGH_SPEED = <span style="color: rgba(128, 0, 128, 1)">300</span><span style="color: rgba(0, 0, 0, 1)">,
    _ </span>= <span style="color: rgba(128, 0, 128, 1)">0XFF</span><span style="color: rgba(0, 0, 0, 1)">
};
</span><span style="color: rgba(0, 0, 255, 1)">enum</span><span style="color: rgba(0, 0, 0, 1)"> Drum{
    BassDrum </span>= <span style="color: rgba(128, 0, 128, 1)">36</span>, SnareDrum = <span style="color: rgba(128, 0, 128, 1)">38</span>, ClosedHiHat = <span style="color: rgba(128, 0, 128, 1)">42</span>, OpenHiHat = <span style="color: rgba(128, 0, 128, 1)">46</span><span style="color: rgba(0, 0, 0, 1)">
};
</span><span style="color: rgba(0, 0, 255, 1)">enum</span><span style="color: rgba(0, 0, 0, 1)"> Instrument{
    AcousticGrandPiano </span>= <span style="color: rgba(128, 0, 128, 1)">0</span>, BrightAcousticPiano = <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">,
    ElectricGrandPiano </span>= <span style="color: rgba(128, 0, 128, 1)">2</span>, HonkyTonkPiano = <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">,
    ElectricPiano1 </span>= <span style="color: rgba(128, 0, 128, 1)">4</span>, ElectricPiano2 = <span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">
};</span></pre>
</div>
<p>一些基础方法，包括初始化/关闭设备、设置参数、播放单个音符和播放和弦等。</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> initDevice();
</span><span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> closeDevice();
</span><span style="color: rgba(0, 0, 255, 1)">void</span> setInstrument(<span style="color: rgba(0, 0, 255, 1)">int</span> channel, <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> instrument);
</span><span style="color: rgba(0, 0, 255, 1)">void</span> setVolume(<span style="color: rgba(0, 0, 255, 1)">int</span> channel, <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> volume);

</span><span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> PlayNote(HMIDIOUT handle, UINT channel, UINT note, UINT velocity);

</span><span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> playChord(HMIDIOUT handle, UINT channel, UINT note1, UINT note2, UINT note3, UINT note4, UINT velocity);

</span><span style="color: rgba(0, 0, 255, 1)">void</span> playChord(HMIDIOUT handle, UINT channel, UINT note1, UINT note2, UINT note3, UINT velocity);</pre>
</div>
<p>在<code>MIDIHelper.cpp</code>中：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> initDevice(){
    midiOutOpen(</span>&amp;hMidiOut, <span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">, CALLBACK_NULL);
}

</span><span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> closeDevice(){
    midiOutClose(hMidiOut);
}

</span><span style="color: rgba(0, 0, 255, 1)">void</span> setInstrument(<span style="color: rgba(0, 0, 255, 1)">int</span> channel,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> instrument){
    </span><span style="color: rgba(0, 0, 255, 1)">if</span> (channel &gt; <span style="color: rgba(128, 0, 128, 1)">15</span> || instrument &gt; <span style="color: rgba(128, 0, 128, 1)">127</span>) <span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
    DWORD message </span>= <span style="color: rgba(128, 0, 128, 1)">0xC0</span> | channel | (instrument &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span><span style="color: rgba(0, 0, 0, 1)">);
    midiOutShortMsg(hMidiOut, message);
}

</span><span style="color: rgba(0, 0, 255, 1)">void</span> setVolume(<span style="color: rgba(0, 0, 255, 1)">int</span> channel,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> volume){
    </span><span style="color: rgba(0, 0, 255, 1)">if</span> (channel &gt; <span style="color: rgba(128, 0, 128, 1)">15</span> || volume &gt; <span style="color: rgba(128, 0, 128, 1)">127</span>) <span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
    DWORD message </span>= <span style="color: rgba(128, 0, 128, 1)">0xB0</span> | channel | (<span style="color: rgba(128, 0, 128, 1)">7</span> &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (volume &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    midiOutShortMsg(hMidiOut, message);
}

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">播放单个音符，note是音符，velocity是力度</span>
<span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> PlayNote(HMIDIOUT handle, UINT channel, UINT note, UINT velocity) {
    </span><span style="color: rgba(0, 0, 255, 1)">if</span> (channel &gt; <span style="color: rgba(128, 0, 128, 1)">15</span> || note &gt; <span style="color: rgba(128, 0, 128, 1)">127</span> || velocity &gt; <span style="color: rgba(128, 0, 128, 1)">127</span>) <span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
    DWORD message </span>= <span style="color: rgba(128, 0, 128, 1)">0x90</span> | channel | (note &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (velocity &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    midiOutShortMsg(handle, message);
}

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">四指和弦</span>
<span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> playChord(HMIDIOUT handle, UINT channel, UINT note1, UINT note2, UINT note3, UINT note4, UINT velocity){
    </span><span style="color: rgba(0, 0, 255, 1)">if</span> (channel &gt; <span style="color: rgba(128, 0, 128, 1)">15</span> || note1 &gt; <span style="color: rgba(128, 0, 128, 1)">127</span> || note2 &gt; <span style="color: rgba(128, 0, 128, 1)">127</span> || note3 &gt; <span style="color: rgba(128, 0, 128, 1)">127</span> || note4 &gt; <span style="color: rgba(128, 0, 128, 1)">127</span> || velocity &gt; <span style="color: rgba(128, 0, 128, 1)">127</span>) <span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
    DWORD message1 </span>= <span style="color: rgba(128, 0, 128, 1)">0x90</span> | channel | (note1 &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (velocity &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    DWORD message2 </span>= <span style="color: rgba(128, 0, 128, 1)">0x90</span> | channel | (note2 &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (velocity &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    DWORD message3 </span>= <span style="color: rgba(128, 0, 128, 1)">0x90</span> | channel | (note3 &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (velocity &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    DWORD message4 </span>= <span style="color: rgba(128, 0, 128, 1)">0x90</span> | channel | (note4 &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (velocity &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    midiOutShortMsg(handle, message1);
    midiOutShortMsg(handle, message2);
    midiOutShortMsg(handle, message3);
    midiOutShortMsg(handle, message4);
}

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">三指和弦</span>
<span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> playChord(HMIDIOUT handle, UINT channel, UINT note1, UINT note2, UINT note3, UINT velocity) {
    </span><span style="color: rgba(0, 0, 255, 1)">if</span> (channel &gt; <span style="color: rgba(128, 0, 128, 1)">15</span> || note1 &gt; <span style="color: rgba(128, 0, 128, 1)">127</span> || note2 &gt; <span style="color: rgba(128, 0, 128, 1)">127</span> || note3 &gt; <span style="color: rgba(128, 0, 128, 1)">127</span> || velocity &gt; <span style="color: rgba(128, 0, 128, 1)">127</span>) <span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
    DWORD message1 </span>= <span style="color: rgba(128, 0, 128, 1)">0x90</span> | channel | (note1 &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (velocity &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    DWORD message2 </span>= <span style="color: rgba(128, 0, 128, 1)">0x90</span> | channel | (note2 &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (velocity &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    DWORD message3 </span>= <span style="color: rgba(128, 0, 128, 1)">0x90</span> | channel | (note3 &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">8</span>) | (velocity &lt;&lt; <span style="color: rgba(128, 0, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)">);
    midiOutShortMsg(handle, message1);
    midiOutShortMsg(handle, message2);
    midiOutShortMsg(handle, message3);
}</span></pre>
</div>
<h3 id="初始化和结束">2. 初始化和结束<a class="anchor" href="https://blog.twlmgatito.cn/posts/cpp-midi-sunnydays/#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E7%BB%93%E6%9D%9F" rel="noopener nofollow"><span class="anchor-icon" data-pagefind-ignore=""><br></span></a></h3>
<p>先在头文件中定义一个全局MIDI句柄:</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">extern</span> HMIDIOUT hMidiOut;</pre>
</div>
<p>在入口处初始化MIDI设备并在结束时关闭：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 0, 1)">HMIDIOUT hMidiOut;
</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> main() {
    initDevice();
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">...</span>
<span style="color: rgba(0, 0, 0, 1)">    closeDevice();
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}</span></pre>
</div>
<p>初始化MIDI设备之后，为每一个乐器分配一个通道<code>channel</code>（0~15，通常9分配给打击类乐器,例如鼓组），控制音量<code>volume</code>，然后就可以开始演奏了。</p>
<h2 id="二自制简易乐谱">二、自制简易乐谱<a class="anchor" href="https://blog.twlmgatito.cn/posts/cpp-midi-sunnydays/#%E4%BA%8C%E8%87%AA%E5%88%B6%E7%AE%80%E6%98%93%E4%B9%90%E8%B0%B1" rel="noopener nofollow"><span class="anchor-icon" data-pagefind-ignore=""><br></span></a></h2>
<p>以<code>Voice.cpp</code>为例,定义一个数组为频谱，控制停顿和音符，遍历数组播放：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> <span style="color: rgba(0, 0, 255, 1)">namespace</span><span style="color: rgba(0, 0, 0, 1)"> SunnyDays{
</span><span style="color: rgba(0, 128, 128, 1)"> 2</span>     <span style="color: rgba(0, 0, 255, 1)">int</span> channelVoice=<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)"> 3</span>     <span style="color: rgba(0, 0, 255, 1)">void</span> playVoice(<span style="color: rgba(0, 0, 255, 1)">int</span> note, <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> velocity){
</span><span style="color: rgba(0, 128, 128, 1)"> 4</span> <span style="color: rgba(0, 0, 0, 1)">        PlayNote(hMidiOut, channelVoice, note, velocity);
</span><span style="color: rgba(0, 128, 128, 1)"> 5</span> <span style="color: rgba(0, 0, 0, 1)">    }
</span><span style="color: rgba(0, 128, 128, 1)"> 6</span>     <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> voice(){
</span><span style="color: rgba(0, 128, 128, 1)"> 7</span>         Sleep(<span style="color: rgba(128, 0, 128, 1)">13100</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">等待前奏</span>
<span style="color: rgba(0, 128, 128, 1)"> 8</span>         <span style="color: rgba(0, 0, 255, 1)">int</span> sleep = <span style="color: rgba(128, 0, 128, 1)">390</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)"> 9</span>         <span style="color: rgba(0, 0, 255, 1)">int</span> data[] =
<span style="color: rgba(0, 128, 128, 1)">10</span> <span style="color: rgba(0, 0, 0, 1)">                {
</span><span style="color: rgba(0, 128, 128, 1)">11</span>                     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">故事的小黄花</span>
<span style="color: rgba(0, 128, 128, 1)">12</span>                     -<span style="color: rgba(128, 0, 128, 1)">90</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">13</span>                     <span style="color: rgba(128, 0, 128, 1)">300</span><span style="color: rgba(0, 0, 0, 1)">,M5,M5,M1,M1,_,M2,M3,_,
</span><span style="color: rgba(0, 128, 128, 1)">14</span>                     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">从出生那年就飘着</span>
<span style="color: rgba(0, 128, 128, 1)">15</span>                     -<span style="color: rgba(128, 0, 128, 1)">90</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">16</span>                     M5,M5,M1,M1,<span style="color: rgba(128, 0, 128, 1)">0</span>,M2,M3,<span style="color: rgba(128, 0, 128, 1)">300</span><span style="color: rgba(0, 0, 0, 1)">,M2,M1,_,
</span><span style="color: rgba(0, 128, 128, 1)">17</span>                     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">童年的荡秋千</span>
<span style="color: rgba(0, 128, 128, 1)">18</span>                     -<span style="color: rgba(128, 0, 128, 1)">90</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">19</span>                     <span style="color: rgba(128, 0, 128, 1)">300</span><span style="color: rgba(0, 0, 0, 1)">,M5,M5,M1,M1,_,M2,M3,_,
</span><span style="color: rgba(0, 128, 128, 1)">20</span>                     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">随记忆一直晃到现在</span>
<span style="color: rgba(0, 128, 128, 1)">21</span>                     -<span style="color: rgba(128, 0, 128, 1)">90</span><span style="color: rgba(0, 0, 0, 1)">,  
</span><span style="color: rgba(0, 128, 128, 1)">22</span>                     M3,_,<span style="color: rgba(128, 0, 128, 1)">500</span>,M2,M3,M4,M3,M2,M4,M3,<span style="color: rgba(128, 0, 128, 1)">700</span>,M2,<span style="color: rgba(128, 0, 128, 1)">700</span><span style="color: rgba(0, 0, 0, 1)">,_,
</span><span style="color: rgba(0, 128, 128, 1)">23</span>                     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">...</span>
<span style="color: rgba(0, 128, 128, 1)">24</span> <span style="color: rgba(0, 0, 0, 1)">                }
</span><span style="color: rgba(0, 128, 128, 1)">25</span>         <span style="color: rgba(0, 0, 255, 1)">for</span><span style="color: rgba(0, 0, 0, 1)"> (auto i : data) {
</span><span style="color: rgba(0, 128, 128, 1)">26</span>             <span style="color: rgba(0, 0, 255, 1)">if</span>(i==-<span style="color: rgba(128, 0, 128, 1)">30</span>){logTime(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Enter chorus</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 0, 255, 1)">continue</span>;}<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">调试用</span>
<span style="color: rgba(0, 128, 128, 1)">27</span>             <span style="color: rgba(0, 0, 255, 1)">if</span>(i==-<span style="color: rgba(128, 0, 128, 1)">90</span>){NextLyric(); <span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;}
</span><span style="color: rgba(0, 128, 128, 1)">28</span>             <span style="color: rgba(0, 0, 255, 1)">if</span> (i == <span style="color: rgba(128, 0, 128, 1)">0</span>) { sleep = <span style="color: rgba(128, 0, 128, 1)">180</span>; <span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">; }
</span><span style="color: rgba(0, 128, 128, 1)">29</span>             <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">...</span>
<span style="color: rgba(0, 128, 128, 1)">30</span>             <span style="color: rgba(0, 0, 255, 1)">if</span> (i ==<span style="color: rgba(0, 0, 0, 1)"> _) {
</span><span style="color: rgba(0, 128, 128, 1)">31</span>                 Sleep(<span style="color: rgba(128, 0, 128, 1)">390</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">32</span>                 <span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">33</span> <span style="color: rgba(0, 0, 0, 1)">            }
</span><span style="color: rgba(0, 128, 128, 1)">34</span> 
<span style="color: rgba(0, 128, 128, 1)">35</span>             playVoice(i, <span style="color: rgba(128, 0, 128, 1)">80</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">36</span> <span style="color: rgba(0, 0, 0, 1)">            Sleep(sleep);
</span><span style="color: rgba(0, 128, 128, 1)">37</span> <span style="color: rgba(0, 0, 0, 1)">        }
</span><span style="color: rgba(0, 128, 128, 1)">38</span> <span style="color: rgba(0, 0, 0, 1)">    }
</span><span style="color: rgba(0, 128, 128, 1)">39</span> }</pre>
</div>
<p>打个鼓：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> <span style="color: rgba(0, 0, 255, 1)">namespace</span><span style="color: rgba(0, 0, 0, 1)"> SunnyDays{
</span><span style="color: rgba(0, 128, 128, 1)"> 2</span>     <span style="color: rgba(0, 0, 255, 1)">int</span> channelBassDrum=<span style="color: rgba(128, 0, 128, 1)">9</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)"> 3</span> 
<span style="color: rgba(0, 128, 128, 1)"> 4</span>     <span style="color: rgba(0, 0, 255, 1)">void</span> playDrum(<span style="color: rgba(0, 0, 255, 1)">int</span> note, <span style="color: rgba(0, 0, 255, 1)">int</span> velocity, <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> duration){
</span><span style="color: rgba(0, 128, 128, 1)"> 5</span> <span style="color: rgba(0, 0, 0, 1)">        PlayNote(hMidiOut, channelBassDrum, note, velocity);
</span><span style="color: rgba(0, 128, 128, 1)"> 6</span>         <span style="color: rgba(0, 0, 255, 1)">if</span>(duration&gt;<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">) {
</span><span style="color: rgba(0, 128, 128, 1)"> 7</span> <span style="color: rgba(0, 0, 0, 1)">            Sleep(duration);
</span><span style="color: rgba(0, 128, 128, 1)"> 8</span>             PlayNote(hMidiOut, channelBassDrum, note, <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)"> 9</span> <span style="color: rgba(0, 0, 0, 1)">        }
</span><span style="color: rgba(0, 128, 128, 1)">10</span> <span style="color: rgba(0, 0, 0, 1)">    }
</span><span style="color: rgba(0, 128, 128, 1)">11</span> 
<span style="color: rgba(0, 128, 128, 1)">12</span>     <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> bassDrum(){
</span><span style="color: rgba(0, 128, 128, 1)">13</span>         Sleep(<span style="color: rgba(128, 0, 128, 1)">11260</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">14</span>         cout&lt;&lt;<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Drum Bass Start!</span><span style="color: rgba(128, 0, 0, 1)">"</span>&lt;&lt;<span style="color: rgba(0, 0, 0, 1)">endl;
</span><span style="color: rgba(0, 128, 128, 1)">15</span>         playDrum(SnareDrum,<span style="color: rgba(128, 0, 128, 1)">100</span>,<span style="color: rgba(128, 0, 128, 1)">180</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">16</span>         playDrum(SnareDrum,<span style="color: rgba(128, 0, 128, 1)">100</span>,<span style="color: rgba(128, 0, 128, 1)">210</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">17</span>         playDrum(BassDrum, <span style="color: rgba(128, 0, 128, 1)">100</span>, <span style="color: rgba(128, 0, 128, 1)">210</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">18</span>         playDrum(SnareDrum,<span style="color: rgba(128, 0, 128, 1)">100</span>,<span style="color: rgba(128, 0, 128, 1)">190</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">19</span>         playDrum(BassDrum, <span style="color: rgba(128, 0, 128, 1)">100</span>, <span style="color: rgba(128, 0, 128, 1)">210</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">20</span>         playDrum(SnareDrum,<span style="color: rgba(128, 0, 128, 1)">100</span>,<span style="color: rgba(128, 0, 128, 1)">200</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">21</span>         playDrum(SnareDrum,<span style="color: rgba(128, 0, 128, 1)">100</span>,<span style="color: rgba(128, 0, 128, 1)">200</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">22</span>         playDrum(OpenHiHat,<span style="color: rgba(128, 0, 128, 1)">100</span>,-<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">23</span>         Sleep(<span style="color: rgba(128, 0, 128, 1)">200</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">24</span>         <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">...</span>
<span style="color: rgba(0, 128, 128, 1)">25</span> <span style="color: rgba(0, 0, 0, 1)">    }
</span><span style="color: rgba(0, 128, 128, 1)">26</span> }</pre>
</div>
<p>简易副歌和弦，是从B站一位up主那里学的（已经忘记是哪位了qwq）：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> <span style="color: rgba(0, 0, 255, 1)">namespace</span><span style="color: rgba(0, 0, 0, 1)"> SunnyDays {
</span><span style="color: rgba(0, 128, 128, 1)"> 2</span>     <span style="color: rgba(0, 0, 255, 1)">int</span> channelChord=<span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)"> 3</span>     <span style="color: rgba(0, 0, 255, 1)">void</span> chordLevel(<span style="color: rgba(0, 0, 255, 1)">int</span> level,<span style="color: rgba(0, 0, 255, 1)">int</span> sleep,<span style="color: rgba(0, 0, 255, 1)">int</span> repeat=<span style="color: rgba(128, 0, 128, 1)">2</span>,<span style="color: rgba(0, 0, 255, 1)">int</span> vel=<span style="color: rgba(128, 0, 128, 1)">70</span><span style="color: rgba(0, 0, 0, 1)">){
</span><span style="color: rgba(0, 128, 128, 1)"> 4</span>         repeat--<span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)"> 5</span>         <span style="color: rgba(0, 0, 255, 1)">int</span> down=<span style="color: rgba(128, 0, 128, 1)">8</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)"> 6</span>         <span style="color: rgba(0, 0, 255, 1)">if</span>(level==<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">){
</span><span style="color: rgba(0, 128, 128, 1)"> 7</span>             <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">一级和弦 加右指</span>
<span style="color: rgba(0, 128, 128, 1)"> 8</span> <span style="color: rgba(0, 0, 0, 1)">            playChord(hMidiOut, channelChord, M1, M3, M5, L1, vel);
</span><span style="color: rgba(0, 128, 128, 1)"> 9</span>             <span style="color: rgba(0, 0, 255, 1)">while</span>(repeat--<span style="color: rgba(0, 0, 0, 1)">) {
</span><span style="color: rgba(0, 128, 128, 1)">10</span> <span style="color: rgba(0, 0, 0, 1)">                Sleep(sleep);
</span><span style="color: rgba(0, 128, 128, 1)">11</span>                 playChord(hMidiOut, channelChord, M1, M3, M5, vel -<span style="color: rgba(0, 0, 0, 1)"> down);
</span><span style="color: rgba(0, 128, 128, 1)">12</span> <span style="color: rgba(0, 0, 0, 1)">            }
</span><span style="color: rgba(0, 128, 128, 1)">13</span>         }<span style="color: rgba(0, 0, 255, 1)">else</span> <span style="color: rgba(0, 0, 255, 1)">if</span>(level==<span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">){
</span><span style="color: rgba(0, 128, 128, 1)">14</span>             <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">三级和弦 加右指</span>
<span style="color: rgba(0, 128, 128, 1)">15</span> <span style="color: rgba(0, 0, 0, 1)">            playChord(hMidiOut, channelChord, M3, M5, M7, L3, vel);
</span><span style="color: rgba(0, 128, 128, 1)">16</span>             <span style="color: rgba(0, 0, 255, 1)">while</span>(repeat--<span style="color: rgba(0, 0, 0, 1)">) {
</span><span style="color: rgba(0, 128, 128, 1)">17</span> <span style="color: rgba(0, 0, 0, 1)">                Sleep(sleep);
</span><span style="color: rgba(0, 128, 128, 1)">18</span>                 playChord(hMidiOut, channelChord, M3, M5, M7, vel -<span style="color: rgba(0, 0, 0, 1)"> down);
</span><span style="color: rgba(0, 128, 128, 1)">19</span> <span style="color: rgba(0, 0, 0, 1)">            }
</span><span style="color: rgba(0, 128, 128, 1)">20</span> <span style="color: rgba(0, 0, 0, 1)">        }
</span><span style="color: rgba(0, 128, 128, 1)">21</span>         <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">...</span>
<span style="color: rgba(0, 128, 128, 1)">22</span> <span style="color: rgba(0, 0, 0, 1)">    }
</span><span style="color: rgba(0, 128, 128, 1)">23</span>     <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> chord(){
</span><span style="color: rgba(0, 128, 128, 1)">24</span>         Sleep(<span style="color: rgba(128, 0, 128, 1)">63724</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">25</span>         <span style="color: rgba(0, 0, 255, 1)">int</span> sleep=<span style="color: rgba(128, 0, 128, 1)">740</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">26</span>         <span style="color: rgba(0, 0, 255, 1)">int</span> data[]=<span style="color: rgba(0, 0, 0, 1)">{
</span><span style="color: rgba(0, 128, 128, 1)">27</span>                 <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">刮风这天 我试过握着你手</span>
<span style="color: rgba(0, 128, 128, 1)">28</span>                 <span style="color: rgba(128, 0, 128, 1)">1</span>,<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">29</span>                 <span style="color: rgba(128, 0, 128, 1)">6</span>,<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">30</span>                 <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">但偏偏 雨渐渐</span>
<span style="color: rgba(0, 128, 128, 1)">31</span>                 <span style="color: rgba(128, 0, 128, 1)">4</span>,<span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">32</span>                 <span style="color: rgba(128, 0, 128, 1)">5</span>,<span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">33</span>                 <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">大到我看你不见</span>
<span style="color: rgba(0, 128, 128, 1)">34</span>                 <span style="color: rgba(128, 0, 128, 1)">1</span>,<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">35</span>                 <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">还有多久 我才能</span>
<span style="color: rgba(0, 128, 128, 1)">36</span>                 <span style="color: rgba(128, 0, 128, 1)">3</span>,<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">37</span>                 <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">↑ 在你身边</span>
<span style="color: rgba(0, 128, 128, 1)">38</span>                 <span style="color: rgba(128, 0, 128, 1)">6</span>,<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">39</span>                 <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">↓ 等到放晴的那天</span>
<span style="color: rgba(0, 128, 128, 1)">40</span>                 <span style="color: rgba(128, 0, 128, 1)">4</span>,<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">41</span>                 <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">↑ 也许我会比较好一点</span>
<span style="color: rgba(0, 128, 128, 1)">42</span>                 <span style="color: rgba(128, 0, 128, 1)">5</span>,<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">,
</span><span style="color: rgba(0, 128, 128, 1)">43</span>                 <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">..</span>
<span style="color: rgba(0, 128, 128, 1)">44</span> <span style="color: rgba(0, 0, 0, 1)">        }
</span><span style="color: rgba(0, 128, 128, 1)">45</span>         <span style="color: rgba(0, 0, 255, 1)">int</span> count=<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(data)/<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">46</span>         <span style="color: rgba(0, 0, 255, 1)">for</span>(<span style="color: rgba(0, 0, 255, 1)">int</span> i=<span style="color: rgba(128, 0, 128, 1)">0</span>;i&lt;count;i+=<span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">){
</span><span style="color: rgba(0, 128, 128, 1)">47</span>             cout&lt;&lt;<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">chord </span><span style="color: rgba(128, 0, 0, 1)">"</span>&lt;&lt;data[i]&lt;&lt;<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  x</span><span style="color: rgba(128, 0, 0, 1)">"</span>&lt;&lt;data[i+<span style="color: rgba(128, 0, 128, 1)">1</span>]&lt;&lt;<span style="color: rgba(0, 0, 0, 1)">endl;
</span><span style="color: rgba(0, 128, 128, 1)">48</span>             chordLevel(data[i],sleep,data[i+<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">]);
</span><span style="color: rgba(0, 128, 128, 1)">49</span> <span style="color: rgba(0, 0, 0, 1)">            Sleep(sleep);
</span><span style="color: rgba(0, 128, 128, 1)">50</span> <span style="color: rgba(0, 0, 0, 1)">        }
</span><span style="color: rgba(0, 128, 128, 1)">51</span>         <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">...</span>
<span style="color: rgba(0, 128, 128, 1)">52</span> <span style="color: rgba(0, 0, 0, 1)">    }
</span><span style="color: rgba(0, 128, 128, 1)">53</span> }</pre>
</div>
<h2 id="三合成演奏">三、合成演奏<a class="anchor" href="https://blog.twlmgatito.cn/posts/cpp-midi-sunnydays/#%E4%B8%89%E5%90%88%E6%88%90%E6%BC%94%E5%A5%8F" rel="noopener nofollow"><span class="anchor-icon" data-pagefind-ignore=""><br></span></a></h2>
<p>我用了一个笨蛋方法，用多线程单独控制每一个通道，然后在主线程中调用：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> main(){
</span><span style="color: rgba(0, 128, 128, 1)"> 2</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">...</span>
<span style="color: rgba(0, 128, 128, 1)"> 3</span> <span style="color: rgba(0, 0, 0, 1)">    initDevice();
</span><span style="color: rgba(0, 128, 128, 1)"> 4</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">设置音量</span>
<span style="color: rgba(0, 128, 128, 1)"> 5</span>     setVolume(channelChord,<span style="color: rgba(128, 0, 128, 1)">80</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)"> 6</span>     setVolume(channelMainLine,<span style="color: rgba(128, 0, 128, 1)">80</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)"> 7</span>     setVolume(channelVoice,<span style="color: rgba(128, 0, 128, 1)">120</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)"> 8</span>     setVolume(channelBassDrum,<span style="color: rgba(128, 0, 128, 1)">80</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)"> 9</span> 
<span style="color: rgba(0, 128, 128, 1)">10</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">设置乐器（特定音色）</span>
<span style="color: rgba(0, 128, 128, 1)">11</span> <span style="color: rgba(0, 0, 0, 1)">    setInstrument(channelChord,ElectricPiano1);
</span><span style="color: rgba(0, 128, 128, 1)">12</span> <span style="color: rgba(0, 0, 0, 1)">    setInstrument(channelMainLine,ElectricPiano1);
</span><span style="color: rgba(0, 128, 128, 1)">13</span> 
<span style="color: rgba(0, 128, 128, 1)">14</span> 
<span style="color: rgba(0, 128, 128, 1)">15</span>     system(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">pause</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">按下回车，就开始啦</span>
<span style="color: rgba(0, 128, 128, 1)">16</span> <span style="color: rgba(0, 0, 0, 1)">    beginLogger();
</span><span style="color: rgba(0, 128, 128, 1)">17</span> 
<span style="color: rgba(0, 128, 128, 1)">18</span> 
<span style="color: rgba(0, 128, 128, 1)">19</span> <span style="color: rgba(0, 0, 0, 1)">    thread t0(voice);
</span><span style="color: rgba(0, 128, 128, 1)">20</span> <span style="color: rgba(0, 0, 0, 1)">    thread t1(mainLine);
</span><span style="color: rgba(0, 128, 128, 1)">21</span> <span style="color: rgba(0, 0, 0, 1)">    thread t2(bassDrum);
</span><span style="color: rgba(0, 128, 128, 1)">22</span> <span style="color: rgba(0, 0, 0, 1)">    thread t3(chord);
</span><span style="color: rgba(0, 128, 128, 1)">23</span> <span style="color: rgba(0, 0, 0, 1)">    t0.join();
</span><span style="color: rgba(0, 128, 128, 1)">24</span> <span style="color: rgba(0, 0, 0, 1)">    t1.join();
</span><span style="color: rgba(0, 128, 128, 1)">25</span> <span style="color: rgba(0, 0, 0, 1)">    t2.join();
</span><span style="color: rgba(0, 128, 128, 1)">26</span> <span style="color: rgba(0, 0, 0, 1)">    t3.join();
</span><span style="color: rgba(0, 128, 128, 1)">27</span> 
<span style="color: rgba(0, 128, 128, 1)">28</span> <span style="color: rgba(0, 0, 0, 1)">    closeDevice();
</span><span style="color: rgba(0, 128, 128, 1)">29</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">...</span>
<span style="color: rgba(0, 128, 128, 1)">30</span> }</pre>
</div>
<p>（最后叠个甲，俺不懂音乐制作，更不会什么C++😿）</p>
<p>&nbsp;</p>
<p><img src="https://img2024.cnblogs.com/blog/1188749/202407/1188749-20240702112134529-1920703459.png" alt="" loading="lazy"></p>
<p>&nbsp; 本作品采用&nbsp;<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener nofollow">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>&nbsp;进行许可。欢迎转载、使用、重新发布，但务必保留文章署名TwilightLemon，不得用于商业目的，基于本文修改后的作品务必以相同的许可发布。</p>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0653870360787037" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-02-13 22:48">2025-02-13 22:48</span>&nbsp;
<a href="https://www.cnblogs.com/TwilightLemon">TwilightLemon</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18714544" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18714544);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18714544', targetLink: 'https://www.cnblogs.com/TwilightLemon/p/18714544', title: 'C++ 使用MIDI库演奏《晴天》' })">举报</a>
</div>
        