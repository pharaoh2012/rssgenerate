
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/deali/p/19051717" title="发布于 2025-08-21 22:38">
    <span role="heading" aria-level="2">在Windows上将git与ssh-agent搭配使用，再也不用输入git密码了</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="前言">前言</h2>
<p>之前的文章中已经解决了 Windows 上的 SSH 登录的问题，成功把 Windows 上的 ssh-agent 用起来了，详情可以看这篇文章: <a href="https://blog.deali.cn/Blog/Post/514395100768e83a" target="_blank" rel="noopener nofollow">在 Windows 10 上实现免密码 SSH 登录</a></p>
<p>不过使用 git 还是会反复提示输入私钥密码，烦得很</p>
<p>原因也很简单，打开 git bash 运行一下命令测试就知道了</p>
<pre><code class="language-bash">$ ssh-add -l
Could not open a connection to your authentication agent.
</code></pre>
<p>就是 git 里用的 ssh 是它自带的，不是 Windows 系统的那一个，应该是为了兼容性考虑吧，毕竟之前 Windows 是没有 ssh 的</p>
<p>那么解决思路也很简单，只要配置 git 使用 Windows 的 SSH 就行了</p>
<h2 id="配置">配置</h2>
<p>一行代码搞定</p>
<pre><code class="language-powershell">git config --global core.sshCommand "'C:\Windows\System32\OpenSSH\ssh.exe'"
</code></pre>
<h2 id="有问题">有问题？</h2>
<p>一开始我配置完了运行老是出错</p>
<pre><code>CreateProcessW failed error:2
posix_spawnp: No such file or directory
</code></pre>
<p>后面加了 <code>-v</code> 参数才发现是我的 <code>~/.ssh/config</code> 里的配置</p>
<p>之前配置了 GitHub 走代理</p>
<pre><code>Host github.com
    User git
    Port 443
    HostName ssh.github.com
    TCPKeepAlive yes
    ProxyCommand "$HOME/scoop/apps/git/current/mingw64/bin/connect.exe -S 127.0.0.1:7890 -a none %h %p"
</code></pre>
<p>之前在 git 自带的 ssh 环境下运行没问题，但现在用了 Windows 的 ssh 反而不行了，于是把这个 <code>ProxyCommand</code> 配置注释掉，就 OK 了</p>
<p>如果有遇到类似问题的同学，可以参考一下。</p>
<h2 id="参考资料">参考资料</h2>
<ul>
<li><a href="https://darraghoriordan.medium.com/how-to-use-ssh-with-git-and-ssh-agent-on-windows-7aeb1f64724" target="_blank" rel="noopener nofollow">How to use SSH with Git and ssh-agent on Windows</a></li>
<li><a href="https://serverfault.com/questions/956613/windows-10-ssh-proxycommand-posix-spawn-no-such-file-or-directory" target="_blank" rel="noopener nofollow">windows 10 ssh proxycommand: "posix_spawn: No such file or directory"</a></li>
</ul>

</div>
<div id="MySignature" role="contentinfo">
    微信公众号：「程序设计实验室」
专注于互联网热门新技术探索与团队敏捷开发实践，包括架构设计、机器学习与数据分析算法、移动端开发、Linux、Web前后端开发等，欢迎一起探讨技术，分享学习实践经验。
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-08-21 22:39">2025-08-21 22:38</span>&nbsp;
<a href="https://www.cnblogs.com/deali">程序设计实验室</a>&nbsp;
阅读(<span id="post_view_count">31</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19051717);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19051717', targetLink: 'https://www.cnblogs.com/deali/p/19051717', title: '在Windows上将git与ssh-agent搭配使用，再也不用输入git密码了' })">举报</a>
</div>
        