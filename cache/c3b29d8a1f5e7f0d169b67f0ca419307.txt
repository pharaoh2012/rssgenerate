
		<div class="posthead">
			<h2>
				<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wxp100/p/18706204" title="发布于 2025-02-09 15:54">
    <span role="heading" aria-level="2">Q: 导出的照片时，批量修改创建时间和修改时间。</span>
    

</a>

			</h2>
 			Posted on 
<span id="post-date" data-last-update-days="0.014495562778935185" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-02-09 15:55">2025-02-09 15:54</span>&nbsp;
<a href="https://www.cnblogs.com/wxp100">三年三班王小朋</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18706204" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18706204);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18706204', targetLink: 'https://www.cnblogs.com/wxp100/p/18706204', title: 'Q: 导出的照片时，批量修改创建时间和修改时间。' })">举报</a>

			
			
		</div>
		<div class="postbody"><div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>使用PowerShell脚本批量修改目录下所有照片（包括但不限于.jpg, .jpeg, .png等格式）的创建时间和最后修改时间，你可以采用以下脚本。这个脚本将遍历指定目录及其子目录下的所有支持的照片文件，并将它们的创建时间和最后修改时间设置为你指定的新时间。</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 设置照片所在的目录路径和新的日期时间</span>
<span style="color: rgba(128, 0, 128, 1)">$path</span> = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">X:\家人精选照片\爷爷过九十大寿</span><span style="color: rgba(128, 0, 0, 1)">"</span>
<span style="color: rgba(128, 0, 128, 1)">$newDate</span> = [datetime]<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2010-11-01 12:00:00</span><span style="color: rgba(128, 0, 0, 1)">"</span>

<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 定义要处理的图片扩展名</span>
<span style="color: rgba(128, 0, 128, 1)">$imageExtensions</span> = @(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">.jpg</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">.jpeg</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">.png</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">.gif</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">.bmp</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">.tiff</span><span style="color: rgba(128, 0, 0, 1)">"</span>) <span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 根据需要添加或删除</span><span style="color: rgba(0, 128, 0, 1)">
#</span><span style="color: rgba(0, 128, 0, 1)"> 获取目录中所有的图片文件，包含子目录</span>
<span style="color: rgba(0, 0, 255, 1)">Get-ChildItem</span> -Path <span style="color: rgba(128, 0, 128, 1)">$path</span> -Recurse | <span style="color: rgba(0, 0, 255, 1)">Where-Object</span> { <span style="color: rgba(128, 0, 128, 1)">$imageExtensions</span> <span style="color: rgba(0, 128, 128, 1)">-contains</span> <span style="color: rgba(128, 0, 128, 1)">$_</span>.Extension.ToLower() } | <span style="color: rgba(0, 0, 255, 1)">ForEach</span>-<span style="color: rgba(0, 0, 0, 1)">Object {
    </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 修改创建时间</span>
    <span style="color: rgba(128, 0, 128, 1)">$_</span>.CreationTime = <span style="color: rgba(128, 0, 128, 1)">$newDate</span>
    <span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 修改最后修改时间</span>
    <span style="color: rgba(128, 0, 128, 1)">$_</span>.LastWriteTime = <span style="color: rgba(128, 0, 128, 1)">$newDate</span>
    <span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 如果也需要修改访问时间，可以取消下面这行的注释</span>
    <span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> $_.LastAccessTime = $newDate</span>
<span style="color: rgba(0, 0, 0, 1)">}
</span><span style="color: rgba(0, 0, 255, 1)">Write-Output</span> <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">时间戳更新完成。</span><span style="color: rgba(128, 0, 0, 1)">"</span></pre>
</div>
<p>&nbsp;</p>
</div>
<div class="clear"></div>
</div>
	