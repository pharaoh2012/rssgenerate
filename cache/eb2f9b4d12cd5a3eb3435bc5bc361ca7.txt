
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/SmalBox/p/19061005" title="å‘å¸ƒäº 2025-08-27 14:59">
    <span role="heading" aria-level="2">ã€æ¸²æŸ“æµæ°´çº¿ã€‘[è¾“å‡ºé˜¶æ®µ]-[åŒç¼“å†²æœºåˆ¶]ä»¥UnityURPä¸ºä¾‹</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3685400/202508/3685400-20250827150348799-2104102233.png" alt="ã€æ¸²æŸ“æµæ°´çº¿ã€‘[è¾“å‡ºé˜¶æ®µ]-[åŒç¼“å†²æœºåˆ¶]ä»¥UnityURPä¸ºä¾‹" class="desc_img">
        Unity URPä¸­çš„åŒç¼“å†²æŠ€æœ¯è§£æ åŒç¼“å†²æŠ€æœ¯æ˜¯å›¾å½¢æ¸²æŸ“ä¸­è§£å†³ç”»é¢é—ªçƒå’Œæ’•è£‚çš„å…³é”®æœºåˆ¶ã€‚åœ¨Unity URPä¸­ï¼Œè¯¥æŠ€æœ¯é€šè¿‡SwapBufferSystemç±»å®ç°ï¼ŒåŒ…å«m_Aå’Œm_Bä¸¤ä¸ªç¼“å†²åŒºäº¤æ›¿ä½¿ç”¨ã€‚URPå¯¹åŒç¼“å†²è¿›è¡Œäº†ç³»ç»ŸåŒ–å°è£…ï¼Œç›¸æ¯”æ—©æœŸå†…ç½®ç®¡çº¿æ›´é«˜æ•ˆã€‚å®ç°åŸç†åŒ…æ‹¬ï¼š1)åˆ›å»ºä¸¤ä¸ªæ¸²æŸ“ç›®æ ‡ä½œä¸ºå¸§ç¼“å†²ï¼›2)é€šè¿‡æè¿°ç¬¦æ§åˆ¶å†…å­˜åˆ†é…ï¼›3)ä¸VSyncä¿¡å·åŒæ­¥é˜²æ­¢æ’•è£‚ã€‚ç¤ºä¾‹ä»£ç å±•ç¤ºäº†åœ¨åå¤„ç†æ•ˆæœã€è‡ªå®šä¹‰æ¸²æŸ“ç³»ç»Ÿå’Œå¤šç›¸æœºæ¸²æŸ“ä¸­çš„åº”ç”¨ï¼Œå¦‚ä½¿ç”¨ä¸´æ—¶æ¸²æŸ“ç›®æ ‡å®ç°æ•ˆæœå åŠ ï¼Œä»¥åŠå¤šç›¸æœºå¹³æ»‘åˆ‡æ¢ã€‚åŒç¼“å†²æœºåˆ¶çš„ä¼˜åŒ–ä½¿URPèƒ½å¤Ÿæ
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<ul>
<li>æœ€ç»ˆå°†å¤„ç†ç»“æœå†™å…¥é¢œè‰²/æ·±åº¦/æ¨¡æ¿ç¼“å†²åŒº</li>
<li>å¯ç‹¬ç«‹æ§åˆ¶å„é€šé“å†™å…¥æƒé™â€Œ</li>
</ul>
<blockquote>
<p><a href="https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13021255&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" target="_blank" rel="noopener nofollow">ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<h1 id="åŒç¼“å†²æœºåˆ¶ä»‹ç»"><strong>åŒç¼“å†²æœºåˆ¶ä»‹ç»</strong></h1>
<p>åŒç¼“å†²(Double Buffer)æ˜¯ä¸€ç§å›¾å½¢æ¸²æŸ“ä¸­çš„å¸¸ç”¨æŠ€æœ¯ï¼Œé€šè¿‡ä½¿ç”¨ä¸¤ä¸ªç¼“å†²åŒº(å‰å°ç¼“å†²åŒºå’Œåå°ç¼“å†²åŒº)æ¥è§£å†³å›¾å½¢æ¸²æŸ“è¿‡ç¨‹ä¸­çš„é—ªçƒå’Œæ’•è£‚é—®é¢˜ã€‚åœ¨Unity URPä¸­ï¼ŒåŒç¼“å†²æœºåˆ¶ä¸»è¦ç”¨äºç®¡ç†æ¸²æŸ“ç›®æ ‡ï¼Œç¡®ä¿æ¸²æŸ“è¿‡ç¨‹çš„å¹³æ»‘è¿›è¡Œã€‚</p>
<p>åŒç¼“å†²çš„æ ¸å¿ƒåŸç†æ˜¯ï¼šä¸€ä¸ªç¼“å†²åŒºç”¨äºå½“å‰æ˜¾ç¤ºçš„å¸§(å‰å°ç¼“å†²åŒº)ï¼Œå¦ä¸€ä¸ªç¼“å†²åŒºç”¨äºç»˜åˆ¶æ–°å¸§(åå°ç¼“å†²åŒº)ã€‚å½“åå°ç¼“å†²åŒºå®Œæˆç»˜åˆ¶åï¼Œç³»ç»Ÿä¼šæ‰§è¡Œäº¤æ¢æ“ä½œï¼Œå°†ä¸¤ä¸ªç¼“å†²åŒºç¬æ—¶äº¤æ¢ã€‚ç°ä»£GPUé€šå¸¸ä½¿ç”¨ä¸‰é‡ç¼“å†²ç­‰å¤šç¼“å†²æŠ€æœ¯æ¥è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½ã€‚</p>
<h1 id="å†å²å‘å±•æµç¨‹"><strong>å†å²å‘å±•æµç¨‹</strong></h1>
<p>åŒç¼“å†²æŠ€æœ¯æœ€æ—©åº”ç”¨äºå›¾å½¢æ˜¾ç¤ºé¢†åŸŸï¼Œç”¨äºè§£å†³å±å¹•åˆ·æ–°å’Œå›¾å½¢ç»˜åˆ¶ä¹‹é—´çš„åŒæ­¥é—®é¢˜ã€‚åœ¨Unityå¼•æ“ä¸­ï¼ŒåŒç¼“å†²æœºåˆ¶éšç€æ¸²æŸ“ç®¡çº¿çš„æ¼”è¿›ä¸æ–­ä¼˜åŒ–ï¼š</p>
<ul>
<li>â€Œ<strong>å†…ç½®æ¸²æŸ“ç®¡çº¿æ—¶æœŸ</strong>â€Œï¼šUnityæ—©æœŸç‰ˆæœ¬ä½¿ç”¨å†…ç½®æ¸²æŸ“ç®¡çº¿ï¼ŒåŒç¼“å†²ä¸»è¦é€šè¿‡å‘½ä»¤ç¼“å†²åŒº(CommandBuffer)å®ç°ï¼Œå¼€å‘è€…å¯ä»¥æ‰‹åŠ¨ç®¡ç†æ¸²æŸ“ç›®æ ‡çš„åˆ‡æ¢ã€‚</li>
<li>â€Œ<strong>å¯ç¼–ç¨‹æ¸²æŸ“ç®¡çº¿(SRP)å¼•å…¥</strong>â€Œï¼šUnity 2018ç‰ˆæœ¬å¼•å…¥å¯ç¼–ç¨‹æ¸²æŸ“ç®¡çº¿æ¦‚å¿µï¼Œä¸ºåŒç¼“å†²æä¾›äº†æ›´çµæ´»çš„æ¥å£ã€‚</li>
<li>â€Œ<strong>URPæˆç†ŸæœŸ</strong>â€Œï¼šåœ¨URP(Universal Render Pipeline)ä¸­ï¼ŒåŒç¼“å†²æœºåˆ¶è¢«ç³»ç»ŸåŒ–å°è£…ï¼Œå½¢æˆäº†SwapBufferSystemç­‰é«˜çº§æŠ½è±¡ï¼Œä¼˜åŒ–äº†åå¤„ç†æµç¨‹ã€‚</li>
</ul>
<h1 id="å†…ç½®ç®¡çº¿ä¸urpä¸­çš„åŒç¼“å†²å˜é‡"><strong>å†…ç½®ç®¡çº¿ä¸URPä¸­çš„åŒç¼“å†²å˜é‡</strong></h1>
<h2 id="å†…ç½®ç®¡çº¿ä¸­çš„åŒç¼“å†²å˜é‡"><strong>å†…ç½®ç®¡çº¿ä¸­çš„åŒç¼“å†²å˜é‡</strong></h2>
<p>åœ¨å†…ç½®æ¸²æŸ“ç®¡çº¿ä¸­ï¼ŒåŒç¼“å†²ä¸»è¦é€šè¿‡ä»¥ä¸‹å˜é‡å’Œæœºåˆ¶å®ç°ï¼š</p>
<ul>
<li><code>CommandBuffer</code>ï¼šå­˜å‚¨ä¸€ç³»åˆ—æ¸²æŸ“æŒ‡ä»¤çš„å®¹å™¨ï¼Œå¯ç”¨äºè®¾ç½®æ¸²æŸ“ç›®æ ‡</li>
<li><code>RenderTexture</code>ï¼šä¸´æ—¶æ¸²æŸ“çº¹ç†ï¼Œå¸¸è¢«ç”¨ä½œåå°ç¼“å†²åŒº</li>
<li><code>BuiltinRenderTextureType</code>ï¼šå†…ç½®çº¹ç†ç±»å‹ï¼ŒåŒ…æ‹¬<code>CurrentActive</code>å’Œ<code>CameraTarget</code>ç­‰</li>
</ul>
<h1 id="urpä¸­çš„åŒç¼“å†²å˜é‡"><strong>URPä¸­çš„åŒç¼“å†²å˜é‡</strong></h1>
<p>URPå¯¹åŒç¼“å†²æœºåˆ¶è¿›è¡Œäº†æ›´é«˜çº§çš„å°è£…ï¼Œä¸»è¦æ¶‰åŠä»¥ä¸‹å˜é‡å’Œç±»ï¼š</p>
<ul>
<li><code>SwapBufferSystem</code>ï¼šURPä¸­çš„åŒç¼“å†²ç³»ç»Ÿå®ç°ï¼ŒåŒ…å«<code>m_A</code>å’Œ<code>m_B</code>ä¸¤ä¸ª<code>SwapBuffer</code>ç»“æ„ä½“</li>
<li><code>RenderTargetHandle</code>ï¼šURPä¸­è¡¨ç¤ºæ¸²æŸ“ç›®æ ‡çš„å¥æŸ„</li>
<li><code>ScriptableRenderPass</code>ï¼šæ¸²æŸ“é€šé“åŸºç±»ï¼ŒåŒ…å«è®¾ç½®æ¸²æŸ“ç›®æ ‡çš„æ¥å£</li>
<li><code>UniversalRenderer</code>ï¼šURPé»˜è®¤æ¸²æŸ“å™¨ï¼Œç®¡ç†åŒç¼“å†²çš„åˆå§‹åŒ–å’Œäº¤æ¢</li>
</ul>
<h1 id="åº•å±‚åŸç†è§£æ"><strong>åº•å±‚åŸç†è§£æ</strong></h1>
<h2 id="åº•å±‚å®ç°æ ¸å¿ƒç±»ä¸å˜é‡"><strong>åº•å±‚å®ç°æ ¸å¿ƒç±»ä¸å˜é‡</strong></h2>
<p>åœ¨Unity URPä¸­ï¼ŒåŒç¼“å†²æœºåˆ¶ä¸»è¦é€šè¿‡<code>SwapBufferSystem</code>ç±»å®ç°ï¼Œè¯¥ç±»åŒ…å«ä¸¤ä¸ªå…³é”®å˜é‡<code>m_A</code>å’Œ<code>m_B</code>ï¼Œåˆ†åˆ«ä»£è¡¨å‰åç¼“å†²åŒºã€‚å…·ä½“å®ç°ä½äº<code>UniversalRenderer</code>ç±»ä¸­ï¼Œä½œä¸ºæ¸²æŸ“ç›®æ ‡ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ã€‚</p>
<h3 id="ä¸»è¦å®ç°ç»†èŠ‚">ä¸»è¦å®ç°ç»†èŠ‚</h3>
<ul>
<li><code>SwapBuffer</code>ç»“æ„ä½“ï¼šåŒ…å«<code>name</code>(ç¼“å†²åŒºåç§°)å’Œ<code>rt</code>(RenderTexture)ä¸¤ä¸ªå­—æ®µ</li>
<li><code>SwapBufferSystem</code>ç±»ï¼šç®¡ç†ä¸¤ä¸ª<code>SwapBuffer</code>å®ä¾‹çš„äº¤æ¢é€»è¾‘</li>
<li><code>UniversalRenderer</code>ç±»ï¼šåˆå§‹åŒ–å¹¶æ§åˆ¶åŒç¼“å†²ç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸ</li>
</ul>
<h2 id="ç¼“å†²åŒºåˆ›å»º">â€Œ<strong>ç¼“å†²åŒºåˆ›å»º</strong>â€Œ</h2>
<ul>
<li>åœ¨<code>UniversalRenderer</code>çš„<code>Setup</code>æ–¹æ³•ä¸­åˆ›å»ºä¸¤ä¸ªæ¸²æŸ“ç›®æ ‡ï¼Œè¿™äº›ç›®æ ‡å®é™…ä¸Šæ˜¯çº¹ç†æ”¯æŒçš„å¸§ç¼“å†²ã€‚</li>
</ul>
<h2 id="æè¿°ç¬¦æ§åˆ¶">â€Œ<strong>æè¿°ç¬¦æ§åˆ¶</strong>â€Œ</h2>
<ul>
<li>é€šè¿‡<code>cameraTargetDescriptor</code>å‚æ•°æè¿°æ¸²æŸ“ç›®æ ‡çš„å†…å­˜åˆ†é…æ–¹å¼ï¼Œå¯ä»¥åœ¨<code>AddRenderPasses</code>é˜¶æ®µä¿®æ”¹è¿™äº›å‚æ•°æ¥"åŠ«æŒ"æ¸²æŸ“ç›®æ ‡ã€‚</li>
</ul>
<h2 id="äº¤æ¢æœºåˆ¶">â€Œ<strong>äº¤æ¢æœºåˆ¶</strong>â€Œ</h2>
<ul>
<li>URPä½¿ç”¨<code>SwapBufferSystem</code>ç»´æŠ¤ä¸¤ä¸ªæ¸²æŸ“ç›®æ ‡ç¼“å†²åŒº(<code>m_A</code>å’Œ<code>m_B</code>)ï¼Œåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­äº¤æ›¿ä½¿ç”¨ï¼Œé¿å…ä¸­é—´ç¯èŠ‚çš„é‡å¤æ‹·è´ã€‚</li>
</ul>
<h2 id="åŒæ­¥æ§åˆ¶">â€Œ<strong>åŒæ­¥æ§åˆ¶</strong>â€Œ</h2>
<ul>
<li>åŒç¼“å†²ä¸VSyncä¿¡å·é…åˆå·¥ä½œï¼Œç¡®ä¿ç¼“å†²åŒºäº¤æ¢ä¸å±å¹•åˆ·æ–°åŒæ­¥ï¼Œé˜²æ­¢ç”»é¢æ’•è£‚.</li>
</ul>
<h1 id="åŒç¼“å†²æœºåˆ¶urpç¤ºä¾‹"><strong>åŒç¼“å†²æœºåˆ¶URPç¤ºä¾‹</strong></h1>
<h2 id="åå¤„ç†æ•ˆæœåŒç¼“å†²å®ç°"><strong>åå¤„ç†æ•ˆæœåŒç¼“å†²å®ç°</strong></h2>
<ul>
<li>
<p>PostProcessFeature.cs</p>
<p>åå¤„ç†æ•ˆæœä¸­å¦‚ä½•ä½¿ç”¨ä¸´æ—¶æ¸²æŸ“ç›®æ ‡å®ç°åŒç¼“å†²äº¤æ¢ï¼Œé¿å…ç›´æ¥ä¿®æ”¹åŸå§‹å¸§ç¼“å†²å¯¼è‡´çš„é—®é¢˜</p>
<pre><code class="language-csharp">using UnityEngine;
using UnityEngine.Rendering;
using UnityEngine.Rendering.Universal;

public class CustomPostProcessPass : ScriptableRenderPass
{
    private Material m_Material;
    private RenderTargetHandle m_TemporaryColorTexture;
    private RenderTargetHandle m_CameraColorTexture;
    
    public CustomPostProcessPass(Material material)
    {
        m_Material = material;
        m_TemporaryColorTexture.Init("_TemporaryColorTexture");
    }

    public override void Configure(CommandBuffer cmd, RenderTextureDescriptor cameraTextureDescriptor)
    {
        cmd.GetTemporaryRT(m_TemporaryColorTexture.id, cameraTextureDescriptor);
    }

    public override void Execute(ScriptableRenderContext context, ref RenderingData renderingData)
    {
        CommandBuffer cmd = CommandBufferPool.Get("Custom Post Processing");
        
        // åŒç¼“å†²äº¤æ¢
        Blit(cmd, m_CameraColorTexture.Identifier(), 
            m_TemporaryColorTexture.Identifier(), m_Material);
        Blit(cmd, m_TemporaryColorTexture.Identifier(), 
            m_CameraColorTexture.Identifier());
            
        context.ExecuteCommandBuffer(cmd);
        CommandBufferPool.Release(cmd);
    }

    public override void FrameCleanup(CommandBuffer cmd)
    {
        cmd.ReleaseTemporaryRT(m_TemporaryColorTexture.id);
    }
}
</code></pre>
</li>
</ul>
<h2 id="è‡ªå®šä¹‰æ¸²æŸ“ç›®æ ‡åŒç¼“å†²ç³»ç»Ÿ"><strong>è‡ªå®šä¹‰æ¸²æŸ“ç›®æ ‡åŒç¼“å†²ç³»ç»Ÿ</strong></h2>
<ul>
<li>
<p>CustomBufferSystem.cs</p>
<p>å®ç°äº†ä¸€ä¸ªç®€å•çš„åŒç¼“å†²ç³»ç»Ÿç¤ºä¾‹ï¼Œå¯ç”¨äºéœ€è¦å¤šå¸§æ•°æ®ç´¯ç§¯çš„æ•ˆæœå¦‚è¿åŠ¨æ¨¡ç³Š</p>
<pre><code class="language-csharp">
using UnityEngine;
using UnityEngine.Rendering;
using UnityEngine.Rendering.Universal;

public class CustomBufferSystem
{
    private RenderTargetHandle[] m_Buffers = new RenderTargetHandle[2];
    private int m_CurrentBufferIndex = 0;
    
    public void Initialize(string name)
    {
        m_Buffers[0].Init(name + "_Buffer0");
        m_Buffers[1].Init(name + "_Buffer1");
    }

    public RenderTargetHandle GetCurrentBuffer()
    {
        return m_Buffers[m_CurrentBufferIndex];
    }

    public RenderTargetHandle GetNextBuffer()
    {
        return m_Buffers[(m_CurrentBufferIndex + 1) % 2];
    }

    public void Swap()
    {
        m_CurrentBufferIndex = (m_CurrentBufferIndex + 1) % 2;
    }

    public void Dispose(CommandBuffer cmd)
    {
        cmd.ReleaseTemporaryRT(m_Buffers[0].id);
        cmd.ReleaseTemporaryRT(m_Buffers[1].id);
    }
}
</code></pre>
</li>
</ul>
<h2 id="urpå¤šç›¸æœºæ¸²æŸ“åŒç¼“å†²åŒæ­¥"><strong>URPå¤šç›¸æœºæ¸²æŸ“åŒç¼“å†²åŒæ­¥</strong></h2>
<ul>
<li>
<p>MultiCameraRenderer.cs</p>
<p>å¤šç›¸æœºæ¸²æŸ“åœºæ™¯ä¸­å¦‚ä½•ä½¿ç”¨åŒç¼“å†²æœºåˆ¶å®ç°å¹³æ»‘çš„ç›¸æœºåˆ‡æ¢æ•ˆæœ</p>
<pre><code class="language-csharp">using UnityEngine;
using UnityEngine.Rendering;
using UnityEngine.Rendering.Universal;

public class MultiCameraRenderer : MonoBehaviour
{
    public Camera[] cameras;
    private RenderTexture[] buffers = new RenderTexture[2];
    private int currentBufferIndex = 0;
    
    void Start()
    {
        buffers[0] = new RenderTexture(Screen.width, Screen.height, 24);
        buffers[1] = new RenderTexture(Screen.width, Screen.height, 24);
    }

    void Update()
    {
        var renderer = (UniversalRenderPipelineAsset)GraphicsSettings.currentRenderPipeline;
        
        // æ¸²æŸ“åˆ°åå°ç¼“å†²åŒº
        int nextBufferIndex = (currentBufferIndex + 1) % 2;
        cameras[0].targetTexture = buffers[nextBufferIndex];
        
        // äº¤æ¢ç¼“å†²åŒº
        currentBufferIndex = nextBufferIndex;
        
        // æ˜¾ç¤ºå½“å‰ç¼“å†²åŒº
        Graphics.Blit(buffers[currentBufferIndex], null as RenderTexture);
    }
}
</code></pre>
</li>
</ul>
<hr>
<blockquote>
<p><a href="https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13021255&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" target="_blank" rel="noopener nofollow">ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.003472222222222222" data-date-updated="2025-08-27 15:04">2025-08-27 14:59</span>&nbsp;
<a href="https://www.cnblogs.com/SmalBox">SmalBox</a>&nbsp;
é˜…è¯»(<span id="post_view_count">0</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19061005);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19061005', targetLink: 'https://www.cnblogs.com/SmalBox/p/19061005', title: 'ã€æ¸²æŸ“æµæ°´çº¿ã€‘[è¾“å‡ºé˜¶æ®µ]-[åŒç¼“å†²æœºåˆ¶]ä»¥UnityURPä¸ºä¾‹' })">ä¸¾æŠ¥</a>
</div>
        