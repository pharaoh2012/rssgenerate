
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/miketwais/p/18813661/llms" title="发布于 2025-04-07 21:55">
    <span role="heading" aria-level="2">应用引入LLM实践</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        无论是从实际应用角度，还是从营销角度，我们都需要接入大模型能力。
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>LLM最近在各行各业遍地开花，产生了很好的效果，也落地了很多好的功能应用。</p>
<p>无论是从实际应用角度，还是从营销角度，我们都需要接入大模型能力。</p>
<p>拿国内比较火的Deepseek来说，具有良好的推理能力，可以在我们的产品中帮我们做一些信息溯源的工作，考虑接入这部分功能，deepseek自己部署要耗费不少成本，我们暂时不考虑。国内云商已经大量接入deepseek能力，并且对外提供服务，我们考虑接入云商的deepseek能力。前期做了一些调研：</p>
<p>&nbsp;<img src="https://img2024.cnblogs.com/blog/489086/202504/489086-20250407214642008-1563576060.png" alt="" width="715" height="492" loading="lazy"></p>
<p>关于集成，目前大部分都是使用openai库集成LLM，有一套规范的方法，集成方法实例如下：</p>
<div class="cnblogs_code"><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" id="code_img_closed_7dbea406-98fe-4e6f-b5d5-b92556c3140b" class="code_img_closed"><img src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" id="code_img_opened_7dbea406-98fe-4e6f-b5d5-b92556c3140b" class="code_img_opened" style="display: none">
<div id="cnblogs_code_open_7dbea406-98fe-4e6f-b5d5-b92556c3140b" class="cnblogs_code_hide">
<pre><span style="color: rgba(0, 0, 255, 1)">from</span> openai <span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> OpenAI

</span><span style="color: rgba(0, 0, 255, 1)">if</span> <span style="color: rgba(128, 0, 128, 1)">__name__</span> == <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">__main__</span><span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">:
    </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)">DeepSeek-R1-32K</span>
    base_url = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">https://maas-cn-southwest-2.modelarts-maas.com/v1/infers/8a062fd4-7367-4ab4-a936-5eeb8fb821c4/v1</span><span style="color: rgba(128, 0, 0, 1)">"</span>
    <span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)">DeepSeek-R1-671B-32K</span>
    <span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)">base_url = "https://maas-cn-southwest-2.modelarts-maas.com/v1/infers/952e4f88-ef93-4398-ae8d-af37f63f0d8e/v1"</span>
<span style="color: rgba(0, 0, 0, 1)">    
    api_key </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Y****</span><span style="color: rgba(128, 0, 0, 1)">"</span>  <span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 把&lt;your_apiKey&gt;替换成已获取的API Key。</span>
<span style="color: rgba(0, 0, 0, 1)">
    client </span>= OpenAI(api_key=api_key, base_url=<span style="color: rgba(0, 0, 0, 1)">base_url)

    response </span>=<span style="color: rgba(0, 0, 0, 1)"> client.chat.completions.create(
        model</span>=<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">DeepSeek-R1</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
        messages</span>=<span style="color: rgba(0, 0, 0, 1)">[
            {</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">role</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">system</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">content</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">You are an assistant</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">},
            {</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">role</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">user</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">content</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Your task is to help me complete some simple word processing tasks</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">},

        ],
        max_tokens</span>=1024<span style="color: rgba(0, 0, 0, 1)">,
        temperature</span>=0.6<span style="color: rgba(0, 0, 0, 1)">,
        stream</span>=<span style="color: rgba(0, 0, 0, 1)">False
    )
    </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> Print result.     </span>
<span style="color: rgba(0, 0, 255, 1)">print</span>(response.choices[0].message.content)</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>目前云商都提供免费token 供试用，可以薅一下羊毛，我们多集成几个大模型</p>
<p>我们使用flas框架封装一套框架，结构如下：</p>
<p><img src="https://img2024.cnblogs.com/blog/489086/202504/489086-20250407215328704-1790082375.png" alt="" loading="lazy"></p>
<p>&nbsp;然后打包成docker，这样就可以使用API的方式免费调用Deepseek大模型了！！</p>
<p>可以做一个简单的页面使用。</p>
<p><img src="https://img2024.cnblogs.com/blog/489086/202504/489086-20250407215502512-1683343415.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.014458351232638889" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-04-07 21:56">2025-04-07 21:55</span>&nbsp;
<a href="https://www.cnblogs.com/miketwais">MasonZhang</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18813661" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18813661);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18813661', targetLink: 'https://www.cnblogs.com/miketwais/p/18813661/llms', title: '应用引入LLM实践' })">举报</a>
</div>
        