
        <div class="postTitle">
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/mysticbinary/p/18859195" title="发布于 2025-05-08 08:45">
    <span role="heading" aria-level="2">密钥管理—密钥生命周期对应的技术和流程</span>
    

</a>

        </div>
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p></p><div class="toc"><div class="toc-container-header">目录</div><ul><li><a href="#密钥管理的流程" rel="noopener nofollow">密钥管理的流程</a></li><li><a href="#密钥管理的两个基本需求" rel="noopener nofollow">密钥管理的两个基本需求</a></li><li><a href="#密钥的生存周期" rel="noopener nofollow">密钥的生存周期</a><ul><li><a href="#密钥的生存期" rel="noopener nofollow">密钥的生存期</a></li><li><a href="#密钥生成" rel="noopener nofollow"><strong>密钥生成</strong></a><ul><li><a href="#密钥长度的选择" rel="noopener nofollow">密钥长度的选择</a></li><li><a href="#密钥派生" rel="noopener nofollow">密钥派生</a></li></ul></li><li><a href="#密钥建立" rel="noopener nofollow"><strong>密钥建立</strong></a></li><li><a href="#密钥存储" rel="noopener nofollow"><strong>密钥存储</strong></a><ul><li><a href="#密钥备份密钥存档密钥恢复" rel="noopener nofollow">密钥备份/密钥存档/密钥恢复</a></li></ul></li><li><a href="#密钥使用" rel="noopener nofollow"><strong>密钥使用</strong></a><ul><li><a href="#密钥变更" rel="noopener nofollow">密钥变更</a></li></ul></li><li><a href="#密钥销毁" rel="noopener nofollow"><strong>密钥销毁</strong></a></li></ul></li><li><a href="#密钥管理的实际流程实例" rel="noopener nofollow">密钥管理的实际流程实例</a></li><li><a href="#总结" rel="noopener nofollow">总结</a></li><li><a href="#reference" rel="noopener nofollow">Reference</a></li></ul></div><p></p>
<hr>
<blockquote>
<p>对于任何密码系统的安全性来说，密钥管理都是至关重要的。</p>
</blockquote>
<p>密钥管理是安全的密码算法的前置条件，如果没有安全的过程来处理密钥，那么使用密码技术就没有任何意义。</p>
<p><strong>密钥管理是什么？</strong><br>
密钥管理是密码机制和真实系统安全性之间的接口，<strong>因此必须根据特定应用或组织的需要进行定制。</strong></p>
<p>但注意，不同的体系需要不同的解决方案，<strong>没有一种绝对正确的管理密钥的方法</strong>。</p>
<p>下文关注：</p>
<ul>
<li>对称密钥</li>
<li>公钥对中的私钥（既解密私钥或签名密钥）</li>
</ul>
<hr>
<h1 id="密钥管理的流程">密钥管理的流程</h1>
<p>密钥管理指“ <strong>密码学密钥的安全管理</strong> ”，这是一个宽泛的定义，因为密钥管理涉及范围很广（可能涉及很多信息安全问题，例如物理安全、访问控制、网络安全、安全策略、风险管理和灾难恢复），流程包括：</p>
<ul>
<li>技术控制
<ul>
<li>可能需要特殊的硬件设备来存储密码学密钥；</li>
<li>可能需要特殊的密码协议来建立密钥；</li>
</ul>
</li>
<li>过程控制
<ul>
<li>指策略、实践和流程；</li>
</ul>
</li>
<li>环境控制
<ul>
<li>根据实际环境进行调整；</li>
</ul>
</li>
<li>人为元素
<ul>
<li>密钥管理最终通常涉及人来做事；</li>
</ul>
</li>
</ul>
<hr>
<h1 id="密钥管理的两个基本需求">密钥管理的两个基本需求</h1>
<p>这个两个密钥管理的<strong>基本需求</strong>，适用于密钥生存周期的各个阶段：</p>
<ol>
<li>密钥的<strong>保密性</strong>；
<ul>
<li>在密钥的整个生存周期中，秘密密钥必须对所有各方保密，除非获得授权知道它们；</li>
<li>如使用弱密码生成机制，容易被攻击者确定关于密钥信息；</li>
<li>在传输时容易受到攻击，因此，必须使用安全密钥分发机制；</li>
<li>密钥被存储在设备上时，可能是他们最脆弱的时候；因此存储机制必须足够强大，以抵御能够访问其设备的攻击者；</li>
<li>如果密钥没有被正确销毁，那么它可能被恢复；</li>
</ul>
</li>
<li>密钥<strong>目的</strong>保证；
<ul>
<li>密钥关联的实体信息（在对称密码中，可能有多个实体；在公钥密码，每个密钥通常只与一个实体关联）；</li>
<li>使用密钥的算法；</li>
<li>密钥使用限制；（例如，某个对称密钥只能用于创建和验证MAC，或者某个签名密钥只能用于对某个交易额的事务进行数字签名。）</li>
<li>数据完整性；</li>
<li>将上述信息链接到密钥本身（作绑定），否则就不能依赖于它；</li>
<li>在某些应用中，我们需要一个更强的要求，即对目的的保证可以<strong>向第三方证明</strong> （provable to a third party），这可能是数字签名方案的验证密钥的情况。</li>
</ul>
</li>
</ol>
<hr>
<h1 id="密钥的生存周期">密钥的生存周期</h1>
<p>密钥管理范围的另一种视角是通过考虑密钥生存周期（Key Lifecycle），它标识了在整个生存期中密钥相关的各种进程。如下图：</p>
<p><img src="https://img2024.cnblogs.com/blog/1552062/202505/1552062-20250504210630055-1194679803.png" alt="image" loading="lazy"></p>
<h2 id="密钥的生存期">密钥的生存期</h2>
<p>密钥的<strong>预期生存期(Cryptoperiod)</strong> 指的是密钥只能在指定的时间内使用，在此期间内，密钥是被认为<strong>可用的(Live)</strong>。一旦超过这个生存周期，密钥将被视为<strong>过期(Expire)</strong> ,不应该被使用。此时，它可能需要 <strong>存档（Archieve）</strong> 或 <strong>销毁(Destroy)</strong> 。</p>
<p>给密钥设置有限的生存期的原因：</p>
<ul>
<li>降低密钥泄露的风险；</li>
<li>减少密钥管理的失败；（例如，强制每年更换密钥，将确保那些离职人员还保留了密钥，他们在下一年将无法使用）</li>
<li>降低未来受攻击的风险；</li>
<li>强制实施管理周期；（比如，对提供按年付费对电子资源的访问，那么一年的密钥生存周期就允许可访问密钥的人可以打开付费资源）</li>
<li>灵活性；</li>
<li>限制秘钥暴露；</li>
</ul>
<h2 id="密钥生成"><strong>密钥生成</strong></h2>
<p>密钥的生存周期，从密钥的生成开始。</p>
<ol>
<li>直接用随机数生成的数字；</li>
</ol>
<h3 id="密钥长度的选择">密钥长度的选择</h3>
<p>密钥的长度取决于<strong>效率</strong>和<strong>安全性</strong>这个两个维度的考量。</p>
<h3 id="密钥派生">密钥派生</h3>
<p>派生出密钥的秘密值被称为基密钥（Base Key）.</p>
<p>对称密钥的派生方法：</p>
<ul>
<li>
<p>可以使用<strong>密钥派生函数</strong>（HKDF）派生。</p>
</li>
<li>
<p>也可以基于口令派生密钥。</p>
</li>
<li>
<p>从组元生成密钥。</p>
</li>
</ul>
<h2 id="密钥建立"><strong>密钥建立</strong></h2>
<blockquote>
<p>管理对称密钥最常用的技术就是密钥分级（Key Hierarchy）；</p>
</blockquote>
<p>分级部署密钥有两个明显的优势：</p>
<ol>
<li>安全分发和存储；</li>
<li>方便可扩展的密钥变更；</li>
</ol>
<p>三级密钥结构案例：</p>
<ol>
<li>主密钥（Master Key，MK）<br>
一般使用硬件安全模块（HSM）来存储主密钥；</li>
<li>密钥加密密钥(Key Encrypting Key，KEK)</li>
<li>数据密钥(Data Key，DK)，也称为会话密钥（Session Key）</li>
</ol>
<p>密钥包装：<br>
密钥分级中，一个密钥的传输，必须在另一个密钥的保护下。<br>
涉及密钥派送；</p>
<p>建立密码学密钥的方法：</p>
<ul>
<li>密钥分级</li>
<li>可伸缩的密钥分级结构</li>
<li>单交易唯一密钥</li>
</ul>
<h2 id="密钥存储"><strong>密钥存储</strong></h2>
<p>密钥需要得到保护，那么密钥存储在哪里呢？<br>
最好的方法是不要再任何地方存储密码学密钥，而是在需要的时候动态生成它们。</p>
<p>存储方式：</p>
<ul>
<li>存储在软件中</li>
<li>存储在硬件中
<ol>
<li>硬件安全模块，提供防篡改功能，有人视图提取密钥，就会触发防篡改电路。</li>
<li>HSM, 会有一个或多个密钥始终驻留在HSM中，这个密钥称为 本地主密钥（Local Master Key,LMK）</li>
<li>其它类型的硬件</li>
</ol>
</li>
</ul>
<h3 id="密钥备份密钥存档密钥恢复">密钥备份/密钥存档/密钥恢复</h3>
<p>todo</p>
<h2 id="密钥使用"><strong>密钥使用</strong></h2>
<p>什么是<strong>密钥分离</strong>？</p>
<h3 id="密钥变更">密钥变更</h3>
<p>密钥变更的情况：</p>
<ol>
<li>有计划的密钥变更</li>
<li>无计划的密钥变更</li>
</ol>
<p>变更原理：</p>
<ol>
<li>生成变建立一个新的密钥</li>
<li>撤销旧密钥</li>
</ol>
<p>密钥激活：<br>
密钥激活是指授权使用密钥的过程。</p>
<p>授权是基于密钥的身份信息进行实体身份认证。</p>
<p><img src="https://img2024.cnblogs.com/blog/1552062/202505/1552062-20250508084511337-308044428.jpg" alt="image" loading="lazy"></p>
<h2 id="密钥销毁"><strong>密钥销毁</strong></h2>
<p>当密钥不在用于任何目的是，必须以安全的方式销毁它。</p>
<p>遇到一下情况时，需要销毁密钥：</p>
<ol>
<li>当密钥过期时（密钥的生存期的自然结束）</li>
<li>当密钥被撤销时</li>
<li>在密钥存档的必要期限结束时。</li>
</ol>
<p>采用的技术：<br>
数据擦除，或数据清理机制。</p>
<hr>
<h1 id="密钥管理的实际流程实例">密钥管理的实际流程实例</h1>
<p>todo</p>
<hr>
<h1 id="总结">总结</h1>
<p>密码学原语很少因其设计的弱点而受到损害，反而<strong>常常是由于密钥管理不善而受到损害</strong>。因此，从实践的角度来看，密钥管理是<strong>最重要</strong>的一个环节。</p>
<p>密钥管理这个是密码学中与用户关系最大的方面，因为它是最有可能<strong>需要在单个应用环境中进行决策和流程设计的部分</strong>。</p>
<p>密钥管理由<strong>策略</strong>、<strong>流程控制</strong>组合，最终必须落到<strong>实践</strong>。</p>
<hr>
<h1 id="reference">Reference</h1>
<p>【密码学】密钥管理：③密钥的保护、存储、备份、撤销、过期、销毁<br>
<a href="https://blog.csdn.net/qq_39780701/article/details/141141468" target="_blank" rel="noopener nofollow">https://blog.csdn.net/qq_39780701/article/details/141141468</a></p>
<p>NIST的《密钥管理的NIST建议》</p>

</div>
<div class="clear"></div>

        <div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0.01805914626273148" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-08 08:45">2025-05-08 08:45</span>&nbsp;
<a href="https://www.cnblogs.com/mysticbinary">Mysticbinary</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18859195);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18859195', targetLink: 'https://www.cnblogs.com/mysticbinary/p/18859195', title: '密钥管理—密钥生命周期对应的技术和流程' })">举报</a>
</div>
    