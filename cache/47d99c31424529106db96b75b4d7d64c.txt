
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/code-daily/p/18764803" title="发布于 2025-03-12 10:14">
    <span role="heading" aria-level="2">AI与.NET技术实操系列（六）：基于图像分类模型对图像进行分类</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<section id="nice" data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="margin: 0; padding: 0 10px; background: linear-gradient(90deg, rgba(50, 0, 0, 0.03) 0, rgba(255, 255, 255, 0) 11.49%) left top / 20px 20px repeat scroll padding-box border-box, linear-gradient(360deg, rgba(50, 0, 0, 0.04) 0, rgba(255, 255, 255, 0) 12.16%) repeat rgba(0, 0, 0, 0); width: auto; font-family: Optima, PingFangSC-light, serif; font-size: 16px; color: rgba(0, 0, 0, 1); line-height: 1.5em; word-spacing: 0; letter-spacing: 0; overflow-wrap: break-word; text-align: left"><h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">引言</span><span class="suffix" style="display: none"></span></h2>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">人工智能（AI）技术的迅猛发展推动了各行各业的数字化转型。图像分类，作为计算机视觉领域的核心技术之一，能够让机器自动识别图像中的物体、场景或特征，已广泛应用于医疗诊断、安防监控、自动驾驶和电子商务等领域。</p>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">与此同时，.NET 平台凭借其高效性、跨平台能力和强大的 C# 编程语言支持，成为开发者构建企业级应用的首选技术栈。将 AI 图像分类模型与 .NET 技术结合，不仅能充分发挥两者的优势，还能为开发者提供一种高效、直观的实现方式。</p>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">本文将详细介绍如何在 .NET 环境下使用 C# 部署和调用 AI 图像分类模型。我们将从环境搭建、模型选择，到模型调用，再到实际应用场景，逐步展开讲解，并提供丰富的代码示例和实践指导，帮助开发者快速上手并应用到实际项目中。</p>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">准备工作</span><span class="suffix" style="display: none"></span></h2>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">在开始实现图像分类之前，我们需要准备必要的开发环境和工具。以下是所需的软件和库：</p>
<ul data-tool="mdnice编辑器" style="list-style-type: disc; margin: 8px 0; padding: 0 0 0 25px; color: rgba(0, 0, 0, 1)">
<li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">Visual Studio</strong>：Visual Studio 2022。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">.NET SDK</strong>：安装 .NET 6.0 或更高版本，确保支持最新的功能和性能优化。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">ML.NET</strong>：微软提供的开源机器学习框架，专为 .NET 开发者设计，支持模型训练和推理。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">模型文件</strong>：我们将使用预训练的图像分类模型 tensorflow_inception_graph.pb。</section></li></ul>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">安装步骤</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">创建项目并添加依赖</strong>：在命令行中运行以下命令，创建一个控制台应用程序并安装必要的 NuGet 包：</p>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px">dotnet&nbsp;new&nbsp;console&nbsp;-n&nbsp;ImageClassificationDemo<br><span class="hljs-built_in" style="color: rgba(230, 192, 123, 1); line-height: 26px">cd</span>&nbsp;ImageClassificationDemo<br>dotnet&nbsp;add&nbsp;package&nbsp;Microsoft.ML<br>dotnet&nbsp;add&nbsp;package&nbsp;Microsoft.ML.ImageAnalytics<br>dotnet&nbsp;add&nbsp;package&nbsp;Microsoft.ML.TensorFlow<br>dotnet&nbsp;add&nbsp;package&nbsp;SciSharp.TensorFlow.Redist<br></code></pre>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">完成以上步骤后，你的环境就准备好了。接下来，我们将选择一个合适的图像分类模型。</p>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">图像分类模型的选择</span><span class="suffix" style="display: none"></span></h2>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">图像分类模型是基于监督学习的神经网络，其目标是将输入图像分配到预定义的类别中。在选择模型时，我们需要考虑模型的性能、计算复杂度和适用场景。以下是几种常见的图像分类模型：</p>
<ul data-tool="mdnice编辑器" style="list-style-type: disc; margin: 8px 0; padding: 0 0 0 25px; color: rgba(0, 0, 0, 1)">
<li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">卷积神经网络（CNN）</strong>：如 LeNet、AlexNet 和 VGGNet，适合基本的图像分类任务，但层数较深时可能面临梯度消失问题。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">残差网络（ResNet）</strong>：通过引入残差连接（skip connections），解决了深层网络的训练难题，适用于高精度分类任务。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">EfficientNet</strong>：通过平衡网络深度、宽度和分辨率，提供高效的性能，适合资源受限的场景。</section></li></ul>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">模型训练与导出</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">考虑到时间和资源成本，我们将直接使用预训练的 <strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">tensorflow_inception_graph.pb</strong> 模型。如果你有自定义需求，可以使用以下步骤训练并导出模型：</p>
<ol data-tool="mdnice编辑器" style="list-style-type: decimal; margin: 8px 0; padding: 0 0 0 25px; color: rgba(0, 0, 0, 1)">
<li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">数据准备</strong>：收集并标注图像数据集，分为训练集和验证集。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">训练模型</strong>：使用 TensorFlow 或 PyTorch 等框架训练模型。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">导出模型</strong>：利用框架提供的导出工具导出模型。</section></li></ol>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">在本文中，我们选择 <strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">tensorflow_inception_graph.pb</strong> 作为示例模型，这是一种由Google开发的高性能卷积神经网络（CNN）架构。</p>
<blockquote class="custom-blockquote multiquote-1" data-tool="mdnice编辑器" style="margin: 20px 0; padding: 10px 10px 10px 20px; border: 1px solid rgba(64, 184, 255, 0.4); border-radius: 8px; background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.1); width: auto; height: auto; box-shadow: 0 0 rgba(0, 0, 0, 0); display: block; overflow-x: auto; overflow-y: auto"><span style="display: block; color: rgba(64, 184, 250, 0.5); font-size: 28px; line-height: 1.5em; letter-spacing: 0; text-align: left; font-weight: bold">❝</span>
<p style="text-indent: 0; padding: 8px 0; color: rgba(59, 59, 59, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal; margin: 0">该模块通过并行使用不同大小的卷积核（如1x1、3x3、5x5）和池化层，提取图像的多尺度特征。这种设计提高了模型在图像分类任务中的表现，同时保持了计算效率。支持 1000 个类别的分类，且可以轻松集成到 .NET 中。</p>
</blockquote>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">大家可以直接点击 <a href="https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip" style="color: rgba(64, 184, 250, 1); font-weight: bold; border-top: 1px none rgba(30, 107, 184, 1); border-bottom: 1px solid rgba(59, 170, 250, 1); border-left: 1px none rgba(30, 107, 184, 1); border-right: 1px none rgba(30, 107, 184, 1); border-radius: 0; margin: 0; padding: 0; text-decoration: none; text-decoration-thickness: initial; overflow-wrap: break-word" rel="noopener nofollow">tensorflow_inception_graph.pb</a> 下载（文章最后也有下载方式）预训练的模型文件和分类文件，并将其放入项目目录中。</p>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">也可以到<a href="https://github.com/martinwicke/tensorflow-tutorial/blob/master/tensorflow_inception_graph.pb" style="color: rgba(64, 184, 250, 1); font-weight: bold; border-top: 1px none rgba(30, 107, 184, 1); border-bottom: 1px solid rgba(59, 170, 250, 1); border-left: 1px none rgba(30, 107, 184, 1); border-right: 1px none rgba(30, 107, 184, 1); border-radius: 0; margin: 0; padding: 0; text-decoration: none; text-decoration-thickness: initial; overflow-wrap: break-word" rel="noopener nofollow">github</a>上下载（文章最后也有下载方式），里面的内容相对来说也更丰富些。</p>
<figure data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; display: flex; flex-direction: column; justify-content: center; align-items: center"><img src="https://files.mdnice.com/user/4969/3590b5b2-ab83-420e-8289-98b3583a8edf.png" alt="" style="display: block; margin-top: 0; margin-right: auto; margin-bottom: 0; max-width: 100%; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 8px; object-fit: fill; box-shadow: 2px 4px 8px rgba(153, 153, 153, 1)"></figure>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">在 .NET 中调用模型</span><span class="suffix" style="display: none"></span></h2>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">现在，我们进入核心部分：在 .NET 中调用 tensorflow_inception_graph.pb。以下是逐步实现的过程。</p>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">1. 创建 .NET 项目</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">使用命令行创建一个控制台应用，项目基本结构如下：</p>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px">ImageClassificationDemo/<br>├──&nbsp;ImageClassificationDemo.csproj<br>├──&nbsp;Program.cs<br>├──&nbsp;assets/inputs/inception/tensorflow_inception_graph.pb<br>├──&nbsp;assets/inputs/inception/imagenet_comp_graph_label_strings.txt<br></code></pre>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">2. 定义输入和输出数据结构</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">如果在运行的时候报错说找不到模型或者label文件，可以进行如下操作：</p>
<figure data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; display: flex; flex-direction: column; justify-content: center; align-items: center"><img src="https://files.mdnice.com/user/4969/5c28233a-779d-47ed-8764-69437944d1a3.png" alt="" style="display: block; margin-top: 0; margin-right: auto; margin-bottom: 0; max-width: 100%; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 8px; object-fit: fill; box-shadow: 2px 4px 8px rgba(153, 153, 153, 1)"></figure>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">输入类中定义数据的结构如下，后续会使用 <strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">TextLoader</strong> 加载数据时引用该类型。此处的类名为 <strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">ImageNetData</strong>：</p>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">class</span>&nbsp;<span class="hljs-title" style="color: rgba(97, 174, 238, 1); line-height: 26px">ImageNetData</span><br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-meta" style="color: rgba(97, 174, 238, 1); line-height: 26px">LoadColumn(0)</span>]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;ImagePath;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-meta" style="color: rgba(97, 174, 238, 1); line-height: 26px">LoadColumn(1)</span>]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;Label;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-function" style="line-height: 26px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">static</span>&nbsp;IEnumerable&lt;ImageNetData&gt;&nbsp;<span class="hljs-title" style="color: rgba(97, 174, 238, 1); line-height: 26px">ReadFromCsv</span>(<span class="hljs-params" style="line-height: 26px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;file,&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;folder</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">return</span>&nbsp;File.ReadAllLines(file)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Select(x&nbsp;=&gt;&nbsp;x.Split(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">'\t'</span>))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Select(x&nbsp;=&gt;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">new</span>&nbsp;ImageNetData&nbsp;{&nbsp;ImagePath&nbsp;=&nbsp;Path.Combine(folder,&nbsp;x[<span class="hljs-number" style="color: rgba(209, 154, 102, 1); line-height: 26px">0</span>]),&nbsp;Label&nbsp;=&nbsp;x[<span class="hljs-number" style="color: rgba(209, 154, 102, 1); line-height: 26px">1</span>]&nbsp;}&nbsp;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">class</span>&nbsp;<span class="hljs-title" style="color: rgba(97, 174, 238, 1); line-height: 26px">ImageNetDataProbability</span>&nbsp;:&nbsp;<span class="hljs-title" style="color: rgba(97, 174, 238, 1); line-height: 26px">ImageNetData</span><br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;PredictedLabel;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">float</span>&nbsp;Probability&nbsp;{&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">get</span>;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">set</span>;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></code></pre>
<blockquote class="custom-blockquote multiquote-1" data-tool="mdnice编辑器" style="margin: 20px 0; padding: 10px 10px 10px 20px; border: 1px solid rgba(64, 184, 255, 0.4); border-radius: 8px; background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.1); width: auto; height: auto; box-shadow: 0 0 rgba(0, 0, 0, 0); display: block; overflow-x: auto; overflow-y: auto"><span style="display: block; color: rgba(64, 184, 250, 0.5); font-size: 28px; line-height: 1.5em; letter-spacing: 0; text-align: left; font-weight: bold">❝</span>
<p style="text-indent: 0; padding: 8px 0; color: rgba(59, 59, 59, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal; margin: 0">需要强调的是，<strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">ImageNetData</strong> 类中的标签在使用 TensorFlow 模型进行评分时并没有真正使用。而是在测试预测时使用它，这样就可以将每个样本数据的实际标签与 TensorFlow 模型提供的预测标签进行比较。</p>
</blockquote>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">输出类的结构如下：</p>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">class</span>&nbsp;<span class="hljs-title" style="color: rgba(97, 174, 238, 1); line-height: 26px">ImageNetPrediction</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-meta" style="color: rgba(97, 174, 238, 1); line-height: 26px">ColumnName(TFModelScorer.InceptionSettings.outputTensorName)</span>]<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">float</span>[]&nbsp;PredictedLabels;<br>}<br></code></pre>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">Inception 模型还需要几个传入的默认参数：</p>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">struct</span>&nbsp;ImageNetSettings<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">const</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">int</span>&nbsp;imageHeight&nbsp;=&nbsp;<span class="hljs-number" style="color: rgba(209, 154, 102, 1); line-height: 26px">224</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">const</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">int</span>&nbsp;imageWidth&nbsp;=&nbsp;<span class="hljs-number" style="color: rgba(209, 154, 102, 1); line-height: 26px">224</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">const</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">float</span>&nbsp;mean&nbsp;=&nbsp;<span class="hljs-number" style="color: rgba(209, 154, 102, 1); line-height: 26px">117</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">public</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">const</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">bool</span>&nbsp;channelsLast&nbsp;=&nbsp;<span class="hljs-literal" style="color: rgba(86, 182, 194, 1); line-height: 26px">true</span>;<br>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></code></pre>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">3. 定义 estimator 管道</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<blockquote class="custom-blockquote multiquote-1" data-tool="mdnice编辑器" style="margin: 20px 0; padding: 10px 10px 10px 20px; border: 1px solid rgba(64, 184, 255, 0.4); border-radius: 8px; background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.1); width: auto; height: auto; box-shadow: 0 0 rgba(0, 0, 0, 0); display: block; overflow-x: auto; overflow-y: auto"><span style="display: block; color: rgba(64, 184, 250, 0.5); font-size: 28px; line-height: 1.5em; letter-spacing: 0; text-align: left; font-weight: bold">❝</span>
<p style="text-indent: 0; padding: 8px 0; color: rgba(59, 59, 59, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal; margin: 0">在处理深度神经网络时，必须使图像适应网络期望的格式。这就是图像被调整大小然后转换的原因（主要是像素值在所有R，G，B通道上被归一化）。</p>
</blockquote>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;pipeline&nbsp;=&nbsp;mlContext.Transforms.LoadImages(outputColumnName:&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>,&nbsp;imageFolder:&nbsp;imagesFolder,&nbsp;inputColumnName:&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">nameof</span>(ImageNetData.ImagePath))<br>&nbsp;&nbsp;&nbsp;&nbsp;.Append(mlContext.Transforms.ResizeImages(outputColumnName:&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>,&nbsp;imageWidth:&nbsp;ImageNetSettings.imageWidth,&nbsp;imageHeight:&nbsp;ImageNetSettings.imageHeight,&nbsp;inputColumnName:&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>))<br>&nbsp;&nbsp;&nbsp;&nbsp;.Append(mlContext.Transforms.ExtractPixels(outputColumnName:&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>,&nbsp;interleavePixelColors:&nbsp;ImageNetSettings.channelsLast,&nbsp;offsetImage:&nbsp;ImageNetSettings.mean))<br>&nbsp;&nbsp;&nbsp;&nbsp;.Append(mlContext.Model.LoadTensorFlowModel(modelLocation)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ScoreTensorFlowModel(outputColumnNames:&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">new</span>[]&nbsp;{&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"softmax2"</span>&nbsp;},&nbsp;inputColumnNames:&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">new</span>[]&nbsp;{&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addBatchDimensionInput:<span class="hljs-literal" style="color: rgba(86, 182, 194, 1); line-height: 26px">true</span>));<br></code></pre>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">运行代码后，模型将被成功加载到内存中，接下来我们可以调用它进行图像分类。</p>
<blockquote class="custom-blockquote multiquote-1" data-tool="mdnice编辑器" style="margin: 20px 0; padding: 10px 10px 10px 20px; border: 1px solid rgba(64, 184, 255, 0.4); border-radius: 8px; background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.1); width: auto; height: auto; box-shadow: 0 0 rgba(0, 0, 0, 0); display: block; overflow-x: auto; overflow-y: auto"><span style="display: block; color: rgba(64, 184, 250, 0.5); font-size: 28px; line-height: 1.5em; letter-spacing: 0; text-align: left; font-weight: bold">❝</span>
<p style="text-indent: 0; padding: 8px 0; color: rgba(59, 59, 59, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal; margin: 0">通常情况下，这里经常报的错就是输入/输出节点的名称不正确，你可以通过 Netron (https://netron.app/)工具查看输入/输出节点的名称。</p>
<p style="text-indent: 0; padding: 8px 0; color: rgba(59, 59, 59, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal; margin: 0">因为这两个节点的名称后面会在 estimator 的定义中使用：在 inception 网络的情况下，输入张量命名为 'input'，输出命名为 'softmax2'。</p>
</blockquote>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">下图是通过 <strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">Netron</strong> 读取的 <strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">tensorflow_inception_graph.pb</strong> 模型分析图：</p>
<figure data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; display: flex; flex-direction: column; justify-content: center; align-items: center"><img src="https://files.mdnice.com/user/4969/7277d52f-7338-42f8-9b46-a7a247cf2ebb.png" alt="输入张量名" style="display: block; margin-top: 0; margin-right: auto; margin-bottom: 0; max-width: 100%; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 8px; object-fit: fill; box-shadow: 2px 4px 8px rgba(153, 153, 153, 1)"><figcaption style="color: rgba(136, 136, 136, 1); font-size: 13px; line-height: 1.5em; letter-spacing: 0; text-align: center; font-weight: normal; margin: 10px 0 0; padding: 0">输入张量名</figcaption></figure>
<figure data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; display: flex; flex-direction: column; justify-content: center; align-items: center"><img src="https://files.mdnice.com/user/4969/264ae714-6dfd-401d-b044-bffb7e80fba9.png" alt="输出张量名" style="display: block; margin-top: 0; margin-right: auto; margin-bottom: 0; max-width: 100%; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 8px; object-fit: fill; box-shadow: 2px 4px 8px rgba(153, 153, 153, 1)"><figcaption style="color: rgba(136, 136, 136, 1); font-size: 13px; line-height: 1.5em; letter-spacing: 0; text-align: center; font-weight: normal; margin: 10px 0 0; padding: 0">输出张量名</figcaption></figure>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">4. 提取预测结果</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">填充 <strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">estimator</strong> 管道</p>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px">ITransformer&nbsp;model&nbsp;=&nbsp;pipeline.Fit(data);<br><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;predictionEngine&nbsp;=&nbsp;mlContext.Model.CreatePredictionEngine&lt;ImageNetData,&nbsp;ImageNetPrediction&gt;(model);<br></code></pre>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">当获得预测结果后，我们会在属性中得到一个浮点数数组。数组中的每个位置都会分配到一个标签。</p>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">例如，如果模型有5个不同的标签，则数组将为length = 5。数组中的每个位置都表示标签在该位置的概率；所有数组值（概率）的和等于1。</p>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">然后，您需要选择最大的值（概率），并检查配给了该位置的那个以填充 estimator 管道标签。</p>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">调用模型进行图像分类</span><span class="suffix" style="display: none"></span></h2>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">接下来我们需要编写代码来加载图像、进行预测并解析结果。</p>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">1. 准备素材与分类文件</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">定义图像文件夹目录和图像分类目录。以下代码加载并预处理图像：</p>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;assetsRelativePath&nbsp;=&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">@"../../../assets"</span>;<br><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;assetsPath&nbsp;=&nbsp;GetAbsolutePath(assetsRelativePath);<br><br><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;tagsTsv&nbsp;=&nbsp;Path.Combine(assetsPath,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inputs"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"images"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"tags.tsv"</span>);<br><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;imagesFolder&nbsp;=&nbsp;Path.Combine(assetsPath,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inputs"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"images"</span>);<br><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;inceptionPb&nbsp;=&nbsp;Path.Combine(assetsPath,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inputs"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inception"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"tensorflow_inception_graph.pb"</span>);<br><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;labelsTxt&nbsp;=&nbsp;Path.Combine(assetsPath,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inputs"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inception"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"imagenet_comp_graph_label_strings.txt"</span>);<br></code></pre>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">2. 加载模型</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px"><span class="hljs-function" style="line-height: 26px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">private</span>&nbsp;PredictionEngine&lt;ImageNetData,&nbsp;ImageNetPrediction&gt;&nbsp;<span class="hljs-title" style="color: rgba(97, 174, 238, 1); line-height: 26px">LoadModel</span>(<span class="hljs-params" style="line-height: 26px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;dataLocation,&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;imagesFolder,&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;modelLocation</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;ConsoleWriteHeader(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"Read&nbsp;model"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">$"Model&nbsp;location:&nbsp;<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{modelLocation}</span>"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">$"Images&nbsp;folder:&nbsp;<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{imagesFolder}</span>"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">$"Training&nbsp;file:&nbsp;<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{dataLocation}</span>"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">$"Default&nbsp;parameters:&nbsp;image&nbsp;size=(<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{ImageNetSettings.imageWidth}</span>,<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{ImageNetSettings.imageHeight}</span>),&nbsp;image&nbsp;mean:&nbsp;<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{ImageNetSettings.mean}</span>"</span>);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;data&nbsp;=&nbsp;mlContext.Data.LoadFromTextFile&lt;ImageNetData&gt;(dataLocation,&nbsp;hasHeader:&nbsp;<span class="hljs-literal" style="color: rgba(86, 182, 194, 1); line-height: 26px">true</span>);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;pipeline&nbsp;=&nbsp;mlContext.Transforms.LoadImages(outputColumnName:&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>,&nbsp;imageFolder:&nbsp;imagesFolder,&nbsp;inputColumnName:&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">nameof</span>(ImageNetData.ImagePath))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Append(mlContext.Transforms.ResizeImages(outputColumnName:&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>,&nbsp;imageWidth:&nbsp;ImageNetSettings.imageWidth,&nbsp;imageHeight:&nbsp;ImageNetSettings.imageHeight,&nbsp;inputColumnName:&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Append(mlContext.Transforms.ExtractPixels(outputColumnName:&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>,&nbsp;interleavePixelColors:&nbsp;ImageNetSettings.channelsLast,&nbsp;offsetImage:&nbsp;ImageNetSettings.mean))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Append(mlContext.Model.LoadTensorFlowModel(modelLocation).<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ScoreTensorFlowModel(outputColumnNames:&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">new</span>[]&nbsp;{&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"softmax2"</span>&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inputColumnNames:&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">new</span>[]&nbsp;{&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"input"</span>&nbsp;},&nbsp;addBatchDimensionInput:<span class="hljs-literal" style="color: rgba(86, 182, 194, 1); line-height: 26px">true</span>));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;ITransformer&nbsp;model&nbsp;=&nbsp;pipeline.Fit(data);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;predictionEngine&nbsp;=&nbsp;mlContext.Model.CreatePredictionEngine&lt;ImageNetData,&nbsp;ImageNetPrediction&gt;(model);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">return</span>&nbsp;predictionEngine;<br>}<br></code></pre>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">3. 解析输出结果</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px"><span class="hljs-function" style="line-height: 26px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">protected</span>&nbsp;IEnumerable&lt;ImageNetData&gt;&nbsp;<span class="hljs-title" style="color: rgba(97, 174, 238, 1); line-height: 26px">PredictDataUsingModel</span>(<span class="hljs-params" style="line-height: 26px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;testLocation,&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;imagesFolder,&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;labelsLocation,&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PredictionEngine&lt;ImageNetData,&nbsp;ImageNetPrediction&gt;&nbsp;model</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;ConsoleWriteHeader(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"Classify&nbsp;images"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">$"Images&nbsp;folder:&nbsp;<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{imagesFolder}</span>"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">$"Training&nbsp;file:&nbsp;<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{testLocation}</span>"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">$"Labels&nbsp;file:&nbsp;<span class="hljs-subst" style="color: rgba(224, 108, 117, 1); line-height: 26px">{labelsLocation}</span>"</span>);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;labels&nbsp;=&nbsp;ReadLabels(labelsLocation);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;testData&nbsp;=&nbsp;ImageNetData.ReadFromCsv(testLocation,&nbsp;imagesFolder);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">foreach</span>&nbsp;(<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;sample&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">in</span>&nbsp;testData)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;probs&nbsp;=&nbsp;model.Predict(sample).PredictedLabels;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;imageData&nbsp;=&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">new</span>&nbsp;ImageNetDataProbability()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImagePath&nbsp;=&nbsp;sample.ImagePath,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label&nbsp;=&nbsp;sample.Label<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(imageData.PredictedLabel,&nbsp;imageData.Probability)&nbsp;=&nbsp;GetBestLabel(labels,&nbsp;probs);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageData.ConsoleWrite();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">yield</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">return</span>&nbsp;imageData;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></code></pre>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">在 <code style="color: rgba(53, 148, 247, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(27, 31, 35, 0.05); width: auto; height: auto; margin: 0 2px; padding: 2px 4px; border-top: 3px none rgba(0, 0, 0, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 4px; overflow-wrap: break-word; font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; word-break: break-all">Main</code> 方法中调用，完整代码如下：</p>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px"><span class="hljs-function" style="line-height: 26px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">static</span>&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">void</span>&nbsp;<span class="hljs-title" style="color: rgba(97, 174, 238, 1); line-height: 26px">Main</span>(<span class="hljs-params" style="line-height: 26px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>[]&nbsp;args</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;assetsRelativePath&nbsp;=&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">@"../../../assets"</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;assetsPath&nbsp;=&nbsp;GetAbsolutePath(assetsRelativePath);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;tagsTsv&nbsp;=&nbsp;Path.Combine(assetsPath,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inputs"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"images"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"tags.tsv"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;imagesFolder&nbsp;=&nbsp;Path.Combine(assetsPath,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inputs"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"images"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;inceptionPb&nbsp;=&nbsp;Path.Combine(assetsPath,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inputs"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inception"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"tensorflow_inception_graph.pb"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">string</span>&nbsp;labelsTxt&nbsp;=&nbsp;Path.Combine(assetsPath,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inputs"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"inception"</span>,&nbsp;<span class="hljs-string" style="color: rgba(152, 195, 121, 1); line-height: 26px">"imagenet_comp_graph_label_strings.txt"</span>);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">try</span><br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TFModelScorer&nbsp;modelScorer&nbsp;=&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">new</span>&nbsp;TFModelScorer(tagsTsv,&nbsp;imagesFolder,&nbsp;inceptionPb,&nbsp;labelsTxt);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modelScorer.Score();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">catch</span>&nbsp;(Exception&nbsp;ex)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConsoleHelpers.ConsoleWriteException(ex.ToString());<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;ConsoleHelpers.ConsolePressAnyKey();<br>}<br></code></pre>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">运行程序后，你将看到类似以下的输出：</p>
<figure data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; display: flex; flex-direction: column; justify-content: center; align-items: center"><img src="https://files.mdnice.com/user/4969/2185d88d-6d99-4095-a3cc-72151ee15a6c.png" alt="" style="display: block; margin-top: 0; margin-right: auto; margin-bottom: 0; max-width: 100%; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 8px; object-fit: fill; box-shadow: 2px 4px 8px rgba(153, 153, 153, 1)"></figure>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">其他实现方式</span><span class="suffix" style="display: none"></span></h2>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">在实际应用中，我们也可以使用ONNX模型，此处不做额外叙述。由于模型的性能和效率至关重要，只是提供一些优化建议：</p>
<ol data-tool="mdnice编辑器" style="list-style-type: decimal; margin: 8px 0; padding: 0 0 0 25px; color: rgba(0, 0, 0, 1)">
<li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">模型量化</strong>：使用 ONNX Runtime 的量化工具，将模型从浮点数（FP32）转换为整数（INT8），减少模型大小和推理时间。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">硬件加速</strong>：结合 ONNX Runtime 的 GPU 支持，利用 CUDA 或 DirectML 加速推理。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">批处理</strong>：如果需要处理多张图像，可以将输入组织为批次（batch），提高吞吐量。例如：</section></li></ol>
<pre class="custom" data-tool="mdnice编辑器" style="border-radius: 5px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.55); text-align: left; margin: 10px 0; padding: 0"><span style="display: block; background: url(&quot;https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg&quot;) 10px 10px / 40px no-repeat rgba(40, 44, 52, 1); height: 30px; width: 100%; margin-bottom: -7px; border-radius: 5px"></span><code class="hljs" style="overflow-x: auto; padding: 15px 16px 16px; color: rgba(171, 178, 191, 1); background: rgba(40, 44, 52, 1); border-radius: 5px; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px"><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;inputs&nbsp;=&nbsp;<span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">new</span>&nbsp;List&lt;ImageInput&gt;&nbsp;{&nbsp;input1,&nbsp;input2,&nbsp;input3&nbsp;};<br><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;batchPrediction&nbsp;=&nbsp;mlContext.Data.LoadFromEnumerable(inputs);<br><span class="hljs-keyword" style="color: rgba(198, 120, 221, 1); line-height: 26px">var</span>&nbsp;predictions&nbsp;=&nbsp;model.Transform(batchPrediction);<br></code></pre>
<ol start="4" data-tool="mdnice编辑器" style="list-style-type: decimal; margin: 8px 0; padding: 0 0 0 25px; color: rgba(0, 0, 0, 1)">
<li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">缓存机制</strong>：对于频繁使用的模型，保持预测引擎的单例实例，避免重复加载。</section></li></ol>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">通过这些优化，模型可以在 .NET 环境中实现更高的性能，满足实时应用的需求。</p>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">实际应用场景</span><span class="suffix" style="display: none"></span></h2>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">图像分类模型在 .NET 应用中有广泛的用途，以下是几个典型场景：</p>
<ol data-tool="mdnice编辑器" style="list-style-type: decimal; margin: 8px 0; padding: 0 0 0 25px; color: rgba(0, 0, 0, 1)">
<li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><p style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">医疗影像分析</strong><br>
在医疗系统中，部署图像分类模型可以辅助医生识别 X 光片或 MRI 图像中的异常。例如，检测肺部结节或肿瘤。</p>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><p style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">智能安防</strong><br>
在监控系统中，模型可以实时识别可疑物体或行为，如检测闯入者或遗留物品。</p>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><p style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">电子商务</strong><br>
在商品管理系统中，自动分类上传的商品图像，提升搜索和推荐的准确性。</p>
</section></li></ol>
<h3 data-tool="mdnice编辑器" style="border-bottom: 4px solid rgba(64, 184, 250, 1); margin: 30px 0 15px; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border-top: 1px none rgba(0, 0, 0, 1); border-left: 1px none rgba(0, 0, 0, 1); border-right: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: block; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/fullstack-1.png&quot;) left top / 20px 20px no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 20px; height: 20px; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0 0 -25px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 20px; color: rgba(64, 184, 250, 1); line-height: 1.5em; letter-spacing: 0; padding: 0; align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin: 0 0 0 25px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">挑战与解决方案</span><span class="suffix" style="background: none left top / auto no-repeat scroll padding-box border-box rgba(64, 184, 250, 0.5); align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 20px 0 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: flex; font-size: 22px; font-weight: bold; flex-direction: unset; float: right; height: 10px; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: -10px 0 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: 200px; -webkit-box-reflect: unset"></span></h3>
<ul data-tool="mdnice编辑器" style="list-style-type: disc; margin: 8px 0; padding: 0 0 0 25px; color: rgba(0, 0, 0, 1)">
<li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">数据隐私</strong>：通过加密传输和本地推理保护用户数据。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">模型更新</strong>：定期从云端下载新模型，并使用版本控制管理。</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">计算资源</strong>：在资源受限的设备上，使用轻量化模型（如 MobileNet）。</section></li></ul>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">结论</span><span class="suffix" style="display: none"></span></h2>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">本文详细介绍了如何在 .NET 环境下使用 C# 部署和调用 AI 图像分类模型。从环境搭建到模型选择、部署与调用，再到性能优化和应用场景，我们提供了一套完整的实践指南。通过 ML.NET 和预测模式的支持，开发者可以轻松地将强大的 AI 能力集成到 .NET 应用中。</p>
<p data-tool="mdnice编辑器" style="color: rgba(43, 43, 43, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; text-indent: 0; margin: 0; padding: 8px 0">随着 AI 技术的不断进步和 .NET 平台的持续发展，二者的结合将为开发者带来更多可能性。无论是构建智能桌面应用、Web 服务还是跨平台解决方案，图像分类模型都能为项目增添创新价值。希望本文能为你的 AI 之旅提供启发和帮助！</p>
<hr data-tool="mdnice编辑器" style="margin: 10px 0; padding: 0; border-top: 2px solid rgba(59, 170, 250, 1); border-bottom: 3px none rgba(0, 0, 0, 0.4); border-left: 3px none rgba(0, 0, 0, 0.4); border-right: 3px none rgba(0, 0, 0, 0.4); border-radius: 0; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: 1px">
<h2 data-tool="mdnice编辑器" style="align-items: unset; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: center; line-height: 1.5em; margin: 30px 0 15px; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset"><span class="prefix" style="background: url(&quot;https://files.mdnice.com/user/3441/25e68d6a-ac8b-4e0c-b12b-ac27b90d88be.png&quot;) left top / contain no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: 30px; height: auto; align-items: unset; border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(0, 0, 0, 1); display: block; font-size: 22px; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; justify-content: unset; letter-spacing: 0; line-height: 1.5em; margin: 0; overflow-x: unset; overflow-y: unset; padding: 0; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; -webkit-box-reflect: unset"></span><span class="content" style="font-size: 22px; line-height: 1.8em; letter-spacing: 0; margin: 0; padding: 0 10px 0 0; align-items: unset; background: linear-gradient(0deg, rgba(231, 247, 252, 1) 40%, rgba(0, 0, 0, 0) 40%) left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 1px none rgba(0, 0, 0, 1); border-radius: 0; box-shadow: none; color: rgba(112, 188, 234, 1); display: block; font-weight: bold; font-style: normal; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset">参考资料</span><span class="suffix" style="display: none"></span></h2>
<ul data-tool="mdnice编辑器" style="list-style-type: disc; margin: 8px 0; padding: 0 0 0 25px; color: rgba(0, 0, 0, 1)">
<li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">素材下载地址：</strong> https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">Netron工具地址：</strong> https://netron.app/</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">224x224图像素材：</strong> https://www.kaggle.com/datasets/abhinavnayak/catsvdogs-transformed/data</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">tensorflow教程及模型文件和label文件：</strong> https://github.com/martinwicke/tensorflow-tutorial</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">Image Classification - Scoring sample：</strong> https://github.com/dotnet/machinelearning-samples/blob/main/samples/csharp/getting-started/DeepLearning_ImageClassification_TensorFlow/README.md</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">ML.NET 官方文档：</strong> https://dotnet.microsoft.com/apps/machinelearning-ai/ml-dotnet</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; color: rgba(89, 89, 89, 1); font-size: 14px; line-height: 1.8em; letter-spacing: 0.02em; text-align: left; font-weight: normal"><strong style="color: rgba(53, 148, 247, 1); font-weight: bold; background: none left top / auto no-repeat scroll padding-box border-box rgba(0, 0, 0, 0); width: auto; height: auto; margin: 0; padding: 0; border: 3px none rgba(0, 0, 0, 0.4); border-radius: 0">ONNX Model Zoo：</strong> https://github.com/onnx/models</section></li></ul>
</section>
</div>
<div id="MySignature" role="contentinfo">
    <p>
    本文来自博客园，作者：<a href="https://www.cnblogs.com/code-daily/" target="_blank">AI·NET极客圈</a>，转载请注明原文链接：<a href="https://www.cnblogs.com/code-daily/p/18764803" target="_blank">https://www.cnblogs.com/code-daily/p/18764803</a> 
</p>
<br>
<img src="https://images.cnblogs.com/cnblogs_com/blogs/272929/galleries/2447197/o_250311050355_AI.NET%20Logo.png" width="61.8%">

<p>
    欢迎关注我的公众号，作为.NET程序员，我们聚焦人工智能技术，深入探讨AI的前沿应用与发展趋势，为你立体呈现人工智能的无限可能，让我们共同携手走在科技最前沿。
</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.02702239608101852" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-12 10:15">2025-03-12 10:14</span>&nbsp;
<a href="https://www.cnblogs.com/code-daily">AI·NET极客圈</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18764803" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18764803);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18764803', targetLink: 'https://www.cnblogs.com/code-daily/p/18764803', title: 'AI与.NET技术实操系列（六）：基于图像分类模型对图像进行分类' })">举报</a>
</div>
        