
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/noear/p/18688783" title="发布于 2025-01-23 23:39">
    <span role="heading" aria-level="2">[Java] Solon 框架的三大核心组件之一插件扩展体系</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        Solon 的三大核心组件：Plugin 插件扩展机制，Ioc/Aop 应用容器，Context+Handler 通用上下文处理接口。
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="1solon-的三大核心组件">1、Solon 的三大核心组件</h3>
<table>
<thead>
<tr>
<th>核心组件</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Plugin 插件扩展机制</td>
<td>提供“编码风格”的扩展体系</td>
</tr>
<tr>
<td>Ioc/Aop 应用容器</td>
<td>提供基于注入依赖的自动装配体系</td>
</tr>
<tr>
<td>Context+Handler 通用上下文处理接口</td>
<td>提供“开放式处理”适配体系（俗称，三元合一）</td>
</tr>
</tbody>
</table>
<h3 id="2solon-plugin-插件扩展机制">2、Solon Plugin 插件扩展机制</h3>
<p>几种 Java 扩展机制：</p>
<table>
<thead>
<tr>
<th>扩展机制</th>
<th>描述</th>
<th>特点</th>
<th>体验风格</th>
<th>适用性</th>
</tr>
</thead>
<tbody>
<tr>
<td>Java SPI</td>
<td>Java 自带的</td>
<td>以接口为单位</td>
<td>配置风格</td>
<td>适用于所有 Java 生态（最通用）</td>
</tr>
<tr>
<td>Spring Factories</td>
<td>Spring 框架提供的</td>
<td>以组件为单位</td>
<td>配置风格</td>
<td>适用于 Spring 生态体系</td>
</tr>
<tr>
<td>Solon Plugin</td>
<td>Solon 框架提供的</td>
<td>以模块为单位</td>
<td>编码风格</td>
<td>适用于 Solon 生态体系</td>
</tr>
</tbody>
</table>
<p>Solon Plugin 是 Java SPI 的一种“增强”模式，强调编码风格。插件模块元信息配置会申明一个 Plugin 接口的实现类，在应用启动时扫描元信息目录，以发现所有申明的插件实现。</p>
<p>Plugin 的接口定义：</p>
<pre><code class="language-java">public interface Plugin {
    //启动
    void start(AppContext context) throws Throwable;
    //预停止
    default void prestop() throws Throwable{}
    //停止
    default void stop() throws Throwable{}
}
</code></pre>
<p>Plugin 实现类的元信息配置申明：以 <code>META-INF/solon</code> 为专属目录；使用 <code>properties</code> 格式；要配置插件的实现类及优先级。</p>
<pre><code># META-INF/solon/{packname}.properties

solon.plugin={PluginImpl}   #插件实现类配置
solon.plugin.priority=1 #插件优化级配置。越大越优先，默认为0
</code></pre>
<h3 id="3solon-plugin-插件示例">3、Solon Plugin 插件示例</h3>
<p>用一个数据缓存与事务相关的插件为例，以模块为单位实现整体装配（编码风格）：</p>
<pre><code class="language-java">public class DemoSolonPlugin implements Plugin {
    @Override
    public void start(AppContext context) {
        if (context.app() != null) {
            //添加事务控制支持
            if (context.app().source().isAnnotationPresent(EnableTransaction.class)) {
                //添加注解拦截器
                context.beanInterceptorAdd(Tran.class, TranInterceptor.instance, 120);
            }

            //添加缓存控制支持
            if (context.app().source().isAnnotationPresent(EnableCaching.class)) {
                //添加注解拦截器
                context.beanInterceptorAdd(CachePut.class, new CachePutInterceptor(), 110);
                context.beanInterceptorAdd(CacheRemove.class, new CacheRemoveInterceptor(), 110);
                context.beanInterceptorAdd(Cache.class, new CacheInterceptor(), 111);
            }
        }
        
        //根据配置自动构建数据源
        context.beanMake(DataSourcesAutoConfiguration.class);
    }
}
</code></pre>
<p>插件应用示意：</p>
<pre><code class="language-java">@EnableTransaction
@EnableCaching
public class App {
    public static void main(String[] args) {
        Solon.start(App.class, args);
    }
}

@Component
public class DemoService {
    @Cache
    public String test() {
        return new Date().toString();
    }
    
    @Tran
    public void post() {
        ...
    }
}
</code></pre>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.031069608131944444" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-01-23 23:39">2025-01-23 23:39</span>&nbsp;
<a href="https://www.cnblogs.com/noear">带刺的坐椅</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18688783" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18688783);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18688783', targetLink: 'https://www.cnblogs.com/noear/p/18688783', title: '[Java] Solon 框架的三大核心组件之一插件扩展体系' })">举报</a>
</div>
        