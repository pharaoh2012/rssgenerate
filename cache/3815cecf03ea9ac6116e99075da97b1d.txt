
		<h2>
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/209jkjkjk/p/18674423" title="发布于 2025-01-16 10:35">
    <span role="heading" aria-level="2">Bartender SDK C#调用二次开发 代码示例</span>
    

</a>

		</h2>
		<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="说明">说明</h2>
<p>软件版本：Bartender 2022<br>
是否支持32位：否<br>
SDK类型：Engine类调用（还有另一种风格的SDK，忘记是啥了）</p>
<h2 id="引用com库">引用COM库</h2>
<p>参考路径：<br>
Seagull\BarTender 2022\SDK\Assemblies\Seagull.BarTender.Print.dll<br>
可能只能用framework4.8跑</p>
<h2 id="启动引擎">启动引擎</h2>
<pre><code class="language-C#">// 启动引擎（第一次运行耗时较多）
Engine btEngine = new Engine(true)
</code></pre>
<h2 id="打开btw文档并指定打印机">打开BTW文档并指定打印机</h2>
<pre><code class="language-C#">// 打开标签
LabelFormatDocument btFormat = btEngine.Documents.Open(文件名, 打印机名);
</code></pre>
<h2 id="给具名字段赋值">给具名字段赋值</h2>
<pre><code class="language-C#">// 设置数据 字段信息 Directory&lt;string, string&gt;
foreach(var kv in 字段信息)
{
    btFormat.SubStrings[kv.Key].Value = kv.Value;
}
</code></pre>
<h2 id="设置数量">设置数量</h2>
<pre><code class="language-C#">// 对应软件里的序号数量
btFormat.PrintSetup.NumberOfSerializedLabels = 序号数量;
// 对应软件里每个序号的copies数量
btFormat.PrintSetup.IdenticalCopiesOfLabel = 打印数量;
</code></pre>
<h2 id="设置纸张大小">设置纸张大小</h2>
<pre><code class="language-C#">btFormat.PageSetup.PaperWidth = 纸张宽度;
btFormat.PageSetup.PaperHeight = 纸张高度;
</code></pre>
<h2 id="打印并获得返回值">打印并获得返回值</h2>
<pre><code class="language-C#">// 第一个参数为JobName
Result result = btFormat.Print("", out Messages messages);
// Result为枚举 例如if (result == Result.Success)
// Messages是IEnumerable&lt;Message&gt; 迭代可得到更多详细信息
foreach(Message msg in messages)
{
    Console.WriteLine(msg.ID);
    Console.WriteLine(msg.Text);
    // msg.xx 还有更多
}
</code></pre>
<h2 id="不完整的整体代码">不完整的整体代码</h2>
<pre><code class="language-C#">// 启动引擎
using (Engine btEngine = new Engine(true))
{
    // 打开标签
    LabelFormatDocument btFormat = btEngine.Documents.Open(文件名, 打印机名);
    // 设置数据
    foreach(var kv in 字段信息)
    {
        btFormat.SubStrings[kv.Key].Value = kv.Value;
    }
    // 设置数量
    btFormat.PrintSetup.NumberOfSerializedLabels = 序号数量;
    btFormat.PrintSetup.IdenticalCopiesOfLabel = 打印数量;
    btFormat.PageSetup.PaperWidth = 纸张宽度;
    btFormat.PageSetup.PaperHeight = 纸张高度;
    Result result = btFormat.Print("", out Messages messages);
    // 关闭
    btFormat.Close(SaveOptions.DoNotSaveChanges);
    btEngine.Stop();
    // 返回信息
    Console.WriteLine(result.ToString());   // Success
    foreach(Message msg in messages)
    {
        Console.WriteLine(msg.ID);
        Console.WriteLine(msg.Text);
    }
}
</code></pre>

</div>
<div class="clear"></div>

		<p class="postfoot">
			posted on 
<span id="post-date" data-last-update-days="2.221499310770833" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-01-16 10:58">2025-01-16 10:35</span>&nbsp;
<a href="https://www.cnblogs.com/209jkjkjk">卢晓春</a>&nbsp;
阅读(<span id="post_view_count">44</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18674423" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18674423);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18674423', targetLink: 'https://www.cnblogs.com/209jkjkjk/p/18674423', title: 'Bartender SDK C#调用二次开发 代码示例' })">举报</a>

		</p>
	