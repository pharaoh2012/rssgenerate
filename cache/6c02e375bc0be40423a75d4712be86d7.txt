
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/gentsir/p/18913839" title="发布于 2025-06-06 12:12">
    <span role="heading" aria-level="2">Cropper.js 裁剪图片，并利用 FormData 对象将裁剪图片生成 Blob 数据上传到服务器</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>  <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">div </span><span style="color: rgba(255, 0, 0, 1)">class</span><span style="color: rgba(0, 0, 255, 1)">="form-group sync-to-img hidden"</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
    <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">label </span><span style="color: rgba(255, 0, 0, 1)">for</span><span style="color: rgba(0, 0, 255, 1)">="Admin-Image-img_cut"</span><span style="color: rgba(255, 0, 0, 1)"> class</span><span style="color: rgba(0, 0, 255, 1)">="col-sm-2 col-md-1 col-lg-1  control-label"</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>图片裁剪<span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">label</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
    <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">div </span><span style="color: rgba(255, 0, 0, 1)">class</span><span style="color: rgba(0, 0, 255, 1)">="col-sm-10 col-md-11 col-lg-11"</span><span style="color: rgba(255, 0, 0, 1)"> style</span><span style="color: rgba(0, 0, 255, 1)">="width: 580px"</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">div </span><span style="color: rgba(255, 0, 0, 1)">id</span><span style="color: rgba(0, 0, 255, 1)">="Admin-Image-img_cut-state"</span><span style="color: rgba(255, 0, 0, 1)"> class</span><span style="color: rgba(0, 0, 255, 1)">="uploader-list"</span><span style="color: rgba(0, 0, 255, 1)">&gt;&lt;/</span><span style="color: rgba(128, 0, 0, 1)">div</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">div </span><span style="color: rgba(255, 0, 0, 1)">id</span><span style="color: rgba(0, 0, 255, 1)">="Admin-Image-img_cut-show"</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
            <span style="color: rgba(0, 0, 255, 1)">&lt;?</span><span style="color: rgba(255, 0, 255, 1)">php if(isset($data['img_url']) &amp;&amp; $data['img_url']){echo '&lt;img style="max-width: 100%;" id="img-cut" src="'.$data['img_url'].'"&gt;'; } </span><span style="color: rgba(0, 0, 255, 1)">?&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">div</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">input </span><span style="color: rgba(255, 0, 0, 1)">style</span><span style="color: rgba(0, 0, 255, 1)">="margin: 10px 0; width: 150%;"</span><span style="color: rgba(255, 0, 0, 1)"> type</span><span style="color: rgba(0, 0, 255, 1)">="text"</span><span style="color: rgba(255, 0, 0, 1)"> class</span><span style="color: rgba(0, 0, 255, 1)">="form-control"</span><span style="color: rgba(255, 0, 0, 1)"> id</span><span style="color: rgba(0, 0, 255, 1)">="figure-img"</span><span style="color: rgba(255, 0, 0, 1)"> name</span><span style="color: rgba(0, 0, 255, 1)">="figure_img"</span> <span style="color: rgba(0, 0, 255, 1)">/&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">input </span><span style="color: rgba(255, 0, 0, 1)">type</span><span style="color: rgba(0, 0, 255, 1)">="hidden"</span><span style="color: rgba(255, 0, 0, 1)"> id</span><span style="color: rgba(0, 0, 255, 1)">="figure-type"</span><span style="color: rgba(255, 0, 0, 1)"> name</span><span style="color: rgba(0, 0, 255, 1)">="figure_type"</span><span style="color: rgba(255, 0, 0, 1)"> value</span><span style="color: rgba(0, 0, 255, 1)">=""</span> <span style="color: rgba(0, 0, 255, 1)">/&gt;</span>
        <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">button </span><span style="color: rgba(255, 0, 0, 1)">type</span><span style="color: rgba(0, 0, 255, 1)">="button"</span><span style="color: rgba(255, 0, 0, 1)"> id</span><span style="color: rgba(0, 0, 255, 1)">="save-cuted-img"</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>确定裁剪<span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">button</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
    <span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">div</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
  <span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">div</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>    let $image = $('#img-cut'<span style="color: rgba(0, 0, 0, 1)">);
    $image.cropper({
        viewMode: </span>1<span style="color: rgba(0, 0, 0, 1)">,
        aspectRatio:</span>600/400,
        zoomable: <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">,
        crop: </span><span style="color: rgba(0, 0, 255, 1)">function</span><span style="color: rgba(0, 0, 0, 1)">(event) { }
    });
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Get the Cropper.js instance after initialized 有损压缩</span>
    let cropper = $image.data('cropper'<span style="color: rgba(0, 0, 0, 1)">);
    $(</span>'body').on('click', '#save-cuted-img', <span style="color: rgba(0, 0, 255, 1)">function</span><span style="color: rgba(0, 0, 0, 1)">(event) {
        event.preventDefault();<br>　　　　　// 防止canvas数据量过大
        cropper.getCroppedCanvas({ maxWidth: </span>2048, maxHeight: 2048 }).toBlob((blob) =&gt;<span style="color: rgba(0, 0, 0, 1)"> {
            const formData </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> FormData();
            formData.append(</span>'file', blob , 'croppedImage1.png'<span style="color: rgba(0, 0, 0, 1)">);
            $.ajax({
                type:</span>"POST"<span style="color: rgba(0, 0, 0, 1)">,
                url:</span>"&lt;?php echo U('Upload/ajax_file'); ?&gt;"<span style="color: rgba(0, 0, 0, 1)">,
                processData: </span><span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">,
                contentType: </span><span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">,
                data: formData,
                dataType: </span>'json'<span style="color: rgba(0, 0, 0, 1)">,
                beforeSend: </span><span style="color: rgba(0, 0, 255, 1)">function</span><span style="color: rgba(0, 0, 0, 1)"> () {
                    $(</span>'#save-cuted-img').text('正在上传...').prop('disabled', <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">);
                },
                success: </span><span style="color: rgba(0, 0, 255, 1)">function</span><span style="color: rgba(0, 0, 0, 1)">(re){
                    </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (re.success) {
                        $(</span>'#figure-img'<span style="color: rgba(0, 0, 0, 1)">).val(re.msg);
                        $(</span>'#figure-type').val($('#Admin-Image-type_id option:selected'<span style="color: rgba(0, 0, 0, 1)">).text());
                        alert(</span>"裁剪图片上传成功"<span style="color: rgba(0, 0, 0, 1)">);
                    } </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)"> {
                        alert(re.msg);
                    }
                },
                error() {
                    console.log(</span>'裁剪图片上传失败'<span style="color: rgba(0, 0, 0, 1)">);
                },
                complete: </span><span style="color: rgba(0, 0, 255, 1)">function</span><span style="color: rgba(0, 0, 0, 1)"> () {
                    $(</span>'#save-cuted-img').text('确定裁剪').prop('disabled', <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">);
                }
            });
        }, </span>'image/png', 1<span style="color: rgba(0, 0, 0, 1)">); // 设置图片质量
    });</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div id="gtx-trans" style="position: absolute; left: 284px; top: 696.219px">&nbsp;</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.008407199722222222" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-06-06 12:12">2025-06-06 12:12</span>&nbsp;
<a href="https://www.cnblogs.com/gentsir">gentsir</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18913839);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18913839', targetLink: 'https://www.cnblogs.com/gentsir/p/18913839', title: 'Cropper.js 裁剪图片，并利用 FormData 对象将裁剪图片生成 Blob 数据上传到服务器' })">举报</a>
</div>
        