
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/deali/p/18996188" title="å‘å¸ƒäº 2025-07-21 17:12">
    <span role="heading" aria-level="2">ä½¿ç”¨django-simple-historyå®ç°ç®€å•å®¡è®¡åŠŸèƒ½</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬æ–‡ä¾ç„¶æ˜¯ä¸­å°é¡¹ç›®å»¶ä¼¸çš„ç¬”è®°</p>
<p>è¿™ä¸ªç³»åˆ—çš„æ–‡ç« å¤ªå°ä¼—äº†ï¼Œçœ‹çš„äººéƒ½ä¸å¤š</p>
<p>æˆ‘äº‰å–å°½å¿«æŠŠè¿™ç³»åˆ—å®Œç»“äº†ï¼Œç„¶åè¿›å…¥æ–°çš„é¡¹ç›®</p>
<h2 id="å…³äºå®¡è®¡">å…³äºå®¡è®¡</h2>
<p>ä¹‹å‰æˆ‘åœ¨ dotnet çš„é¡¹ç›®é‡Œå·²ç»è‡ªå·±å®ç°äº†å®¡è®¡åŠŸèƒ½äº†ï¼Œè¿˜æ˜¯ç”¨åˆ‡é¢æ€æƒ³æçš„</p>
<p>è¯¦è§ï¼š</p>
<ul>
<li><a href="https://blog.deali.cn/Blog/Post/38b0ad0d91248f21" target="_blank" rel="noopener nofollow">AspNetCoreå¼€å‘ç¬”è®°ï¼šå®ç°åŠ¨æ€å®¡è®¡æ—¥å¿—åŠŸèƒ½</a></li>
<li><a href="https://blog.deali.cn/Blog/Post/9527cd9e7cfa854c" target="_blank" rel="noopener nofollow">AspNetCoreå¼€å‘ç¬”è®°ï¼šè¿›ä¸€æ­¥å®ç°éä¾µå…¥æ€§å®¡è®¡æ—¥å¿—åŠŸèƒ½</a></li>
</ul>
<p>Django ç”Ÿæ€éå¸¸ä¸°å¯Œï¼Œå®ç°å®¡è®¡åº”è¯¥ä¹Ÿæœ‰å¾ˆå¤šæ–¹æ³•å’Œç°æˆçš„åº“</p>
<p>è€Œä¸”å› ä¸ºå¼ºç»‘å®šäº†è‡ªå·±çš„ä¸€å¥— ORM ï¼Œæ•´ä¸ªç”Ÿæ€éƒ½å›´ç»•è¿™ä¸ªä½“ç³»æ¥å±•å¼€ï¼Œæ›´åŠ çš„å¼€ç®±å³ç”¨</p>
<h2 id="simple-history">simple-history</h2>
<p>æœ¬æ–‡ä½¿ç”¨äº†çš„è¿™ä¸ª simple-history å¯ä»¥è®°å½•æ¯ä¸ª model çš„æ“ä½œ</p>
<p>æ­é… DjangoStarter æ¡†æ¶ä½¿ç”¨ï¼Œç›®å‰å·²ç»åˆ‡æ¢åˆ° unfold admin ä½œä¸ºç®¡ç†åå°ï¼Œå¯ä»¥æ— ç¼é›†æˆ</p>
<ul>
<li><a href="https://github.com/django-commons/django-simple-history" target="_blank" rel="noopener nofollow">https://github.com/django-commons/django-simple-history</a></li>
<li><a href="https://unfoldadmin.com/docs/integrations/django-simple-history/" target="_blank" rel="noopener nofollow">https://unfoldadmin.com/docs/integrations/django-simple-history/</a></li>
</ul>
<h2 id="å®‰è£…æ™®é€šdjangoé¡¹ç›®">å®‰è£…(æ™®é€šDjangoé¡¹ç›®)</h2>
<p>è¿™é‡Œæ˜¯æ™®é€š Django é¡¹ç›®çš„æ­¥éª¤</p>
<p>å…ˆå®‰è£…ä¾èµ–</p>
<pre><code class="language-bash">pdm add django-simple-history
</code></pre>
<p>æ³¨å†Œåº”ç”¨</p>
<pre><code class="language-python">INSTALLED_APPS = [
    # ...
    'simple_history',
]
</code></pre>
<p>æ·»åŠ ä¸­é—´ä»¶</p>
<p>è¿™ä¸ªåº“çš„å®¡è®¡åŠŸèƒ½æ˜¯é€šè¿‡ä¸­é—´ä»¶æ¥å®ç°çš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸ç”¨ä¸­é—´ä»¶ï¼Œéœ€è¦é¢å¤–çš„æ–¹å¼æŠ˜è…¾ã€‚</p>
<pre><code class="language-python">MIDDLEWARE = [
    # ...
    'simple_history.middleware.HistoryRequestMiddleware',
]
</code></pre>
<p>ç„¶åä¿®æ”¹ admin ç»§æ‰¿ <code>SimpleHistoryAdmin</code></p>
<pre><code class="language-python">from simple_history.admin import SimpleHistoryAdmin

@admin.register(Movie)
class MovieAdmin(SimpleHistoryAdmin):
    ...
</code></pre>
<p>è¿™æ ·å°±å¯ä»¥åœ¨åå°çœ‹åˆ°è¿™ä¸ª model çš„ç›¸å…³æ“ä½œäº†</p>
<h2 id="djangostarteré›†æˆ">DjangoStarteré›†æˆ</h2>
<p>å®é™…ä¸Šæ˜¯ unfold çš„é›†æˆğŸ¤£</p>
<h3 id="æ³¨å†ŒæœåŠ¡">æ³¨å†ŒæœåŠ¡</h3>
<p>ç¡®ä¿æŒ‰ç…§ä»¥ä¸‹é¡ºåºæ³¨å†Œapp</p>
<pre><code class="language-python">INSTALLED_APPS = [
    "unfold",
    # ...
    "unfold.contrib.simple_history",
    # ...
    "simple_history",
]
</code></pre>
<h3 id="ä¿®æ”¹admin">ä¿®æ”¹admin</h3>
<p>è™½ç„¶ä¸ä¿®æ”¹ä¹Ÿèƒ½ work</p>
<p>ä¸è¿‡å°±æ²¡é‚£ä¹ˆå¥½çš„é›†æˆåº¦å’Œæ ·å¼</p>
<pre><code class="language-python">from unfold.admin import ModelAdmin
from simple_history.admin import SimpleHistoryAdmin

@admin.register(Movie)
class MovieAdmin(SimpleHistoryAdmin, ModelAdmin):
    ...
</code></pre>
<h2 id="å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨</h2>
<p>åœ¨éœ€è¦è®°å½•æ“ä½œå†å²çš„ model æ·»åŠ  <code>history = HistoricalRecords()</code> å­—æ®µ</p>
<pre><code class="language-python">class Movie(ModelExt):
    title = models.CharField(max_length=100)
    description = models.TextField()
    year = models.IntegerField()
    rating = models.IntegerField()
    genre = models.CharField(max_length=100)
    director = models.CharField(max_length=100)
    actors = models.CharField(max_length=100)
    history = HistoricalRecords()
</code></pre>
<p>è€è§„çŸ©ï¼Œä¿®æ”¹äº†æ¨¡å‹éœ€è¦åŒæ­¥æ•°æ®åº“</p>
<pre><code class="language-bash">python src/manage.py makemigrations
python src/manage.py migrate
</code></pre>
<p>è®°å¾— admin ä¹Ÿè¦åŒæ­¥ä¿®æ”¹ï¼Œæ–¹æ³•åœ¨å‰é¢ä»‹ç»è¿‡äº†</p>
<p>è¿™æ—¶å€™è¿›å…¥ admin ç®¡ç†ç•Œé¢ï¼Œç‚¹å‡»æŸä¸€ä¸ªå…·ä½“æ•°æ®ï¼Œå³ä¸Šè§’å°±æœ‰ä¸ªâ€œå†å²â€æŒ‰é’®ï¼Œç‚¹è¿›å»å¯ä»¥çœ‹åˆ°æ‰€æœ‰æ“ä½œè®°å½•äº†</p>
<h2 id="å®ç°æ•ˆæœ">å®ç°æ•ˆæœ</h2>
<p>æŸ¥çœ‹åˆ°æ“ä½œå†å²ç±»ä¼¼ä¸‹é¢è¿™æ ·</p>
<p>å¯ä»¥çœ‹åˆ°ä¿®æ”¹äººå’Œä¿®æ”¹äº†å“ªäº›å†…å®¹</p>
<h3 id="_"></h3>
<table>
<thead>
<tr>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">è®°å½•å¯¹è±¡</td>
<td style="text-align: left">æ—¥æœŸ/æ—¶é—´</td>
<td style="text-align: left">å¤‡æ³¨</td>
<td style="text-align: left">ä¿®æ”¹äºº</td>
<td style="text-align: left">ä¿®æ”¹åŸå› </td>
<td style="text-align: left">Changes</td>
</tr>
<tr>
<td style="text-align: left"><a href="http://127.0.0.1:18080/admin/demo/actor/22/history/5/" target="_blank" rel="noopener nofollow">æ¼”å‘˜1</a></td>
<td style="text-align: left">2025å¹´7æœˆ19æ—¥ 23:56</td>
<td style="text-align: left">å·²ä¿®æ”¹</td>
<td style="text-align: left"><a href="http://127.0.0.1:18080/admin/auth/user/3/change/" target="_blank" rel="noopener nofollow">admin</a></td>
<td style="text-align: left">None</td>
<td style="text-align: left"><strong>City:</strong> Tokyo â¡ï¸ Tokyo Sega</td>
</tr>
<tr>
<td style="text-align: left"><a href="http://127.0.0.1:18080/admin/demo/actor/22/history/4/" target="_blank" rel="noopener nofollow">æ¼”å‘˜1</a></td>
<td style="text-align: left">2025å¹´7æœˆ19æ—¥ 23:56</td>
<td style="text-align: left">å·²åˆ›å»º</td>
<td style="text-align: left"><a href="http://127.0.0.1:18080/admin/auth/user/3/change/" target="_blank" rel="noopener nofollow">admin</a></td>
<td style="text-align: left">None</td>
<td style="text-align: left"></td>
</tr>
</tbody>
</table>
<h2 id="å°ç»“">å°ç»“</h2>
<p>è¿™ä¸ªåº“è¿˜æœ‰å¾ˆå¤šå¯ä»¥è‡ªå®šä¹‰çš„åœ°æ–¹ï¼Œæ–‡æ¡£ä¹Ÿå†™å¾—å¾ˆè¯¦ç»†äº†</p>
<p>æˆ‘å°±æ²¡å¿…è¦æ¬è¿äº†ï¼ˆå…¶å®æ˜¯æˆ‘ç”¨åˆ°çš„åŠŸèƒ½å°±è¿™ä¹ˆç®€å•ï¼‰</p>
<p>unfold è¿˜æœ‰å¾ˆå¤šé›†æˆçš„ç¬¬ä¸‰æ–¹åº“ï¼Œæ„Ÿè§‰éƒ½ä¸é”™ï¼ˆè¿Ÿæ—©è¦é›†æˆåˆ° DjangoStarter é‡Œï¼‰</p>
<ul>
<li>
<p><a href="https://unfoldadmin.com/docs/integrations/django-celery-beat/" target="_blank" rel="noopener nofollow">django-celery-beat</a></p>
</li>
<li>
<p><a href="https://unfoldadmin.com/docs/integrations/django-money/" target="_blank" rel="noopener nofollow">django-money</a></p>
</li>
<li>
<p><a href="https://unfoldadmin.com/docs/integrations/django-constance/" target="_blank" rel="noopener nofollow">django-constance</a></p>
</li>
<li>
<p><a href="https://unfoldadmin.com/docs/integrations/django-import-export/" target="_blank" rel="noopener nofollow">django-import-export</a></p>
</li>
<li>
<p><a href="https://unfoldadmin.com/docs/integrations/django-simple-history/" target="_blank" rel="noopener nofollow">django-simple-history</a></p>
</li>
<li>
<p><a href="https://unfoldadmin.com/docs/integrations/django-guardian/" target="_blank" rel="noopener nofollow">django-guardian</a></p>
</li>
<li>
<p><a href="https://unfoldadmin.com/docs/integrations/django-modeltranslation/" target="_blank" rel="noopener nofollow">django-modeltranslation</a></p>
</li>
<li>
<p><a href="https://unfoldadmin.com/docs/integrations/django-location-field/" target="_blank" rel="noopener nofollow">django-location-field</a></p>
</li>
</ul>

</div>
<div id="MySignature" role="contentinfo">
    å¾®ä¿¡å…¬ä¼—å·ï¼šã€Œç¨‹åºè®¾è®¡å®éªŒå®¤ã€
ä¸“æ³¨äºäº’è”ç½‘çƒ­é—¨æ–°æŠ€æœ¯æ¢ç´¢ä¸å›¢é˜Ÿæ•æ·å¼€å‘å®è·µï¼ŒåŒ…æ‹¬æ¶æ„è®¾è®¡ã€æœºå™¨å­¦ä¹ ä¸æ•°æ®åˆ†æç®—æ³•ã€ç§»åŠ¨ç«¯å¼€å‘ã€Linuxã€Webå‰åç«¯å¼€å‘ç­‰ï¼Œæ¬¢è¿ä¸€èµ·æ¢è®¨æŠ€æœ¯ï¼Œåˆ†äº«å­¦ä¹ å®è·µç»éªŒã€‚
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-21 17:13">2025-07-21 17:12</span>&nbsp;
<a href="https://www.cnblogs.com/deali">ç¨‹åºè®¾è®¡å®éªŒå®¤</a>&nbsp;
é˜…è¯»(<span id="post_view_count">11</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18996188);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18996188', targetLink: 'https://www.cnblogs.com/deali/p/18996188', title: 'ä½¿ç”¨django-simple-historyå®ç°ç®€å•å®¡è®¡åŠŸèƒ½' })">ä¸¾æŠ¥</a>
</div>
        