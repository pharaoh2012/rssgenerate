
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wang_yb/p/18812454" title="发布于 2025-04-07 12:07">
    <span role="heading" aria-level="2">『Plotly实战指南』--箱线图绘制与应用</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>在数据可视化领域，<strong>箱线图</strong>（<code>Box Plot</code>）是一种强大的工具，用于展示数据的<strong>分布特征</strong>、<strong>集中趋势</strong>以及<strong>异常值</strong>。</p>
<p>它不仅能够快速揭示数据的<strong>偏态</strong>、<strong>离散程度</strong>，还能帮助我们识别<strong>潜在的数据问题</strong>。</p>
<p>本文将从基础绘制到业务实战，系统讲解如何用 <code>Plotly</code> 构建交互式箱线图，并掌握其在异常值检测、多组对比分析中的核心应用。</p>
<h1 id="1-基础绘制">1. 基础绘制</h1>
<p><strong>箱线图</strong>是一种用于展示一组数据的五数概括（<strong>最小值</strong>、<strong>第一四分位数</strong>、<strong>中位数</strong>、<strong>第三四分位数</strong>和<strong>最大值</strong>）的图表。</p>
<p>它的几何形态主要由以下几个部分构成：</p>
<ul>
<li><strong>中位数</strong>（<code>Median</code>）：位于箱体中间的横线，表示数据的中间值，将数据分为上下两部分。</li>
<li><strong>四分位数</strong>（<code>Quartiles</code>）：第一四分位数（<code>Q1</code>）位于箱体下边缘，表示数据中有 25% 的值低于此数；第三四分位数（<code>Q3</code>）位于箱体上边缘，表示数据中有 75% 的值低于此数。</li>
<li><strong>箱体</strong>（<code>Box</code>）：由 Q1 和 Q3 构成，其高度表示数据的中间 50% 的分布范围，反映了数据的集中趋势和离散程度。</li>
<li><strong>触须</strong>（<code>Whiskers</code>）：从箱体延伸出的两条线，通常表示数据的正常范围。其长度一般为 1.5 倍的四分位距（IQR = Q3 - Q1），超出此范围的数据点被视为异常值。</li>
<li><strong>异常值</strong>（<code>Outliers</code>）：用单独的点标记，表示那些偏离正常范围的数据点，可能需要进一步分析其成因</li>
</ul>
<p><strong>箱线图</strong>的几何形态与数据分布有着密切的关系。例如，</p>
<ul>
<li>箱体越窄，说明数据的集中程度越高；</li>
<li>触须越短，说明数据的离散程度越小；</li>
<li>异常值的分布情况则可以提示数据中是否存在异常情况或特殊规律。</li>
</ul>
<p>下面的示例，我们构造一组学生成绩的数据，然后用<strong>箱线图</strong>来展示成绩的分布情况。</p>
<pre><code class="language-python">import plotly.graph_objects as go
import numpy as np

# 生成示例数据
np.random.seed(10)
scores = np.random.randint(1, 100, 100)

# 绘制单变量箱线图
fig = go.Figure(
    data=[
        go.Box(
            y=scores,
            boxpoints="outliers",
        )
    ]
)
fig.update_layout(title="学生考试成绩箱线图", yaxis_title="成绩")
fig.show()
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/83005/202504/83005-20250407115221366-477851333.png" alt="" loading="lazy"></p>
<p>上图中，<strong>箱体范围</strong>：从 Q1 到 Q3，表示数据的中间 50% 的分布范围。箱体的高度越小，说明数据越集中。</p>
<p>如果有异常值的话，会用蓝色的圆点标记，表示超出正常范围的数据点。</p>
<p>这些异常值可能是数据录入错误、特殊事件影响或其他原因导致的。</p>
<p>比如，我们给变量<code>scores</code>中添加一些异常的数值，再看看箱线图的变化。</p>
<pre><code class="language-python">scores = np.append(scores, [-100, 200])
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/83005/202504/83005-20250407115221375-273830706.png" alt="" loading="lazy"></p>
<p>图中多了2个蓝色的圆点，就是后面添加的两个<strong>异常值</strong>。</p>
<h1 id="2-分析应用">2. 分析应用</h1>
<h2 id="21-异常值识别">2.1. 异常值识别</h2>
<p><strong>异常值</strong>是数据分析中需要特别关注的部分。它们可能会影响统计分析的结果，甚至误导决策。</p>
<hr>
<p><strong>箱线图</strong>提供了一种直观且有效的方法来识别异常值。</p>
<p>异常值通常是通过四分位距（<code>IQR</code>）来判定的。具体规则如下：</p>
<ul>
<li>小于$ Q1 - 1.5 \times IQR $的数据点被视为<strong>下异常值</strong>。</li>
<li>大于$ Q3 + 1.5 \times IQR $的数据点被视为<strong>上异常值</strong>。</li>
</ul>
<p><code>Plotly</code>的交互式功能可以让我们更方便地分析异常值。</p>
<p>通过设置<code>boxpoints='all'</code>，我们可以将所有数据点显示出来，并通过颜色或其他样式来区分正常值和异常值。</p>
<pre><code class="language-python">import plotly.graph_objects as go
import numpy as np

# 生成示例数据
np.random.seed(10)
scores = np.random.randint(1, 100, 100)
scores = np.append(scores, [-100, 200])

fig = go.Figure(
    data=[
        go.Box(
            y=scores,
            boxpoints="all",
            jitter=0.3,
            pointpos=-1.8,
            marker_color="rgba(0, 0, 255, 0.7)",
            line_color="black",
            notched=True,
        )
    ]
)
fig.update_layout(title="学生考试成绩箱线图（高亮异常值）", yaxis_title="成绩")
fig.show()
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/83005/202504/83005-20250407115221368-1595286734.png" alt="" loading="lazy"></p>
<p>在上述代码中，  <code>jitter</code>参数用于调整数据点的抖动程度，避免数据点重叠；</p>
<p><code>pointpos</code>参数用于控制数据点的水平位置。</p>
<p>通过这种方式，我们可以清晰地看到哪些数据点是异常值。</p>
<p>在识别出异常值后，一般需要根据具体情况选择合适的处理方法：</p>
<ul>
<li><strong>删除</strong>：如果异常值是由于数据录入错误或不可信的测量结果导致的，可以直接将其删除。</li>
<li><strong>修正</strong>：如果异常值可能是真实存在的，但数值有误，可以根据业务逻辑或参考其他数据进行修正。</li>
<li><strong>保留</strong>：在某些情况下，异常值可能具有重要的业务意义，如特殊事件的影响，此时应保留异常值并进行进一步分析。</li>
</ul>
<h2 id="22-多组数据箱线图">2.2. 多组数据箱线图</h2>
<p><strong>箱线图</strong>不仅可以用于单变量的分析，还可以用于多组数据的对比分析。</p>
<p>通过将不同组的数据绘制在同一张箱线图上，我们可以直观地比较它们的分布特征和差异。</p>
<p>假设我们有一组包含多个分类变量的数据，例如不同班级学生的考试成绩。</p>
<pre><code class="language-python"># 示例数据：不同班级学生的考试成绩
data = {
    "Class A": [85, 90, 78, 92, 88, 76, 89, 95, 67, 83],
    "Class B": [82, 87, 79, 91, 85, 75, 88, 93, 77, 84],
    "Class C": [88, 93, 81, 95, 86, 78, 90, 94, 82, 87],
}

fig = go.Figure()
colors = ["blue", "green", "red"]
for class_name, scores in data.items():
    fig.add_trace(
        go.Box(
            y=scores,
            name=class_name,
            boxpoints="outliers",
            line_color="black",
            fillcolor=colors.pop(),
        )
    )

fig.update_layout(
    title="不同班级学生考试成绩对比",
    yaxis_title="成绩",
    xaxis_title="班级",
    boxgap=0.3,
)  # 调整箱线图之间的间距
fig.show()
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/83005/202504/83005-20250407115221373-844998914.png" alt="" loading="lazy"></p>
<p>通过分析分组箱线图，我们可以发现不同班级学生成绩的差异情况。</p>
<h1 id="3-总结">3. 总结</h1>
<p><strong>箱线图</strong>作为探索性数据分析中的重要工具，不仅能够帮助我们快速把握数据的分布特征，还能有效识别异常值，促进数据清洗与预处理。</p>
<p>在实际应用中，建议：</p>
<ul>
<li>优先清洗数据中的极端异常值，避免误导分析结论。</li>
<li>在业务报告中，充分利用箱线图的直观性，传递数据分布与组间差异信息，辅助决策制定。</li>
</ul>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.17968108197569443" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-04-07 12:07">2025-04-07 12:07</span>&nbsp;
<a href="https://www.cnblogs.com/wang_yb">wang_yb</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18812454" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18812454);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18812454', targetLink: 'https://www.cnblogs.com/wang_yb/p/18812454', title: '『Plotly实战指南』--箱线图绘制与应用' })">举报</a>
</div>
        