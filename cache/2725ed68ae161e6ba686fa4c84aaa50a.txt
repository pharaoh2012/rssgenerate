
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Merbleue/p/19000138" title="发布于 2025-07-23 09:54">
    <span role="heading" aria-level="2">Argo CD持续交付工具部署</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="介绍">介绍</h2>
<p>Argo CD 是一款适用于 Kubernetes 的声明式 GitOps 持续交付工具。</p>
<h2 id="架构">架构</h2>
<p><img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722101428652.png" class="lazyload"></p>
<p>Argo CD 是作为一个 Kubernetes 控制器来实现的，它能持续监控运行中的应用程序，并将当前的实时状态与所需的目标状态（在 Git 仓库中指定）进行比较。 如果部署的应用程序的实时状态与目标状态有偏差，则会被视为 "不同步"。 Argo CD 会报告并可视化差异，同时提供自动或手动同步实时状态的功能，使其恢复到所需的目标状态。 对 Git 仓库中的所需目标状态所做的任何修改都会自动应用并反映在指定的目标环境中。</p>
<h2 id="功能">功能</h2>
<ul>
<li>将应用程序自动部署到指定的目标环境中</li>
<li>支持多种配置管理/模板工具（kustomize、helm、Jsonnet、plain-YAML）</li>
<li>管理和部署到多个集群的能力</li>
<li>SSO 集成（OIDC、OAuth2、LDAP、SAML 2.0、GitHub、GitLab、Microsoft、LinkedIn）</li>
<li>多租户和 RBAC 授权策略</li>
<li>回滚/任意滚动到 Git 仓库中提交的任何应用程序配置</li>
<li>应用资源健康状态分析</li>
<li>自动配置漂移检测和可视化</li>
<li>自动或手动将应用程序同步到所需状态</li>
<li>提供应用程序活动实时视图的 Web UI</li>
<li>用于自动化和 CI 集成的 CLI</li>
<li>Webhook 集成（GitHub、BitBucket、GitLab）</li>
<li>用于自动化的访问令牌</li>
<li>同步前、同步中、同步后钩子，以支持复杂的应用程序推出（如蓝色/绿色和金丝雀升级）</li>
<li>应用程序事件和 API 调用的审计跟踪</li>
<li>Prometheus 指标</li>
<li>参数重写，用于重写 Git 中的 helm 参数</li>
</ul>
<h2 id="安装">安装</h2>
<pre><code class="language-sh">kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
</code></pre>
<p>部署完成后查看pod是否正常启动</p>
<pre><code class="language-sh">kubectl get pods -n argocd
</code></pre>
<p><img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722101938759.png" class="lazyload"></p>
<h2 id="安装-argo-cd-cli">安装 Argo CD CLI</h2>
<p>Argo CD CLI 是用于管理 Argo CD 的命令行工具，具体操作系统安装文档参考 <a href="https://argoproj.github.io/argo-cd/cli_installation/" target="_blank" rel="noopener nofollow">Argo CD CLI 安装文档</a></p>
<pre><code class="language-sh"># ubuntu 系统安装
curl -sSL -o /usr/local/bin/argocd https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64

# 授权
chmod +x /usr/local/bin/argocd

</code></pre>
<p>验证：<br>
<img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722102558952.png" class="lazyload"></p>
<h2 id="暴露-argo-cd-服务">暴露 Argo CD 服务</h2>
<p>默认情况下，Argo CD API 服务器不公开外部 IP。 要访问 API 服务器，请选择以下技术之一公开 Argo CD API 服务器：</p>
<pre><code class="language-sh"># NodePort
kubectl patch svc argocd-server -n argocd -p '{"spec": {"type": "NodePort"}}'

# LoadBalancer
kubectl patch svc argocd-server -n argocd -p '{"spec": {"type": "LoadBalancer"}}'
</code></pre>
<p><img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722103059166.png" class="lazyload"></p>
<p>浏览器通过https://<ip>:31951 访问Argo CD<br>
<img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722103350490.png" class="lazyload"></ip></p>
<h2 id="获取-argo-cd-密码">获取 Argo CD 密码</h2>
<p>Argo CD 安装后有一个内置的 "admin "用户，可以完全访问系统。 建议仅在初始配置时使用 "admin "用户，然后切换到本地用户或配置 SSO 集成，admin "账户的初始密码会自动生成，并以明文形式存储在 Argo CD 安装命名空间中名为 "argocd-initial-admin-secret "的秘密中的 "password "字段中。</p>
<pre><code class="language-sh"># 获取 admin 密码
kubectl get secret argocd-initial-admin-secret -n argocd -o jsonpath="{.data.password}" | base64 -d
</code></pre>
<p><img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722103832423.png" class="lazyload"></p>
<p>命令方式获取</p>
<pre><code class="language-sh">argocd admin initial-password -n argocd
</code></pre>
<p><img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722104219554.png" class="lazyload"></p>
<h2 id="修改-argo-cd-密码">修改 Argo CD 密码</h2>
<p>图形化界面修改 Argo CD 密码<br>
<img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722104531942.png" class="lazyload"></p>
<p>命令行方式修改 Argo CD 密码</p>
<pre><code class="language-sh"># 首先登录
argocd login 192.168.0.81:31951

# 修改密码
argocd account update-password
</code></pre>
<p><img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722104912543.png" class="lazyload"></p>
<h2 id="测试通过-git-实现应用部署">测试通过 Git 实现应用部署</h2>
<p>首先在设置里面添加git仓库<br>
<img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722111122690.png" class="lazyload"></p>
<p>创建成功显示<br>
<img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722111219582.png" class="lazyload"></p>
<p>创建应用<br>
<img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722112616414.png" class="lazyload"></p>
<p>点击sync部署<br>
<img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722122246682.png" class="lazyload"></p>
<p>kubernetes-dashboard查看<br>
<img alt="" loading="lazy" data-src="https://merblue.oss-cn-chengdu.aliyuncs.com/blog_img/20250722122347598.png" class="lazyload"></p>

</div>
<div id="MySignature" role="contentinfo">
    <p>本文来自博客园，作者：<a href="https://www.cnblogs.com/Merbleue/" target="_blank">谭咏麟</a>，转载请注明原文链接：<a href="https://www.cnblogs.com/Merbleue/p/19000138" target="_blank">https://www.cnblogs.com/Merbleue/p/19000138</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-23 09:55">2025-07-23 09:54</span>&nbsp;
<a href="https://www.cnblogs.com/Merbleue">谭咏麟</a>&nbsp;
阅读(<span id="post_view_count">24</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19000138);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19000138', targetLink: 'https://www.cnblogs.com/Merbleue/p/19000138', title: 'Argo CD持续交付工具部署' })">举报</a>
</div>
        