
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xuhe2/p/18792632" title="发布于 2025-03-26 14:44">
    <span role="heading" aria-level="2">本地部署overleaf服务帮助latex论文编写</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>是的,<a href="https://www.overleaf.com/" target="_blank" rel="noopener nofollow">overleaf</a>是一个很好的服务,提供了立刻上手就可以编写的latex文章的服务.但是,overleaf会面对latex超时,所以需要付钱的情况,这常出现在编写期刊的论文的情况.</p>
<blockquote>
<p>因为时效性,所以,过去的一些操作已经不适用于新版本的overleaf的本地化部署,该博客提供了最新的部署方式指导(以及一些常见问题修复)</p>
</blockquote>
<h1 id="部署overleaf服务">部署overleaf服务</h1>
<p><a href="https://github.com/overleaf/overleaf/blob/main/docker-compose.yml" target="_blank" rel="noopener nofollow">官方仓库docker compose yaml部署overleaf服务</a>存在一定的问题,无法连接mongodb数据库<br>
所以,使用官方提供的<a href="https://github.com/overleaf/toolkit/" target="_blank" rel="noopener nofollow">Overleaf Toolkit</a>,该工具提供了构建好的一些可执行工具帮助部署和使用</p>
<h2 id="requirements">requirements</h2>
<ul>
<li>git</li>
<li>docker</li>
<li>docker compose</li>
</ul>
<blockquote>
<p>不会高效地安装docker依赖?可以参考博客<a href="https://www.cnblogs.com/xuhe2/p/18770822" target="_blank">[tldr] debian系用户配置使用docker</a></p>
</blockquote>
<h2 id="clone-repo">clone repo</h2>
<pre><code class="language-shell">git clone --depth=1 https://github.com/overleaf/toolkit.git ./overleaf-toolkit
</code></pre>
<blockquote>
<p><code>--depth=1</code>的作用是只clone最新一次的内容,这个可以有效地减少需要下载的内容<br>
出现了<strong>网络问题</strong>,无法下载,可以试一下<a href="https://github.com/xuhe2/github520cli" target="_blank" rel="noopener nofollow">github520cli</a>开源项目,使用方式参考博客<a href="https://www.cnblogs.com/xuhe2/p/18716808" target="_blank">github520cli解决无法github访问问题</a></p>
</blockquote>
<p>该仓库提供了overleaf需要的一系列工具,文档可以参考<a href="https://github.com/overleaf/toolkit/blob/master/doc/README.md" target="_blank" rel="noopener nofollow">官方仓库的README</a></p>
<h2 id="docker部署">docker部署</h2>
<p>需要三个docker image</p>
<ul>
<li>redis</li>
<li>mongodb</li>
<li>sharelatex</li>
</ul>
<blockquote>
<p>如果网络问题可以考虑proxy或者国内镜像源,但是sharlatex不在国内的镜像源的白名单里面.</p>
</blockquote>
<p>检查<code>bin/</code>文件夹中的内容,这里面包含了一些通过docker compose运行的可执行文件.</p>
<pre><code>backup-config*   doctor*      init*   rename-env-vars-5-0*  shell*  up*                       
dev/             error-logs*  logs*   rename-rc-vars*       start*  upgrade*                  
docker-compose*  images*      mongo*  run-script*           stop*   
</code></pre>
<blockquote>
<p>使用<code>ls</code>指令检查可执行文件<br>
主要需要的文件有<code>start</code>,<code>stop</code>,<code>shell</code><br>
也可以通过docker compose指令直接启动服务</p>
</blockquote>
<p>使用<code>./bin/up</code>启动服务<br>
使用<code>./bin/stop</code>停止服务<br>
使用<code>./bin/start</code>重新启动服务<br>
使用<code>./bin/shell</code>连接进入容器内部</p>
<blockquote>
<p>你可以通过<code>docker-compose exec -it sharelatex bash</code>取得类似的效果</p>
</blockquote>
<p><strong>启动三个服务,其中,sharelatex耗费最多的时间,每次启动都是需要花费时间的,并且,这个容器内部还包含了nginx服务</strong></p>
<h1 id="安装依赖解决bug">安装依赖(解决BUG)</h1>
<p>在编写一些latex文档的时候,可能存在依赖缺失的问题,例如<a href="https://www.cnblogs.com/Xiaoyan-Li/p/14805950.html" target="_blank">[Latex] CTEX解决File "xxx.sty" not found问题</a></p>
<p>通过检查<a href="https://github.com/overleaf/overleaf/issues/978" target="_blank" rel="noopener nofollow">github issue978</a>得到问题的解决办法,主要是通过<strong>更新textlive的方式</strong></p>
<blockquote>
<p>该博客中提供了更新的方式</p>
</blockquote>
<p><a href="https://www.tug.org/texlive/upgrade.html" target="_blank" rel="noopener nofollow">Upgrade from TeX Live 2024 to 2025</a>官方提供了很好的升级textlive版本的方式,其中,<strong>推荐<a href="https://www.tug.org/texlive/quickinstall.html" target="_blank" rel="noopener nofollow">快速安装的方式</a></strong></p>
<h2 id="进入容器">进入容器</h2>
<p>一些的安装和更新操作需要在容器内部进行,所以,先使用<code>./bin/shell</code>进入容器内部shell</p>
<p>去到临时文件夹开始操作</p>
<pre><code class="language-shell">cd /tmp # working directory of your choice
</code></pre>
<p>下载需要的文件</p>
<pre><code class="language-shell">wget https://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz
</code></pre>
<p>解压</p>
<pre><code class="language-shell">zcat &lt; install-tl-unx.tar.gz | tar xf - # note final - on that command line
</code></pre>
<p>前往解压出来的文件夹</p>
<pre><code class="language-shell">cd install-tl-*
</code></pre>
<blockquote>
<p>这个*需要换成对应的数字</p>
</blockquote>
<p>(可选)更换textlive镜像源,参考<a href="https://zhuanlan.zhihu.com/p/444440227" target="_blank" rel="noopener nofollow">知乎-更换textlive的镜像源</a></p>
<pre><code class="language-shell">tlmgr option repository https://mirrors.aliyun.com/CTAN/systems/texlive/tlnet
</code></pre>
<blockquote>
<p>这个是永久性换源</p>
</blockquote>
<p>安装</p>
<pre><code class="language-shell">perl ./install-tl --no-interaction # as root or with writable destination
# may take several hours to run
</code></pre>
<blockquote>
<p>这个安装过程很漫长,大概有4900个pkg需要安装,下载完成之后安装也需要一定的时间</p>
</blockquote>
<h2 id="重启服务">重启服务</h2>
<p>安装全部的服务之后,然后,需要重启服务</p>
<p>只需<code>./bin/stop</code>然后<code>./bin/start</code>即可</p>
<h1 id="使用服务">使用服务</h1>
<p>第一次登陆的时候会创建管理员用户,管理员用户再添加其他用户.</p>
<p>后续使用的时候登陆一般用户访问服务即可</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.4839845288576389" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-26 14:44">2025-03-26 14:44</span>&nbsp;
<a href="https://www.cnblogs.com/xuhe2">xuhe2</a>&nbsp;
阅读(<span id="post_view_count">171</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18792632" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18792632);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18792632', targetLink: 'https://www.cnblogs.com/xuhe2/p/18792632', title: '本地部署overleaf服务帮助latex论文编写' })">举报</a>
</div>
        