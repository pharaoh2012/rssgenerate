
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/chenshibao/p/18994852" title="发布于 2025-07-20 23:51">
    <span role="heading" aria-level="2">WPF开发中实现DataGrid中的数据分页显示，自定义分页样式（与上一篇不同的分页）</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="实际开发中我们可能需要自己写一些自定义的分页设计所以我们需要学会自己封装一个可以直接套用的分页控件以下就是一个完整的用例话不多说我们直接上代码实现">实际开发中，我们可能需要自己写一些自定义的分页设计，所以我们需要学会自己封装一个可以直接套用的分页控件，以下就是一个完整的用例，话不多说，我们直接上代码实现。</h1>
<h2 id="1新建一个分页控件viewpagination2control">1.新建一个分页控件View：Pagination2Control</h2>
<h3 id="11-ui展示如下">1.1 UI展示如下</h3>
<pre><code>&lt;UserControl x:Class="WPFDemoMVVM.Controls.Pagination2Control"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
			 xmlns:local="clr-namespace:WPFDemoMVVM.Controls"
			 xmlns:lang="clr-namespace:WPFDemoMVVM.Resources"
			 xmlns:lex="http://wpflocalizeextension.codeplex.com"
			 lex:ResxLocalizationProvider.DefaultAssembly="WPFDemoMVVM"
			 lex:ResxLocalizationProvider.DefaultDictionary="Lang"
			 lex:LocalizeDictionary.DesignCulture="zh-CN"
			 mc:Ignorable="d" 
			 d:DesignHeight="30" d:DesignWidth="800"&gt;
	&lt;UserControl.Resources&gt;
		&lt;Style x:Key="PgBaseButtonStyle" TargetType="Button" &gt;
			&lt;Setter Property="Template"&gt;
				&lt;Setter.Value&gt;
					&lt;ControlTemplate TargetType="Button"&gt;
						&lt;Border CornerRadius="6"
						 Background="{TemplateBinding Background}"
						 BorderBrush="{TemplateBinding BorderBrush}"
						 BorderThickness="{TemplateBinding BorderThickness}"&gt;
							&lt;Grid&gt;
								&lt;ContentPresenter HorizontalAlignment="Center"
						   VerticalAlignment="Center"
						   Content="{TemplateBinding Content}"/&gt;
							&lt;/Grid&gt;
						&lt;/Border&gt;
					&lt;/ControlTemplate&gt;
				&lt;/Setter.Value&gt;
			&lt;/Setter&gt;
			&lt;Setter Property="Background" Value="#282B3B"/&gt;
			&lt;Setter Property="BorderBrush" Value="#367AFF"/&gt;
			&lt;Setter Property="BorderThickness" Value="1"/&gt;
			&lt;Setter Property="Foreground" Value="White"/&gt;
			&lt;Setter Property="Padding" Value="0"/&gt;
			&lt;Setter Property="Height" Value="30"/&gt;
			&lt;Setter Property="Width" Value="70"/&gt;
			&lt;Setter Property="FontSize" Value="14"/&gt;
			&lt;Setter Property="VerticalAlignment" Value="Center"/&gt;
			&lt;Setter Property="VerticalContentAlignment" Value="Center"/&gt;
			&lt;Setter Property="HorizontalAlignment" Value="Center"/&gt;
			&lt;Setter Property="HorizontalContentAlignment" Value="Center"/&gt;
			&lt;Setter Property="Margin" Value="5 0"/&gt;
			&lt;Style.Triggers&gt;
				&lt;Trigger Property="IsMouseOver" Value="True"&gt;
					&lt;Setter Property="Foreground" Value="White"/&gt;
					&lt;Setter Property="BorderThickness" Value="2"/&gt;
					&lt;Setter Property="Cursor" Value="Hand"/&gt;
					&lt;Setter Property="Opacity" Value="1"/&gt;
				&lt;/Trigger&gt;
			&lt;/Style.Triggers&gt;
		&lt;/Style&gt;

		&lt;Style x:Key="PgComBoxStyle" TargetType="ComboBox"&gt;
			&lt;Setter Property="Background" Value="#0D0D19"/&gt;
			&lt;Setter Property="FontSize" Value="14"/&gt;
			&lt;Setter Property="Margin" Value="20,0,0,0"/&gt;
			&lt;Setter Property="Height" Value="32"/&gt;
			&lt;Setter Property="Width" Value="80"/&gt;
			&lt;Setter Property="VerticalAlignment" Value="Center"/&gt;
			&lt;Setter Property="HorizontalAlignment" Value="Center"/&gt;
			&lt;Setter Property="BorderBrush" Value="#367AFF"/&gt;
			&lt;Setter Property="BorderThickness" Value="0"/&gt;
			&lt;Setter Property="FontFamily" Value="Arial"/&gt;
		&lt;/Style&gt;


		&lt;Style TargetType="TextBlock" x:Key="BaseTextBlockStyle"&gt;
			&lt;Setter Property="FontSize" Value="14"/&gt;
			&lt;Setter Property="FontFamily" Value="Arial"/&gt;
			&lt;Setter Property="FontWeight" Value="Normal"/&gt;
			&lt;Setter Property="Opacity" Value="1"/&gt;
			&lt;Setter Property="Background" Value="{x:Null}"/&gt;
			&lt;Setter Property="Foreground" Value="White"/&gt;
			&lt;Setter Property="VerticalAlignment" Value="Center"/&gt;
			&lt;Setter Property="HorizontalAlignment" Value="Center"/&gt;
			&lt;Setter Property="Padding" Value="0"/&gt;
		&lt;/Style&gt;

		&lt;Style x:Key="BaseComboBoxStyle" TargetType="ComboBox"&gt;
			&lt;Setter Property="Foreground" Value="White"/&gt;
			&lt;Setter Property="Background" Value="#0D0D19"/&gt;
			&lt;Setter Property="BorderThickness" Value="0"/&gt;
			&lt;Setter Property="FontSize" Value="14"/&gt;
			&lt;Setter Property="FontFamily" Value="Arial"/&gt;
			&lt;Setter Property="Width" Value="80"/&gt;
			&lt;Setter Property="Height" Value="32"/&gt;
			&lt;Setter Property="FontSize" Value="14"/&gt;
			&lt;Setter Property="HorizontalAlignment" Value="Right"/&gt;
			&lt;Setter Property="VerticalAlignment" Value="Center"/&gt;
			&lt;Setter Property="Margin" Value="5,0,5,0"/&gt;
			&lt;Setter Property="IsEditable" Value="False"/&gt;
			&lt;Setter Property="ItemTemplate"&gt;
				&lt;Setter.Value&gt;
					&lt;DataTemplate&gt;
						&lt;TextBlock Text="{Binding}" Style="{StaticResource BaseTextBlockStyle}" HorizontalAlignment="Center"/&gt;
					&lt;/DataTemplate&gt;
				&lt;/Setter.Value&gt;
			&lt;/Setter&gt;
			&lt;Setter Property="Template"&gt;
				&lt;Setter.Value&gt;
					&lt;ControlTemplate TargetType="ComboBox"&gt;
						&lt;Grid&gt;
							&lt;ToggleButton
								Name="ToggleButton"
								IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
								ClickMode="Press"
								Background="{TemplateBinding Background}"
								BorderThickness="{TemplateBinding BorderThickness}" Width="{TemplateBinding Width}"&gt;
								&lt;Grid&gt;
									&lt;ContentPresenter
									Name="ContentSite"
									IsHitTestVisible="False"
									Content="{TemplateBinding SelectionBoxItem}"
									ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
									VerticalAlignment="Center"
									HorizontalAlignment="Left" Width="60"
									Margin="5,0,0,0"
									RecognizesAccessKey="True"/&gt;
									&lt;Path
									HorizontalAlignment="Right"
									Margin="0,0,6,0"
									VerticalAlignment="Center"
									Data="M 0 0 L 4 4 L 8 0 Z"
									Fill="White"/&gt;
								&lt;/Grid&gt;
							&lt;/ToggleButton&gt;
							&lt;Popup
							Name="Popup"
							Placement="Bottom"
							IsOpen="{TemplateBinding IsDropDownOpen}"
							AllowsTransparency="True"
							Focusable="False"
							PopupAnimation="Slide"&gt;
								&lt;Grid
								Name="DropDown"
								SnapsToDevicePixels="True"
								MinWidth="{TemplateBinding ActualWidth}"
								MaxHeight="200"
								Background="#0D0D19"&gt;
									&lt;Border x:Name="DropDownBorder" BorderThickness="0" Background="#0D0D19"/&gt;
									&lt;ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True"&gt;
										&lt;StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" /&gt;
									&lt;/ScrollViewer&gt;
								&lt;/Grid&gt;
							&lt;/Popup&gt;
						&lt;/Grid&gt;
						&lt;ControlTemplate.Triggers&gt;
							&lt;Trigger Property="HasItems" Value="false"&gt;
								&lt;Setter TargetName="DropDownBorder" Property="MinHeight" Value="95"/&gt;
							&lt;/Trigger&gt;
							&lt;Trigger Property="IsEnabled" Value="false"&gt;
								&lt;Setter Property="Foreground" Value="Gray"/&gt;
							&lt;/Trigger&gt;
							&lt;Trigger Property="IsMouseOver" Value="True"&gt;
								&lt;Setter Property="Background" Value="#1A1A2A"/&gt;
							&lt;/Trigger&gt;
						&lt;/ControlTemplate.Triggers&gt;
					&lt;/ControlTemplate&gt;
				&lt;/Setter.Value&gt;
			&lt;/Setter&gt;
		&lt;/Style&gt;

		&lt;Style TargetType="TextBox" x:Key="BaseTextBoxStyle"&gt;
			&lt;Setter Property="Height" Value="32"/&gt;
			&lt;Setter Property="Width" Value="98"/&gt;
			&lt;Setter Property="FontSize" Value="14"/&gt;
			&lt;Setter Property="FontFamily" Value="Arial"/&gt;
			&lt;Setter Property="FontWeight" Value="Normal"/&gt;
			&lt;Setter Property="Opacity" Value="0.8"/&gt;
			&lt;Setter Property="Background" Value="#0C0E1A"/&gt;
			&lt;Setter Property="Foreground" Value="White"/&gt;
			&lt;Setter Property="BorderThickness" Value="0"/&gt;
			&lt;Setter Property="Padding" Value="0"/&gt;
			&lt;Setter Property="VerticalAlignment" Value="Center"/&gt;
			&lt;Setter Property="HorizontalAlignment" Value="Center"/&gt;
			&lt;Setter Property="VerticalContentAlignment" Value="Center"/&gt;
			&lt;Setter Property="HorizontalContentAlignment" Value="Left"/&gt;
			&lt;!-- 设置光标颜色为白色 --&gt;
			&lt;Setter Property="CaretBrush" Value="White"/&gt;
		&lt;/Style&gt;

	&lt;/UserControl.Resources&gt;

	&lt;StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" &gt;
		&lt;Button Content="«" Command="{Binding PreviousPageCommand}" IsEnabled="{Binding CanGoPrevious}" Style="{DynamicResource PgBaseButtonStyle}" Width="30"/&gt;

		&lt;!-- 页码显示为横向排列 --&gt;
		&lt;ItemsControl ItemsSource="{Binding PageNumbers}"&gt;
			&lt;ItemsControl.ItemsPanel&gt;
				&lt;ItemsPanelTemplate&gt;
					&lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center" /&gt;
				&lt;/ItemsPanelTemplate&gt;
			&lt;/ItemsControl.ItemsPanel&gt;
			&lt;ItemsControl.ItemTemplate&gt;
				&lt;DataTemplate&gt;
					&lt;Button Content="{Binding Display}"
					Margin="2"
					Padding="5,2"
					MinWidth="30"
					IsEnabled="{Binding IsEnabled}"
					Command="{Binding DataContext.GoToPageCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
					CommandParameter="{Binding PageNumber}" Style="{DynamicResource PgBaseButtonStyle}" Width="30"/&gt;
				&lt;/DataTemplate&gt;
			&lt;/ItemsControl.ItemTemplate&gt;
		&lt;/ItemsControl&gt;

		&lt;Button Content="»" Command="{Binding NextPageCommand}" IsEnabled="{Binding CanGoNext}" Style="{DynamicResource PgBaseButtonStyle}" Width="30"/&gt;

		&lt;TextBlock Text="{lex:Loc PageSize}" VerticalAlignment="Center" Style="{DynamicResource ResourceKey=BaseTextBlockStyle}" FontSize="14" Margin="5 0"/&gt;
		&lt;ComboBox ItemsSource="{Binding PageSizeOptions, Mode=OneWay}" SelectedItem="{Binding ItemsPerPage,  Mode=TwoWay}" Style="{DynamicResource BaseComboBoxStyle}" Margin="5 0"/&gt;

		&lt;!-- 总记录数和页数 --&gt;
		&lt;TextBlock VerticalAlignment="Center" Margin="10,0,0,0" Text="{Binding SummaryText}" Style="{DynamicResource BaseTextBlockStyle}"/&gt;
	&lt;/StackPanel&gt;
&lt;/UserControl&gt;
</code></pre>
<h3 id="12-分页控件的viewmodelpaging2viewmodel">1.2 分页控件的ViewModel：Paging2ViewModel</h3>
<pre><code>public partial class Paging2ViewModel : ObservableObject
{
	private int _totalItems;
	private int _itemsPerPage = 10;
	private int _currentPage = 1;
	private int _maxVisiblePages = 7;

	[ObservableProperty]
	private ObservableCollection&lt;int&gt; pageSizeOptions;

	//[ObservableProperty]
	//private int pageSize;

	[ObservableProperty]
	private string language;

	public int TotalItems
	{
		get =&gt; _totalItems;
		set
		{
			SetProperty(ref _totalItems, value);
			UpdatePagination();
		}
	}

	public int ItemsPerPage
	{
		get =&gt; _itemsPerPage;
		set
		{
			SetProperty(ref _itemsPerPage, value);
			UpdatePagination();
		}
	}

	public int CurrentPage
	{
		get =&gt; _currentPage;
		set
		{
			SetProperty(ref _currentPage, value);
			UpdatePagination();
		}
	}

	public ObservableCollection&lt;PaginationPageNumber&gt; PageNumbers { get; set; } = new();

	public ICommand NextPageCommand =&gt; new RelayCommand(() =&gt;
	{
		if (CurrentPage &lt; TotalPages)
			CurrentPage++;
		PageChanged.Invoke(CurrentPage, ItemsPerPage);
	});

	public ICommand PreviousPageCommand =&gt; new RelayCommand(() =&gt;
	{
		if (CurrentPage &gt; 1)
			CurrentPage--;
		PageChanged.Invoke(CurrentPage, ItemsPerPage);
	});

	public ICommand GoToPageCommand =&gt; new RelayCommand&lt;int&gt;(page =&gt;
	{
		if (page != CurrentPage)
			CurrentPage = page;
		PageChanged.Invoke(CurrentPage, ItemsPerPage);
	});

	public ICommand CurrentPageChangedCommand { get; set; }

	public int TotalPages =&gt; (int)Math.Ceiling((double)TotalItems / ItemsPerPage);

	public bool CanGoNext =&gt; CurrentPage &lt; TotalPages;
	public bool CanGoPrevious =&gt; CurrentPage &gt; 1;

	public string SummaryText =&gt; Language == "zh-CN" ? $"共 {TotalItems} 条 / {TotalPages} 页" : $"total {TotalItems} items / {TotalPages} pages";

	public Paging2ViewModel()
	{
		Language = "zh-CN";
		PageSizeOptions = new ObservableCollection&lt;int&gt; { 10, 20, 50 };
		ItemsPerPage = PageSizeOptions[0];
		CurrentPage = 1;
		UpdatePagination();
	}

	private void UpdatePagination()
	{
		PageNumbers.Clear();
		int totalPages = TotalPages;

		if (totalPages &lt;= _maxVisiblePages)
		{
			for (int i = 1; i &lt;= totalPages; i++)
				AddPageButton(i);
		}
		else
		{
			AddPageButton(1);

			if (CurrentPage &gt; 4)
				AddEllipsis();

			int start = Math.Max(2, CurrentPage - 1);
			int end = Math.Min(totalPages - 1, CurrentPage + 1);

			for (int i = start; i &lt;= end; i++)
				AddPageButton(i);

			if (CurrentPage &lt; totalPages - 3)
				AddEllipsis();

			AddPageButton(totalPages);
		}

		CurrentPageChangedCommand?.Execute(CurrentPage);
		OnPropertyChanged(nameof(SummaryText));
		OnPropertyChanged(nameof(CanGoNext));
		OnPropertyChanged(nameof(CanGoPrevious));
	}

	private void AddPageButton(int number)
	{
		PageNumbers.Add(new PaginationPageNumber
		{
			Display = number.ToString(),
			PageNumber = number,
			IsEnabled = number != CurrentPage
		});
	}

	private void AddEllipsis()
	{
		PageNumbers.Add(new PaginationPageNumber
		{
			Display = "...",
			PageNumber = -1,
			IsEnabled = false
		});
	}

	//partial void OnPageSizeChanged(int value)
	//{
	//    CurrentPage = 1;
	//    OnPropertyChanged(nameof(TotalPages));
	//    OnPropertyChanged(nameof(SummaryText));
	//    //GoToPageCommand(CurrentPage);
	//    UpdatePagination();
	//}


	partial void OnLanguageChanged(string value)
	{
		OnPropertyChanged(nameof(SummaryText));
	}

	public event Action&lt;int, int&gt; PageChanged;
}

public class PaginationPageNumber
{
	public string Display { get; set; } // "1", "...", "5" 等
	public int PageNumber { get; set; }
	public bool IsEnabled { get; set; } = true;
}
</code></pre>
<h2 id="2datagridandpageview-界面展示如下">2.DataGridAndPageView 界面展示如下：</h2>
<h3 id="21-ui界面如下">2.1 UI界面如下：</h3>
<pre><code>&lt;Window x:Class="WPFDemoMVVM.View.DataGridAndPageView"
		 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		 xmlns:local="clr-namespace:WPFDemoMVVM.View"
		 xmlns:hr="clr-namespace:WPFDemoMVVM.Helpers"
		 xmlns:be="clr-namespace:WPFDemoMVVM.Behaviors"
		 xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
		 xmlns:pg="clr-namespace:WPFDemoMVVM.Controls"
		 xmlns:lang="clr-namespace:WPFDemoMVVM.Resources"
		 xmlns:lex="http://wpflocalizeextension.codeplex.com"
		 lex:ResxLocalizationProvider.DefaultAssembly="WPFDemoMVVM"
		 lex:ResxLocalizationProvider.DefaultDictionary="Lang"
		 lex:LocalizeDictionary.DesignCulture="zh-CN"
		 mc:Ignorable="d"
		 WindowStartupLocation="CenterScreen"
		 Style="{DynamicResource WindowBaseCommonStyle}"
		 Height="600" Width="800"&gt;

	&lt;!--穿透属性，使窗口背景透明--&gt;
	&lt;WindowChrome.WindowChrome&gt;
		&lt;WindowChrome CaptionHeight="50"/&gt;
	&lt;/WindowChrome.WindowChrome&gt;

	&lt;Window.Resources&gt;
		&lt;CollectionViewSource x:Key="view" Filter="CollectionViewSource_Filter"/&gt;


		&lt;!--datagrid样式--&gt;
		&lt;Style x:Key="DataGridStyleCommon" TargetType="DataGrid"&gt;
			&lt;Setter Property="RowHeight" Value="40"/&gt;
			&lt;Setter Property="Background"  Value="#191D2A" /&gt;
			&lt;Setter Property="BorderBrush"  Value="{x:Null}" /&gt;
			&lt;Setter Property="Foreground" Value="White"/&gt;
			&lt;Setter Property="Opacity" Value="1"/&gt;
			&lt;!--该属性指示是否允许用户调整列宽度--&gt;
			&lt;Setter Property="CanUserResizeColumns"   Value="false" /&gt;
			&lt;!--网格线颜色--&gt;
			&lt;Setter Property="VerticalGridLinesBrush" Value="{x:Null}"/&gt;
			&lt;Setter Property="IsReadOnly" Value="True"&gt;&lt;/Setter&gt;
			&lt;Setter Property="HorizontalGridLinesBrush"&gt;
				&lt;Setter.Value&gt;
					&lt;SolidColorBrush Color="#10FFFFFF" /&gt;
					&lt;!--网格透明度--&gt;
				&lt;/Setter.Value&gt;
			&lt;/Setter&gt;
			&lt;!--&lt;Setter Property="VerticalGridLinesBrush"&gt;
		 &lt;Setter.Value&gt;
			 &lt;SolidColorBrush Color="#FFEA8777" /&gt;
		 &lt;/Setter.Value&gt;
	 &lt;/Setter&gt;--&gt;
			&lt;!--表格字段显示手动完成--&gt;
			&lt;Setter Property="AutoGenerateColumns" Value="False"&gt;&lt;/Setter&gt;
			&lt;!--隔行换色 --&gt;
			&lt;Setter Property="AlternationCount" Value="3"&gt;&lt;/Setter&gt;
			&lt;!--DataGrid控件模板--&gt;
			&lt;Setter Property="Template"&gt;
				&lt;Setter.Value&gt;
					&lt;ControlTemplate TargetType="{x:Type DataGrid}"&gt;
						&lt;Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" x:Name="border"
						 Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="True"&gt;
							&lt;ScrollViewer x:Name="DG_ScrollViewer" Focusable="false"&gt;
								&lt;ScrollViewer.Template&gt;
									&lt;ControlTemplate TargetType="{x:Type ScrollViewer}"&gt;
										&lt;Grid&gt;
											&lt;Grid.ColumnDefinitions&gt;
												&lt;ColumnDefinition x:Name="col_rowheader" Width="1" /&gt;
												&lt;ColumnDefinition Width="*" /&gt;
												&lt;ColumnDefinition Width="Auto" /&gt;
											&lt;/Grid.ColumnDefinitions&gt;
											&lt;Grid.RowDefinitions&gt;
												&lt;RowDefinition Height="Auto" /&gt;
												&lt;RowDefinition Height="*" /&gt;
												&lt;RowDefinition Height="Auto" /&gt;
											&lt;/Grid.RowDefinitions&gt;
											&lt;!--选中所有行--&gt;
											&lt;Button Command="ApplicationCommands.SelectAll" Focusable="False" Style="{DynamicResource {ComponentResourceKey ResourceId=DataGridSelectAllButtonStyle, TypeInTargetAssembly={x:Type DataGrid}}}" Width="{Binding CellsPanelHorizontalOffset, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type DataGrid}}}"&gt;
												&lt;Button.Visibility&gt;
													&lt;Binding Path="HeadersVisibility" RelativeSource="{RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type DataGrid}}"&gt;
														&lt;Binding.ConverterParameter&gt;
															&lt;DataGridHeadersVisibility&gt;All&lt;/DataGridHeadersVisibility&gt;
														&lt;/Binding.ConverterParameter&gt;
													&lt;/Binding&gt;
												&lt;/Button.Visibility&gt;
											&lt;/Button&gt;
											&lt;!--表格头部--&gt;
											&lt;DataGridColumnHeadersPresenter x:Name="PART_ColumnHeadersPresenter" Grid.Column="1" Grid.ColumnSpan="2"
												 Visibility="{Binding HeadersVisibility, ConverterParameter={x:Static DataGridHeadersVisibility.Column}, Converter={x:Static DataGrid.HeadersVisibilityConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" &gt;
											&lt;/DataGridColumnHeadersPresenter&gt;
											&lt;!--主数据区--&gt;
											&lt;Grid Grid.Row="1" Grid.ColumnSpan="2"&gt;
												&lt;ScrollContentPresenter x:Name="PART_ScrollContentPresenter" CanContentScroll="{TemplateBinding CanContentScroll}" Grid.ColumnSpan="2" /&gt;
											&lt;/Grid&gt;
											&lt;!--垂直滑动条--&gt;

											&lt;ScrollBar x:Name="PART_VerticalScrollBar" Grid.Column="2" Maximum="{TemplateBinding ScrollableHeight}"
												Orientation="Vertical" Grid.Row="0" Grid.RowSpan="3" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
												Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
												ViewportSize="{TemplateBinding ViewportHeight}" /&gt;

											&lt;!--横向滑动条--&gt;
											&lt;!--
									 &lt;ScrollBar x:Name="PART_HorizontalScrollBar" Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="2"
													Maximum="{TemplateBinding ScrollableWidth}" Orientation="Horizontal"
													Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
													Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
													ViewportSize="{TemplateBinding ViewportWidth}" /&gt;--&gt;
										&lt;/Grid&gt;
									&lt;/ControlTemplate&gt;
								&lt;/ScrollViewer.Template&gt;
								&lt;ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" /&gt;
							&lt;/ScrollViewer&gt;
						&lt;/Border&gt;
						&lt;ControlTemplate.Triggers&gt;
							&lt;Trigger Property="IsEnabled" Value="false"&gt;
								&lt;Setter Property="Opacity" Value="1" TargetName="border" /&gt;
							&lt;/Trigger&gt;
						&lt;/ControlTemplate.Triggers&gt;
					&lt;/ControlTemplate&gt;
				&lt;/Setter.Value&gt;
			&lt;/Setter&gt;
			&lt;Style.Triggers&gt;
				&lt;Trigger Property="IsGrouping" Value="true"&gt;
					&lt;Setter Property="ScrollViewer.CanContentScroll" Value="false" /&gt;
				&lt;/Trigger&gt;
			&lt;/Style.Triggers&gt;

		&lt;/Style&gt;

		&lt;!--行头部样式--&gt;
		&lt;Style x:Key="DataGridRowHeaderStyleCommon" TargetType="DataGridRowHeader"&gt;
			&lt;Setter Property="HorizontalContentAlignment" Value="Stretch" /&gt;
			&lt;Setter Property="VerticalContentAlignment" Value="Center" /&gt;
			&lt;Setter Property="Background" Value="Transparent" /&gt;
			&lt;Setter Property="BorderBrush" Value="{x:Null}" /&gt;
			&lt;Setter Property="BorderThickness" Value="1" /&gt;
			&lt;Setter Property="Margin" Value="0,0,0,0" /&gt;
			&lt;Setter Property="Template"&gt;
				&lt;Setter.Value&gt;
					&lt;ControlTemplate TargetType="{x:Type DataGridRowHeader}"&gt;
						&lt;Grid&gt;
							&lt;Border BorderBrush="{TemplateBinding BorderBrush}"
							Background="{TemplateBinding Background}"
							BorderThickness="{TemplateBinding BorderThickness}"
							Padding="{TemplateBinding Padding}"
							Margin="{TemplateBinding Margin}"
							SnapsToDevicePixels="True"&gt;
								&lt;ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
										  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
										  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/&gt;
							&lt;/Border&gt;
						&lt;/Grid&gt;
					&lt;/ControlTemplate&gt;
				&lt;/Setter.Value&gt;
			&lt;/Setter&gt;
		&lt;/Style&gt;

		&lt;!--标题栏 列头部样式--&gt;
		&lt;Style x:Key="DataGridColumnHeaderStyleCommon" TargetType="DataGridColumnHeader"&gt;
			&lt;Setter Property="SnapsToDevicePixels" Value="True" /&gt;
			&lt;Setter Property="MinWidth" Value="15" /&gt;
			&lt;Setter Property="MinHeight" Value="28" /&gt;
			&lt;!--&lt;Setter Property="Foreground" Value="#FF0FA459" /&gt;--&gt;
			&lt;Setter Property="Foreground" Value="{DynamicResource textBoxWhiteColor}" /&gt;
			&lt;Setter Property="FontSize"   Value="14" /&gt;
			&lt;!--&lt;Setter Property="Cursor"     Value="Hand" /&gt;--&gt;
			&lt;Setter Property="Height" Value="30" /&gt;
			&lt;Setter Property="Template"&gt;
				&lt;Setter.Value&gt;
					&lt;ControlTemplate TargetType="DataGridColumnHeader"&gt;
						&lt;!--设置表头的背景等样式--&gt;
						&lt;Border x:Name="BackgroundBorder"  Background="{DynamicResource backgroundGrayColor}"   BorderThickness="0"   BorderBrush="{DynamicResource borderBrushCommonColor}"  Width="Auto"&gt;
							&lt;Grid&gt;
								&lt;Grid.ColumnDefinitions&gt;
									&lt;ColumnDefinition Width="*" /&gt;
								&lt;/Grid.ColumnDefinitions&gt;
								&lt;!--内容--&gt;
								&lt;ContentPresenter  Margin="0,0,0,0"  VerticalAlignment="Center"  HorizontalAlignment="Center" /&gt;
								&lt;!--排序图标--&gt;
								&lt;Path x:Name="SortArrow"  Visibility="Collapsed"   Data="M0,0 L1,0 0.5,1 z"  Stretch="Fill"    Grid.Column="2"    
								   Width="8"  Height="6"  Fill="{DynamicResource textBoxWhiteColor}" Margin="0,0,50,0"  VerticalAlignment="Center"  RenderTransformOrigin="1,1" /&gt;
								&lt;!--分割线--&gt;
								&lt;Rectangle Visibility="Collapsed"  Width="1" Fill="#d6c79b" HorizontalAlignment="Right"  Grid.ColumnSpan="1"   /&gt;
							&lt;/Grid&gt;
						&lt;/Border&gt;
					&lt;/ControlTemplate&gt;
				&lt;/Setter.Value&gt;
			&lt;/Setter&gt;
		&lt;/Style&gt;


		&lt;!--行样式触发--&gt;
		&lt;!--背景色改变必须先设置cellStyle 因为cellStyle会覆盖rowStyle样式--&gt;
		&lt;Style x:Key="DataGridRowStyleCommon"  TargetType="DataGridRow"&gt;
			&lt;Setter Property="Background"  Value="#0D0D19"/&gt;
			&lt;Setter Property="Height"  Value="40" /&gt;
			&lt;Setter Property="Foreground" Value="White" /&gt;
			&lt;Style.Triggers&gt;
				&lt;!--隔行换色--&gt;
				&lt;!--&lt;Trigger Property="AlternationIndex"  Value="0"&gt;
			&lt;Setter Property="Background"   Value="{x:Null}" /&gt;
		&lt;/Trigger&gt;--&gt;
				&lt;!--&lt;Trigger Property="AlternationIndex"   Value="1"&gt;
			&lt;Setter Property="Background" Value="#FFD4C9F9" /&gt;
		&lt;/Trigger&gt;
		&lt;Trigger Property="AlternationIndex"   Value="2"&gt;
			&lt;Setter Property="Background" Value="#FFFFCFC7" /&gt;
		&lt;/Trigger&gt;--&gt;
				&lt;Trigger Property="IsMouseOver"   Value="True"&gt;
					&lt;Setter Property="Foreground" Value="White"/&gt;
					&lt;Setter Property="Background"  Value="#191D2A" /&gt;
					&lt;Setter Property="Cursor" Value="Hand"/&gt;
					&lt;Setter Property="Opacity" Value="0.6"&gt;&lt;/Setter&gt;
				&lt;/Trigger&gt;
				&lt;Trigger Property="IsSelected" Value="True"&gt;
					&lt;!--&lt;Setter Property="Foreground"   Value="#FFF31006" /&gt;--&gt;
					&lt;Setter Property="Opacity" Value="1"&gt;&lt;/Setter&gt;
					&lt;Setter Property="Background" Value="#1D1D2A"/&gt;
				&lt;/Trigger&gt;
			&lt;/Style.Triggers&gt;
		&lt;/Style&gt;

		&lt;!--单元格样式触发--&gt;
		&lt;Style x:Key="DataGridCellStyleCommon" TargetType="DataGridCell"&gt;
			&lt;Setter Property="Template"&gt;
				&lt;Setter.Value&gt;
					&lt;ControlTemplate TargetType="DataGridCell"&gt;
						&lt;TextBlock TextAlignment="Center"  VerticalAlignment="Center"&gt;    
					&lt;ContentPresenter /&gt;
						&lt;/TextBlock&gt;
					&lt;/ControlTemplate&gt;
				&lt;/Setter.Value&gt;
			&lt;/Setter&gt;
			&lt;Style.Triggers&gt;
				&lt;Trigger Property="IsSelected" Value="True"&gt;
					&lt;Setter Property="Foreground" Value="White" /&gt;
					&lt;Setter Property="FontWeight" Value="Bold"/&gt;
				&lt;/Trigger&gt;
				&lt;Trigger Property="IsMouseOver" Value="True"&gt;
					&lt;Setter Property="Foreground" Value="White"/&gt;
				&lt;/Trigger&gt;
			&lt;/Style.Triggers&gt;
		&lt;/Style&gt;



	&lt;/Window.Resources&gt;
	&lt;Grid&gt;
		&lt;Grid.RowDefinitions&gt;
			&lt;RowDefinition Height="30"/&gt;
			&lt;RowDefinition/&gt;
			&lt;RowDefinition Height="40"/&gt;
			&lt;RowDefinition Height="80"/&gt;
		&lt;/Grid.RowDefinitions&gt;

		&lt;StackPanel Grid.Row="0" VerticalAlignment="Center" Orientation="Horizontal" HorizontalAlignment="Right" Margin="5"&gt;
			&lt;Button Content="{lex:Loc Close}" Command="{Binding CloseCommand}" Style="{DynamicResource BtnWindowChangeStyle}"&gt;&lt;/Button&gt;
		&lt;/StackPanel&gt;

		&lt;Grid Grid.Row="1" Height="500" Width="auto"&gt;
			&lt;DataGrid Name="userInfoGrid"  AutoGenerateColumns="False" Height="440" HorizontalAlignment="Left" HorizontalContentAlignment="Center" VerticalAlignment="Top" IsReadOnly="True" CanUserAddRows="False" VerticalScrollBarVisibility="Auto" EnableRowVirtualization="False"                                  
				Style="{DynamicResource ResourceKey=DataGridStyleCommon}"
				   RowHeaderStyle="{DynamicResource ResourceKey=DataGridRowHeaderStyleCommon}"                    
				   ColumnHeaderStyle="{DynamicResource ResourceKey=DataGridColumnHeaderStyleCommon}"                    
				   RowStyle="{DynamicResource ResourceKey=DataGridRowStyleCommon}"                    
				   CellStyle="{DynamicResource ResourceKey=DataGridCellStyleCommon}" Margin="2 0 5 0" BorderThickness="1" ItemsSource="{Binding CollectionView,Mode=OneWay}"
						  hr:MultiSelectorHelper.MonitorSelectionChanged="True"
							hr:MultiSelectorHelper.BindableSelectedItems="{Binding SelectedItems,Mode=OneWayToSource}"
						  &gt;

				&lt;i:Interaction.Behaviors&gt;
					&lt;be:SelectedItemsBehavior BindableSelectedItems="{Binding SelectedItems,Mode=OneWayToSource}"/&gt;
				&lt;/i:Interaction.Behaviors&gt;
				&lt;DataGrid.Columns&gt;
					&lt;DataGridTextColumn Binding="{Binding Index}" CanUserSort="False" IsReadOnly="True" Width="60"&gt;
						&lt;DataGridTextColumn.HeaderTemplate&gt;
							&lt;DataTemplate&gt;
								&lt;TextBlock Text="{lex:Loc Number}"/&gt;
							&lt;/DataTemplate&gt;
						&lt;/DataGridTextColumn.HeaderTemplate&gt;
					&lt;/DataGridTextColumn&gt;
					&lt;DataGridTextColumn Binding="{Binding Name}" CanUserSort="False" IsReadOnly="True" Width="*"&gt;
						&lt;DataGridTextColumn.HeaderTemplate&gt;
							&lt;DataTemplate&gt;
								&lt;TextBlock Text="{lex:Loc AccountName}"/&gt;
							&lt;/DataTemplate&gt;
						&lt;/DataGridTextColumn.HeaderTemplate&gt;
					&lt;/DataGridTextColumn&gt;
					&lt;DataGridTextColumn Binding="{Binding Salary}" CanUserSort="False" IsReadOnly="True" Width="*"&gt;
						&lt;DataGridTextColumn.HeaderTemplate&gt;
							&lt;DataTemplate&gt;
								&lt;TextBlock Text="{lex:Loc Salary}"/&gt;
							&lt;/DataTemplate&gt;
						&lt;/DataGridTextColumn.HeaderTemplate&gt;
					&lt;/DataGridTextColumn&gt;
				&lt;/DataGrid.Columns&gt;
			&lt;/DataGrid&gt;
		&lt;/Grid&gt;

		&lt;pg:Pagination2Control x:Name="pageControl" Grid.Row="2" DataContext="{Binding Pagination}" VerticalAlignment="Bottom" Background="#191D2A" Height="40"&gt;
		&lt;/pg:Pagination2Control&gt;
		&lt;StackPanel Grid.Row="3" Orientation="Horizontal"&gt;
			&lt;TextBlock Text="{lex:Loc AccountName}" Style="{DynamicResource BaseTextBlockStyle}" Margin="5"/&gt;
			&lt;TextBox x:Name="queryKeyword" Text="{Binding QueryKeyword,UpdateSourceTrigger=PropertyChanged}" Width="200" Height="32" Margin="5"/&gt;
			&lt;Button Margin="5" Content="{lex:Loc Add}" Command="{Binding AddCommand}"/&gt;
			&lt;Button Margin="5" Content="{lex:Loc Delete}" Command="{Binding DeleteCommand}"/&gt;
			&lt;Button Margin="5" Content="{lex:Loc Calculate}" Command="{Binding CalculateSumSalaryCommand}" CommandParameter="{Binding ElementName=userInfoGrid,Path=SelectedItems}"/&gt;
			&lt;TextBox Text="{Binding TotalSalary}" Width="100" Height="32" Margin="5"/&gt;
			&lt;ComboBox  Margin="5" Width="100" ItemsSource="{Binding Languages}" SelectedValuePath="Tag" DisplayMemberPath="Name" SelectedValue="{Binding SelectedLanguage, Mode=TwoWay}" Style="{DynamicResource BaseComboBoxStyle}" &gt;
				&lt;i:Interaction.Triggers&gt;
					&lt;i:EventTrigger EventName="SelectionChanged"&gt;
						&lt;i:InvokeCommandAction  Command="{Binding ChangeLanguageCommand}" CommandParameter="{Binding SelectedValue, RelativeSource={RelativeSource AncestorType=ComboBox}}" /&gt;
					&lt;/i:EventTrigger&gt;
				&lt;/i:Interaction.Triggers&gt;
			&lt;/ComboBox&gt;
		&lt;/StackPanel&gt;

	&lt;/Grid&gt;

&lt;/Window&gt;
</code></pre>
<h3 id="22-实现datagridandpageviewmodel的业务逻辑">2.2 实现DataGridAndPageViewModel的业务逻辑：</h3>
<pre><code>public partial class DataGridAndPageViewModel: ObservableObject
{
	public List&lt;EmployeeModel&gt; employees;

	[ObservableProperty]
	ICollectionView collectionView;

	[ObservableProperty]
	string queryKeyword;

	[ObservableProperty]
	IList selectedItems;

	[ObservableProperty]
	private double totalSalary;

	[ObservableProperty]
	public Paging2ViewModel pagination;

	public ObservableCollection&lt;LanguageItem&gt; Languages { get; } = new ObservableCollection&lt;LanguageItem&gt;
	{
		new LanguageItem { Tag = "zh-CN", Name = "中文" },
		new LanguageItem { Tag = "en", Name = "英文" }
	};

	[ObservableProperty]
	private string selectedLanguage;

	public ICommand CloseCommand { get; }
	public DataGridAndPageViewModel()
	{           
		Pagination = new Paging2ViewModel();
		Pagination.PageChanged += OnPageChanged;
		ChangeLanguage("zh-CN");

		IEnumerable&lt;EmployeeModel&gt; employees = EmployeeModel.FakeMany(10);
		this.employees = new List&lt;EmployeeModel&gt;(employees);

		var pageData = this.employees
			.Skip((Pagination.CurrentPage - 1) * Pagination.ItemsPerPage)
			.Take(Pagination.ItemsPerPage)
			.Select((e, i) =&gt;
			{
				e.Index = (Pagination.CurrentPage - 1) * Pagination.ItemsPerPage + i + 1;
				return e;
			}).ToList();

		CollectionView = CollectionViewSource.GetDefaultView(pageData);

		Pagination.TotalItems = this.employees.Count;


		CloseCommand = new RelayCommand(() =&gt;
		{
			// 发送关闭窗口的消息
			WeakReferenceMessenger.Default.Send(new CloseWindowMessage("DataGridAndPageView"));
		});
	}


	partial void OnQueryKeywordChanged(string value)
	{
		Pagination.CurrentPage = 1; // 筛选后回到第一页
		OnPageChanged(Pagination.CurrentPage, Pagination.ItemsPerPage);
	}

	[RelayCommand]
	private void ChangeLanguage(string languageCode)
	{
		SelectedLanguage = languageCode;
		Pagination.Language = languageCode;
		var culture = new CultureInfo(languageCode);
		Thread.CurrentThread.CurrentCulture = culture;
		Thread.CurrentThread.CurrentUICulture = culture;
		LocalizeDictionary.Instance.Culture = culture;
	}


	private void OnPageChanged(int currentPage, int pageSize)
	{
		var filtered = employees.Where(e =&gt; string.IsNullOrEmpty(QueryKeyword) || e.Name.Contains(QueryKeyword, StringComparison.OrdinalIgnoreCase)).ToList();
		Pagination.TotalItems = filtered.Count;

		//重新生成索引 number从1开始
		var pageData = filtered
			.Skip((currentPage - 1) * pageSize)
			.Take(pageSize)
			.Select((e, i) =&gt;
			{
				e.Index = (currentPage - 1) * pageSize + i + 1;
				return e;
			}).ToList();

		CollectionView = CollectionViewSource.GetDefaultView(pageData);

	}


	[RelayCommand]
	public void Add()
	{
		employees.Add(EmployeeModel.FakeOne());
		OnPageChanged(Pagination.CurrentPage, Pagination.ItemsPerPage);
	}

	[RelayCommand]
	public void Delete()
	{
		if (SelectedItems != null)
		{
			employees.RemoveAll(e =&gt; SelectedItems.Contains(e));
			OnPageChanged(Pagination.CurrentPage, Pagination.ItemsPerPage);
		}
	}


	[RelayCommand]
	public void CalculateSumSalary()
	{
		if (SelectedItems != null)
		{
			var sum = SelectedItems.Cast&lt;EmployeeModel&gt;().Sum(x =&gt; ((EmployeeModel)x).Salary);
			TotalSalary = sum;
		}

		foreach (var item in employees)
		{
			item.IsSelected = item.Salary &gt; 15000;
		}
		collectionView.Refresh();
	}

}
</code></pre>
<h2 id="3运行效果如下">3.运行效果如下：</h2>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2212230/202507/2212230-20250720234631365-216184456.png" class="lazyload"></p>
<p><strong>分页显示</strong></p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2212230/202507/2212230-20250720234816161-6453789.png" class="lazyload"></p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2212230/202507/2212230-20250720235017874-915759449.png" class="lazyload"></p>
<p><strong>超过7页后，显示“....”</strong>：</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2212230/202507/2212230-20250720235131413-103893035.png" class="lazyload"></p>
<p>源代码地址：<a href="https://gitee.com/chenshibao/wpfdemo.git" target="_blank" rel="noopener nofollow">https://gitee.com/chenshibao/wpfdemo.git</a></p>
<p><strong>如果本文介绍对你有帮助，可以一键四连：点赞+评论+收藏+推荐，谢谢！</strong></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-20 23:52">2025-07-20 23:51</span>&nbsp;
<a href="https://www.cnblogs.com/chenshibao">似梦亦非梦</a>&nbsp;
阅读(<span id="post_view_count">166</span>)&nbsp;
评论(<span id="post_comment_count">4</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18994852);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18994852', targetLink: 'https://www.cnblogs.com/chenshibao/p/18994852', title: 'WPF开发中实现DataGrid中的数据分页显示，自定义分页样式（与上一篇不同的分页）' })">举报</a>
</div>
        