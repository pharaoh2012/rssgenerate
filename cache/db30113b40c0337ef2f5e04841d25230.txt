
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lucky_hu/p/19018899" title="发布于 2025-08-02 15:51">
    <span role="heading" aria-level="2">Coze工作流实战：一键上传excel生成数据图表</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="导航">导航</h3>
<ul>
<li>前言</li>
<li>工作流实现效果</li>
<li>操作步骤</li>
<li>调试</li>
<li>结语</li>
<li>Excel数据案例</li>
<li>参考</li>
</ul>
<blockquote>
<p>本文首发<a href="https://www.52interview.com/solutions/99" target="_blank" rel="noopener nofollow">《Coze工作流实战：一键上传excel生成数据图表》</a>，共计1500字，阅读时长3min。</p>
</blockquote>
<h2 id="前言">前言</h2>
<p>在日常工作中，数据统计是一个很常见的需求。</p>
<p>大部分人同学能把数据统计出来，按照各种维度汇总成为一个excel表格。</p>
<p>如果能再进一步，将这些数据，转化为图表，那就更加直观了。</p>
<p>这样的交付结果，一定也能让领导和同事眼前一亮。</p>
<p>今天，我们就尝试通过Coze工作流来实现excel生成数据图表!</p>
<p>欢迎点赞、收藏、关注。</p>
<h2 id="工作流实现效果">工作流实现效果</h2>
<br>
<section>
    <a href="https://img.zhikestreet.com/1754116924718-min.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/1754116924718-min.png" alt=""></a>
</section> 
<br>
<h3 id="工作流展示">工作流展示</h3>
<br>
<section>
    <a href="https://img.zhikestreet.com/2025-08-02_133950_185.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/2025-08-02_133950_185.png" alt=""></a>
</section> 
<br>
<h3 id="操作步骤">操作步骤</h3>
<h4 id="1创建工作流">1、创建工作流</h4>
<p>登录扣子(coze)平台:<a href="https://www.coze.cn/studio" target="_blank" rel="noopener nofollow">https://www.coze.cn/studio</a></p>
<ul>
<li>选择"开发平台"-&gt;"快速开始"</li>
<li>在左侧选择"+",选择"创建应用"，给应用起一个名称，并选择"确认"</li>
<li>在左侧资源库页面右上角单击 +资源，并选择工作流。</li>
<li>设置工作流的名称与描述，并单击确认。</li>
</ul>
<blockquote>
<p>如果没有账户，可以先注册一个，coze空间已经全面开开放，免费使用。</p>
</blockquote>
<br>
<section>
    <a href="https://img.zhikestreet.com/20250614144143.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/20250614144143.png" alt=""></a>
</section> 
<br>
<h4 id="2开始节点">2、开始节点</h4>
<p>开始节点，作为入口。<br>
设置两个变量</p>
<ul>
<li>input：用户输入excel表格,excel文件类型</li>
<li>chartType：期望的图表类型，支持柱状图、折线图、雷达图、饼图</li>
</ul>
<blockquote>
<p>这里的输入变量，都要求必填</p>
</blockquote>
<br>
<section>
    <a href="https://img.zhikestreet.com/2025-08-02_134224_353.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/2025-08-02_134224_353.png" alt=""></a>
</section> 
<br>
<h4 id="3excel内容读取节点">3、Excel内容读取节点</h4>
<blockquote>
<p>Notes: 这里使用的是ReadFile插件。<a href="https://www.coze.cn/store/plugin/7379907202049572903" target="_blank" rel="noopener nofollow">https://www.coze.cn/store/plugin/7379907202049572903</a></p>
</blockquote>
<ul>
<li>url: Excel地址</li>
<li>sheetName: Excel的sheet页名称，不输入则读取第一个sheet页</li>
</ul>
<br>
<section>
    <a href="https://img.zhikestreet.com/2025-08-02_134808_401.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/2025-08-02_134808_401.png" alt=""></a>
</section> 
<br>
<h4 id="4条件判断节点">4、条件判断节点</h4>
<p>目前支持柱状图、折线图、雷达图、饼图四种类型，根据用户输入的chartType，进行判断，并输出对应的变量。</p>
<br>
<section>
    <a href="https://img.zhikestreet.com/2025-08-02_135107_496.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/2025-08-02_135107_496.png" alt=""></a>
</section> 
<br>
<p>Coze上的"图表大师"插件，用于生成图表，分别对应不同类型的图表生成。</p>
<h4 id="5大模型_excel转提示词节点">5、大模型_excel转提示词节点</h4>
<br>
<section>
    <a href="https://img.zhikestreet.com/2025-08-02_135555_511.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/2025-08-02_135555_511.png" alt=""></a>
</section> 
<br>
<p>这里分别对应：</p>
<ul>
<li>大模型_饼图数据转化</li>
<li>大模型_柱状图数据转化</li>
<li>大模型_折线图数据转化</li>
<li>大模型_雷达图数据转化</li>
<li>大模型_通用图表数据转化</li>
</ul>
<p>这里以"大模型_折线图数据转化"为例，输入为excel文件，输出为饼图数据提示词。</p>
<pre><code class="language-md">
## 角色定义
专业数据分析助手，专注于将结构化数据转化为可视化图表和可操作的业务洞察。

## 核心功能
### 1. 数据分析
- **趋势分析**：识别增长/下降/波动模式
- **关键指标**：
  - 计算月环比增长率
  - 标记峰值/谷值及出现时间
  - 统计平均值和中位数
- **业务洞察**：提供3-5条基于数据的建议
- **异常检测**：标注异常波动并提供可能解释

### 2. 输出结构
- 输出符合“图表大师”标准折线图JSON结构，输出结果中要求legend=1
{
  "data": "[45,52]",
  "legend": 1,
  "name": "营收",
  "title": "Q1-Q2营收增长15.6%",
  "xAxis": {
    "data": "[\"Q1\",\"Q2\"]",
    "name": "季度",
    "type": "category"
  },
  "yAxis": {
    "name": "营收（万元）",
    "type": "value"
  },
  "areaStyle": {
    "opacity": 1
  }
}
</code></pre>
<h4 id="6图表组件节点">6、图表组件节点</h4>
<br>
<section>
    <a href="https://img.zhikestreet.com/2022025-08-02_140546_961.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/2025-08-02_140546_961.png" alt=""></a>
</section> 
<br>
<p>接收大模型输出的json数据，并生成对应的图表。</p>
<h4 id="7结束节点">7、结束节点</h4>
<br>
<section>
    <a href="https://img.zhikestreet.com/2025-08-02_140832_567.png" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/2025-08-02_140832_567.png" alt=""></a>
</section> 
<br>
<p>至此工作流搭建完毕。</p>
<h3 id="调试">调试</h3>
<p>接下来，选择"试运行"，运行后，会生成对应的图表。<br>
<br></p>
<section>
    <a href="https://img.zhikestreet.com/202508021536.jpg" data-lightbox="example-set" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/202508021536.jpg" alt=""></a>
</section> 
<br>
<p>运行完成之后，可以从输出中查看结果。<br>
然后复制图片链接下即可。</p>
<h3 id="结语">结语</h3>
<p>AI工作流适用于解决一些复杂问题。</p>
<p>这对于不会写程序的人来说，是一个可以落地的工具。</p>
<p>2025年，很多企业已经开始推送AI的落地应用，比如构建智能体，构建AI应用等。</p>
<p>当然，AI工作流还有很长的路要走，但已经可以解决很多实际问题了。</p>
<h3 id="excel数据案例仅供参考">Excel数据案例（仅供参考）</h3>
<h4 id="饼图">饼图</h4>
<table>
<thead>
<tr>
<th>渠道</th>
<th>销售额（万元）</th>
</tr>
</thead>
<tbody>
<tr>
<td>天猫旗舰店</td>
<td>180</td>
</tr>
<tr>
<td>京东自营</td>
<td>120</td>
</tr>
<tr>
<td>拼多多</td>
<td>80</td>
</tr>
<tr>
<td>抖音直播</td>
<td>60</td>
</tr>
<tr>
<td>官网直销</td>
<td>40</td>
</tr>
</tbody>
</table>
<h4 id="折线图">折线图</h4>
<table>
<thead>
<tr>
<th>月份</th>
<th>销售额</th>
</tr>
</thead>
<tbody>
<tr>
<td>1月</td>
<td>12000</td>
</tr>
<tr>
<td>2月</td>
<td>15000</td>
</tr>
<tr>
<td>3月</td>
<td>18000</td>
</tr>
<tr>
<td>4月</td>
<td>16000</td>
</tr>
<tr>
<td>5月</td>
<td>20000</td>
</tr>
<tr>
<td>6月</td>
<td>22000</td>
</tr>
<tr>
<td>7月</td>
<td>25000</td>
</tr>
<tr>
<td>8月</td>
<td>23000</td>
</tr>
<tr>
<td>9月</td>
<td>28000</td>
</tr>
<tr>
<td>10月</td>
<td>30000</td>
</tr>
<tr>
<td>11月</td>
<td>32000</td>
</tr>
<tr>
<td>12月</td>
<td>35000</td>
</tr>
</tbody>
</table>
<h4 id="柱状图">柱状图</h4>
<table>
<thead>
<tr>
<th>季度</th>
<th>产品A</th>
<th>产品B</th>
<th>产品C</th>
</tr>
</thead>
<tbody>
<tr>
<td>Q1</td>
<td>1200</td>
<td>800</td>
<td>1500</td>
</tr>
<tr>
<td>Q2</td>
<td>1500</td>
<td>950</td>
<td>1800</td>
</tr>
<tr>
<td>Q3</td>
<td>1800</td>
<td>1100</td>
<td>2000</td>
</tr>
<tr>
<td>Q4</td>
<td>2000</td>
<td>1300</td>
<td>2200</td>
</tr>
</tbody>
</table>
<h4 id="雷达图">雷达图</h4>
<table>
<thead>
<tr>
<th>能力维度</th>
<th>员工A</th>
<th>员工B</th>
<th>员工C</th>
<th>满分值</th>
</tr>
</thead>
<tbody>
<tr>
<td>沟通能力</td>
<td>85</td>
<td>90</td>
<td>70</td>
<td>100</td>
</tr>
<tr>
<td>技术能力</td>
<td>95</td>
<td>75</td>
<td>85</td>
<td>100</td>
</tr>
<tr>
<td>团队合作</td>
<td>80</td>
<td>85</td>
<td>90</td>
<td>100</td>
</tr>
<tr>
<td>创新能力</td>
<td>70</td>
<td>80</td>
<td>75</td>
<td>100</td>
</tr>
<tr>
<td>工作效率</td>
<td>90</td>
<td>70</td>
<td>95</td>
<td>100</td>
</tr>
</tbody>
</table>
<h3 id="参考">参考</h3>
<ul>
<li><a href="https://www.coze.cn/open/docs/guides" target="_blank" rel="noopener nofollow">《Coze官方文档》</a></li>
<li><a href="https://www.coze.cn/store/plugin?cate_type=recommend&amp;cate_value=recommend" target="_blank" rel="noopener nofollow">《Coze插件商店》</a></li>
</ul>
<br>
<section>
 <a href="https://www.52interview.com/solutions/99" target="_blank" rel="noopener nofollow"><img style="display: block; margin-left: auto; margin-right: auto" src="https://img.zhikestreet.com/20210522-22216942.jpg" alt=""></a>
</section> 
<br>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-08-02 15:51">2025-08-02 15:51</span>&nbsp;
<a href="https://www.cnblogs.com/lucky_hu">楠木大叔</a>&nbsp;
阅读(<span id="post_view_count">101</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19018899);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19018899', targetLink: 'https://www.cnblogs.com/lucky_hu/p/19018899', title: 'Coze工作流实战：一键上传excel生成数据图表' })">举报</a>
</div>
        