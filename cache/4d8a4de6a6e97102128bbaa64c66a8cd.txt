
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/BFMC/p/18767134" title="发布于 2025-03-12 14:00">
    <span role="heading" aria-level="2">MySql 主从(备)部署 | 冷备份</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h1>前言</h1>
<p>MySQL 主从复制（Master-Slave Replication）是一种常见的数据库架构设计，用于提高数据可用性、实现读写分离以及支持备份策略。<br>冷备份是指在数据库关闭状态下进行的数据备份方式。这种方式简单直接，但需要导致服务中断。<br>在数据库管理中，确保数据的高可用性和灾难恢复能力是至关重要的。MySQL 通过主从复制（Master-Slave Replication）和冷备份（Cold Backup）为用户提供了一套完整的解决方案</p>
<h1>准备</h1>
<p>1，分别在两台电脑上安装mysql（尽量保障mysql版本一样）。</p>
<p><strong>PS:可以在一台电脑上弄，需要注意端口之类的。</strong></p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312110936380-12021200.png" alt="" loading="lazy"></p>
<p>2，安装后查看数据库的目录，本次演示使用默认安装。</p>
<p>　　MySQL Server 程序文件的安装位置：</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312111517694-396007810.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>　　此目录主要用于存放数据文件、配置文件以及日志文件等</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312111459135-729099686.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<h1>主从部署</h1>
<h3><strong>Master（主机）</strong></h3>
<p>1，打开服务找到对应的mysql服务进行关闭：</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312114401854-1349620313.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>2，打开my.ini文件。在图中位置增加以下内容：</p>
<p>增加内容的意思是，一下这几个数据库会同步到从机上。</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312112412609-23251869.png" alt="" loading="lazy"></p>
<p>&nbsp;3，在master数据库中创建一个账号，用于给slave使用，因为slave需要连接到master，然后下载binlog，那么就必须给它分配一个账号，而且账号权限只能用于同步binlog。</p>
<p>运行如下sql语句：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">CREATE USER 'slave'@'%' IDENTIFIED BY '123456';#创建新的账号，账号名称为slave，密码为123456
GRANT REPLICATION SLAVE ON *.* TO 'slave'@'%'; #赋予账号slave同步binlog的权限
FLUSH PRIVILEGES;#刷新一下</pre>
</div>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312114801301-1765777031.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>4，在主机的数据库中运行语句，记住返回的参数需要用。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">show master status  
</pre>
</div>
<p>　</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312114957066-329686536.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<h3><strong>Slave（从机）</strong></h3>
<p>1，同样停止服务并打开my.ini文件。修改增加以下内容：</p>
<p>注意这里的server-id不能重复</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312133451014-1074488929.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>&nbsp;2，所有文件配置就ok了。修改之后重启mysql服务。</p>
<p>&nbsp;</p>
<p>3，新增sql脚本，输入以下脚本，其中&nbsp;master_log_file 和 master_log_pos 是主机的数据。<em id="__mceDel" style="font-family: &quot;Courier New&quot;; font-size: 12px"><span style="background-color: rgba(248, 248, 248, 1)">stop slave;</span></em></p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">#master服务器的ip地址
CHANGE MASTER TO master_host='192.168.1.100',
#第5步中创建的账号
master_user='slave',
#第5步中创建的密码
master_password='123456',
#上一步中的File
master_log_file='ECS-56099351-bin.000002',
#上一步中的Position
master_log_pos= 2840,
get_master_public_key=1;
start slave;
</pre>
</div>
<p>&nbsp;</p>
<p>4，查看下线程状态。如果两个都是yes证明就可以了。</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312134913998-1382875899.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>5，我们试着给master主机的db数据库中写入一些数据，发现从机中也是有的。</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312135442170-1029263470.png" alt="" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312135533331-637042086.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>冷备份</h1>
<p>1，同样需要把mysql的服务停掉。</p>
<p>2，我们找到数据文件夹中，把下面两个文件压缩打包备份。</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312135636374-92574045.png" alt="" loading="lazy"></p>
<p>&nbsp;3，把打包后的文件，解压到需要恢复的数据库目录中解压</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312135739880-268712477.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<p>4，打开server服务，然后我们使用新备份的账号密码登陆看一下恢复情况。</p>
<p>&nbsp;</p>
<p><img src="https://img2024.cnblogs.com/blog/1266469/202503/1266469-20250312140000076-604634064.png" alt="" loading="lazy"></p>
<p>&nbsp;</p>
<h1>结语</h1>
<p>需要注意的是，虽然主从复制能够大大提高系统的可用性，但并不能完全代替备份策略。合理结合使用冷备份等备份方法，才能更好地保护数据安全。</p>
<p>参考文献：</p>
<p><a href="https://www.bilibili.com/opus/832990670635401267" rel="noopener nofollow">实战讲解mysql8主从复制(windows版) - 哔哩哔哩</a></p>
</div>
<div id="MySignature" role="contentinfo">
    从前慢，车马慢。
一生只爱一个人。
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.7955329487268519" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-12 14:00">2025-03-12 14:00</span>&nbsp;
<a href="https://www.cnblogs.com/BFMC">黄金程序员</a>&nbsp;
阅读(<span id="post_view_count">219</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18767134" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18767134);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18767134', targetLink: 'https://www.cnblogs.com/BFMC/p/18767134', title: 'MySql 主从(备)部署 | 冷备份' })">举报</a>
</div>
        