
<table cellspacing="0" cellpadding="0"><tbody><tr><td class="t_f" id="postmessage_52866939">
<font size="5">问题描述</font><br>
<font color="#c0c0c0">系统信息：</font><br>
<font color="#c0c0c0">版本 Windows 11 企业版</font><br>
<font color="#c0c0c0">版本号 24H2</font><br>
<font color="#c0c0c0">安装日期 &amp;#8206;2025/&amp;#8206;3/&amp;#8206;25</font><br>
<font color="#c0c0c0">操作系统版本 26100.3775</font><br>
<font color="#c0c0c0">体验 Windows 功能体验包 1000.26100.66.0</font><br>
<font color="#c0c0c0">设备名称 ITB*****17</font><br>
<font color="#c0c0c0">设备全名 ITB*****17.s****i.com</font><br>
<font color="#c0c0c0">处理器 Intel(R) Core(TM) Ultra 5 225H 1.70 GHz</font><br>
<font color="#c0c0c0">机带 RAM 32.0 GB (31.4 GB 可用)</font><br>
<font color="#c0c0c0">设备 ID D31629******************A</font><br>
<font color="#c0c0c0">产品 ID 00328******************M</font><br>
<font color="#c0c0c0">系统类型 64 位操作系统, 基于 x64 的处理器</font><br>
<font color="#c0c0c0">笔和触控 没有可用于此显示器的笔或触控输入</font><br>
<br>
<font size="3"><strong>卸载Edge原因</strong></font><br>
在Edge浏览器中打开任意网页进行文件上传时出现卡死现象，浏览器打开文件选择器，在选择器中选择任意类型、大小的文件后点击确认按钮就出现选择器卡顿现象，基本卡住十几二十秒之后才消失，文件得以选中上传，切换其他浏览器(chrome等)不会出现此问题。<br>
卸载Edge用到的工具是52吧友分享的：EdgeRemover.exe(EdgeRemover v18 - 吾爱<a href="https://www.52pojie.cn" target="_blank" class="relatedlink">破解</a> - 52pojie.cn)<br>
<font size="3"><strong>安装Edge</strong></font><br>
<br>
<br>
安装方式一：将Edge卸载后（webview2并未卸载），再从edge官网重新下载进行安装【MicrosoftEdgeSetup.exe】出现如下信息：<br>
<img id="aimg_FxQiM" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" file="https://s3.bmp.ovh/imgs/2025/04/10/16a4f0b280ce5186.png" onmouseover="img_onmouseoverfunc(this)" lazyloadthumb="1" border="0" alt="" src="https://s3.bmp.ovh/imgs/2025/04/10/16a4f0b280ce5186.png"><br>
安装方式二：尝试使用【edge.msi】进行安装，出现如图报错信息：<br>
<img id="aimg_iuB0H" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" file="https://s3.bmp.ovh/imgs/2025/04/10/f5efebbc6ed08018.png" onmouseover="img_onmouseoverfunc(this)" lazyloadthumb="1" border="0" alt="" src="https://s3.bmp.ovh/imgs/2025/04/10/f5efebbc6ed08018.png"><br>
附运行日志：<br>
<div style="padding:15px 0;"><div style="font-size:12px;">[Bash shell] <em class="viewsource" style="cursor:pointer;font-size:12px;color:#369 !important;">纯文本查看</em> <em class="copycode" style="cursor:pointer;font-size:12px;color:#369 !important;">复制代码</em></div><pre class="brush: bash; gutter: true">=== Logging started: 2025/4/10 20:40:53 ===

Action start 20:40:53: INSTALL.

Action start 20:40:53: FindRelatedProducts.

Action ended 20:40:53: FindRelatedProducts. Return value 1.

Action start 20:40:54: AppSearch.

Action ended 20:40:54: AppSearch. Return value 1.

Action start 20:40:54: ValidateProductID.

Action ended 20:40:54: ValidateProductID. Return value 1.

Action start 20:40:54: CostInitialize.

Action ended 20:40:54: CostInitialize. Return value 1.

Action start 20:40:54: FileCost.

Action ended 20:40:54: FileCost. Return value 1.

Action start 20:40:54: CostFinalize.

Action ended 20:40:54: CostFinalize. Return value 1.

Action start 20:40:54: InstallValidate.

Action ended 20:40:54: InstallValidate. Return value 1.

Action start 20:40:54: RemoveExistingProducts.

Action ended 20:40:54: RemoveExistingProducts. Return value 1.

Action start 20:40:54: InstallInitialize.

Action ended 20:40:54: InstallInitialize. Return value 1.

Action start 20:40:54: ProcessComponents.

Action ended 20:40:54: ProcessComponents. Return value 1.

Action start 20:40:54: UnpublishFeatures.

Action ended 20:40:54: UnpublishFeatures. Return value 1.

Action start 20:40:54: RemoveRegistryValues.

Action ended 20:40:54: RemoveRegistryValues. Return value 1.

Action start 20:40:54: RemoveFiles.

Action ended 20:40:54: RemoveFiles. Return value 0.

Action start 20:40:54: InstallFiles.

Action ended 20:40:54: InstallFiles. Return value 1.

Action start 20:40:54: SetOptArgsProperty.

Action ended 20:40:54: SetOptArgsProperty. Return value 1.

Action start 20:40:54: ExtractTagInfoFromInstaller.

Action ended 20:40:54: ExtractTagInfoFromInstaller. Return value 1.

Action start 20:40:54: SetProductTagProperty.

Action ended 20:40:54: SetProductTagProperty. Return value 1.

Action start 20:40:54: AppendCustomParamsToProductTagProperty.

Action ended 20:40:54: AppendCustomParamsToProductTagProperty. Return value 1.

Action start 20:40:54: BuildInstallCommand.

Action ended 20:40:54: BuildInstallCommand. Return value 1.

Action start 20:40:54: SetAppGuidProperty.

Action ended 20:40:54: SetAppGuidProperty. Return value 1.

Action start 20:40:54: ShowInstallerResultUIString.

Action ended 20:40:54: ShowInstallerResultUIString. Return value 1.

Action start 20:40:54: DoInstall.

Action ended 20:40:55: DoInstall. Return value 1.

Action start 20:40:55: WriteRegistryValues.

Action ended 20:40:55: WriteRegistryValues. Return value 1.

Action start 20:40:55: RegisterUser.

Action ended 20:40:55: RegisterUser. Return value 1.

Action start 20:40:55: RegisterProduct.

Action ended 20:40:55: RegisterProduct. Return value 1.

Action start 20:40:55: PublishFeatures.

Action ended 20:40:55: PublishFeatures. Return value 1.

Action start 20:40:55: PublishProduct.

Action ended 20:40:55: PublishProduct. Return value 1.

Action start 20:40:55: InstallFinalize.

CustomAction DoInstall returned actual error code -2147219438 (note this may not be 100% accurate if translation happened inside sandbox)

MSI (s) (30:AC) [20:41:31:728]: Product: Microsoft Edge -- Error 1722. There is a problem with this Windows Installer package. A program run as part of the setup did not finish as expected. Contact your support personnel or package vendor. Action DoInstall, location: C:\WINDOWS\Installer\MSIBAA4.tmp, command: /silent /install "appguid={56EB18F8-B008-4CBD-B6D2-8C97FE7E9062}&amp;appname=Microsoft Edge&amp;needsAdmin=True&amp;usagestats=0&amp;ap=stable-arch_x64" /installsource enterprisemsi /appargs "appguid={56EB18F8-B008-4CBD-B6D2-8C97FE7E9062}&amp;installerdata=%7B%22distribution%22%3A%7B%22msi%22%3Atrue%2C%22system_level%22%3Atrue%2C%22verbose_logging%22%3Atrue%2C%22msi_product_id%22%3A%22EE51ED96-8814-3D8D-8AFE-DE0338B3FD2D%22%2C%22allow_downgrade%22%3Afalse%2C%22do_not_create_desktop_shortcut%22%3Afalse%2C%22do_not_create_taskbar_shortcut%22%3Afalse%7D%7D"


Error 1722. There is a problem with this Windows Installer package. A program run as part of the setup did not finish as expected. Contact your support personnel or package vendor. Action DoInstall, location: C:\WINDOWS\Installer\MSIBAA4.tmp, command: /silent /install "appguid={56EB18F8-B008-4CBD-B6D2-8C97FE7E9062}&amp;appname=Microsoft Edge&amp;needsAdmin=True&amp;usagestats=0&amp;ap=stable-arch_x64" /installsource enterprisemsi /appargs "appguid={56EB18F8-B008-4CBD-B6D2-8C97FE7E9062}&amp;installerdata=%7B%22distribution%22%3A%7B%22msi%22%3Atrue%2C%22system_level%22%3Atrue%2C%22verbose_logging%22%3Atrue%2C%22msi_product_id%22%3A%22EE51ED96-8814-3D8D-8AFE-DE0338B3FD2D%22%2C%22allow_downgrade%22%3Afalse%2C%22do_not_create_desktop_shortcut%22%3Afalse%2C%22do_not_create_taskbar_shortcut%22%3Afalse%7D%7D"

Action ended 20:41:31: InstallFinalize. Return value 3.

Action ended 20:41:31: INSTALL. Return value 3.

MSI (s) (30:AC) [20:41:31:819]: Product: Microsoft Edge -- Installation failed.


MSI (s) (30:AC) [20:41:31:820]: Windows Installer 已安装产品。产品名称: Microsoft Edge。产品版本: 135.0.3179.66。产品语言: 1033。制造商: Microsoft Corporation。安装成功或错误状态: 1603。


=== Logging stopped: 2025/4/10 20:41:31 ===</pre></div><br>
<br>
<hr class="l"><br>
<font size="5">解决方案</font><br>
<font size="2">经过不断尝试，我在微软社区提出了这样的问题，终于在社区大佬的帮助下解决了我的问题</font><br>
<font size="2">使用管理员身份的CMD执行下面的命令，之后再重启尝试安装Edge，便解决了我的问题，同时还解决了文件选择器卡死的问题</font><img src="https://static.52pojie.cn/static/image/smiley/default/lol.gif" smilieid="12" border="0" alt=""><br>
<br>
<div style="padding:15px 0;"><div style="font-size:12px;">[Bash shell] <em class="viewsource" style="cursor:pointer;font-size:12px;color:#369 !important;">纯文本查看</em> <em class="copycode" style="cursor:pointer;font-size:12px;color:#369 !important;">复制代码</em></div><pre class="brush: bash; gutter: true">reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies" /f
reg delete "HKCU\Software\Microsoft\WindowsSelfHost" /f
reg delete "HKCU\Software\Policies" /f
reg delete "HKLM\Software\Microsoft\Policies" /f
reg delete "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies" /f
reg delete "HKLM\Software\Microsoft\Windows\CurrentVersion\WindowsStore\WindowsUpdate" /f
reg delete "HKLM\Software\Microsoft\WindowsSelfHost" /f
reg delete "HKLM\Software\Policies" /f
reg delete "HKLM\Software\WOW6432Node\Microsoft\Policies" /f
reg delete "HKLM\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Policies" /f
reg delete "HKLM\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\WindowsStore\WindowsUpdate" /f</pre></div><br>
<br>
<img id="aimg_hpUem" onclick="zoom(this, this.src, 0, 0, 0)" class="zoom" file="https://s3.bmp.ovh/imgs/2025/04/14/aada16f7aeff5880.png" onmouseover="img_onmouseoverfunc(this)" lazyloadthumb="1" border="0" alt="" src="https://s3.bmp.ovh/imgs/2025/04/14/aada16f7aeff5880.png"><br>
<font size="2"><font color="#ff0000">希望这个分享对所有有相似情形的同学能有所帮助，这里是我在微软社区提的问题原文，有需要的朋友可以点开查看：</font></font><br>
<font size="2"><font color="#ff0000">https://answers.microsoft.com/zh-hans/microsoftedge/forum/all/%E5%8D%B8%E8%BD%BDedge%E5%90%8E%E9%87%8D%E6%96%B0/8deecb1d-d6bf-409b-afe1-255dec38a352</font></font></td></tr></tbody></table>


