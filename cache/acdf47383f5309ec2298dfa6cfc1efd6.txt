
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/supermao12/p/18745741" title="发布于 2025-03-02 08:08">
    <span role="heading" aria-level="2">ragflow-ollama 知识库建立测试</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="ollama查看模型">ollama查看模型</h3>
<pre><code class="language-powershell">C:\Users\DK&gt;ollama show deepseek-r1:7b
  Model
    architecture        qwen2
    parameters          7.6B
    context length      131072
    embedding length    3584
    quantization        Q4_K_M

  Parameters
    stop    "&lt;｜begin▁of▁sentence｜&gt;"
    stop    "&lt;｜end▁of▁sentence｜&gt;"
    stop    "&lt;｜User｜&gt;"
    stop    "&lt;｜Assistant｜&gt;"

  License
    MIT License
    Copyright (c) 2023 DeepSeek


C:\Users\DK&gt;
</code></pre>
<ol>
<li>架构 (architecture): qwen2<br>
表示该模型的架构类型是 qwen2，这通常指的是模型所采用的具体神经网络架构设计。不同架构会影响模型的训练效率、推理速度、效果等。</li>
<li>参数量 (parameters): 7.6B (76亿)<br>
该模型有约76亿个参数。参数量是衡量一个深度学习模型大小的标准，通常与模型的学习能力、性能有关。参数越多，模型的潜在能力越强，但同时也可能需要更多的计算资源。</li>
<li>上下文长度 (context length): 131072<br>
这个参数表示模型能够处理的最大上下文窗口的大小，即在一次推理中能够考虑的最大输入文本长度。这里是131072个token（词元），说明该模型能够处理非常长的文本输入。</li>
<li>嵌入维度 (embedding length): 3584<br>
嵌入维度表示每个token或单词在模型内部表示的向量的维度。嵌入维度越高，通常模型能捕捉的语义信息越丰富。这里的值是3584。</li>
<li>量化方式 (quantization): Q4_K_M<br>
量化是指对模型权重进行压缩，以减少内存使用并加速推理。在这里使用了 Q4_K_M 量化方案。Q4代表使用4位量化，K和M可能是特定的量化策略细节（如如何映射权重值）。</li>
<li>停止符号 (stop tokens):<br>
"&lt;｜begin▁of▁sentence｜&gt;", "&lt;｜end▁of▁sentence｜&gt;", "&lt;｜User｜&gt;", "&lt;｜Assistant｜&gt;"<br>
这些是模型用来标记对话开始、结束和区分角色的特殊token。它们帮助模型理解何时开始生成回答，何时结束，以及对话中的哪个部分属于用户，哪个属于助手。</li>
<li>许可证 (License): MIT License<br>
该模型遵循MIT开源许可证，意味着你可以自由使用、修改、分发该模型，但需要附带原作者的版权声明和许可证。</li>
</ol>
<p><strong>主要看嵌入维度与上下文长度，这些对rag的部署很重要</strong></p>
<h3 id="阿里云百炼平台测试">阿里云百炼平台测试</h3>
<p><img src="https://img2024.cnblogs.com/blog/2415164/202502/2415164-20250224101321445-1391258406.png" alt="" loading="lazy"><br>
在阿里云上找到key，加入进ragflow<br>
模型有免费额度可以进行对比测试</p>
<h3 id="ragflow安装">ragflow安装</h3>
<pre><code class="language-powershell">1.从github网址clone ragflow的仓库
2.\ragflow-main\ragflow-main\docker 更这个文件下的.env
#RAGFLOW_IMAGE=infiniflow/ragflow:v0.15.0-slim
#
# To download the RAGFlow Docker image with embedding models, uncomment the following line instead:
RAGFLOW_IMAGE=infiniflow/ragflow:v0.16.0
注释silm 打开完整版
3.来到.env文件下docker compose -f docker-compose.yaml up -d
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302073333168-322823972.png" alt="" loading="lazy"><br>
<strong>如果使用localhost按登录没反应，换成其他本地的网卡地址</strong></p>
<p>添加模型<br>
<img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302073556022-1602619527.png" alt="" loading="lazy"><br>
ollama则可以用他暴露的局域网地址api<br>
qwen直接用一条apikey就可以<br>
<img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302074209603-451791014.png" alt="" loading="lazy"><br>
选择全局模型，和embeding，其他默认即可</p>
<p><img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302075224331-894135187.png" alt="" loading="lazy"></p>
<p>配置知识库<br>
<img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302075852179-1430095341.png" alt="" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302075827208-1782129814.png" alt="" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302080057571-1225874066.png" alt="" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302080108220-1213092045.jpg" alt="" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302080112628-869989686.jpg" alt="" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/2415164/202503/2415164-20250302080551779-272083706.png" alt="" loading="lazy"><br>
<strong>调用api的效果要优于本地模型</strong><br>
<strong>模型全局设置-知识库设置-聊天设置</strong>这三个为ragflow主要设置</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.507946289630787" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-02 08:16">2025-03-02 08:08</span>&nbsp;
<a href="https://www.cnblogs.com/supermao12">supermao12</a>&nbsp;
阅读(<span id="post_view_count">59</span>)&nbsp;
评论(<span id="post_comment_count">2</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18745741" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18745741);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18745741', targetLink: 'https://www.cnblogs.com/supermao12/p/18745741', title: 'ragflow-ollama 知识库建立测试' })">举报</a>
</div>
        