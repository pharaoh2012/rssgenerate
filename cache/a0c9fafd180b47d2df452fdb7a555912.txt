
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/fanshaoO/p/19000630" title="å‘å¸ƒäº 2025-07-23 14:05">
    <span role="heading" aria-level="2">ä»WebApiè¿ç§»åˆ°Minimal APIï¼Ÿæœ‰äº†è¿™ä¸ªç¥å™¨ï¼Œå°ç™½ä¹Ÿèƒ½10åˆ†é’Ÿæå®šï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>è¿˜åœ¨çº ç»“è¦ä¸è¦ä»ä¼ ç»ŸWebApiè¿ç§»åˆ°Minimal APIï¼Ÿæ‹…å¿ƒæ”¹ä»£ç æ”¹åˆ°ç§ƒå¤´ï¼Ÿåˆ«æ€•ï¼ä»Šå¤©ç»™ä½ å®‰åˆ©ä¸€ä¸ªé»‘ç§‘æŠ€â€”â€”<strong>MiniController</strong>ï¼Œè®©ä½ æ—¢èƒ½äº«å—Minimal APIçš„è½»é‡å¿«é€Ÿï¼Œåˆä¸ç”¨æ”¾å¼ƒWebApiçš„ä¼˜é›…å†™æ³•ï¼Œè¿ç§»è¿‡ç¨‹æ¯”æ³¡æ¯å’–å•¡è¿˜ç®€å•ï¼</p>
</blockquote>
<p>å…ˆä¸Šé“¾æ¥ <a href="https://github.com/fanslead/MiniController" target="_blank" rel="noopener nofollow">https://github.com/fanslead/MiniController</a></p>
<h2 id="-ä¸ºå•¥è¦æŠ˜è…¾è¿ç§»">ğŸ§ ä¸ºå•¥è¦æŠ˜è…¾è¿ç§»ï¼Ÿ</h2>
<p>å…ˆç»™å°ç™½ä»¬ç§‘æ™®ä¸‹ï¼šä¼ ç»ŸWebApiå’ŒMinimal APIå°±åƒè€å¼ç”µè„‘å’Œè½»è–„æœ¬â€”â€”å‰è€…åŠŸèƒ½å…¨ä½†ç¬¨é‡ï¼Œåè€…å°å·§å¿«ä½†æ“ä½œæ–¹å¼ä¸ä¸€æ ·ã€‚</p>
<table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>ä¼ ç»ŸWebApi</th>
<th>Minimal API</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä»£ç é‡</td>
<td>ä¸€å †æ¨¡æ¿ä»£ç </td>
<td>ä¸€è¡Œé¡¶è¿‡å»åè¡Œ</td>
</tr>
<tr>
<td>å¯åŠ¨é€Ÿåº¦</td>
<td>è¾ƒæ…¢</td>
<td>é£å¿«ï¼ˆå°¤å…¶é€‚åˆå¾®æœåŠ¡ï¼‰</td>
</tr>
<tr>
<td>é¡¹ç›®ç»“æ„</td>
<td>å±‚å±‚æ–‡ä»¶å¤¹ï¼ˆControllersã€Models...ï¼‰</td>
<td>ä¸€ä¸ªProgram.csæå®šå¤§åŠ</td>
</tr>
</tbody>
</table>
<p>ä½†ç›´æ¥è½¬Minimal APIåˆæ€•ä¸ä¹ æƒ¯ï¼Ÿ<strong>MiniControllerå°±æ˜¯ä½ çš„è¿‡æ¸¡ç¥å™¨</strong>ï¼</p>
<h2 id="-è¿ç§»å‰çš„å‡†å¤‡3æ­¥æå®šç¯å¢ƒ">ğŸš€ è¿ç§»å‰çš„å‡†å¤‡ï¼š3æ­¥æå®šç¯å¢ƒ</h2>
<ol>
<li>
<p><strong>å®‰è£…NuGetåŒ…</strong>ï¼ˆå¤åˆ¶ç²˜è´´å°±è¡Œï¼‰ï¼š</p>
<pre><code class="language-bash">Install-Package MiniController
Install-Package MiniController.Attributes
</code></pre>
<p>ï¼ˆå¦‚æœç”¨.NET CLIå°±æ¢è¿™ä¸ªï¼‰ï¼š</p>
<pre><code class="language-bash">dotnet add package MiniController
dotnet add package MiniController.Attributes
</code></pre>
</li>
<li>
<p><strong>ç¡®è®¤é¡¹ç›®ç‰ˆæœ¬</strong>ï¼šéœ€è¦ASP.NET Core 6.0ä»¥ä¸Šï¼ˆç°åœ¨æ–°å»ºçš„é¡¹ç›®åŸºæœ¬éƒ½æ˜¯å•¦ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å‡†å¤‡å¥½ä½ çš„WebApiæ§åˆ¶å™¨</strong>ï¼šæ¯”å¦‚è¿™ç§ç†Ÿæ‚‰çš„ä»£ç ï¼š</p>
<pre><code class="language-csharp">// ä¼ ç»ŸWebApiæ§åˆ¶å™¨
[ApiController]
[Route("api/[controller]")]
public class UserController : ControllerBase
{
    private readonly IUserService _userService;

    public UserController(IUserService userService)
    {
        _userService = userService;
    }

    [HttpGet("{id}")]
    public async Task&lt;IActionResult&gt; GetUser(int id)
    {
        var user = await _userService.GetById(id);
        return Ok(user);
    }
}
</code></pre>
</li>
</ol>
<h2 id="ï¸-å¼€å§‹è¿ç§»æ”¹3å¤„ä»£ç å°±è¡Œ">âœ‚ï¸ å¼€å§‹è¿ç§»ï¼šæ”¹3å¤„ä»£ç å°±è¡Œï¼</h2>
<h3 id="ç¬¬1æ­¥æ¢ä¸ªç‰¹æ€§æ ‡ç­¾">ç¬¬1æ­¥ï¼šæ¢ä¸ªç‰¹æ€§æ ‡ç­¾</h3>
<p>æŠŠ<code>[ApiController]</code>å’Œ<code>[Route]</code>åˆ æ‰ï¼Œæ¢æˆ<code>[MiniController]</code>ï¼š</p>
<pre><code class="language-csharp">// åŸæ¥çš„
[ApiController]
[Route("api/[controller]")]

// æ¢æˆè¿™ä¸ª
[MiniController("/api/[controller]")]  // è·¯ç”±è§„åˆ™ç›´æ¥ä¼ å‚æ•°
</code></pre>
<h3 id="ç¬¬2æ­¥åˆ æ‰controllerbaseç»§æ‰¿">ç¬¬2æ­¥ï¼šåˆ æ‰ControllerBaseç»§æ‰¿</h3>
<p>Minimal APIä¸éœ€è¦ç»§æ‰¿å•¦ï¼Œç›´æ¥ç®€åŒ–ï¼š</p>
<pre><code class="language-csharp">// åŸæ¥çš„
public class UserController : ControllerBase

// æ¢æˆè¿™ä¸ª
public class UserController  // å»æ‰ç»§æ‰¿
</code></pre>
<h3 id="ç¬¬3æ­¥è¿”å›å€¼æ”¹ä¸€ä¸‹å¯é€‰ä½†æ¨è">ç¬¬3æ­¥ï¼šè¿”å›å€¼æ”¹ä¸€ä¸‹ï¼ˆå¯é€‰ä½†æ¨èï¼‰</h3>
<p>æŠŠ<code>IActionResult</code>æ¢æˆ<code>IResult</code>ï¼Œå†™æ³•æ›´ç®€æ´ï¼š</p>
<pre><code class="language-csharp">// åŸæ¥çš„
public async Task&lt;IActionResult&gt; GetUser(int id)
{
    var user = await _userService.GetById(id);
    return Ok(user);
}

// æ¢æˆè¿™ä¸ªï¼ˆæ›´æ¸…çˆ½ï¼‰
public async Task&lt;IResult&gt; GetUser(int id)
{
    var user = await _userService.GetById(id);
    return Results.Ok(user);  // ç”¨Resultsé™æ€ç±»
}
</code></pre>
<h2 id="-æ³¨å†ŒæœåŠ¡åŠ 2è¡Œä»£ç æå®šå…¨å±€é…ç½®">ğŸ¯ æ³¨å†ŒæœåŠ¡ï¼šåŠ 2è¡Œä»£ç æå®šå…¨å±€é…ç½®</h2>
<p>æ‰“å¼€Program.csï¼Œæ‰¾åˆ°<code>var app = builder.Build();</code>å‰åï¼ŒåŠ è¿™ä¸¤å¥ï¼š</p>
<pre><code class="language-csharp">var builder = WebApplication.CreateBuilder(args);

// 1. æ³¨å†ŒMiniControlleræœåŠ¡ï¼ˆä¾èµ–æ³¨å…¥ç”¨ï¼‰
builder.Services.AddMiniControllers();

var app = builder.Build();

// 2. æ³¨å†Œæ‰€æœ‰ç«¯ç‚¹ï¼ˆæ›¿ä»£åŸæ¥çš„MapControllers()ï¼‰
app.MapMiniController();

app.Run();
</code></pre>
<p>æå®šï¼å°±è¿™ä¹ˆç®€å•ï¼Ÿå¯¹ï¼å› ä¸ºMiniControllerä¼šè‡ªåŠ¨å¸®ä½ ç”ŸæˆMinimal APIçš„è·¯ç”±ä»£ç ï¼Œä½ å®Œå…¨ä¸ç”¨æ‰‹åŠ¨å†™é‚£äº›<code>app.MapGet</code>ã€<code>app.MapPost</code>äº†ï¼</p>
<h2 id="-é«˜çº§æŠ€å·§ä¿ç•™webapiçš„å¥½ä¹ æƒ¯">ğŸ§© é«˜çº§æŠ€å·§ï¼šä¿ç•™WebApiçš„å¥½ä¹ æƒ¯</h2>
<p>æ‹…å¿ƒè¿ç§»åä¸¢åŠŸèƒ½ï¼Ÿä¸å­˜åœ¨çš„ï¼è¿™äº›WebApiå¸¸ç”¨åŠŸèƒ½éƒ½æ”¯æŒï¼š</p>
<ol>
<li>
<p><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šæ„é€ å‡½æ•°æ³¨å…¥ç…§æ ·ç”¨</p>
<pre><code class="language-csharp">public class UserController
{
    private readonly IUserService _userService;
    
    // ç†Ÿæ‚‰çš„æ„é€ å‡½æ•°æ³¨å…¥
    public UserController(IUserService userService)
    {
        _userService = userService;
    }
}
</code></pre>
</li>
<li>
<p><strong>å‚æ•°ç»‘å®š</strong>ï¼š<code>[FromRoute]</code>ã€<code>[FromBody]</code>è¿™äº›æ ‡ç­¾ç»§ç»­ç”¨</p>
<pre><code class="language-csharp">[HttpPost]
public IResult CreateUser([FromBody] CreateUserRequest request)
{
    // å’Œä»¥å‰ä¸€æ ·ç”¨
}
</code></pre>
</li>
<li>
<p><strong>æˆæƒå’Œæ–‡æ¡£</strong>ï¼š<code>[Authorize]</code>ã€<code>[ProducesResponseType]</code>éƒ½æ”¯æŒ</p>
<pre><code class="language-csharp">[HttpGet("{id}")]
[Authorize(Roles = "Admin")]
[ProducesResponseType(typeof(User), 200)]
[ProducesResponseType(404)]
public IResult GetUser(int id)
{
    // æƒé™å’Œæ–‡æ¡£ä¸€æ­¥åˆ°ä½
}
</code></pre>
</li>
</ol>
<h2 id="-å¸¸è§é—®é¢˜å°ç™½å¿…çœ‹">â“ å¸¸è§é—®é¢˜ï¼šå°ç™½å¿…çœ‹</h2>
<ol>
<li>
<p><strong>è¿ç§»åè·¯ç”±å˜äº†ï¼Ÿ</strong><br>
ä¸ä¼šï¼<code>[MiniController("/api/[controller]")]</code>å’ŒåŸæ¥WebApiçš„<code>[Route("api/[controller]")]</code>æ•ˆæœä¸€æ ·ã€‚</p>
</li>
<li>
<p><strong>é™æ€ç±»ä¹Ÿèƒ½æ”¯æŒï¼Ÿ</strong><br>
å¯ä»¥ï¼ç®€å•æ¥å£ç›´æ¥ç”¨é™æ€ç±»ï¼Œè¿ä¾èµ–æ³¨å…¥éƒ½çœäº†ï¼ˆä¹Ÿæ”¯æŒæ–¹æ³•çº§åˆ«çš„ä¾èµ–æ³¨å…¥ï¼‰ï¼š</p>
<pre><code class="language-csharp">[MiniController("/api/demo")]
public static class DemoController
{
    [HttpGet("hello")]
    public static IResult Hello() =&gt; Results.Ok("Hello World");
}
</code></pre>
</li>
<li>
<p><strong>Swaggerè¿˜èƒ½ç”¨å—ï¼Ÿ</strong><br>
å®Œå…¨æ”¯æŒï¼å’Œä»¥å‰ä¸€æ ·åŠ <code>AddEndpointsApiExplorer()</code>å’Œ<code>AddSwaggerGen()</code>å°±è¡Œã€‚</p>
</li>
</ol>
<h2 id="-æ€»ç»“è¿™æ³¢è¿ç§»è¡€èµšä¸äº">ğŸ‰ æ€»ç»“ï¼šè¿™æ³¢è¿ç§»è¡€èµšä¸äº</h2>
<p>ç”¨MiniControllerè¿ç§»åˆ°Minimal APIï¼Œä½ ä¼šå¾—åˆ°ï¼š</p>
<ul>
<li>ä»£ç é‡å‡å°‘50%ä»¥ä¸Š</li>
<li>å¯åŠ¨é€Ÿåº¦æå‡ï¼ˆå°¤å…¶å¾®æœåŠ¡åœºæ™¯ï¼‰</li>
<li>ä¿ç•™WebApiçš„å¼€å‘ä¹ æƒ¯ï¼ˆä¸ç”¨é‡æ–°å­¦ï¼‰</li>
<li>è‡ªåŠ¨ç”Ÿæˆè§„èŒƒçš„è·¯ç”±ä»£ç ï¼ˆå°‘å†™bugï¼‰</li>
</ul>
<p>è¿˜ç­‰å•¥ï¼Ÿèµ¶ç´§æ‹¿ä½ çš„é¡¹ç›®è¯•è¯•ï¼Œ10åˆ†é’Ÿå°±èƒ½ä½“éªŒé£ä¸€èˆ¬çš„æ„Ÿè§‰ï¼æœ‰é—®é¢˜å°±åœ¨è¯„è®ºåŒºé—®ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾ä¸Šæ‰‹ï½</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-23 14:05">2025-07-23 14:05</span>&nbsp;
<a href="https://www.cnblogs.com/fanshaoO">é¥­å‹ºoO</a>&nbsp;
é˜…è¯»(<span id="post_view_count">191</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19000630);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19000630', targetLink: 'https://www.cnblogs.com/fanshaoO/p/19000630', title: 'ä»WebApiè¿ç§»åˆ°Minimal APIï¼Ÿæœ‰äº†è¿™ä¸ªç¥å™¨ï¼Œå°ç™½ä¹Ÿèƒ½10åˆ†é’Ÿæå®šï¼' })">ä¸¾æŠ¥</a>
</div>
        