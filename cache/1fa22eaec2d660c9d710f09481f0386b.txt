
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/burc/p/18568288" title="å‘å¸ƒäº 2025-01-13 08:55">
    <span role="heading" aria-level="2">å‰ç«¯å®ç° HTML ç½‘é¡µè½¬ PDF å¹¶å¯¼å‡ºğŸ¤“</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/2180164/202411/2180164-20241125180120867-822644957.png" alt="å‰ç«¯å®ç° HTML ç½‘é¡µè½¬ PDF å¹¶å¯¼å‡º&amp;#129299;" class="desc_img">
        æœ‰ä¸ªæ–°éœ€æ±‚ï¼Œå½“ç‚¹å‡»ã€ä¸‹è½½ã€‘æŒ‰é’®æ—¶ï¼Œç›´æ¥å°†å½“å‰ htmlé¡µé¢ä¸‹è½½ä¸º PDFã€‚é€šè¿‡ html2canvas + jsPDF å¯å®ç°PDFå•é¡µä¸‹è½½ï¼Œç”šè‡³æ˜¯å¤šé¡µä¸‹è½½ï¼Œè®°å½•åˆ†äº«ä¸€ä¸‹~ æœ€åæœ‰æ ·å¼æºç ï¼Œå¯è‡ªå–ğŸ«¡
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æœ‰ä¸ªæ–°éœ€æ±‚ï¼Œå½“ç‚¹å‡»ã€ä¸‹è½½ã€‘æŒ‰é’®æ—¶ï¼Œç›´æ¥å°†å½“å‰ htmlé¡µé¢ä¸‹è½½ä¸º PDFã€‚é€šè¿‡ html2canvas + jsPDF å¯å®ç°PDFå•é¡µä¸‹è½½ï¼Œç”šè‡³æ˜¯å¤šé¡µä¸‹è½½ï¼Œè®°å½•åˆ†äº«ä¸€ä¸‹~ æœ€åæœ‰æºç ï¼Œå¯è‡ªå–ğŸ«¡</p>
<p><img src="https://img2024.cnblogs.com/blog/2180164/202411/2180164-20241125175934462-1567954946.gif" alt="" loading="lazy"></p>
<h1 id="html2canvas">html2canvas</h1>
<p>html2canvaså®˜ç½‘åœ¨è¿™ï¼š<a href="https://html2canvas.hertzen.com/" target="_blank" rel="noopener nofollow">html2canvas - Screenshots with JavaScript</a></p>
<p>html2canvas æ˜¯ä¸€ä¸ª HTML æ¸²æŸ“å™¨ã€‚è¯¥è„šæœ¬å…è®¸ä½ ç›´æ¥åœ¨ç”¨æˆ·æµè§ˆå™¨æˆªå–é¡µé¢æˆ–éƒ¨åˆ†ç½‘é¡µçš„â€œå±å¹•æˆªå±â€ï¼Œé€šè¿‡è¯»å– DOM ä»¥åŠåº”ç”¨äºå…ƒç´ çš„ä¸åŒæ ·å¼ï¼Œå°†å½“å‰é¡µé¢å‘ˆç°ä¸º <code>canvas</code> å›¾åƒ</p>
<p>å®‰è£… html2canvas</p>
<pre><code class="language-javascript">npm install --save html2canvas
</code></pre>
<p>æˆªå–é¡µé¢ç”Ÿæˆ<code>canvas</code>ï¼Œå¹¶å°†å…¶æ’å…¥é¡µé¢ä¸­</p>
<pre><code class="language-javascript">html2canvas(document.body}).then(function(canvas) {
    document.body.appendChild(canvas);
});
</code></pre>
<p>æ³¨æ„ï¼šå—é™äºæµè§ˆå™¨çš„å®ç°ï¼ŒHTML çš„ canvas å…ƒç´ ä¹Ÿæœ‰é«˜åº¦é™åˆ¶âš  å¯å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/canvas" target="_blank" rel="noopener nofollow">canvas æœ€å¤§ç”»å¸ƒå°ºå¯¸ - MDN</a></p>
<ul>
<li>Chrome å’Œ Firefox ç­‰ç°ä»£æµè§ˆå™¨ï¼Œcanvas çš„æœ€å¤§å°ºå¯¸é€šå¸¸é™åˆ¶åœ¨ 32767 åƒç´ ï¼Œè¿™ä¹Ÿæ˜¯ WebGL å’Œ 2D canvas çš„å…±åŒé™åˆ¶ã€‚è¶…è¿‡è¿™ä¸ªå€¼ä¼šå¯¼è‡´ canvas ç”Ÿæˆå¤±è´¥ï¼ŒæŠ›å‡ºé”™è¯¯ï¼Œæˆ–è€…æ˜¾ç¤ºç©ºç™½å†…å®¹ã€‚</li>
<li>è€ç‰ˆæœ¬çš„ IE å¯¹ canvas å°ºå¯¸é™åˆ¶è¾ƒä¸ºä¸¥æ ¼ï¼Œä¸€èˆ¬åœ¨ 8192 åƒç´ ä¸Šä¸‹ã€‚ç°ä»£ç‰ˆæœ¬çš„ Edge åˆ™ä¸ Chrome çš„é™åˆ¶ç±»ä¼¼</li>
</ul>
<h1 id="jspdf">jsPDF</h1>
<p>jsPDFæ–‡æ¡£å¯ä»¥çœ‹è¿™ï¼š<a href="https://github.com/parallax/jsPDF" target="_blank" rel="noopener nofollow">GitHub - parallax/jsPDF: Client-side JavaScript PDF generation for everyone.</a></p>
<p>å®‰è£… jspdf</p>
<pre><code class="language-javascript">npm install jspdf --save
</code></pre>
<p>APIä¹Ÿå¾ˆç®€å•ï¼Œä¸‹é¢æ˜¯ä¸ªç”Ÿæˆæ–‡æœ¬å’Œå›¾ç‰‡çš„PDFæ ·ä¾‹</p>
<pre><code class="language-javascript">// jsPDF ä¸‹è½½æ–‡æœ¬å›¾ç‰‡PDF
const downLoadPdf = () =&gt; {
  // ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ–¹å‘ï¼Œç¬¬äºŒä¸ªå•ä½ï¼Œç¬¬ä¸‰ä¸ªå°ºå¯¸ 'a4' = [595.28,841.89]
  const doc = new jsPDF('', 'pt', [500, 1000])

  // å­—ä½“å¤§å°
  doc.setFontSize(50)

  // æ–‡æœ¬ï¼Œå·¦è¾¹è·ï¼Œä¸Šè¾¹è·
  doc.text('Hello world!', 10, 50)

  // base64ï¼Œå›¾ç‰‡ç±»å‹ï¼Œå·¦è¾¹è·ï¼Œä¸Šè¾¹è·ï¼Œå®½åº¦ï¼Œé«˜åº¦
  doc.addImage(base64, 'PNG', 10, 60, 400, 200)

  doc.save('a4.pdf')
}
</code></pre>
<p>æ³¨æ„ï¼š jsPDF ç”Ÿæˆçš„ PDF é»˜è®¤ä»¥ pt (point) ä¸ºå•ä½ï¼Œå•é¡µçš„æœ€å¤§é«˜åº¦é€šå¸¸é™åˆ¶åœ¨ 14400 ptã€‚è¶…è¿‡è¿™ä¸ªé«˜åº¦å¯èƒ½å¯¼è‡´ç”Ÿæˆçš„ PDF æ— æ³•æ­£ç¡®æ¸²æŸ“æˆ–æµè§ˆå™¨å´©æºƒâš </p>
<h1 id="html2canvas--jspdf-å®ç°é¡µé¢ä¸‹è½½">html2canvas + jsPDF å®ç°é¡µé¢ä¸‹è½½</h1>
<h2 id="å•é¡µä¸‹è½½è‡ªé€‚åº”çº¸">å•é¡µä¸‹è½½ï¼ˆè‡ªé€‚åº”çº¸ï¼‰</h2>
<p>PDFé¡µé¢çš„å®½é«˜ é‡‡ç”¨ canvasçš„å®½é«˜</p>
<ul>
<li>è‹¥<code>canvas.height &gt;= canvas.width</code>ï¼Œé‡‡ç”¨ <code>portrait</code> çºµå‘é¡µé¢</li>
<li>è‹¥<code>canvas.width &gt; canvas.height</code>ï¼Œé‡‡ç”¨ <code>landscape</code> æ¨ªå‘é¡µé¢</li>
</ul>
<p>å¦‚æœé¡µé¢å¾ˆé•¿çš„è¯ï¼Œå•é¡µä¸‹è½½å°±ä¼šç”Ÿæˆä¸€å¼ é•¿é•¿çš„PDFã€‚æ³¨æ„ï¼è¶…è¿‡é™åˆ¶å°±ä¼šæ˜¾ç¤ºç©ºç™½é¡µé¢ï¼Œ jsPDF ç”Ÿæˆçš„ PDFå•é¡µæœ€å¤§é«˜åº¦ä¸º 14400ptâš </p>
<blockquote>
<p>canvasä¹Ÿæœ‰æœ€å¤§é«˜åº¦é™åˆ¶ 32767åƒç´ ï¼Œå¦‚æœé¡µé¢è¿‡é•¿çš„è¯ï¼Œé€šè¿‡ html2canvas ç”Ÿæˆ canvasä¼šå¤±è´¥</p>
</blockquote>
<pre><code class="language-javascript">const downLoadPdfAutoSingle = () =&gt; {
  html2canvas(document.body, {
    scale: window.devicePixelRatio * 2, // ä½¿ç”¨è®¾å¤‡çš„åƒç´ æ¯” * 2
  }).then(canvas =&gt; {
    // è¿”å›å›¾ç‰‡dataURLï¼Œå‚æ•°ï¼šå›¾ç‰‡æ ¼å¼å’Œæ¸…æ™°åº¦(0-1)
    const pageData = canvas.toDataURL('image/jpeg', 1.0)

    const pageWidth = canvas.width
    const pageHeight =  canvas.height
    const orientation = canvas.height &gt;= canvas.width ? 'portrait' : 'landscape'  // portrait è¡¨ç¤ºçºµå‘ï¼Œlandscapeè¡¨ç¤ºæ¨ªå‘
    const pdf = new jsPDF(orientation, 'pt', [pageWidth, pageHeight])
    
    // addImageåä¸¤ä¸ªå‚æ•°æ§åˆ¶æ·»åŠ å›¾ç‰‡çš„å°ºå¯¸ï¼Œæ­¤å¤„å°†é¡µé¢é«˜åº¦æŒ‰ç…§a4çº¸å®½é«˜æ¯”åˆ—è¿›è¡Œå‹ç¼©
    pdf.addImage(
      pageData,
      'JPEG',
      0,
      0,
      pageWidth,
      pageHeight
    )
    pdf.save('ä¸‹è½½ä¸€é¡µPDFï¼ˆè‡ªé€‚åº”çº¸ï¼‰.pdf')
  })
}
</code></pre>
<h2 id="å•é¡µä¸‹è½½a4çº¸">å•é¡µä¸‹è½½ï¼ˆA4çº¸ï¼‰</h2>
<p>å·²çŸ¥ï¼šA4çº¸çš„å®½åº¦ å’Œ canvasçš„å®½åº¦é«˜åº¦ã€‚å¯å¾— canvasåœ¨A4çº¸ä¸Šå ç”¨çš„æ€»é«˜åº¦ï¼ˆA4çº¸å°ºå¯¸ä¸ºå®½ 595.28ptï¼Œé«˜ 841.89ptï¼‰</p>
<p>å¦‚æœé¡µé¢å¾ˆé•¿çš„è¯ï¼Œå•é¡µä¸‹è½½å°±ä¼šç”Ÿæˆä¸€å¼ é•¿é•¿çš„PDFã€‚æ³¨æ„ï¼è¶…è¿‡é™åˆ¶å°±ä¼šæ˜¾ç¤ºç©ºç™½é¡µé¢ï¼Œ jsPDF ç”Ÿæˆçš„ PDFå•é¡µæœ€å¤§é«˜åº¦ä¸º 14400ptâš </p>
<blockquote>
<p>canvasä¹Ÿæœ‰æœ€å¤§é«˜åº¦é™åˆ¶ 32767åƒç´ ï¼Œå¦‚æœé¡µé¢è¿‡é•¿çš„è¯ï¼Œé€šè¿‡ html2canvas ç”Ÿæˆ canvasä¼šå¤±è´¥</p>
</blockquote>
<pre><code class="language-javascript">const downLoadPdfA4Single = () =&gt; {
  html2canvas(document.body).then(canvas =&gt; {
    // è¿”å›å›¾ç‰‡dataURLï¼Œå‚æ•°ï¼šå›¾ç‰‡æ ¼å¼å’Œæ¸…æ™°åº¦(0-1)
    const pageData = canvas.toDataURL('image/jpeg', 1.0)

    // æ–¹å‘çºµå‘ï¼Œå°ºå¯¸ponitsï¼Œçº¸å¼ æ ¼å¼ a4 å³ [595.28, 841.89]
    const A4Width = 595.28
    const A4Height = 841.89 // A4çº¸å®½
    const pageHeight = A4Height &gt;= A4Width * canvas.height / canvas.width ? A4Height :  A4Width * canvas.height / canvas.width
    const pdf = new jsPDF('portrait', 'pt', [A4Width, pageHeight])
    
    // addImageåä¸¤ä¸ªå‚æ•°æ§åˆ¶æ·»åŠ å›¾ç‰‡çš„å°ºå¯¸ï¼Œæ­¤å¤„å°†é¡µé¢é«˜åº¦æŒ‰ç…§a4çº¸å®½é«˜æ¯”åˆ—è¿›è¡Œå‹ç¼©
    pdf.addImage(
      pageData,
      'JPEG',
      0,
      0,
      A4Width,
      A4Width * canvas.height / canvas.width,
    )
    pdf.save('ä¸‹è½½ä¸€é¡µPDFï¼ˆA4çº¸ï¼‰.pdf')
  })
}
</code></pre>
<h2 id="å¤šé¡µä¸‹è½½è‡ªé€‚åº”çº¸">å¤šé¡µä¸‹è½½ï¼ˆè‡ªé€‚åº”çº¸ï¼‰</h2>
<p>ç”±äº jsPDF å•é¡µæœ€å¤§é«˜åº¦çš„é™åˆ¶ åˆæˆ–æ˜¯ éœ€æ±‚å±‚é¢ï¼Œæˆ‘ä»¬éœ€è¦å®ç°è‡ªåŠ¨åˆ†é¡µä¸‹è½½</p>
<p>æˆ‘ä»¬è®¾ç½®ä¸€é¡µPDFé¡µé¢å®½åº¦ä¸º<code>canvas.width</code>ï¼Œé«˜åº¦ä¸º<code>canvas.width * 1.3</code></p>
<p><strong>åˆ†é¡µæ€è·¯ï¼šæ¯ä¸ªPDFé¡µé¢éƒ½æ˜¾ç¤ºä¸€å¼  canvas å›¾ï¼Œåªä¸è¿‡æ˜¯è®¡ç®—åç§»é‡ï¼Œæ¯ä¸ªPDFé¡µé¢æ˜¾ç¤ºçš„æ˜¯ canvas çš„ä¸åŒä½ç½®</strong></p>
<p>é—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–°çš„PDFé¡µé¢å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ jsPDF çš„<code>pdf.addPage()</code></p>
<pre><code class="language-javascript">const downLoadPdfAutoMultiple = () =&gt; {
  const ele = document.body
  html2canvas(ele, {
    scale: window.devicePixelRatio * 2, // ä½¿ç”¨è®¾å¤‡çš„åƒç´ æ¯” * 2
  }).then(canvas =&gt; {
    let position = 0 //é¡µé¢åç§»
    const autoWidth = canvas.width // ä¸€é¡µçº¸å®½åº¦
    const autoHeight = canvas.width * 1.3 // ä¸€é¡µçº¸é«˜åº¦

    // ä¸€é¡µPDFå¯æ˜¾ç¤ºçš„canvasé«˜åº¦
    const pageHeight = (canvas.width * autoHeight) / autoWidth
    // æœªåˆ†é…åˆ°PDFçš„canvasé«˜åº¦
    let unallottedHeight = canvas.height

    // canvaså¯¹åº”çš„PDFå®½é«˜
    const imgWidth = canvas.width
    const imgHeight = canvas.height

    const pageData = canvas.toDataURL('image/jpeg', 1.0)
    const pdf = new jsPDF('', 'pt', [autoWidth, autoHeight])

    // å½“canvasé«˜åº¦ æœªè¶…è¿‡ ä¸€é¡µPDFå¯æ˜¾ç¤ºçš„canvasé«˜åº¦ï¼Œæ— éœ€åˆ†é¡µ
    if (unallottedHeight &lt;= pageHeight) {
      pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight)
      pdf.save('ä¸‹è½½å¤šé¡µPDFï¼ˆè‡ªé€‚åº”çº¸ï¼‰.pdf')
      return
    }

    while (unallottedHeight &gt; 0) {
      pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
      unallottedHeight -= pageHeight
      position -= autoHeight
      if (unallottedHeight &gt; 0) {
        pdf.addPage()
      }
    }
    pdf.save('html2canvas+jsPDFä¸‹è½½PDF.pdf')
  })
}
</code></pre>
<h2 id="å¤šé¡µä¸‹è½½a4çº¸">å¤šé¡µä¸‹è½½ï¼ˆA4çº¸ï¼‰</h2>
<p>ç”±äº jsPDF å•é¡µæœ€å¤§é«˜åº¦çš„é™åˆ¶ åˆæˆ–æ˜¯ éœ€æ±‚å±‚é¢ï¼Œæˆ‘ä»¬éœ€è¦å®ç°è‡ªåŠ¨åˆ†é¡µä¸‹è½½</p>
<p>æˆ‘ä»¬è®¾ç½®ä¸€é¡µPDFé¡µé¢çš„å®½é«˜ä¸ºA4çº¸å°ºå¯¸ï¼Œå³å®½ 595.28ptï¼Œé«˜ 841.89pt</p>
<p><strong>åˆ†é¡µæ€è·¯ï¼šæ¯ä¸ªPDFé¡µé¢éƒ½æ˜¾ç¤ºä¸€å¼  canvas å›¾ï¼Œåªä¸è¿‡æ˜¯è®¡ç®—åç§»é‡ï¼Œæ¯ä¸ªPDFé¡µé¢æ˜¾ç¤ºçš„æ˜¯ canvas çš„ä¸åŒä½ç½®</strong></p>
<p>é—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–°çš„PDFé¡µé¢å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ jsPDF çš„<code>pdf.addPage()</code></p>
<pre><code class="language-javascript">const downLoadPdfA4Multiple = () =&gt; {
  const ele = document.body
  html2canvas(ele, {
    scale: 2, // ä½¿ç”¨è®¾å¤‡çš„åƒç´ æ¯”
  }).then(canvas =&gt; {
    let position = 0 //é¡µé¢åç§»
    const A4Width = 595.28 // A4çº¸å®½åº¦
    const A4Height = 841.89 // A4çº¸å®½

    // ä¸€é¡µPDFå¯æ˜¾ç¤ºçš„canvasé«˜åº¦
    const pageHeight = (canvas.width * A4Height) / A4Width
    // æœªåˆ†é…åˆ°PDFçš„canvasé«˜åº¦
    let unallottedHeight = canvas.height

    // canvaså¯¹åº”çš„PDFå®½é«˜
    const imgWidth = A4Width
    const imgHeight = (A4Width * canvas.height) / canvas.width

    const pageData = canvas.toDataURL('image/jpeg', 1.0)
    const pdf = new jsPDF('', 'pt', [A4Width, A4Height])

    // å½“canvasé«˜åº¦ æœªè¶…è¿‡ ä¸€é¡µPDFå¯æ˜¾ç¤ºçš„canvasé«˜åº¦ï¼Œæ— éœ€åˆ†é¡µ
    if (unallottedHeight &lt;= pageHeight) {
      pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight)
      pdf.save('ä¸‹è½½å¤šé¡µPDFï¼ˆA4çº¸ï¼‰.pdf')
      return
    }

    while (unallottedHeight &gt; 0) {
      pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
      unallottedHeight -= pageHeight
      position -= A4Height
      if (unallottedHeight &gt; 0) {
        pdf.addPage()
      }
    }
    pdf.save('ä¸‹è½½å¤šé¡µPDFï¼ˆA4çº¸ï¼‰.pdf')
  })
}
</code></pre>
<h1 id="æºç ">æºç </h1>
<p><a href="https://github.com/burc-li/vue-pdf" target="_blank" rel="noopener nofollow">GitHub - burc-li/vue-pdf: HTML è½¬ PDFä¸‹è½½ï¼ˆhtml2canvas å’Œ jsPDFå®ç°ï¼‰</a></p>

</div>
<div id="MySignature" role="contentinfo">
    äººé—´ä¸æ­£ç»ç”Ÿæ´»æ‰‹å†Œ
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="8.395873716612268" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-01-13 08:56">2025-01-13 08:55</span>&nbsp;
<a href="https://www.cnblogs.com/burc">æŸæˆ</a>&nbsp;
é˜…è¯»(<span id="post_view_count">886</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">4</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18568288" rel="nofollow">ç¼–è¾‘</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18568288);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18568288', targetLink: 'https://www.cnblogs.com/burc/p/18568288', title: 'å‰ç«¯å®ç° HTML ç½‘é¡µè½¬ PDF å¹¶å¯¼å‡º&amp;#129299;' })">ä¸¾æŠ¥</a>
</div>
        