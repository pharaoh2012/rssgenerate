
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/somefuture/p/18889281" title="发布于 2025-05-22 13:43">
    <span role="heading" aria-level="2">GIM发布新版本了 （附rust CLI制作brew bottle流程）</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>GIM 发布新版本了！现在1.3.0版本可用了 <a href="https://github.com/davelet/git-intelligence-message/releases/tag/v1.3.0" target="_blank" rel="noopener nofollow">https://github.com/davelet/git-intelligence-message/releases/tag/v1.3.0</a> 。可以通过<code>brew upgrade git-intelligence-message</code>升级。</p>
<blockquote>
<p>初次安装需要先执行 <code>brew tap davelet/gim</code></p>
</blockquote>
<p>GIM 是一个根据git仓库内文件变更自动生成git提交消息的命令行工具，参考前文《<a href="https://www.cnblogs.com/somefuture/p/18873047" title="GIM: 根据代码变更自动生成git提交消息的工具" target="_blank">GIM: 根据代码变更自动生成git提交消息的工具</a>》。</p>
<p>在最近的版本中主要三个新能力：</p>
<ul>
<li>不再依赖rust而是安装二进制包</li>
<li>自动探测新版本并提示更新</li>
<li>用户可自主调整生成提示（AI prompt）</li>
</ul>
<p>此外还内置了更多大模型的 API 调用地址。</p>
<h3 id="因为我电脑是mac所以只做了mac版本如果有哪位同僚能帮我做成windows版本的不胜感激">因为我电脑是Mac所以只做了Mac版本。如果有哪位同僚能帮我做成windows版本的，不胜感激🙏</h3>
<h1 id="二进制安装">二进制安装</h1>
<p>GIM 现在不依赖 rust 环境了，改为通过<code>brew bottle</code>安装了。即下即用，不用编译安装，立刻节省5G磁盘。</p>
<p>为了保证效果，推荐重装：</p>
<pre><code class="language-bash">brew uninstall git-intelligence-message
brew cleanup
brew update
brew install git-intelligence-message
</code></pre>
<h1 id="升级-gim-版本">升级 GIM 版本</h1>
<p>软件执行时会主动探测是否有新版本。发现后（会有提示）可以执行</p>
<pre><code class="language-bash">gim update
</code></pre>
<p>来升级。如果提示了5次依然没升级则一个月内不会再提示。</p>
<h1 id="调整ai提示词">调整AI提示词</h1>
<p>可以自主设置提示词了。通过命令 <code>gim prompt</code>查看默认提示词，通过<code>gim prompt -e</code>可进行提示词更新。</p>
<p>完整命令可参考项目文档 <a href="https://github.com/davelet/git-intelligence-message/blob/main/README.md" target="_blank" rel="noopener nofollow">https://github.com/davelet/git-intelligence-message/blob/main/README.md</a> 或者帮助文档：</p>
<pre><code class="language-bash">gim prompt -h
Manage ai model prompt files. Show content when no options specified

Usage: gim prompt [OPTIONS]

Options:
  -e, --edit             Optional: Edit the prompt files
  -t, --prompt &lt;PROMPT&gt;  Optional: Specify which prompt to edit (d or diff or diff_prompt or subject_prompt)
  -o, --editor &lt;EDITOR&gt;  Optional: Specify the editor to use (e.g., vim, code, nano)
  -h, --help             Print help
</code></pre>
<h1 id="内置大模型地址清单">内置大模型地址清单</h1>
<p>现在内置了一下8中大模型的API地址：</p>
<table>
<thead>
<tr>
<th>Model Prefix</th>
<th>Service Provider</th>
<th>Default Endpoint</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gpt-*</code></td>
<td>OpenAI</td>
<td><code>https://api.openai.com/v1/chat/completions</code></td>
</tr>
<tr>
<td><code>moonshot-*</code></td>
<td>Moonshot AI</td>
<td><code>https://api.moonshot.cn/v1/chat/completions</code></td>
</tr>
<tr>
<td><code>qwen-*</code></td>
<td>Alibaba Qwen</td>
<td><code>https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions</code></td>
</tr>
<tr>
<td><code>gemini-*</code></td>
<td>Google Gemini</td>
<td><code>https://generativelanguage.googleapis.com/v1beta/openai/</code></td>
</tr>
<tr>
<td><code>doubao-*</code></td>
<td>ByteDance Doubao</td>
<td><code>https://ark.cn-beijing.volces.com/api/v3/chat/completions</code></td>
</tr>
<tr>
<td><code>glm-*</code></td>
<td>THUDM GLM</td>
<td><code>https://open.bigmodel.cn/api/paas/v4/chat/completions</code></td>
</tr>
<tr>
<td><code>deepseek-*</code></td>
<td>DeepSeek</td>
<td><code>https://api.deepseek.com/chat/completions</code></td>
</tr>
<tr>
<td><code>qianfan-*</code></td>
<td>Baidu Qianfan</td>
<td><code>https://qianfan.baidubce.com/v2/chat/completions</code></td>
</tr>
</tbody>
</table>
<p>所以如果你要用的模型是在这清单里可以不用使用<code>gim ai --url</code>来配置。</p>
<h1 id="使用流程">使用流程</h1>
<ol>
<li>通过homebrew安装</li>
<li>设置大模型token参考 <code>gim ai -h</code></li>
<li>切换目录到某个git 仓库</li>
<li>执行<code>gim -a</code> (这就是GIM提供的核心能力)</li>
<li>（可选）执行<code>git push</code>推送提交</li>
</ol>
<hr>
<hr>
<h1 id="bottle-制作流程">bottle 制作流程</h1>
<h2 id="1-新建-tap-分支">1. 新建 tap 分支</h2>
<p>我给 <a href="https://github.com/davelet/homebrew-gim" target="_blank" rel="noopener nofollow">https://github.com/davelet/homebrew-gim</a> 拉了新分支 <code>dep-cargo-install</code>。这个分支保持通过cargo 安装。<br>
<code>main</code> 分支后续更新成bottle安装方式，供用户使用。</p>
<h2 id="2-本地使用-tap-新分支">2. 本地使用 tap 新分支</h2>
<p>有多种方式切换分支，最直观的是</p>
<pre><code class="language-bash">cd "$(brew --repo davelet/gim)"
git checkout dep-cargo-install
git pull
brew install --build-bottle davelet/gim/git-intelligence-message
</code></pre>
<p>这样会通过新分支的旧方式安装软件。</p>
<blockquote>
<p>必须指定参数 --build-bottle 告诉 brew 这个软件要用来制作bottle</p>
</blockquote>
<h2 id="3-制作-bottle">3. 制作 bottle</h2>
<p>找个目录执行</p>
<pre><code class="language-bash">brew bottle git-intelligence-message
</code></pre>
<p>会在当前目录生成一个bottle文件（结尾是 <code>bottle.1.tar.gz</code>）并提示一段代码：</p>
<pre><code class="language-rb">  bottle do
    rebuild 1
    sha256 cellar: :any_skip_relocation, sonoma: "b478f239a65b704c85cc59b1a50fcde797bbbf9c142972c08f529e5bea3f5b7a"
  end
</code></pre>
<h2 id="4-上传文件">4. 上传文件</h2>
<p>把上一步生成的文件重命名，里面的 <code>--</code> 改成 <code>-</code>，上传到仓库的Release里面，比如<br>
<a href="https://github.com/davelet/git-intelligence-message/releases/tag/v1.2.2" target="_blank" rel="noopener nofollow">https://github.com/davelet/git-intelligence-message/releases/tag/v1.2.2</a><br>
把上传好的文件链接复制出来。</p>
<h2 id="5-更新-formulae">5. 更新 Formulae</h2>
<p>最后一步，回到 tap 主分支 <a href="https://github.com/davelet/homebrew-gim/blob/main/Formula/git-intelligence-message.rb" target="_blank" rel="noopener nofollow">https://github.com/davelet/homebrew-gim/blob/main/Formula/git-intelligence-message.rb</a> ，把这个文件里的 <code>depends_on</code> 那一行删掉，改成第三步的代码。<br>
然后在 <code>bottle do</code> 这个块里增加<code>root_url</code>，值就是上一步复制的地址去掉最后的文件名。</p>
<p>大功告成。</p>
<blockquote>
<p>最后的小提示：源文件计算sha256 <code>shasum -a 256 &lt;下载到本地的tar.gz&gt;</code></p>
</blockquote>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.9010607976377315" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-22 14:42">2025-05-22 13:43</span>&nbsp;
<a href="https://www.cnblogs.com/somefuture">大卫小东（Sheldon）</a>&nbsp;
阅读(<span id="post_view_count">166</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18889281);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18889281', targetLink: 'https://www.cnblogs.com/somefuture/p/18889281', title: 'GIM发布新版本了 （附rust CLI制作brew bottle流程）' })">举报</a>
</div>
        