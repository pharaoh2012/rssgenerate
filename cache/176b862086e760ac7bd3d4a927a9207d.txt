
<table cellspacing="0" cellpadding="0"><tbody><tr><td class="t_f" id="postmessage_52551208">
<i class="pstatus"> 本帖最后由 baoshuijun 于 2025-3-8 17:12 编辑 </i><br>
<br>
把以下内容复制到记事本当中,并保存为.cmd或.bat的批处理文件,双击运行此处理文件即可添加成功.<br>
@Echo Off<br>
Title 右键添加隐藏/显示文件及扩展名工具 &amp; Color 0A<br>
cd %systemroot%\system32<br>
call :IsAdmin<br>
set HideFileExt=%WINDIR%\SYSTEM32\HideFileExt.vbs<br>
echo Dim WSHShell&gt;%HideFileExt%<br>
echo Set WSHShell = WScript.CreateObject("WScript.Shell")&gt;&gt;%HideFileExt%<br>
echo. &gt;&gt;%HideFileExt%<br>
echo ' 读取当前隐藏状态&gt;&gt;%HideFileExt%<br>
echo If WSHShell.RegRead("HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Hidden") = 1 Then&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;' 若当前显示隐藏文件，则设置为隐藏&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;WSHShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Hidden", 2, "REG_DWORD"&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;WSHShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideFileExt", 1, "REG_DWORD"&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;WSHShell.RegWrite "HKCR\Directory\Background\shell\HideFileExt\MuiVerb","显示文件及扩展名","REG_EXPAND_SZ"&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;WSHShell.Popup "已隐藏系统文件和扩展名", 1, "操作成功", vbInformation&gt;&gt;%HideFileExt%<br>
echo Else&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;' 若当前隐藏文件，则设置为显示&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;WSHShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Hidden", 1, "REG_DWORD"&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;WSHShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideFileExt", 0, "REG_DWORD"&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;WSHShell.RegWrite "HKCR\Directory\Background\shell\HideFileExt\MuiVerb","隐藏文件及扩展名","REG_EXPAND_SZ"&gt;&gt;%HideFileExt%<br>
echo&nbsp; &nbsp;&nbsp;&nbsp;WSHShell.Popup "已显示系统文件和扩展名", 1, "操作成功", vbInformation&gt;&gt;%HideFileExt%<br>
echo End If&gt;&gt;%HideFileExt%<br>
echo. &gt;&gt;%HideFileExt%<br>
echo ' 刷新资源管理器&gt;&gt;%HideFileExt%<br>
echo WSHShell.SendKeys "{F5}"&gt;&gt;%HideFileExt%<br>
echo Set WSHShell = Nothing&gt;&gt;%HideFileExt%<br>
Reg add "HKCR\Directory\Background\shell\HideFileExt" /v "MuiVerb" /t REG_SZ /d "隐藏文件及扩展名" /f<br>
Reg add "HKCR\Directory\Background\shell\HideFileExt" /v "Icon" /t REG_EXPAND_SZ /d "%%WINDIR%%\System32\SHELL32.DLL,130" /f<br>
Reg add "HKCR\Directory\Background\shell\HideFileExt\Command" /ve /t&nbsp;&nbsp;REG_EXPAND_SZ /d "wscript.exe \"%%WINDIR%%\System32\HideFileExt.vbs\"" /f<br>
Exit<br>
<br>
:IsAdmin<br>
Reg.exe query "HKU\S-1-5-19\Environment"<br>
If Not %ERRORLEVEL% EQU 0 (<br>
 Cls &amp; Echo You must have administrator rights to continue ... <br>
 Pause &amp; Exit<br>
)<br>
Cls<br>
goto:eof<br>
</td></tr></tbody></table>


