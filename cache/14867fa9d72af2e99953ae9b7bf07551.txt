
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Dr-Harrison-Wells/p/18722912" title="发布于 2025-02-18 21:42">
    <span role="heading" aria-level="2">.NET Aspire中的scalar返回NetworkError when attempting to fetch resource 如何解决</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>在.NET Aspire中使用swagger或者scalar做测试时发现，无论哪个API接口，返回的结果都如下图所示（NetworkError when attempting to fetch resource）：<br>
<img src="https://img2024.cnblogs.com/blog/3605789/202502/3605789-20250218211258028-608908990.png" alt="" loading="lazy"></p>
<p>这个问题是由于.NET Core在使用OpenApi时没有转发正确的网络地址导致的</p>
<p>正确的地址（端口号7234）：<br>
<img src="https://img2024.cnblogs.com/blog/3605789/202502/3605789-20250218212313439-1704942381.png" alt="" loading="lazy"></p>
<p>scalar中的地址（错误端口号10050）:<br>
<img src="https://img2024.cnblogs.com/blog/3605789/202502/3605789-20250218212331786-1507475075.png" alt="" loading="lazy"></p>
<p>可以通过添加配置，从而正确转发网络地址（端口号7234）:</p>
<pre><code class="language-c#">app.MapScalarApiReference(options =&gt; options.Servers = []);
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3605789/202502/3605789-20250218213259848-210568534.png" alt="" loading="lazy"></p>
<p>另一种方式是使用跨域解决该问题：</p>
<pre><code class="language-c#">builder.Services.AddCors(options =&gt;
{
    options.AddPolicy("GetorPost",
        builder =&gt;
        builder.AllowAnyOrigin().WithMethods("GET", "POST")
        .AllowAnyHeader());
});
-------------分割线（省略部分代码）-----------
app.UseCors("GetorPost");
</code></pre>
<p>但是这样做并不会显示正确的地址，只是在测试时会返回正确的结果。因此，优先选择第一种方式。</p>
<p>可以在github中找到相似的问题：</p>
<blockquote>
<p><a href="https://github.com/dotnet/aspnetcore/issues/57332#issuecomment-2479286855" target="_blank" rel="noopener nofollow">https://github.com/dotnet/aspnetcore/issues/57332#issuecomment-2479286855</a></p>
</blockquote>
<p>或者是stackoverflow:</p>
<blockquote>
<p><a href="https://stackoverflow.com/questions/79208910/cors-error-when-using-swagger-openai-in-net-9-aspire-application" target="_blank" rel="noopener nofollow">https://stackoverflow.com/questions/79208910/cors-error-when-using-swagger-openai-in-net-9-aspire-application</a></p>
</blockquote>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.35449427596527777" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-02-18 21:43">2025-02-18 21:42</span>&nbsp;
<a href="https://www.cnblogs.com/Dr-Harrison-Wells">Dr_Harrison_Wells</a>&nbsp;
阅读(<span id="post_view_count">1</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18722912" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18722912);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18722912', targetLink: 'https://www.cnblogs.com/Dr-Harrison-Wells/p/18722912', title: '.NET Aspire中的scalar返回NetworkError when attempting to fetch resource 如何解决' })">举报</a>
</div>
        