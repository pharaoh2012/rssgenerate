
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/uzuki/p/18799724" title="发布于 2025-03-29 18:02">
    <span role="heading" aria-level="2">AI可解释性 I | 对抗样本（Adversarial Sample）论文导读（持续更新）- Part I</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        本文作为AI可解释性系列的第一部分，旨在以汉语整理并阅读对抗攻击（Adversarial Attack）相关的论文，并持续更新。与此同时，AI可解释性系列的第二部分：归因方法（Attribution）也即将上线，敬请期待。
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ai可解释性-i--对抗样本adversarial-sample论文导读持续更新">AI可解释性 I | 对抗样本（Adversarial Sample）论文导读（持续更新）</h1>
<h2 id="导言">导言</h2>
<p>本文作为AI可解释性系列的第一部分，旨在以汉语整理并阅读对抗攻击（Adversarial Attack）相关的论文，并持续更新。与此同时，AI可解释性系列的第二部分：归因方法（Attribution）也即将上线，敬请期待。</p>
<h2 id="intriguing-properties-of-neural-networksdec-2013">Intriguing properties of neural networks（Dec 2013）</h2>
<p>作者：Christian Szegedy</p>
<h3 id="简介">简介</h3>
<p><em>Intriguing properties of neural networks</em> 乃是对抗攻击的开山之作，首次发现并将对抗样本命名为Adversarial Sample，首先发现了神经网络存在的两个性质：</p>
<ol>
<li>
<p>单个高层神经元和多个高层神经元的线性组合之间并无差别，即表示语义信息的是高层神经元的空间而非某个具体的神经元</p>
<blockquote>
<p>there is no distinction between individual high level units and random linear combinations of high level units, ..., it is the space, rather than the individual units, that contains of <strong>the semantic information in the high layers of neural networks.</strong></p>
</blockquote>
</li>
<li>
<p>神经网络的输入-输出之间的映射很大程度是不连续的，可以通过对样本施加难以觉察的噪声扰动（perturbation）最大化网络预测误差以使得网络错误分类，并且可以证明这种扰动并不是一种随机的学习走样（random artifact of learning），可以应用在不同数据集训练的不同结构的神经网络</p>
<blockquote>
<p>we find that deep neural networks learn <strong>input-output mappings that are fairly discontinuous</strong> to a significant extend. Specifically, we find that we can cause the network to <strong>misclassify an image by applying a certain imperceptible perturbation, which is found by maximizing the network's prediction error</strong>. In addition, the specific nature of these perturbations is n<strong>ot a random artifact of learning</strong>: the same perturbation can cause a different network, that was trained on a different subset of the dataset, to misclassify the same input.</p>
</blockquote>
</li>
</ol>
<h3 id="神经元激活">神经元激活</h3>
<p>文章通过实验证明，某个神经元的方向（natural basis direction）和随机挑选一个方向（random basis）再和整个层级的激活值作余弦相似度之后的结果完全不可区分。</p>
<p><img src="https://img2024.cnblogs.com/blog/1887071/202503/1887071-20250329175914258-540629450.png" alt="" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/1887071/202503/1887071-20250329175917310-1670472200.png" alt="" loading="lazy"></p>
<p>可以证明，单个神经元的解释程度和整个层级的解释程度不分伯仲，即所谓”神经网络解耦了不同坐标上的特征“存在疑问。</p>
<blockquote>
<p>This suggest that the natural basis is not better than a random basis in for inspecting the properties of <span class="math inline">\(\phi(x)\)</span>. Moreover, it puts into question the notion that neural networks disentangle variation factors across coordinates.</p>
</blockquote>
<p>虽然每个层级似乎在了输入分布的某个部分存在不变性，但是很明显在这些部分的邻域中又存在着一种反直觉的未定义的行为。</p>
<h3 id="神经网络的盲点blind-spots-in-neural-networks">神经网络的盲点（Blind Spots in Neural Networks）</h3>
<p>观点认为神经网络的多层非线性叠加的目的就是为了使得模型对样本空间进行非局部泛化先验（non-local generalization prior）的编码，换句话说，输出可能会对其周围没有训练样本的输入空间邻域分配不显著（推测约为非<span class="math inline">\(\epsilon\)</span>）的概率（对抗攻击可以发生的假设）。这样做的好处在于，不同视角的同一张图片可能在像素空间产生变化，但是经过非局部泛化先验编码使得在概率上的输出是不变的。</p>
<blockquote>
<p>In other words, it is possible for the output unit to assign non-significant (and, presumably, non-epsilon) probabilities to regions of the input space that contain no training examples in their vicinity.</p>
</blockquote>
<p>这里可以推导出一种平滑性假设，即训练样本在<span class="math inline">\(\epsilon\)</span>领域内（<span class="math inline">\(||x^\prime-x||&lt;\epsilon\)</span>）的所有样本都是满足和训练样本的类别一致。</p>
<blockquote>
<p>And that in particular, for a small enough radius " in the vicinity of a given training input x, an x " which satisfies ||x  x " || &lt; " will get assigned a high probability of the correct class by the model.</p>
<p>Uzuki评论：神经网络验证做的工作就是寻找这个<span class="math inline">\(\epsilon\)</span>，证明在<span class="math inline">\(\epsilon\)</span>邻域内不存在对抗样本</p>
</blockquote>
<p>接下来，作者将通过实验证明这种平滑性假设在很多的核方法（kernel method）上都是不成立的，可以通过一种高效的优化算法完成（即对抗攻击），这种优化过程在于遍历从网络形成的流形上以寻找“对抗样本”。这些样本在网络的高维流形上被认为是低概率出现的局部“口袋“。</p>
<blockquote>
<p>In some sense, what we describe is a way to traverse the manifold represented by the network in an efficient way (by optimization) and finding adversarial examples in the input space.</p>
</blockquote>
<h3 id="算法的形式化描述">算法的形式化描述</h3>
<p>给定一个分类器<span class="math inline">\(f:\mathbb{R}^m\rightarrow \{1\dots k\}\)</span>以及一个连续的损失函数<span class="math inline">\(\mathbb{R}^m\times\{1\dots k\} \rightarrow  \mathbb{R}^+\)</span>，输入图像<span class="math inline">\(x\in\mathbb{R}^m\)</span>和目标类别${1\dots k} $以解开下面如下的箱约束（box-constrained）问题：</p>
<ul>
<li>最小化<span class="math inline">\(||r||_2\)</span>并保证：
<ol>
<li><span class="math inline">\(f(x+r)=l\)</span></li>
<li><span class="math inline">\(x+r\in[0,1]^m\)</span>（确保是RGB范围）</li>
</ol>
</li>
</ul>
<p>这个问题只要<span class="math inline">\(f(x)\neq l\)</span>就是一个非平凡的难解问题，因此我们通过box-constrained L-BFGS算法去优化近似求解。问题可以如下表示：通过线搜索找到一个最小的<span class="math inline">\(c\)</span>，以最小化<span class="math inline">\(r\)</span></p>
<ul>
<li>最小化<span class="math inline">\(c|r|+\text{loss}_f(x+r,l)\quad s.t.\quad x+r\in[0,1]^m\)</span></li>
</ul>
<blockquote>
<p>In general, the exact computation of D(x, l) is a hard problem, so we approximate it by using a box-constrained L-BFGS. Concretely, we find an approximation of D(x, l) by performing line-search to find the minimum c &gt; 0 for which the minimizer r of the following problem satisfies f (x + r) = l.</p>
</blockquote>
<h3 id="实验">实验</h3>
<p>通过实验，可以得到如下三个结论：</p>
<ol>
<li>对于文章研究的所有网络（包括MNIST、QuocNet、AlexNet），针对每个样本，始终能够生成与原始样本极其相似、视觉上无法区分的对抗样本，且这些样本均被原网络误分类。</li>
<li>跨模型的泛化性：当使用不同超参数（如层数、正则化项或初始权重）从头训练网络时，仍有相当比例的对抗样本会被误分类。</li>
<li>跨训练集的泛化性：在完全不同的训练集上从头训练的网络，同样会误分类相当数量的对抗样本。</li>
</ol>
<blockquote>
<ol>
<li>For all the networks we studied (MNIST, QuocNet [10], AlexNet [9]), for each sample, we always manage to generate very close, visually indistinguishable, adversarial examples that are misclassified by the original network (see figure 5 for examples).</li>
<li>Cross model generalization: a relatively large fraction of examples will be misclassified by networks trained from scratch with different hyper-parameters (number of layers, regularization or initial weights).</li>
<li>Cross training-set generalization a relatively large fraction of examples will be misclassified by networks trained from scratch trained on a disjoint training set.</li>
</ol>
</blockquote>
<p>可以证明对抗样本存在<strong>普适性</strong>，一个微妙但关键的细节是：对抗样本需针对每一层的输出生成，并用于训练该层之上的所有层级。实验表明，高层生成的对抗样本比输入层或低层生成的更具训练价值。</p>
<blockquote>
<p>A subtle, but essential detail is that adversarial examples are generated for each layer output and are used to train all the layers above. Adversarial examples for the higher layers seem to be more useful than those on the input or lower layers.</p>
</blockquote>
<p>然而，这个实验仍然留下了关于训练集依赖性的问题。生成示例的难度是否仅仅依赖于我们训练集作为样本的特定选择，还是这一效应能够泛化到在完全不同训练集上训练的模型？</p>
<blockquote>
<p>Still, this experiment leaves open the question of dependence over the training set. Does the hardness of the generated examples rely solely on the particular choice of our training set as a sample or does this effect generalize even to models trained on completely different training sets?</p>
</blockquote>
<p>因此作者进行了一个迁移性实验，将MNIST的训练集切分成两个大小为30000的部分<span class="math inline">\(P_1\)</span>和<span class="math inline">\(P_2\)</span>，用以训练三个全连接网络：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>结构</th>
<th>训练数据</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="math inline">\(M_1\)</span></td>
<td>100-100-10</td>
<td><span class="math inline">\(P_1\)</span></td>
</tr>
<tr>
<td><span class="math inline">\(M_1^\prime\)</span></td>
<td>123-456-10</td>
<td><span class="math inline">\(P_1\)</span></td>
</tr>
<tr>
<td><span class="math inline">\(M_2\)</span></td>
<td>100-100-10</td>
<td><span class="math inline">\(P_2\)</span></td>
</tr>
</tbody>
</table>
<p>接下来在每个网络上使用测试集训练对抗样本，并将这些对抗样本迁移到其他网络上，这些对抗样本对其他网络同样有效果。</p>
<blockquote>
<p>Uzuki评论：这个性质为对抗攻击的迁移性（transferability）提供了保证，那些无法得知内部结构黑盒网络，可以通过一个结构类似的白盒作为代理（surrogate model）生成对抗样本。</p>
</blockquote>
<p>因此可以得到一个有趣的结论：即使在不相交的训练集上训练的模型，对抗样本仍然难以处理，尽管它们的有效性显著降低。</p>
<blockquote>
<p>The intriguing conclusion is that the adversarial examples remain hard for models trained even on a disjoint training set, although their effectiveness decreases considerably.</p>
</blockquote>
<h3 id="网络不稳定性的谱分析">网络不稳定性的谱分析</h3>
<p>作者将上一节提出这种监督学习网络对这些特定的扰动族存在的不稳定性可以被如下数学表示：</p>
<p>给定多个集合对<span class="math inline">\((x_i,n_i)\)</span>，使得<span class="math inline">\(||n_i||&lt;\delta\)</span>但<span class="math inline">\(||\phi(x_i;W)-\phi(x_i+n_i;W)||\ge M \ge 0\)</span>，其中<span class="math inline">\(\delta\)</span>是一个非常小的值，<span class="math inline">\(W\)</span>是一个一般的可训练参数。那么这个不稳定的扰动<span class="math inline">\(n_i\)</span>取决于网络结构<span class="math inline">\(\phi\)</span>而非特定训练的参数<span class="math inline">\(W\)</span></p>
<blockquote>
<p>Uzuki评论：这个结论就不得不提对抗训练（Adversarial training）了，因为对抗训练不改变网络结构但是改变了训练集的结构以生成不同的训练参数，提高模型对对抗样本的防护能力，因此对抗训练应该是证明了某个特定的对抗样本生成算法本身总不是最优的</p>
</blockquote>
<h3 id="结论">结论</h3>
<p>通过寻找对抗样本的过程，我们可以证明神经网络本身并没有很好地实现泛化能力，尽管这些对抗样本在训练过程中出现的概率是极低的，但是模型构建的空间本身是稠密的，几乎每个正常样本都能寻找到对抗样本。</p>
<h2 id="explaining-and-haressing-adversarial-examplesmar-2015">Explaining and Haressing Adversarial Examples（Mar 2015）</h2>
<p>作者：Ian J. Goodfellow</p>
<h3 id="简介-1">简介</h3>
<p>本文作为对<em>Intriguing properties of neural networks</em>一文的修正，指出神经网络对对抗样本的敏感性并非源自于非线性而是线性上，并利用这个性质提出了一种更高效的线性攻击：Fast Gradient Sign Method （FGSM）。同时提出了一种正则化方法称为对抗训练（Adversarial training）有助于提高网络对对抗样本的抗性。并证明传统的正则化方法例如dropout，预训练以及模型集成并不能很好地提高模型对于对抗样本的抗性，但是将模型换成非线性结构确能提高模型的抗性。</p>
<p>作者认为，在设计由于其线性而易于训练的模型与设计利用非线性效应以抵抗对抗扰动的模型之间存在根本性的矛盾。因此长期来看，神经网络的突破应该在于提出一种更好的训练方法以应对非线性的网络。</p>
<blockquote>
<p>Our explanation suggests a fundamental tension between designing models that are easy to train due to their linearity and designing models that use nonlinear effects to resist adversarial perturbation.</p>
</blockquote>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.6877379595648148" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-30 01:45">2025-03-29 18:02</span>&nbsp;
<a href="https://www.cnblogs.com/uzuki">Uzuki</a>&nbsp;
阅读(<span id="post_view_count">61</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18799724" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18799724);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18799724', targetLink: 'https://www.cnblogs.com/uzuki/p/18799724', title: 'AI可解释性 I | 对抗样本（Adversarial Sample）论文导读（持续更新）- Part I' })">举报</a>
</div>
        