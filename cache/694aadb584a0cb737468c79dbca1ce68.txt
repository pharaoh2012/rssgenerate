
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/songmin/p/18900380/flutter-plus-cursor-to-develop-ohos-app" title="å‘å¸ƒäº 2025-05-28 14:08">
    <span role="heading" aria-level="2">ã€æ‹¥æŠ±é¸¿è’™ã€‘Flutter+Cursorè½»æ¾æ‰“é€ HarmonyOSåº”ç”¨ï¼ˆä¸€ï¼‰</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3652266/202505/3652266-20250528120909749-1631757322.png" alt="ã€æ‹¥æŠ±é¸¿è’™ã€‘Flutter+Cursorè½»æ¾æ‰“é€ HarmonyOSåº”ç”¨ï¼ˆä¸€ï¼‰" class="desc_img">
        éšç€HarmonyOSçš„å´›èµ·ï¼Œè®¸å¤šå¼€å‘è€…å¼€å§‹æ¢ç´¢å¦‚ä½•å°†Flutteråº”ç”¨è¿ç§»åˆ°é¸¿è’™ç”Ÿæ€ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œä½¿ç”¨Flutterå¼€å‘HarmonyOSåº”ç”¨ï¼Œå¹¶å€ŸåŠ©å¼ºå¤§çš„AIç¼–ç¨‹åŠ©æ‰‹Cursoræ¥åŠ é€ŸUIå¼€å‘è¿‡ç¨‹ã€‚
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>åœ¨ç§»åŠ¨åº”ç”¨å¼€å‘é¢†åŸŸï¼ŒFlutterä»¥å…¶å‡ºè‰²çš„è·¨å¹³å°èƒ½åŠ›å’Œé«˜æ•ˆçš„å¼€å‘ä½“éªŒèµ¢å¾—äº†ä¼—å¤šå¼€å‘è€…çš„é’çï¼Œæ˜¯è®¸å¤šç§»åŠ¨å¼€å‘è€…æ··åˆå¼€å‘çš„é¦–é€‰ã€‚</p>
<p>éšç€HarmonyOSçš„å´›èµ·ï¼Œè®¸å¤šå¼€å‘è€…å¼€å§‹æ¢ç´¢å¦‚ä½•å°†Flutteråº”ç”¨è¿ç§»åˆ°é¸¿è’™ç”Ÿæ€ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œä½¿ç”¨Flutterå¼€å‘HarmonyOSåº”ç”¨ï¼Œå¹¶å€ŸåŠ©å¼ºå¤§çš„AIç¼–ç¨‹åŠ©æ‰‹Cursoræ¥åŠ é€ŸUIå¼€å‘è¿‡ç¨‹ã€‚</p>
<p>è¿™æ˜¯â€œã€æ‹¥æŠ±é¸¿è’™ã€‘Flutter+Cursorè½»æ¾æ‰“é€ HarmonyOSåº”ç”¨â€ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ã€‚</p>
<h2 id="ä¸€ç¯å¢ƒå‡†å¤‡æ­å»ºflutter-for-harmonyoså¼€å‘ç¯å¢ƒ">ä¸€ã€ç¯å¢ƒå‡†å¤‡ï¼šæ­å»ºFlutter for HarmonyOSå¼€å‘ç¯å¢ƒ</h2>
<h3 id="11-åŸºç¡€å·¥å…·å®‰è£…">1.1 åŸºç¡€å·¥å…·å®‰è£…</h3>
<p>é¦–å…ˆç¡®ä¿ä½ çš„å¼€å‘æœºå™¨å·²å®‰è£…ä»¥ä¸‹åŸºç¡€å·¥å…·ï¼š</p>
<ul>
<li>
<p><strong>Flutter SDK</strong>ï¼ˆæ¨è3.13.0æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰</p>
<pre><code class="language-bash"># ä¸‹è½½Flutter SDK
git clone https://github.com/flutter/flutter.git -b stable

# æ·»åŠ ç¯å¢ƒå˜é‡
export PATH="$PATH:`pwd`/flutter/bin"

# è¿è¡Œflutter doctoræ£€æŸ¥ä¾èµ–
flutter doctor
</code></pre>
</li>
<li>
<p><strong>HarmonyOSå¼€å‘å·¥å…·</strong>ï¼š<br>
API12, deveco-studio-5.0 æˆ– command-line-tools-5.0 (æ¨èä½¿ç”¨5.0.0 Releaseæˆ–æ›´æ–°ç‰ˆæœ¬)</p>
</li>
<li>
<p><strong>JDK17</strong></p>
</li>
<li>
<p><strong>é…ç½®ç¯å¢ƒå˜é‡</strong></p>
</li>
</ul>
<pre><code class="language-bash"> export TOOL_HOME=/Applications/DevEco-Studio.app/Contents # macç¯å¢ƒ
 export DEVECO_SDK_HOME=$TOOL_HOME/sdk # command-line-tools/sdk
 export PATH=$TOOL_HOME/tools/ohpm/bin:$PATH # command-line-tools/ohpm/bin
 export PATH=$TOOL_HOME/tools/hvigor/bin:$PATH # command-line-tools/hvigor/bin
 export PATH=$TOOL_HOME/tools/node/bin:$PATH # command-line-tools/tool/node/bin
</code></pre>
<p>ğŸ“¢ğŸ“¢ğŸ“¢æ³¨æ„<br>
è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼Œæ”¯æŒé¸¿è’™çš„Flutter SDKç‰ˆæœ¬ç›®å‰æ˜¯3.22.0ç‰ˆæœ¬ã€‚åœ¨å¼€å‘é€‚é…iOSå’ŒAndroidæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„Flutterç‰ˆæœ¬å¯èƒ½é«˜äº3.22.0ã€‚è¿™æ—¶ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨<a href="https://fvm.app/documentation/getting-started/installation" target="_blank" rel="noopener nofollow">fvm</a>å¯¹Flutterç‰ˆæœ¬è¿›è¡Œç®¡ç†ï¼Œå¯ä»¥åŒæ—¶ç»´æŠ¤å’Œåˆ‡æ¢å¤šä¸ªFlutterç‰ˆæœ¬ã€‚åŒæ—¶ä¹Ÿå»ºè®®ï¼ŒFlutterçš„é¸¿è’™åº”ç”¨ä»“åº“æœ€å¥½å’Œå…¶ä»–ç«¯ä»“åº“åˆ†å¼€ï¼Œå› ä¸ºç›®å‰æ”¯æŒé¸¿è’™çš„Flutterç‰ˆæœ¬æ˜¯æ»åäºFlutterå®˜æ–¹ç‰ˆæœ¬çš„ã€‚</p>
<p>ä½¿ç”¨<code>fvm</code>ç»´æŠ¤å¤šä¸ªç‰ˆæœ¬ç¤ºä¾‹ï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/3652266/202505/3652266-20250528120641798-1526553591.png" alt="4001" loading="lazy"></p>
<h3 id="12-é…ç½®flutteré¸¿è’™æ”¯æŒ">1.2 é…ç½®Flutteré¸¿è’™æ”¯æŒ</h3>
<p>ç›®å‰Flutterå¯¹HarmonyOSçš„æ”¯æŒä¸»è¦é€šè¿‡å¼€æºé¡¹ç›®<a href="https://gitcode.com/openharmony-sig/flutter_flutter/tree/3.22.0-ohos" target="_blank" rel="noopener nofollow">OpenHarmony-TPC/flutter_flutter</a>å®ç°ã€‚</p>
<p>è¯¥ä»“åº“æ˜¯åŸºäºFlutterå®˜æ–¹ä»“åº“çš„3.22.0ç‰ˆæœ¬ï¼Œå¯¹äºOpenHarmonyå¹³å°çš„å…¼å®¹æ‹“å±•ã€‚å¯æ”¯æŒIDEæˆ–è€…ç»ˆç«¯ä½¿ç”¨Flutter ToolsæŒ‡ä»¤ç¼–è¯‘å’Œæ„å»ºOpenHarmonyåº”ç”¨ç¨‹åºã€‚</p>
<p>Buildå‰éœ€ä½¿ç”¨fvmåˆ‡æ¢Flutterç‰ˆæœ¬ï¼š</p>
<pre><code class="language-bash">fvm use custom_3.22.0
</code></pre>
<h3 id="13-ç¯å¢ƒéªŒè¯">1.3 ç¯å¢ƒéªŒè¯</h3>
<p>åˆ›å»ºæ–°é¡¹ç›®å¹¶æ£€æŸ¥é¸¿è’™æ”¯æŒï¼š</p>
<pre><code class="language-bash">flutter create my_harmony_app
cd my_harmony_app
flutter run -d harmony
</code></pre>
<p>å¦‚æœçœ‹åˆ°é¸¿è’™æ¨¡æ‹Ÿå™¨æˆ–çœŸæœºä¸Šè¿è¡Œç€Flutterçš„é»˜è®¤å¯åŠ¨é¡µé¢ï¼Œè¯´æ˜ç¯å¢ƒé…ç½®æˆåŠŸï¼</p>
<h2 id="äºŒflutteré¸¿è’™å¼€å‘æ¡†æ¶è§£æ">äºŒã€Flutteré¸¿è’™å¼€å‘æ¡†æ¶è§£æ</h2>
<h3 id="21-æ¶æ„æ¦‚è§ˆ">2.1 æ¶æ„æ¦‚è§ˆ</h3>
<p>Flutteråœ¨HarmonyOSä¸Šçš„è¿è¡Œæ¶æ„åˆ†ä¸ºä¸‰å±‚ï¼š</p>
<ol>
<li><strong>æ¡†æ¶å±‚</strong>ï¼šDartå®ç°çš„Flutteræ¡†æ¶</li>
<li><strong>å¼•æ“å±‚</strong>ï¼šSkiaæ¸²æŸ“å¼•æ“+é¸¿è’™é€‚é…å±‚</li>
<li><strong>ç³»ç»Ÿå±‚</strong>ï¼šHarmonyOSçš„ACEï¼ˆAbility Cross-platform Environmentï¼‰</li>
</ol>
<h3 id="22-å…³é”®å·®å¼‚ç‚¹">2.2 å…³é”®å·®å¼‚ç‚¹</h3>
<p>ä¸Android/iOSå¹³å°ç›¸æ¯”ï¼ŒFlutteråœ¨é¸¿è’™ä¸Šéœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li><strong>é¡µé¢å¯¼èˆª</strong>ï¼šä½¿ç”¨HarmonyOSçš„Page Abilityè€ŒéActivity/ViewController</li>
<li><strong>æƒé™ç³»ç»Ÿ</strong>ï¼šé¸¿è’™ç‰¹æœ‰çš„æƒé™å£°æ˜æ–¹å¼</li>
<li><strong>åŸç”Ÿäº¤äº’</strong>ï¼šé€šè¿‡<code>ffi</code>ä¸é¸¿è’™çš„Native APIé€šä¿¡</li>
</ul>
<h3 id="23-å¸¸ç”¨é€‚é…ç»„ä»¶">2.3 å¸¸ç”¨é€‚é…ç»„ä»¶</h3>
<pre><code class="language-dart">import 'package:flutter_harmony/harmony.dart';

// é¸¿è’™ç‰¹è‰²çš„ç»„ä»¶
HarmonyApp(
  config: HarmonyConfig(
    abilityName: 'MainAbility', // å¯¹åº”çš„é¸¿è’™Abilityåç§°
  ),
  home: MyHomePage(),
);
</code></pre>
<h2 id="ä¸‰flutterä¸é¸¿è’™åŸç”Ÿäº¤äº’">ä¸‰ã€Flutterä¸é¸¿è’™åŸç”Ÿäº¤äº’</h2>
<h3 id="31-å¯¼å…¥åŸç”Ÿæ’ä»¶">3.1 å¯¼å…¥åŸç”Ÿæ’ä»¶</h3>
<p>ä¸å…¶ä»–ç«¯ç±»ä¼¼ï¼Œohoså·¥ç¨‹ä¸­éœ€è¦<code>GeneratedPluginRegistrant.ets</code>æ–‡ä»¶å¯¼å…¥Flutterç”Ÿæˆçš„åŸç”Ÿæ’ä»¶ã€‚</p>
<h3 id="32-å®ç°flutterplugin">3.2 å®ç°FlutterPlugin</h3>
<p>å®šä¹‰ä¸€ä¸ªç±»ä½œä¸º<code>FlutterPlugin</code>çš„å®ç°ï¼Œå¹¶åœ¨<code>onAttachedToEngine(binding: FlutterPluginBinding): void </code>æ–¹æ³•ä¸­ä½¿ç”¨<code>MethodChannel</code>ç›‘å¬Flutterè°ƒç”¨çš„æ–¹æ³•ã€‚</p>
<pre><code class="language-typescript">export default class HMFlutterPlugin implements FlutterPlugin {
  private channel?: MethodChannel;
  private basicChannel?: BasicMessageChannel&lt;Any&gt;;
  private context?: common.UIAbilityContext;

  setContext(context: common.UIAbilityContext) {
    this.context = context;
  }

  onAttachedToEngine(binding: FlutterPluginBinding): void {
    this.channel = new MethodChannel(binding.getBinaryMessenger(), "com.xxx.app/message");
    this.channel.setMethodCallHandler({
      onMethodCall: (call: MethodCall, result: MethodResult) =&gt; {
        if (!this.context) {
          result.error("CONTEXT_NOT_INITIALIZED", "Context is not initialized", null);
        }

        const argsRec = call.args as Map&lt;string, Object&gt;;
        LogUtil.info(`[flutter-call-ohos]\nmethod: ${call.method}\nargs: ${JSONUtil.toJSONString(argsRec)}`);
        switch (call.method) {
          case "xxx": {
            break;
          }
          default: break;
        }
}
</code></pre>
<h3 id="33-é…ç½®flutterengine">3.3 é…ç½®FlutterEngine</h3>
<p>åœ¨EntryAbility.etsä¸­å®ç°<code>configureFlutterEngine(flutterEngine: FlutterEngine) </code>æ–¹æ³•ã€‚</p>
<pre><code class="language-typescript">configureFlutterEngine(flutterEngine: FlutterEngine) {
    super.configureFlutterEngine(flutterEngine)
    GeneratedPluginRegistrant.registerWith(flutterEngine)
    const plugin = new HMFlutterPlugin();
    plugin.setContext(this.context);
    this.addPlugin(plugin);
  }
</code></pre>
<h3 id="34-å›è°ƒè¿”å›ç»™flutterç«¯">3.4 å›è°ƒè¿”å›ç»™Flutterç«¯</h3>
<p>ä½¿ç”¨<code>result.success(res);</code>å›è°ƒæ‰§è¡ŒæˆåŠŸçš„æ•°æ®ï¼›ä½¿ç”¨<code>result.error(errorCode, error.message, null);</code>å›è°ƒæ‰§è¡Œå¤±è´¥çš„é”™è¯¯ä¿¡æ¯ã€‚</p>
<pre><code class="language-typescript">try {
    // xxxæ¥å£åŠŸèƒ½å®ç°
    result.success(res);
} catch (err) {
    let error = err as BusinessError;
    result.error(errorCode, error.message, null);
}
</code></pre>
<h3 id="35-flutterè°ƒç”¨é¸¿è’™åŸç”Ÿæ–¹æ³•å¹¶æ¥æ”¶å›è°ƒæ•°æ®">3.5 Flutterè°ƒç”¨é¸¿è’™åŸç”Ÿæ–¹æ³•å¹¶æ¥æ”¶å›è°ƒæ•°æ®</h3>
<pre><code class="language-dart">try {
    final res = await _channel.invokeMethod('method_ohos');
    return res.toString().toLowerCase() == 'true' || res.toString() == '1';
} catch (e) {
    printError('get network status error: $e');
}
</code></pre>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>æœ¬ç¯‡ä¸»è¦ä»‹ç»äº†Flutterå¼€å‘é¸¿è’™åº”ç”¨çš„ç¯å¢ƒæ­å»ºå’Œäº¤äº’ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ç¯‡ä»‹ç»å¦‚ä½•å€ŸåŠ©Cursoræé«˜å¼€å‘æ•ˆç‡è®©æˆ‘ä»¬çš„å¼€å‘ä¹‹æ—…è½»æ¾è€Œæœ‰è¶£ã€‚</p>
<p>æˆ‘æ˜¯éƒ‘çŸ¥é±¼ğŸ³ï¼Œæ¬¢è¿å¤§å®¶è®¨è®ºä¸æŒ‡æ•™ã€‚<br>
å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿè¯·ç‚¹èµğŸ‘ğŸ»æ”¶è—â­ï¸å…³æ³¨ğŸ”æˆ‘å§~~</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.009465718256944445" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-28 14:08">2025-05-28 14:08</span>&nbsp;
<a href="https://www.cnblogs.com/songmin">éƒ‘çŸ¥é±¼</a>&nbsp;
é˜…è¯»(<span id="post_view_count">0</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18900380);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18900380', targetLink: 'https://www.cnblogs.com/songmin/p/18900380/flutter-plus-cursor-to-develop-ohos-app', title: 'ã€æ‹¥æŠ±é¸¿è’™ã€‘Flutter+Cursorè½»æ¾æ‰“é€ HarmonyOSåº”ç”¨ï¼ˆä¸€ï¼‰' })">ä¸¾æŠ¥</a>
</div>
        