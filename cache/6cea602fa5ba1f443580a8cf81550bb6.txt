
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Yesi/p/18825067" title="发布于 2025-04-14 16:03">
    <span role="heading" aria-level="2">通过 Python 在PDF中添加、或删除超链接</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>PDF文件现已成为文档存储和分发的首选格式。然而，PDF文件的静态特性有时会限制其交互性。超链接是提高PDF文件互动性和用户体验的关键元素。Python作为一种强大的编程语言，拥有多种库和工具来处理PDF文件，包括添加、删除超链接。本文将详细介绍如何使用第三方库Spire.PDF for Python来进行这些操作。</p>
<ul>
<li>Python 在PDF文档中添加超链接</li>
<li>Python 删除PDF 文档中的超链接</li>
</ul>
<p>&nbsp;</p>
<p>所需Python库&nbsp;-&nbsp;<span style="background-color: rgba(255, 255, 0, 1)"><strong><a href="https://www.e-iceblue.cn/Introduce/Spire-PDF-Python.html" rel="noopener nofollow" target="_blank">Spire.PDF for Python</a></strong></span>。可以通过下面的pip 命令直接安装：</p>
<div class="cnblogs_code">
<pre>pip install Spire.Pdf</pre>
</div>
<p>&nbsp;</p>
<h3>Python 在PDF文档中添加超链接</h3>
<p>Spire.PDF for Python支持在PDF中添加以下几种不同类型的超链接：</p>
<ol>
<li><strong>简单文字链接：</strong>直接使用 <span style="color: rgba(0, 0, 255, 1)"><em>PdfPageBase.Canvas.DrawString()</em> </span>方法将其绘制到页面上。</li>
<li><strong>超文本链接、邮箱链接：</strong>通过 <span style="color: rgba(0, 0, 255, 1)"><em>PdfTextWebLink.DrawTextWebLink()</em></span> 方法绘制到页面上。</li>
<li><strong>文档链接：</strong>通过 <em><span style="color: rgba(0, 0, 255, 1)">PdfPageBase.AnnotationsWidget.Add(PdfFileLinkAnnotation)</span></em> 方法添加。</li>
</ol>
<p>Python 代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">from</span> spire.pdf.common <span style="color: rgba(0, 0, 255, 1)">import</span> *
<span style="color: rgba(0, 0, 255, 1)">from</span> spire.pdf <span style="color: rgba(0, 0, 255, 1)">import</span> *

<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 创建PDF文档</span>
pdf =<span style="color: rgba(0, 0, 0, 1)"> PdfDocument()

</span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 添加页面</span>
page =<span style="color: rgba(0, 0, 0, 1)"> pdf.Pages.Add()

</span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 设置初始X和Y坐标</span>
y = 30.0<span style="color: rgba(0, 0, 0, 1)">
x </span>= 10.0

<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 创建PDF字体</span>
font = PdfTrueTypeFont(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">宋体</span><span style="color: rgba(128, 0, 0, 1)">"</span>, 14.0<span style="color: rgba(0, 0, 0, 1)">, PdfFontStyle.Regular, True)
font1 </span>= PdfTrueTypeFont(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">宋体</span><span style="color: rgba(128, 0, 0, 1)">"</span>, 14.0<span style="color: rgba(0, 0, 0, 1)">, PdfFontStyle.Underline, True)

</span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 添加简单文本链接</span>
label = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">简单链接： </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
format </span>=<span style="color: rgba(0, 0, 0, 1)"> PdfStringFormat()
format.MeasureTrailingSpaces </span>=<span style="color: rgba(0, 0, 0, 1)"> True
page.Canvas.DrawString(label, font, PdfBrushes.get_Black(), </span>0.0<span style="color: rgba(0, 0, 0, 1)">, y, format)
x </span>=<span style="color: rgba(0, 0, 0, 1)"> font.MeasureString(label, format).Width
url </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">https://www.e-iceblue.cn</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
page.Canvas.DrawString(url, font1, PdfBrushes.get_Blue(), x, y)
y </span>= y + 28

<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 添加超文本链接</span>
label = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">超文本链接：</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
page.Canvas.DrawString(label, font, PdfBrushes.get_Black(), </span>0.0<span style="color: rgba(0, 0, 0, 1)">, y, format)
x </span>=<span style="color: rgba(0, 0, 0, 1)"> font.MeasureString(label, format).Width
webLink </span>=<span style="color: rgba(0, 0, 0, 1)"> PdfTextWebLink()
webLink.Text </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">主页</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
webLink.Url </span>=<span style="color: rgba(0, 0, 0, 1)"> url
webLink.Font </span>=<span style="color: rgba(0, 0, 0, 1)"> font1
webLink.Brush </span>=<span style="color: rgba(0, 0, 0, 1)"> PdfBrushes.get_Blue()
webLink.DrawTextWebLink(page.Canvas, PointF(x, y))
y </span>= y + 28

<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 添加邮件链接</span>
label = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">邮件链接： </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
page.Canvas.DrawString(label, font, PdfBrushes.get_Black(), </span>0.0<span style="color: rgba(0, 0, 0, 1)">, y, format)
x </span>=<span style="color: rgba(0, 0, 0, 1)"> font.MeasureString(label, format).Width
link </span>=<span style="color: rgba(0, 0, 0, 1)"> PdfTextWebLink()
link.Text </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">联系我们</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
link.Url </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">mailto:support @e-iceblue.com</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
link.Font </span>=<span style="color: rgba(0, 0, 0, 1)"> font1
link.Brush </span>=<span style="color: rgba(0, 0, 0, 1)"> PdfBrushes.get_Blue()
link.DrawTextWebLink(page.Canvas, PointF(x, y))
y </span>= y + 28

<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 添加文档链接</span>
label = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">文档链接: </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
page.Canvas.DrawString(label, font, PdfBrushes.get_Black(), </span>0.0<span style="color: rgba(0, 0, 0, 1)">, y, format)
x </span>=<span style="color: rgba(0, 0, 0, 1)"> font.MeasureString(label, format).Width
text </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">点击打开文件</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
location </span>=<span style="color: rgba(0, 0, 0, 1)"> PointF(x, y)
size </span>=<span style="color: rgba(0, 0, 0, 1)"> font1.MeasureString(text)
linkBounds </span>=<span style="color: rgba(0, 0, 0, 1)"> RectangleF(location, size)
fileLink </span>= PdfFileLinkAnnotation(linkBounds, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">C:\\Users\\Administrator\\Desktop\\排名.xlsx</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
fileLink.Border </span>= PdfAnnotationBorder(0.0<span style="color: rgba(0, 0, 0, 1)">)
page.AnnotationsWidget.Add(fileLink)
page.Canvas.DrawString(text, font1, PdfBrushes.get_Blue(), x, y)

</span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 保存PDF文档</span>
pdf.SaveToFile(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">PDF超链接.pdf</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
pdf.Close()</span></pre>
</div>
<p><img src="https://img2024.cnblogs.com/blog/706090/202504/706090-20250414160036997-2032882665.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>Python 删除PDF 文档中的超链接</h3>
<p>如果要将PDF文档中已有的超链接一次性全部删除，可以参考以下步骤：</p>
<ol>
<li>通过 <em><span style="color: rgba(0, 0, 255, 1)">LoadFromFile()</span></em> 方法加载 PDF 文档。</li>
<li>循环遍历文档中的页面，并通过 <span style="color: rgba(0, 0, 255, 1)"><em>PdfPageBase.AnnotationsWidget</em></span> 属性获取每个页面上的注释。</li>
<li>循环遍历所有注释，检查每个注释是否为超链接。</li>
<li>如果是，则使用 <em><span style="color: rgba(0, 0, 255, 1)">PdfAnnotationCollection.Remove()</span> </em>方法将其删除。</li>
<li>使用 <em><span style="color: rgba(0, 0, 255, 1)">PdfDocument.SaveToFile()</span> </em>方法保存文档。</li>
</ol>
<p>Python 代码：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">from</span> spire.pdf <span style="color: rgba(0, 0, 255, 1)">import</span> *
<span style="color: rgba(0, 0, 255, 1)">from</span> spire.pdf.common <span style="color: rgba(0, 0, 255, 1)">import</span> *

<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 加载PDF文档</span>
pdf =<span style="color: rgba(0, 0, 0, 1)"> PdfDocument()
pdf.LoadFromFile(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">PDF超链接.pdf</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)

</span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 遍历文档中的所有页面</span>
<span style="color: rgba(0, 0, 255, 1)">for</span> j <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> range(pdf.Pages.Count):
    </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 获取每一页</span>
    page =<span style="color: rgba(0, 0, 0, 1)"> pdf.Pages.get_Item(j)
    </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 获取每一页上的注释</span>
    annotations =<span style="color: rgba(0, 0, 0, 1)"> page.AnnotationsWidget
    </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 检查注释是否为空</span>
    <span style="color: rgba(0, 0, 255, 1)">if</span> annotations.Count &gt;<span style="color: rgba(0, 0, 0, 1)"> 0:
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 遍历所有注释</span>
        i = annotations.Count - 1
        <span style="color: rgba(0, 0, 255, 1)">while</span> i &gt;=<span style="color: rgba(0, 0, 0, 1)">0:
            </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 获取注释</span>
            annotation =<span style="color: rgba(0, 0, 0, 1)"> annotations.get_Item(i)
            </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 检查注释是否为超链接</span>
            <span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> isinstance(annotation, PdfTextWebLinkAnnotationWidget):
                </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 删除超链接</span>
<span style="color: rgba(0, 0, 0, 1)">                annotations.Remove(annotation)
            i </span>-= 1

<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 保存PDF文档</span>
pdf.SaveToFile(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">删除PDF超链接.pdf</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
pdf.Close()</span></pre>
</div>
<p>如果<strong>仅需删除PDF某一页中的指定超链接</strong>，可以参考以下代码：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> 删除第一页中的第一个超链接</span>
page =<span style="color: rgba(0, 0, 0, 1)"> pdf.Pages.get_Item(0)
page.AnnotationsWidget.RemoveAt(0)</span></pre>
</div>
<p>---------------------------------------------------------------------------------------------------------------------</p>
<p>生成文档中的红色水印，可以通过点击以下链接，申请一个月免费授权来去除并完整试用：<br><a href="https://www.e-iceblue.cn/misc/temporary-license.html" rel="noopener nofollow" target="_blank">https://www.e-iceblue.cn/misc/temporary-license.html</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.013253894140046296" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-04-14 16:03">2025-04-14 16:03</span>&nbsp;
<a href="https://www.cnblogs.com/Yesi">E-iceblue</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18825067);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18825067', targetLink: 'https://www.cnblogs.com/Yesi/p/18825067', title: '通过 Python 在PDF中添加、或删除超链接' })">举报</a>
</div>
        