
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lyhabc/p/18492098/postgresql-sqlserver-storage-architecture-comparison" title="发布于 2024-12-24 08:00">
    <span role="heading" aria-level="2">从 $PGDATA 到文件组：深入解析 PostgreSQL 与 SQL Server 的存储策略</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h1 style="text-align: center;">从 $PGDATA 到文件组：深入解析 PostgreSQL 与 SQL Server 的存储策略</h1>
<p>&nbsp;</p>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">在数据库领域，数据存储和管理的效率与可靠性是决定系统性能、可扩展性和易于管理的关键因素。PostgreSQL 和 &nbsp;SQL Server 在数据存储方面采取了略有不同的方式。<br style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">PostgreSQL 中一个数据库管理员经常遇到的关键概念是&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;文件夹。在这里，我们将探讨&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;文件夹是什么，它的重要性，以及 PostgreSQL 的数据存储架构与 &nbsp;SQL Server 的比较。</p>
<h2 style="margin: 30px 0px 15px; padding: 0px; font-weight: 400; font-size: 16px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-color: #000000 #000000 #ef7060; align-items: unset; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; border-style: none none solid; border-width: 1px 1px 2px; border-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.1em; overflow: unset; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;" data-tool="mdnice编辑器"><span style="margin: 0px 5px 0px 0px; padding: 3px 10px 1px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 22px; color: #ffffff; background: none 0% 0% / auto no-repeat scroll padding-box border-box #ef7060; line-height: 1.5em; letter-spacing: 0em; align-items: unset; border-radius: 3px 3px 0px 0px; box-shadow: none; display: inline-block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow: unset; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset; border: 1px none #000000;">什么是 $PGDATA？</span></h2>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器"><code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;在 PostgreSQL 中指的是包含数据库集群所有配置和数据文件的目录。这是 PostgreSQL 数据存储架构的核心。简单来说，它是 PostgreSQL 存储所有文件的目录，这些文件包括实际数据、配置文件、事务日志以及其他重要信息，确保数据库集群能够正常运行。</p>
<h2 style="margin: 30px 0px 15px; padding: 0px; font-weight: 400; font-size: 16px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-color: #000000 #000000 #ef7060; align-items: unset; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; border-style: none none solid; border-width: 1px 1px 2px; border-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.1em; overflow: unset; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;" data-tool="mdnice编辑器"><span style="margin: 0px 5px 0px 0px; padding: 3px 10px 1px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 22px; color: #ffffff; background: none 0% 0% / auto no-repeat scroll padding-box border-box #ef7060; line-height: 1.5em; letter-spacing: 0em; align-items: unset; border-radius: 3px 3px 0px 0px; box-shadow: none; display: inline-block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow: unset; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset; border: 1px none #000000;">$PGDATA 文件夹的关键组成部分</span></h2>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">在&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;文件夹中，你会发现许多子目录和文件，它们存储数据库的不同方面。</p>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">其中一些关键组成部分包括：</p>
<ul class=" list-paddingleft-1" style="margin: 8px 0px; padding: 0px 0px 0px 25px; box-sizing: border-box !important; width: 557.614px; max-width: 100%; overflow-wrap: break-word !important;" data-tool="mdnice编辑器">
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; color: #000000; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;"><em style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-style: italic; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px;"><strong style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto;">base 目录</strong></em>：存储集群中每个数据库的实际数据。每个数据库在 base 文件夹中都有一个单独的子目录。</p>









</li>
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; color: #000000; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;"><em style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-style: italic; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px;"><strong style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto;">PG_VERSION</strong></em>：这是一个小文件，用于存储该集群使用的 PostgreSQL 版本信息，这在升级或迁移时确保兼容性。</p>









</li>
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; color: #000000; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;"><em style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-style: italic; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px;"><strong style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto;">pg_wal（预写日志）</strong></em>：该文件夹包含预写日志（WAL），对于事务的持久性和恢复至关重要。WAL 文件记录了对数据所做的每一次更改，确保在崩溃的情况下数据库可以恢复到一致的状态。</p>









</li>
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; color: #000000; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;"><em style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-style: italic; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px;"><strong style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto;">pg_hba.conf</strong></em>：负责基于主机的身份验证配置文件，在此文件中，你可以定义允许哪些用户从哪些位置（主机）连接到哪些数据库。</p>









</li>
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; color: #000000; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;"><em style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-style: italic; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px;"><strong style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto;">postgresql.conf</strong></em>：主要的配置文件，包含 PostgreSQL 实例的所有操作设置，包括内存设置、日志参数和其他与性能相关的设置。</p>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; color: #000000; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;"><img src="https://img2024.cnblogs.com/blog/257159/202410/257159-20241022104511107-546213413.png" alt="" width="643" height="579"></p>
<p id="1729565109979">&nbsp;</p>









</li>









</ul>
<h2 style="margin: 30px 0px 15px; padding: 0px; font-weight: 400; font-size: 16px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-color: #000000 #000000 #ef7060; align-items: unset; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; border-style: none none solid; border-width: 1px 1px 2px; border-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.1em; overflow: unset; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;" data-tool="mdnice编辑器"><span style="margin: 0px 5px 0px 0px; padding: 3px 10px 1px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 22px; color: #ffffff; background: none 0% 0% / auto no-repeat scroll padding-box border-box #ef7060; line-height: 1.5em; letter-spacing: 0em; align-items: unset; border-radius: 3px 3px 0px 0px; box-shadow: none; display: inline-block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow: unset; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset; border: 1px none #000000;">$PGDATA 的重要性</span></h2>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器"><code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;文件夹至关重要，因为它本质上是 PostgreSQL 的支柱。如果该目录损坏或丢失，集群中的所有数据都会无法恢复。因此，定期保护和备份&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;目录是每个数据库管理员的一项基本任务。</p>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">PostgreSQL 使用基于文件的存储系统，默认情况下将数据写入 8KB 的页面。页面大小可以在编译 C 源代码时更改。这些页面随后被分组为段并存储在&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;目录中。</p>
<h2 style="margin: 30px 0px 15px; padding: 0px; font-weight: 400; font-size: 16px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-color: #000000 #000000 #ef7060; align-items: unset; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; border-style: none none solid; border-width: 1px 1px 2px; border-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.1em; overflow: unset; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;" data-tool="mdnice编辑器"><span style="margin: 0px 5px 0px 0px; padding: 3px 10px 1px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 22px; color: #ffffff; background: none 0% 0% / auto no-repeat scroll padding-box border-box #ef7060; line-height: 1.5em; letter-spacing: 0em; align-items: unset; border-radius: 3px 3px 0px 0px; box-shadow: none; display: inline-block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow: unset; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset; border: 1px none #000000;">配置 $PGDATA</span></h2>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">在 PostgreSQL 初始化（通常使用 initdb）期间，你可以指定&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;目录的位置。你可以通过向 initdb 命令传递 -D 选项或设置 $PGDATA 环境变量来设置位置。例如：</p>
<pre class="highlighter-hljs" data-tool="mdnice编辑器"><code>initdb&nbsp;-D&nbsp;/var/lib/postgresql/data</code></pre>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">初始化后，PostgreSQL 期望环境变量 $PGDATA 始终指向此位置，无论服务器是启动还是停止。</p>
<h2 style="margin: 30px 0px 15px; padding: 0px; font-weight: 400; font-size: 16px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-color: #000000 #000000 #ef7060; align-items: unset; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; border-style: none none solid; border-width: 1px 1px 2px; border-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.1em; overflow: unset; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;" data-tool="mdnice编辑器"><span style="margin: 0px 5px 0px 0px; padding: 3px 10px 1px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 22px; color: #ffffff; background: none 0% 0% / auto no-repeat scroll padding-box border-box #ef7060; line-height: 1.5em; letter-spacing: 0em; align-items: unset; border-radius: 3px 3px 0px 0px; box-shadow: none; display: inline-block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow: unset; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset; border: 1px none #000000;">SQL Server 中的数据存储</span></h2>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">虽然 PostgreSQL 依赖于&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;文件夹进行核心操作，SQL Server 在数据存储和管理方面采取了略有不同的方式。Microsoft SQL Server 将其数据组织为数据库，每个数据库都有自己的一组数据文件、事务日志文件和备份选项。</p>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">在 &nbsp;SQL Server 中，数据库存储在不同类型的文件中：</p>
<ul class=" list-paddingleft-1" style="margin: 8px 0px; padding: 0px 0px 0px 25px; box-sizing: border-box !important; width: 557.614px; max-width: 100%; overflow-wrap: break-word !important;" data-tool="mdnice编辑器">
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><em style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-style: italic; color: #000000; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px;"><strong style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto;">主数据文件（.mdf）</strong></em>：这是存放所有数据库对象（如表、索引、存储过程）的主要数据文件。每个数据库至少有一个 MDF 文件，mdf文件可以理解为数据库的共享表空间，默认所有表都存储在这个mdf文件里。</li>
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><em style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-style: italic; color: #000000; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px;"><strong style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto;">次要数据文件（.ndf）</strong></em>：这些文件是可选的，用于将数据分布到多个磁盘上，从而提高大型系统的性能和可扩展性，ndf文件可以理解为独立表空间，当你把一个文件组附加在ndf文件上，然后指定数据表建立在这个文件组上，相当于把表建立在独立表空间上。</li>
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"><em style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-style: italic; color: #000000; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px;"><strong style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-style: none; border-width: 3px; border-color: rgba(0, 0, 0, 0.4); border-radius: 0px; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto;">事务日志文件（.ldf）</strong></em>：类似于 PostgreSQL 的 WAL，LDF 文件存储数据库中每个事务的日志记录。这对于确保在发生故障时可以回滚事务至关重要，也用于恢复过程。</li>
</ul>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">与 PostgreSQL 不同，PostgreSQL将数据存储在&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA&nbsp;</code>文件夹中的子目录下，SQL Server 将数据库存储在这些 .mdf、.ndf 和 .ldf 文件中，通常位于管理员在安装或创建数据库时设置的特定目录或磁盘上。</p>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">&nbsp;</p>
<h2 style="margin: 30px 0px 15px; padding: 0px; font-weight: 400; font-size: 16px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-color: #000000 #000000 #ef7060; align-items: unset; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; border-style: none none solid; border-width: 1px 1px 2px; border-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.1em; overflow: unset; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;" data-tool="mdnice编辑器"><span style="margin: 0px 5px 0px 0px; padding: 3px 10px 1px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 22px; color: #ffffff; background: none 0% 0% / auto no-repeat scroll padding-box border-box #ef7060; line-height: 1.5em; letter-spacing: 0em; align-items: unset; border-radius: 3px 3px 0px 0px; box-shadow: none; display: inline-block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow: unset; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset; border: 1px none #000000;">PostgreSQL 与 SQL Server 存储的关键区别</span></h2>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">现在我们已经了解了 PostgreSQL 和 SQL Server 如何处理数据存储，以下是它们之间的关键差异：</p>
<ul class=" list-paddingleft-1" style="margin: 8px 0px; padding: 0px 0px 0px 25px; box-sizing: border-box !important; width: 557.614px; max-width: 100%; overflow-wrap: break-word !important;" data-tool="mdnice编辑器">
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">存储位置</li>
</ul>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">PostgreSQL 将所有数据存储在&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;目录中，该目录包含每个数据库的子目录以及 WAL 日志和配置文件。SQL Server 使用单独的文件（.mdf、.ndf、.ldf）来存储每个数据库。管理员可以将这些文件放置在任何磁盘或目录中。</p>
<ul class=" list-paddingleft-1" style="margin: 8px 0px; padding: 0px 0px 0px 25px; box-sizing: border-box !important; width: 557.614px; max-width: 100%; overflow-wrap: break-word !important;" data-tool="mdnice编辑器">
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">事务日志</li>
</ul>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">PostgreSQL 使用 pg_wal 目录来存储预写日志。SQL Server 使用 .ldf 文件进行事务日志记录，与 PostgreSQL 的 WAL 类似，但每个数据库都有自己的 .ldf 文件。</p>
<ul class=" list-paddingleft-1" style="margin: 8px 0px; padding: 0px 0px 0px 25px; box-sizing: border-box !important; width: 557.614px; max-width: 100%; overflow-wrap: break-word !important;" data-tool="mdnice编辑器">
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">文件组抽象</li>
</ul>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">SQL Server 提供文件组，这是一层抽象，允许管理员将数据分布在多个存储设备上以提高性能和管理。PostgreSQL 没有类似的抽象层，文件管理完全依赖于操作系统，管理员只能将不同的表空间放置在不同的磁盘上。</p>
<ul class=" list-paddingleft-1" style="margin: 8px 0px; padding: 0px 0px 0px 25px; box-sizing: border-box !important; width: 557.614px; max-width: 100%; overflow-wrap: break-word !important;" data-tool="mdnice编辑器">
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">配置文件</li>
</ul>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">PostgreSQL 的配置文件紧密集成在&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;目录中（如 postgresql.conf、pg_hba.conf），而 SQL Server 的配置文件通常与数据库文件分开存储。</p>
<ul class=" list-paddingleft-1" style="margin: 8px 0px; padding: 0px 0px 0px 25px; box-sizing: border-box !important; width: 557.614px; max-width: 100%; overflow-wrap: break-word !important;" data-tool="mdnice编辑器">
<li style="margin: 0px; padding: 0px; clear: both; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;">临时数据存储</li>
</ul>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">SQL Server 使用一个专门的系统数据库 TempDB 进行临时数据存储，而 PostgreSQL 则在现有的<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;目录中使用临时表空间，与SQL Server类似，也是整个实例（集群）共享临时表空间。</p>
<h2 style="margin: 30px 0px 15px; padding: 0px; font-weight: 400; font-size: 16px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; border-color: #000000 #000000 #ef7060; align-items: unset; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; border-style: none none solid; border-width: 1px 1px 2px; border-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.1em; overflow: unset; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;" data-tool="mdnice编辑器"><span style="margin: 0px 5px 0px 0px; padding: 3px 10px 1px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; font-size: 22px; color: #ffffff; background: none 0% 0% / auto no-repeat scroll padding-box border-box #ef7060; line-height: 1.5em; letter-spacing: 0em; align-items: unset; border-radius: 3px 3px 0px 0px; box-shadow: none; display: inline-block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; overflow: unset; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset; border: 1px none #000000;">总结</span></h2>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">虽然 PostgreSQL 和 Microsoft SQL Server 都提供了强大的数据存储机制，但它们的方法却有着根本的不同。PostgreSQL 的&nbsp;<code style="margin: 0px 2px; padding: 2px 4px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: #ef7060; font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; border-style: none; border-width: 3px; border-color: #000000 rgba(0, 0, 0, 0.4) rgba(0, 0, 0, 0.4); border-radius: 4px; font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace; word-break: break-all;">$PGDATA</code>&nbsp;文件夹是与数据库集群相关的所有内容的中央枢纽，</p>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">而 SQL Server 则依赖于更为精细化的 .mdf、.ndf 和 .ldf 文件系统来进行数据存储。每个系统都有其自身的优势，最佳选择通常取决于具体的使用场景、性能需求和系统架构偏好。</p>
<p style="margin: 0px; padding: 8px 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; line-height: 1.8em; letter-spacing: 0em; text-indent: 0em;" data-tool="mdnice编辑器">理解每个系统存储架构的细微差别对于数据库管理员来说至关重要，因为这将影响到备份策略、性能调优和灾难恢复计划的决策。</p>
<p style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; clear: both; min-height: 1em; color: rgba(0, 0, 0, 0.9); font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.578px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">&nbsp;</p>
<p><br><strong>参考文章</strong><br>https://www.javelin-tech.com/blog/2020/06/sizing-the-microsoft-sql-mdf-and-ldf/<br>https://docs.oracle.com/cd/E19787-01/820-3361/ciadcigh/index.html<br>https://docs.microfocus.com/UCMDB/11.0/ucmdb-docs/docs/eng/doc_lib/Content/database/PostgresConfig_c_logs.htm<br>https://www.postgresql.org/docs/current/storage-file-layout.html<br>https://www.quora.com/What-are-MDF-and-NDF-files-in-an-SQL-server<br><br><br style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important;"></p>
<p>&nbsp;<img src="https://img2024.cnblogs.com/blog/257159/202408/257159-20240818100857719-1129157724.png" alt="" class="medium-zoom-image"></p>
<p>&nbsp;</p>
<p><strong>本文版权归作者所有，未经作者同意不得转载。</strong></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.042980890040509256" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2024-12-24 08:00">2024-12-24 08:00</span>&nbsp;
<a href="https://www.cnblogs.com/lyhabc">桦仔</a>&nbsp;
阅读(<span id="post_view_count">2</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18492098" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18492098);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18492098', targetLink: 'https://www.cnblogs.com/lyhabc/p/18492098/postgresql-sqlserver-storage-architecture-comparison', title: '从 $PGDATA 到文件组：深入解析 PostgreSQL 与 SQL Server 的存储策略' })">举报</a>
</div>
        