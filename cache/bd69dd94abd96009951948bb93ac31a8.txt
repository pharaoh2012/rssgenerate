
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/guoxiaoyu/p/18870227" title="å‘å¸ƒäº 2025-05-12 20:27">
    <span role="heading" aria-level="2">ä»é›¶åˆ°ä¸€ï¼šæ‰“é€ é«˜æ•ˆçš„é‡‘ä»“ç¤¾åŒº API é›†æˆåˆ° MCP æœåŠ¡æ–¹æ¡ˆ</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ä»Šå¤©åœ¨ä½¿ç”¨å›½äº§æ•°æ®åº“é‡‘ä»“æ—¶ï¼Œæˆ‘å‘ç°æ¯æ¬¡é‡åˆ°é—®é¢˜éƒ½ä¹ æƒ¯æ€§åœ°æ‰“å¼€é‡‘ä»“ç¤¾åŒºè¿›è¡Œæœç´¢å’ŒæŸ¥çœ‹ç›¸å…³ä¿¡æ¯ã€‚å¯æ˜¯æ¯æ¬¡æ‰“å¼€æµè§ˆå™¨çš„æ“ä½œæ€»è®©æˆ‘è§‰å¾—æœ‰äº›éº»çƒ¦ï¼Œäºæ˜¯æˆ‘å†³å®šä¸å†ä¾èµ–è¿™ç§ç¹ççš„è¿‡ç¨‹ã€‚ç´¢æ€§ä»Šå¤©æˆ‘æŠŠè¿™ä¸ªæ¥å£æå–å‡ºæ¥ï¼Œå¹¶å°†å…¶å°è£…æˆMCPæœåŠ¡ç«¯ï¼Œé›†æˆåˆ°äº†æˆ‘çš„CodeBuddyä¸­ã€‚è¿™æ ·ï¼Œæˆ‘æ— è®ºåœ¨ä½•æ—¶ä½•åœ°éƒ½èƒ½ç›´æ¥è¿›è¡Œæé—®å’ŒæŸ¥è¯¢ï¼Œæ—¢æ–¹ä¾¿åˆé«˜æ•ˆã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘å°†è¯¦ç»†è®²è§£å¦‚ä½•ä¸€æ­¥æ­¥åœ°å°†ä¸€ä¸ªAPIæ¥å£å°è£…æˆMCPæœåŠ¡å™¨ï¼Œå¹¶åœ¨å®é™…é¡¹ç›®ä¸­åŠ ä»¥ä½¿ç”¨ã€‚</p>
<h1 id="mcp">MCP</h1>
<h2 id="åˆå§‹åŒ–-mcp">åˆå§‹åŒ– MCP</h2>
<p>è¦åˆå§‹åŒ– MCP æœåŠ¡å™¨ï¼Œé¦–å…ˆéœ€è¦å®‰è£… uv å¹¶è®¾ç½® Python é¡¹ç›®å’Œç¯å¢ƒã€‚å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>åˆ›å»ºæ–°é¡¹ç›®ç›®å½•</p>
<p>uv init kingbase_service<br>
cd kingbase_service</p>
<p>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶æ¿€æ´»</p>
<p>uv venv<br>
.venv\Scripts\activate</p>
<p>å®‰è£…ä¾èµ–</p>
<p>uv add "mcp[cli]" httpx</p>
</blockquote>
<p>åœ¨æ‰€æœ‰æ“ä½œæ‰§è¡Œå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥è¯¥ç›®å½•å¹¶æ‰“å¼€<code> main.py</code> æ–‡ä»¶ã€‚æ–‡ä»¶ä¸­åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ä¸¤ä¸ªæ•°ç›¸åŠ çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ— éœ€å…³æ³¨å®ƒï¼Œç›´æ¥åˆ é™¤è¯¥å†…å®¹å¹¶é‡æ–°ç¼–å†™å³å¯ã€‚</p>
<h2 id="ç¤¾åŒº-api">ç¤¾åŒº API</h2>
<p>ç”±äºç¤¾åŒºæ²¡æœ‰æä¾›ä»»ä½•å…¬å¼€çš„APIæ¥å£ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½é€šè¿‡æ‰‹åŠ¨æŠ“å–æ¥å£çš„æ–¹å¼æ¥è·å–æ•°æ®ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä¸è¿›è¡Œå…·ä½“çš„æ¼”ç¤ºï¼Œæœ€ç»ˆçš„å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from mcp.server.fastmcp import FastMCP
import json
import requests

# åˆå§‹åŒ– FastMCP æœåŠ¡å™¨
mcp = FastMCP("KingBase")

def get_search(query,type):
    cookies = {
        '_ga': 'GA1.3.1791910307.1718679034',
        '__bid_n': '19029f909db92161118c02',
        'Hm_lvt_3c01febe06ffa2353036661fdec1f873': '1718691104,1718792940,1718846376',
        'sensorsdata2015jssdkcross': '%7B%22distinct_id%22%3A%2219029f90aad523-090ebfbc937d5e-4c657b58-2073600-19029f90aae77%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E5%BC%95%E8%8D%90%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC%22%2C%22%24latest_referrer%22%3A%22https%3A%2F%2Fcloud.tencent.com%2F%22%7D%2C%22identities%22%3A%22eyIkaWRlbnRpdHlfY29va2llX2lkIjoiMTkwMjlmOTBhYWQ1MjMtMDkwZWJmYmM5MzdkNWUtNGM2NTdiNTgtMjA3MzYwMC0xOTAyOWY5MGFhZTc3In0%3D%22%2C%22history_login_id%22%3A%7B%22name%22%3A%22%22%2C%22value%22%3A%22%22%7D%2C%22%24device_id%22%3A%2219029f90aad523-090ebfbc937d5e-4c657b58-2073600-19029f90aae77%22%7D',
    }

    headers = {
        'Accept': 'application/json, text/plain, */*',
        'Accept-Language': 'zh-CN',
        'Connection': 'keep-alive',
        'Content-Type': 'application/json;charset=UTF-8',
        # 'Cookie': '_ga=GA1.3.1791910307.1718679034; __bid_n=19029f909db92161118c02; Hm_lvt_3c01febe06ffa2353036661fdec1f873=1718691104,1718792940,1718846376; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%2219029f90aad523-090ebfbc937d5e-4c657b58-2073600-19029f90aae77%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E5%BC%95%E8%8D%90%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC%22%2C%22%24latest_referrer%22%3A%22https%3A%2F%2Fcloud.tencent.com%2F%22%7D%2C%22identities%22%3A%22eyIkaWRlbnRpdHlfY29va2llX2lkIjoiMTkwMjlmOTBhYWQ1MjMtMDkwZWJmYmM5MzdkNWUtNGM2NTdiNTgtMjA3MzYwMC0xOTAyOWY5MGFhZTc3In0%3D%22%2C%22history_login_id%22%3A%7B%22name%22%3A%22%22%2C%22value%22%3A%22%22%7D%2C%22%24device_id%22%3A%2219029f90aad523-090ebfbc937d5e-4c657b58-2073600-19029f90aae77%22%7D',
        'Origin': 'https://bbs.kingbase.com.cn',
        'Referer': 'https://bbs.kingbase.com.cn/',
        'Sec-Fetch-Dest': 'empty',
        'Sec-Fetch-Mode': 'cors',
        'Sec-Fetch-Site': 'same-origin',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0',
        'sec-ch-ua': '"Not/A)Brand";v="8", "Chromium";v="126", "Microsoft Edge";v="126"',
        'sec-ch-ua-mobile': '?0',
        'sec-ch-ua-platform': '"Windows"',
    }
    tpe = f'kingbase_blog_{type}'
    json_data = {
        'keyWord': query,
        'type': tpe,
        'pageNum': 1,
        'pageSize': 5,
        'fullSearch': True,
    }

    response = requests.post(
        'https://bbs.kingbase.com.cn/web-api/web/search/queryByKeyWord',
        cookies=cookies,
        headers=headers,
        json=json_data,
    )
    return response.text

@mcp.tool()
def kingbase_serach(query: str, type: str) -&gt; int:
    """
    æŸ¥è¯¢kingbaseè®ºå›å’Œåšå®¢
    query:æŸ¥è¯¢å†…å®¹
    type:æŸ¥è¯¢èŒƒå›´å›ºå®šå€¼ï¼šè®ºå›ï¼šforumï¼Œåšå®¢ï¼šposts
    """
    return get_search(query,type) 

if __name__ == "__main__":
    print("Starting MCP server...")
    mcp.run(transport='stdio')
</code></pre>
<h2 id="å¯è§†åŒ–æµ‹è¯•">å¯è§†åŒ–æµ‹è¯•</h2>
<p>MCPä¾èµ–é»˜è®¤æä¾›äº†ä¸€ä¸ªå¯è§†åŒ–ç•Œé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œç®€å•çš„æµ‹è¯•æ“ä½œã€‚é€šè¿‡è¯¥ç•Œé¢ï¼Œç”¨æˆ·å¯ä»¥å¿«é€ŸéªŒè¯æœ¬åœ°ç¯å¢ƒæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œç¡®ä¿ç³»ç»Ÿé…ç½®æ­£ç¡®æ— è¯¯ã€‚æµ‹è¯•å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>mcp dev main.py</p>
</blockquote>
<p>æ‰§è¡Œå®Œç›¸å…³å‘½ä»¤åï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºæœ¬åœ°æœåŠ¡çš„IPåœ°å€å’Œç«¯å£å·ã€‚ç‚¹å‡»è¯¥é“¾æ¥ï¼Œå°†èƒ½å¤Ÿåœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹åˆ°ç›¸åº”çš„æ•ˆæœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1423484/202505/1423484-20250510221131137-988930112.png" alt="image" loading="lazy"></p>
<p>çœ‹èµ·æ¥éƒ½æ˜¯æ­£å¸¸çš„ã€‚</p>
<h1 id="æ’ä»¶é…ç½®">æ’ä»¶é…ç½®</h1>
<p>æˆ‘ä»¬ç°åœ¨é…ç½®ä¸€ä¸‹è…¾è®¯äº‘çš„ CodeBuddy ç¼–ç¨‹åŠ©æ‰‹æ’ä»¶ï¼Œ</p>
<p><img src="https://img2024.cnblogs.com/blog/1423484/202505/1423484-20250510221137266-326538093.png" alt="image" loading="lazy"></p>
<p>å¹¶åœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹é…ç½®ä¿¡æ¯ï¼š</p>
<pre><code class="language-json">"mcp-kingbase-server": {
  "command": "uv",
  "args": [
    "--directory",
    "D:/project/python/mcp-server/kingbase_service",
    "run",
    "main.py"
  ]
}
</code></pre>
<p>é…ç½®æˆåŠŸåï¼Œå°±ä¼šæˆåŠŸè§£ææˆ‘ä»¬å†™çš„å·¥å…·ï¼Œæ•ˆæœå¦‚å›¾ï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1423484/202505/1423484-20250510221150824-1605052920.png" alt="image" loading="lazy"></p>
<p>æ¥ç€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨é…ç½®è¿›è¡Œéšæ—¶éšåœ°çš„æŸ¥è¯¢äº†ã€‚</p>
<h2 id="æ•ˆæœæ¼”ç¤º">æ•ˆæœæ¼”ç¤º</h2>
<p>æˆ‘ä»¬ç›´æ¥åœ¨å·¦ä¾§çš„Craftæ ‡ç­¾ä¸­å¼€å§‹ä½¿ç”¨ä¸€ä¸‹ï¼Œè¿™é‡Œç®€å•é—®ä¸€ä¸‹<code>Kingbase æ•°æ®åº“å¦‚ä½•é€šè¿‡å‚æ•°é…ç½®å®ç°é€æ˜æ•°æ®åŠ å¯†ï¼ˆTDEï¼‰</code>é—®é¢˜ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½å›ç­”æˆ‘ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://img2024.cnblogs.com/blog/1423484/202505/1423484-20250510221157407-159872717.png" alt="image" loading="lazy"></p>
<p>æ•ˆæœç¡®å®éå¸¸ä¸é”™ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå·¥ä½œä¸­é‡åˆ°é—®é¢˜æ—¶ï¼Œåªéœ€è½»æ¾æŸ¥è¯¢ï¼Œéšæ—¶å°±èƒ½æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œæå¤§æé«˜äº†æ•ˆç‡ã€‚</p>
<h1 id="å°ç»“">å°ç»“</h1>
<p>å°†é‡‘ä»“ç¤¾åŒºæœç´¢æ¥å£å°è£…æˆMCPæœåŠ¡ç«¯å¹¶é›†æˆåˆ° CodeBuddy ä¸­ï¼Œå¸¦æ¥äº†æ˜¾è‘—çš„æ•ˆç‡æå‡ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸å†éœ€è¦ç¹çåœ°æ‰“å¼€æµè§ˆå™¨è¿›è¡Œæœç´¢ï¼Œç›´æ¥åœ¨å¼€å‘ç¯å¢ƒä¸­å°±èƒ½å¿«é€ŸæŸ¥è¯¢é—®é¢˜ï¼ŒèŠ‚çœäº†å¤§é‡æ—¶é—´ã€‚éšæ—¶éšåœ°çš„æŸ¥è¯¢åŠŸèƒ½å¤§å¤§ç®€åŒ–äº†å·¥ä½œæµç¨‹ï¼Œè®©é—®é¢˜è§£å†³å˜å¾—æ›´åŠ ä¾¿æ·ã€‚</p>
<hr>
<p>æˆ‘æ˜¯åŠªåŠ›çš„å°é›¨ï¼Œä¸€ä¸ªæ­£ç»çš„ Java ä¸œåŒ—æœåŠ¡ç«¯å¼€å‘ï¼Œæ•´å¤©ç¢ç£¨ç€ AI æŠ€æœ¯è¿™å—å„¿çš„å¥¥ç§˜ã€‚ç‰¹çˆ±è·Ÿäººäº¤æµæŠ€æœ¯ï¼Œå–œæ¬¢æŠŠè‡ªå·±çš„å¿ƒå¾—å’Œå¤§å®¶åˆ†äº«ã€‚è¿˜å½“ä¸Šäº†è…¾è®¯äº‘åˆ›ä½œä¹‹æ˜Ÿï¼Œé˜¿é‡Œäº‘ä¸“å®¶åšä¸»ï¼Œåä¸ºäº‘äº‘äº«ä¸“å®¶ï¼Œæ˜é‡‘ä¼˜ç§€ä½œè€…ã€‚å„ç§å¾æ–‡ã€å¼€æºæ¯”èµ›çš„ç‰Œå­ä¹Ÿæ‹¿äº†ã€‚</p>
<p>ğŸ’¡ æƒ³æŠŠæˆ‘åœ¨æŠ€æœ¯è·¯ä¸Šèµ°è¿‡çš„å¼¯è·¯å’Œç»éªŒå…¨éƒ½åˆ†äº«å‡ºæ¥ï¼Œç»™ä½ ä»¬çš„å­¦ä¹ å’Œæˆé•¿å¸¦æ¥ç‚¹å¯å‘ï¼Œå¸®ä¸€æŠŠã€‚</p>
<p>ğŸŒŸ æ¬¢è¿å…³æ³¨åŠªåŠ›çš„å°é›¨ï¼Œå’±ä¸€å—å„¿è¿›æ­¥ï¼ğŸŒŸ</p>

</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.32687250521875" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-12 20:27">2025-05-12 20:27</span>&nbsp;
<a href="https://www.cnblogs.com/guoxiaoyu">åŠªåŠ›çš„å°é›¨</a>&nbsp;
é˜…è¯»(<span id="post_view_count">14</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18870227);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18870227', targetLink: 'https://www.cnblogs.com/guoxiaoyu/p/18870227', title: 'ä»é›¶åˆ°ä¸€ï¼šæ‰“é€ é«˜æ•ˆçš„é‡‘ä»“ç¤¾åŒº API é›†æˆåˆ° MCP æœåŠ¡æ–¹æ¡ˆ' })">ä¸¾æŠ¥</a>
</div>
	