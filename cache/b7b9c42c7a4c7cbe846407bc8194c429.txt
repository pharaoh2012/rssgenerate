
		<div class="posthead">
			<h2>
				<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/data-analytics/p/18854781" title="å‘å¸ƒäº 2025-05-04 08:52">
    <span role="heading" aria-level="2">ã€SQLå‘¨å‘¨ç»ƒã€‘ä¸€å¥ SQL å¦‚ä½•å¸®åŠ© 5 ä¸ªäººä¹°åˆ°ç”µå½±é™¢æœ€å¥½çš„åº§ä½ï¼Ÿ</span>
    

</a>

			</h2>
 			Posted on 
<span id="post-date" data-last-update-days="0.8101750792858796" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-04 08:52">2025-05-04 08:52</span>&nbsp;
<a href="https://www.cnblogs.com/data-analytics">è’‹ç‚¹æ•°åˆ†</a>&nbsp;
é˜…è¯»(<span id="post_view_count">124</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18854781);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18854781', targetLink: 'https://www.cnblogs.com/data-analytics/p/18854781', title: 'ã€SQLå‘¨å‘¨ç»ƒã€‘ä¸€å¥ SQL å¦‚ä½•å¸®åŠ© 5 ä¸ªäººä¹°åˆ°ç”µå½±é™¢æœ€å¥½çš„åº§ä½ï¼Ÿ' })">ä¸¾æŠ¥</a>

			
			
		</div>
		<div class="postbody"><div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<section>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯â€œè’‹ç‚¹æ•°åˆ†â€ï¼Œå¤šå¹´ä»¥æ¥ä¸€ç›´ä»äº‹æ•°æ®åˆ†æå·¥ä½œã€‚ä»ä»Šå¤©å¼€å§‹ï¼Œä¸å¤§å®¶æŒç»­åˆ†äº«å…³äºæ•°æ®åˆ†æçš„å­¦ä¹ å†…å®¹ã€‚</p>
<p>æœ¬æ–‡æ˜¯ç¬¬ 3 ç¯‡ï¼Œä¹Ÿæ˜¯ã€SQL å‘¨å‘¨ç»ƒã€‘ç³»åˆ—çš„ç¬¬ 3 ç¯‡ã€‚è¯¥ç³»åˆ—æ˜¯æŒ‘é€‰æˆ–è‡ªåˆ›å…·æœ‰ä¸€äº›éš¾åº¦çš„ SQL é¢˜ç›®ï¼Œä¸€å‘¨è‡³å°‘æ›´æ–°ä¸€ç¯‡ã€‚åç»­åˆ›ä½œçš„å†…å®¹ï¼Œåˆæ­¥è§„åˆ’çš„æ–¹å‘åŒ…æ‹¬ï¼š</p>
<h2 data-heading="true">åç»­å†…å®¹è§„åˆ’</h2>
<p>1.åˆ©ç”¨&nbsp;<strong>Streamlit</strong>&nbsp;å®ç°&nbsp;<code>Hive å…ƒæ•°æ®å±•ç¤º</code>ã€<code>SQL ç¼–è¾‘å™¨</code>ã€ ç»“åˆ<code>Docker æ²™ç®±å®ç°æ•°æ®åˆ†æ Agent</code><br>2.æ—¶é—´åºåˆ—å¼‚å¸¸è¯†åˆ«ã€å¼‚åŠ¨å½’å› ç®—æ³•<br>3.ç•™å­˜ç‡æ‹Ÿåˆã€é¢„æµ‹ã€å»ºæ¨¡<br>4.å­¦ä¹ &nbsp;<code>AB å®éªŒ</code>ã€å¤æ‚å®éªŒè®¾è®¡ç­‰<br>5.<code>è‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ </code>ã€è‡ªåŠ¨åŒ–ç‰¹å¾å·¥ç¨‹<br>6.<code>å› æœæ¨æ–­</code>å­¦ä¹ <br>7. â€¦â€¦</p>
<p><strong>æ¬¢è¿å…³æ³¨</strong>ï¼Œä¸€èµ·å­¦ä¹ ã€‚</p>
<h2 data-heading="true">ç¬¬ 3 æœŸé¢˜ç›®</h2>
<p>é¢˜ç›®æ¥æºï¼šæ”¹è¿›çš„é¢˜ç›®ï¼Œå¢åŠ äº†ç”µå½±é™¢æœ€ä¼˜é€‰åº§çš„é€»è¾‘</p>
<h3 data-heading="true">ä¸€ã€é¢˜ç›®ä»‹ç»</h3>
<p>çœ‹åˆ°è¿™ä¸ªé¢˜ç›®ï¼Œæœ‰åŒå­¦å¯èƒ½ä¼šåæ§½ï¼šä½ å°å­æ‹‰äº†ï¼Œç¬¬ 3 æœŸå°±å‡ºç°å¸¸è§é¢˜ç›®ã€‚è¿™é‡Œæˆ‘è§£é‡Šä¸€ä¸‹ï¼Œã€<strong>SQL å‘¨å‘¨ç»ƒ</strong>ã€‘ç³»åˆ—çš„ç¡®æ˜¯æƒ³è¾“å‡ºä¸€ç³»åˆ—æˆ‘è®¤ä¸ºæœ‰æŒ‘æˆ˜æ€§æœ‰æ„æ€çš„é¢˜ï¼ˆæ‰€è°“æŒ‘æˆ˜æ€§æ˜¯å¯¹äºå¤§å¤šæ•°æ•°åˆ†ï¼ŒSQL èµ„æ·±è€…é™¤å¤–ï¼‰æˆ‘ä¸æƒ³ç…§æ¬ LeetCode æˆ–ç‰›å®¢çš„é¢˜ï¼Œæ›´ä¸æƒ³å†™ â€œå­¦ç”Ÿè¡¨â€ é‚£ç±»é¢˜ã€‚<br><br></p>
<p>å¥ˆä½•æˆ‘æƒ³è±¡åŠ›æœ‰é™ï¼ˆæœªæ¥å¯èƒ½å¢åŠ ä¸€ä¸ª SQL ç ´æ¡ˆç³»åˆ—ï¼Œç›®å‰æ‰‹é‡Œæœ‰å‡ ç¯‡è‰ç¨¿ï¼Œæ¯”å¦‚é€šè¿‡è¡Œè½¦è½¨è¿¹è®¡ç®—ç½ªæ¡ˆç­–åˆ’åœ°ç‚¹ï¼‰å¯¹äºå¸‚é¢ä¸Šçš„é¢˜ï¼Œå¦‚æœå¢åŠ ä¸€äº›åˆ›æ–°ç‚¹ï¼Œæˆ‘è§‰å¾—ä¹Ÿå€¼å¾—è·Ÿå¤§å®¶åˆ†äº«ã€‚æ¯”å¦‚è¿™é“é¢˜ï¼Œæˆ‘å°±å¢åŠ äº†â€œæœ€ä¼˜é€‰åº§â€çš„é€»è¾‘ã€‚ä¸‹é¢ç›´æ¥è¯´é¢˜ï¼š</p>
<p>æœ‰ä¸€å¼ è¡¨è®°å½•äº†ç”µå½±é™¢æŸä¸ªå…æŸä¸ªåœºæ¬¡çš„åº§ä½å”®å‡ºæƒ…å†µï¼Œå‡è®¾æœ‰ 5 ä¸ªäººæ¥ä¹°ç¥¨ï¼Œè¯·æ‚¨ç”¨ SQL è¾“å‡ºæ‰€æœ‰å¯ä»¥é€‰æ‹©çš„&nbsp;5 ä¸ªè¿ç»­åº§ä½ï¼Œè¿˜è¦æŒ‰ç…§ä¸€å®šè§„åˆ™æ ¹æ®åº§ä½çš„ä½ç½®è¿›è¡Œä¼˜åŠ£æ’åºã€‚åˆ—åå¦‚ä¸‹ï¼ˆè¿™é‡Œä¸æ˜¾ç¤ºæ—¥æœŸã€æ”¾æ˜ å…åå’Œåœºæ¬¡ç­‰å†—ä½™ä¿¡æ¯ï¼‰ï¼š</p>
<section>
<table>
<thead>
<tr>
<td>
<section>åˆ—å</section>
</td>
<td>
<section>æ•°æ®ç±»å‹</section>
</td>
<td>
<section>æ³¨é‡Š</section>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<section>seat_no</section>
</td>
<td>
<section>string</section>
</td>
<td>
<section>åº§ä½å·ï¼ˆæ ¼å¼ï¼šè¡Œå·ç -åˆ—å·ç ï¼‰</section>
</td>
</tr>
<tr>
<td>
<section>is_saled</section>
</td>
<td>
<section>int</section>
</td>
<td>
<section>æ˜¯å¦å”®å‡ºï¼ˆ0-æœªé”€å”®ï¼Œ1-å·²å”®å‡ºï¼‰</section>
</td>
</tr>
</tbody>
</table>
</section>
<p>è¯´æ˜ï¼š</p>
<ol class="list-paddingleft-1">
<li>
<section>1. ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œå‡è®¾ä¸å­˜åœ¨â€œè¿‡é“â€ï¼ˆä»¥åæœ‰æœºä¼šå†"æ°´"ä¸€ç¯‡æ–‡ç« ï¼‰</section>
</li>
<li>
<section>2. ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œâ€œæœ€ä¼˜é€‰åº§â€çš„é€»è¾‘æ˜¯â€”â€”æœ€ä¼˜ç‚¹åœ¨ï¼ˆæ€»è¡Œæ•°*0.65ï¼Œæ€»åˆ—æ•°*0.5ï¼‰æ‰€é€‰åº§ä½ç›¸å¯¹äºå®ƒçš„â€œæ¬§å¼è·ç¦»â€<span data-pm-slice="0 0 []">ï¼ˆè¡Œæ–¹å‘ä¸åˆ—æ–¹å‘çš„æƒé‡æ¯”æ˜¯ 3:2ï¼‰</span>ä¹‹å’Œæœ€å°è€…</section>
</li>
</ol>
<h3 data-heading="true">äºŒã€é¢˜ç›®æ€è·¯</h3>
<p>æƒ³è¦ç­”é¢˜çš„åŒå­¦ï¼Œå¯ä»¥å…ˆæ€è€ƒç­”æ¡ˆğŸ¤”ã€‚<br>â€¦â€¦</p>
<p>â€¦â€¦</p>
<p>â€¦â€¦</p>
<p>æˆ‘æ¥è°ˆè°ˆæˆ‘çš„æ€è·¯ï¼šè¿™é“é¢˜é¢˜ç›®ä¸­çš„â€œè¿ç»­â€ï¼Œå¯èƒ½ä¼šè®©éƒ¨åˆ†æ•°æ®åˆ†æå¸ˆæƒ³èµ·â€œè¿ç»­ç™»å½•â€è¿™ä¸ªç»å…¸é¢˜å‹ã€‚æˆ‘åœ¨ç¬¬ 1 æœŸæ–‡ç« ä¸­æåˆ°ï¼Œè¿™ç±»é¢˜å‹éœ€è¦æ„é€ ä¸€ä¸ªåˆ†ç»„æ ‡è¯†ã€‚ä½†æ˜¯ä»Šå¤©çš„é¢˜ç›®ç®€å•çš„å¤šï¼Œâ€œè¿ç»­ç™»å½•â€ç±»é—®é¢˜ä¹‹æ‰€ä»¥è¦æ„é€ åˆ†ç»„æ ‡è¯†ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æ²¡åŠæ³•ç¡®å®šçª—å£èŒƒå›´ã€‚å¦‚æœè¿™é“é¢˜æ˜¯æ±‚æœ€å¤šæœ‰å¤šå°‘ä¸ªè¿ç»­ç©ºåº§ï¼Œé‚£å¥—è·¯æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>å¯æ˜¯æ—¢ç„¶æ˜¯æ±‚ 5 ä¸ªæˆ–è€…ç‰¹å®šä¸ªè¿ç»­ç©ºåº§ï¼Œé‚£ä¹ˆé—®é¢˜å¤§å¤§ç®€åŒ–äº†ã€‚æˆ‘ä»¬çš„çª—å£èŒƒå›´æ˜¯å›ºå®šçš„ 5 è¡Œå°±è¡Œäº†ï¼Œä½ è¿™ 5 è¡Œä»å“ªä¸ªä½ç½®å¼€å§‹éƒ½å¯ä»¥å†™ã€‚æˆ‘å°±ä»å½“å‰è¡Œå¼€å§‹ç®—ï¼Œä¹Ÿå°±æ˜¯&nbsp;<code>order by seat_col asc rows between current row and 4 following</code>ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘åœ¨&nbsp;<code>Python</code>&nbsp;ä¸­ç”Ÿæˆæ¨¡æ‹Ÿçš„æ•°æ®é›†ã€‚ç›¸å¯¹äºå‰ä¸¤æœŸï¼Œè¿™æœŸæ¨¡æ‹Ÿæ•°æ®ç®€å•å¾—å¤šï¼š</p>
<h3 data-heading="true">ä¸‰ã€ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®</h3>
<p>åªå…³å¿ƒ SQL ä»£ç çš„åŒå­¦ï¼Œå¯ä»¥è·³è½¬åˆ°ç¬¬å››èŠ‚ï¼ˆæˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨&nbsp;<code>Hive</code>&nbsp;è¾ƒå¤šï¼Œå› æ­¤é‡‡ç”¨&nbsp;<code>Hive</code>&nbsp;çš„è¯­æ³•ï¼‰</p>
<p>æ¨¡æ‹Ÿä»£ç å¦‚ä¸‹ï¼š</p>
<section>1. å®šä¹‰æ¨¡æ‹Ÿé€»è¾‘éœ€è¦çš„<code>å¸¸é‡</code>ï¼Œå¤šå°‘æ’å¤šå°‘åˆ—çš„åº§ä½ã€‚ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œè¿™é‡Œå°±æ¨¡æ‹Ÿä¸€ä¸ªé•¿æ–¹å½¢çš„æ™®é€šå…ï¼Œæ²¡æœ‰è¿‡é“ï¼Œæ¯æ’åº§ä½æ•°ä¸€è‡´ï¼š</section>
<pre class="highlighter-hljs" data-dark-theme="true"><code>import&nbsp;numpy&nbsp;as&nbsp;np
import&nbsp;pandas&nbsp;as&nbsp;pd

# æ„Ÿè§‰éšæœºæ•°ç§å­ 2024 æ¯” 2025 æœ€åå±•ç¤ºçš„æ•ˆæœ
np.random.seed(2024)

n_rows =&nbsp;9&nbsp;&nbsp;# å¤šå°‘æ’åº§ä½
n_cols =&nbsp;25&nbsp;&nbsp;# å¤šå°‘åˆ—åº§ä½ï¼Œä¸ºäº†ç®€åŒ–å‡è®¾æ¯æ’åº§ä½æ•°ç›¸åŒ
occupancy_rate =&nbsp;0.3&nbsp;&nbsp;# ç”µå½±é™¢ä¸Šåº§ç‡</code></pre>
<section></section>
<section>2. ç”Ÿæˆ&nbsp;<code>pd.DataFrame</code>ã€‚è¿™é‡Œå¼ºè°ƒä¸€ç‚¹ï¼Œä¸Šåº§ç‡ä¸èƒ½å½“ä½œ&nbsp;<code>0-1 åˆ†å¸ƒ</code>çš„æ¦‚ç‡ï¼Œä¸èƒ½ç”¨&nbsp;<code>0-1 åˆ†å¸ƒ</code>æŠ½æ ·æ¥æ¨¡æ‹Ÿåº§ä½å”®å‡ºæƒ…å†µï¼›è€Œæ˜¯åº”è¯¥ç”¨éšæœºæŠ½æŒ‡å®šæ•°é‡çš„åº§ä½ï¼Œå³ç”¨<strong>é¢‘ç‡</strong>çš„æ–¹å¼æ¥å¤„ç†ï¼š</section>
<pre class="highlighter-hljs" data-dark-theme="true"><code>df = pd.DataFrame(
&nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;"seat_no": [
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;f"{r}-{c}"for&nbsp;r&nbsp;inrange(1, n_rows +&nbsp;1)&nbsp;for&nbsp;c&nbsp;inrange(1, n_cols +&nbsp;1)
&nbsp; &nbsp; &nbsp; &nbsp; ],
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;"is_saled": np.zeros(n_rows * n_cols, dtype=int),
&nbsp; &nbsp; }
)

# æ ¹æ®ä¸Šåº§ç‡éšæœºæŠ½æ ·æŒ‡å®šä¸ªæ•°åº§ä½æ”¹ä¸ºå”®å‡ºçŠ¶æ€
# æ³¨æ„ï¼šæˆ‘ä¸æ˜¯æŠŠä¸Šåº§ç‡å½“æˆ 0-1 åˆ†å¸ƒçš„æ¦‚ç‡
# è€Œæ˜¯å½“æˆâ€œé¢‘ç‡"ï¼ŒæŠ½å–å®é™…é¢‘ç‡å¯¹åº”çš„å·²å”®å‡ºåº§ä½æ•°é‡
saled_index = np.random.choice(
&nbsp; &nbsp; df.index, size=int(occupancy_rate * df.shape[0]), replace=False
)
df.loc[saled_index,&nbsp;"is_saled"] =&nbsp;1# 0 è¡¨ç¤ºåº§ä½æœªå”®å‡ºï¼Œ1è¡¨ç¤ºå·²å”®å‡º

# åœ¨ Jupyer ç¯å¢ƒä¸­å±•ç¤ºæ•°æ®æ¡†
# å¦‚æœåœ¨å…¶ä»–ç¯å¢ƒæ‰§è¡Œï¼Œå¯èƒ½æŠ¥é”™
display(df)</code></pre>
<section></section>
<section>3. è¿™é‡Œåˆ›å»º&nbsp;<code>Hive</code>è¡¨ï¼Œå¹¶å°†æ•°æ®å†™å…¥ã€‚ä¸å‰ä¸¤æœŸä¸åŒï¼Œä¹‹å‰æˆ‘éƒ½æ˜¯å°†<code>pd.DataFrame</code>é‡‡ç”¨<code>to_csv</code>è½¬ä¸º<code>csv</code>æ–‡ä»¶ï¼›ç„¶åç”¨<code>pyHive</code>åœ¨<code>Hive</code>ä¸­å»ºå¥½è¡¨ï¼Œå†ä½¿ç”¨<code>load data local inpath</code>çš„æ–¹æ³•å¯¼å…¥æ•°æ®ã€‚è€Œè¿™ä¸€æ¬¡ï¼Œæˆ‘é‡‡ç”¨<code>CTAS</code>çš„æ–¹å¼æ¥å»ºè¡¨å¹¶å†™å…¥æ•°æ®ï¼Œä¹Ÿå°±æ˜¯<code>create table ... as select...</code>ï¼›ä½†æ˜¯è¿™ç§æ–¹æ³•æœ‰ç¼ºç‚¹ï¼Œæ¯”å¦‚æ— æ³•åœ¨å»ºè¡¨æ—¶å¢åŠ è¡¨å’Œåˆ—çš„å¤‡æ³¨ã€‚å› æ­¤æˆ‘ä½¿ç”¨<code>alter table</code>&nbsp;è¯­å¥æ¥å¢åŠ å¤‡æ³¨ã€‚</section>
<p>å…³äº&nbsp;<code>alter table</code>&nbsp;è¯­å¥çš„ä½¿ç”¨æ ¼å¼å’Œå®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘å·²ç»åœ¨ä»£ç æ³¨é‡Šä¸­è¯´æ˜ï¼š</p>
<pre class="highlighter-hljs" data-dark-theme="true"><code>from&nbsp;pyhive&nbsp;import&nbsp;hive

# é…ç½®è¿æ¥å‚æ•°
host_ip =&nbsp;"127.0.0.1"
port =&nbsp;10000
username =&nbsp;"è’‹ç‚¹æ•°åˆ†"

hive_table_name =&nbsp;'data_exercise.dwd_cinema_seat_sales_status'

# '1-1' å¿…é¡»ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œå¦åˆ™åœ¨ sql ä¸­è¢«å½“æˆ 1-1 çš„æ•°å­¦è¡¨è¾¾å¼
create_table_and_write_data_sql =&nbsp;f'''
create table&nbsp;{hive_table_name}&nbsp;as&nbsp;
select stack({df.shape[0]},
{','.join([f"'{row[0]}',{row[1]}"&nbsp;for&nbsp;row&nbsp;in&nbsp;df.values])}
) as (seat_no, is_saled)
'''

drop_table_sql =&nbsp;f'''
drop table if exists&nbsp;{hive_table_name}
'''

with&nbsp;hive.Connection(host=host_ip, port=port)&nbsp;as&nbsp;conn:
&nbsp; &nbsp; cursor = conn.cursor()
&nbsp; &nbsp;&nbsp;print(f'\næ‰§è¡Œåˆ é™¤è¡¨è¯­å¥ï¼š\n{drop_table_sql}')
&nbsp; &nbsp;&nbsp;# å¦‚æœè¯¥è¡¨å·²å­˜åœ¨ï¼Œåˆ™ drop
&nbsp; &nbsp; cursor.execute(drop_table_sql)

&nbsp; &nbsp;&nbsp;# åˆ›å»ºè¡¨å¹¶å†™å…¥æ•°æ®
&nbsp; &nbsp;&nbsp;print(f'\né‡‡ç”¨ `CTAS` å»ºè¡¨å¹¶å†™å…¥æ•°æ®ï¼š\n{create_table_and_write_data_sql}')
&nbsp; &nbsp; cursor.execute(create_table_and_write_data_sql)

&nbsp; &nbsp;&nbsp;# `CTAS` ä¸èƒ½åœ¨åˆ›å»ºæ—¶æ·»åŠ å¤‡æ³¨ï¼Œä½¿ç”¨ `alter` è¯­å¥å¢åŠ å¤‡æ³¨
&nbsp; &nbsp;&nbsp;# å®˜æ–¹æ–‡æ¡£
&nbsp; &nbsp;&nbsp;# https://hive.apache.org/docs/latest/languagemanual-ddl_27362034/#alter-table-comment
&nbsp; &nbsp;&nbsp;# ALTER TABLE table_name SET TBLPROPERTIES ('comment' = new_comment);
&nbsp; &nbsp; cursor.execute(f'''
&nbsp; &nbsp; alter table&nbsp;{hive_table_name}&nbsp;set tblproperties ('comment' =&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; 'ç”µå½±é™¢è¿ç»­é€‰åº§ | authorï¼šè’‹ç‚¹æ•°åˆ† | æ–‡ç« ç¼–å·ï¼š7b68c66c')
&nbsp; &nbsp; ''')

&nbsp; &nbsp;&nbsp;# å¢åŠ åˆ—å¤‡æ³¨ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£
&nbsp; &nbsp;&nbsp;# https://hive.apache.org/docs/latest/languagemanual-ddl_27362034/#alter-column
&nbsp; &nbsp;&nbsp;# ALTER TABLE table_name [PARTITION partition_spec] CHANGE [COLUMN] col_old_name col_new_name column_type
&nbsp; &nbsp; &nbsp;&nbsp;# [COMMENT col_comment] [FIRST|AFTER column_name] [CASCADE|RESTRICT];
&nbsp; &nbsp;&nbsp;# æ²¡æœ‰æ‰“æ–¹æ‹¬å·çš„éƒ¨åˆ†æ˜¯å¿…é¡»å†™çš„ï¼Œä¹Ÿå°±æ˜¯å“ªæ€•ä½ ä¸æ›´æ”¹åˆ—åï¼Œä¸æ›´æ”¹æ•°æ®ç±»å‹ï¼Œä¹Ÿè¦å†™ä¸Šæ–°æ—§åˆ—åå’Œæ•°æ®ç±»å‹
&nbsp; &nbsp; cursor.execute(f'''
&nbsp; &nbsp; alter table&nbsp;{hive_table_name}&nbsp;change seat_no seat_no string comment 'åº§ä½ç¼–å·'
&nbsp; &nbsp; ''')

&nbsp; &nbsp; cursor.execute(f'''
&nbsp; &nbsp; -- å¦‚æœå°è¯•å°† `is_saled` æ”¹ä¸º `tinyint` ä¼šæŠ¥é”™ï¼Œåªèƒ½å¾€æ›´å¤§çš„æ•´å‹ä¿®æ”¹
&nbsp; &nbsp; alter table&nbsp;{hive_table_name}&nbsp;change is_saled is_saled int comment 'æ˜¯å¦å·²å”®å‡º'
&nbsp; &nbsp; ''')

&nbsp; &nbsp; cursor.execute(f'''
&nbsp; &nbsp; desc formatted&nbsp;{hive_table_name}
&nbsp; &nbsp; ''')

&nbsp; &nbsp; records = cursor.fetchall()

&nbsp; &nbsp;&nbsp;for&nbsp;r&nbsp;in&nbsp;records:
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;print(r)
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
&nbsp; &nbsp; cursor.close()</code></pre>
<section></section>
<section><img src="https://img2024.cnblogs.com/blog/3640949/202504/3640949-20250430075944488-333474640.png" alt="" height="580" width="900">
<p id="1745971185377"></p>
</section>
<section></section>
<p>åœ¨å†™å…¥æ•°æ®æ—¶ï¼Œæˆ‘åœ¨&nbsp;<code>select</code>&nbsp;è¯­å¥ä¸­ä½¿ç”¨äº†&nbsp;<code>stack</code>&nbsp;å‡½æ•°ï¼Œå®ƒæ˜¯è¡¨ç”Ÿæˆå‡½æ•°ã€‚å¦‚æœä½ ä¹‹å‰æ²¡æœ‰åœ¨&nbsp;<code>Hive</code>&nbsp;ä¸­ä½¿ç”¨è¿‡è¿™ä¸ªå‡½æ•°ï¼Œä½ å¯ä»¥æœæœå®ƒçš„ç”¨æ³•ã€‚æ•°æ®æ¯”è¾ƒç®€å•çš„æ—¶å€™ï¼Œæˆ‘å°±ç”¨å®ƒæ¥é…åˆ&nbsp;<code>CTAS</code>&nbsp;å†™å…¥æ•°æ®ã€‚</p>
<blockquote>
<p>æˆ‘é€šè¿‡ä½¿ç”¨&nbsp;<code>PyHive</code>&nbsp;åŒ…å®ç° Python æ“ä½œ&nbsp;<code>Hive</code>ã€‚æˆ‘ä¸ªäººç”µè„‘éƒ¨ç½²äº†&nbsp;<code>Hadoop</code>&nbsp;åŠ&nbsp;<code>Hive</code>ï¼Œä½†æ˜¯æ²¡æœ‰å¼€å¯è®¤è¯ï¼Œä¼ä¸šé‡Œä¸€èˆ¬å¸¸ç”¨&nbsp;<code>Kerberos</code>&nbsp;æ¥è¿›è¡Œå¤§æ•°æ®é›†ç¾¤çš„è®¤è¯ã€‚</p>
</blockquote>
<p>&nbsp;</p>
<p>4. æ—¢ç„¶ä¸Šé¢æ•°æ®éƒ½å†™å…¥&nbsp;<code>Hive</code>&nbsp;äº†ï¼Œé‚£ä¹ˆæˆ‘è¿™é‡Œåˆè´´ä¸€æ®µä»£ç ï¼Œæ˜¯å¹²ä»€ä¹ˆå‘¢ï¼Ÿè¿™æ®µä»£ç æ˜¯ç”¨æ¥åšå¯è§†åŒ–çš„ï¼Œå°†æ¨¡æ‹Ÿç”Ÿæˆçš„æ•°æ®åˆ©ç”¨å‡½æ•°å†™å…¥ç½‘é¡µï¼ˆä»¥å‰åœ¨æ•°åˆ†å·¥ä½œä¸­ç®€å•çš„ä½¿ç”¨è¿‡&nbsp;<code>Vue</code>ï¼‰<code>getCinemaHtml</code>&nbsp;å‡½æ•°å…¶å®å°±æ˜¯ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å‚æ•°è¿”å›å®Œæ•´çš„å­—ç¬¦ä¸²ã€‚å®Œæ•´å­—ç¬¦ä¸²å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç½‘é¡µï¼Œé‡Œé¢ä½¿ç”¨ CDN æ–¹æ³•å¼•å…¥äº†&nbsp;<code>Vue3</code>ï¼Œä½œä¸ºåˆå­¦è€…ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰ä½¿ç”¨å‰ç«¯æ„å»ºç­‰æ–¹æ³•æ¥åšï¼š</p>
<section></section>
<section><img src="https://img2024.cnblogs.com/blog/3640949/202504/3640949-20250430080033453-195967952.png" alt="" height="732" width="1112"></section>
<section></section>
<section></section>
<pre class="highlighter-hljs" data-dark-theme="true"><code># æ„é€ ç‰¹å®šæ ¼å¼ dict ç»™ç½‘é¡µç”»å›¾æä¾›æ•°æ®
seats_info_list = []

for&nbsp;i&nbsp;in&nbsp;df.groupby(by=df["seat_no"].apply(lambda&nbsp;s: s.split("-")[0])):
&nbsp; &nbsp; d = {"seat_row_no":&nbsp;int(i[0])}
&nbsp; &nbsp; d["seat_col_arr"] = i[1]["seat_no"].apply(lambda&nbsp;s:&nbsp;int(s.split("-")[1])).to_list()
&nbsp; &nbsp; d["is_saled_arr"] = i[1]["is_saled"].to_list()
&nbsp; &nbsp; seats_info_list.append(d)

print(seats_info_list)

# å¤–éƒ¨çš„è‡ªå®šä¹‰å‡½æ•°
from&nbsp;cinema_seats_html&nbsp;import&nbsp;getCinamaHtml

withopen('cinema_seats.html',&nbsp;'w')&nbsp;as&nbsp;f:
&nbsp; &nbsp;&nbsp;'''
&nbsp; &nbsp; å°† DataFrame çš„æ•°æ®å¤„ç†ä¸ºç‰¹å®šæ ¼å¼ï¼Œåœ¨ä½œä¸ºå­—ç¬¦ä¸²å†™å…¥
&nbsp; &nbsp; html é¡µé¢çš„ script æ ‡ç­¾ä¸­ï¼›è®© Javascript å°†å…¶ä½œä¸º
&nbsp; &nbsp; ä¸€ä¸ªå¯¹è±¡
&nbsp; &nbsp; '''
&nbsp; &nbsp; html_str = getCinemaHtml(seats_info_list)
&nbsp; &nbsp; f.write(html_str)</code></pre>
<p>&nbsp;</p>
</section>
<section>
<figure>ã€</figure>
</section>
<h3 data-pm-slice="0 0 []">å››ã€SQL è§£ç­”</h3>
<section>
<p>æˆ‘å…ˆå°†&nbsp;<code>seat_no</code>&nbsp;åˆ‡å¼€ï¼Œè¿™æ ·è¡Œå·ç å’Œåˆ—å·ç åé¢å†™ç€æ–¹ä¾¿ã€‚è®¡ç®—è¿ç»­ 5 ä¸ªç©ºåº§ä½ï¼Œä¸ºä»€ä¹ˆè¦&nbsp;<code>sum(if(is_saled=0, 1, 0)) = 5</code>&nbsp;è€Œä¸æ˜¯&nbsp;<code>sum(is_saled) = 0</code>ï¼Œå› ä¸º&nbsp;<code>rows between ... 4 following</code>ï¼Œåœ¨æ‰«åˆ°è¯¥åˆ†ç»„æœ€å 4 è¡Œæ—¶ï¼Œæ­¤æ—¶çª—å£çš„å®é™…é•¿åº¦å·²ç»ä¸æ˜¯ 5 ä¸ªäº†ï¼Œå› ä¸ºåé¢æ²¡æœ‰æ•°æ®äº†ã€‚<code>ç”¨ sum(is_saled) = 0</code>&nbsp;éœ€è¦å¢åŠ é¢å¤–çš„é€»è¾‘ã€‚ç”¨&nbsp;<code>3*abs(seat_row-0.65*seat_max_row)+2*abs(seat_col-0.5*seat_max_col_current_row</code>&nbsp;æ¥å¤„ç†æˆ‘è‡ªå®šä¹‰çš„â€œæ¬§å¼è·ç¦»â€ï¼Œè¿™é‡Œè¡Œæ–¹å‘å’Œåˆ—æ–¹å‘çš„æƒé‡æ˜¯ 3:2ï¼›æœ€åç­›é€‰ 5 ä¸ªè¿ç»­ç©ºåº§çš„æ ‡å¿—ï¼Œå°†â€œæ¬§å¼è·ç¦»â€å‡åºæ’åˆ—ï¼Œå¹¶ä¸”å°†è¿ç»­åº§ä½çš„æ˜¾ç¤ºæ ¼å¼è°ƒæ•´ä¸€ä¸‹å³å¯ã€‚</p>
</section>
<p>&nbsp;</p>
<section><span data-pm-slice="0 0 []"><br></span>
<pre class="highlighter-hljs" data-dark-theme="true"><code>-- æ±‚è¿ç»­ 5 ä¸ªçš„ç©ºåº§ä½

with&nbsp;simple_processing_table&nbsp;as&nbsp;(
&nbsp; &nbsp;&nbsp;-- è¡¨åæ ¹æ®â€œæœ‰é“ç¿»è¯‘â€å–çš„ï¼Œå°±æ˜¯ç®€å•å¤„ç†ä¸€ä¸‹
&nbsp; &nbsp;&nbsp;-- å°†è¡Œå·å’Œåˆ—å·å•ç‹¬æ‹¿å‡ºæ¥ï¼Œåé¢å†™ç€æ–¹ä¾¿ä¸€ç‚¹ç‚¹ï¼›ä¸å¤„ç†ä¹Ÿå¯ä»¥
&nbsp; &nbsp;&nbsp;select
&nbsp; &nbsp; &nbsp; seat_no
&nbsp; &nbsp; ,&nbsp;int(split(seat_no,&nbsp;'-')[0])&nbsp;as&nbsp;seat_row
&nbsp; &nbsp; ,&nbsp;int(split(seat_no,&nbsp;'-')[1])&nbsp;as&nbsp;seat_col
&nbsp; &nbsp; , is_saled
&nbsp; &nbsp;&nbsp;from&nbsp;data_exercise.dwd_cinema_seat_sales_status
)

, calc_5_continuous_seats_table&nbsp;as&nbsp;(
&nbsp; &nbsp;-- è®¡ç®—è¿ç»­ 5 ä¸ªç©ºåº§ä½ï¼Œä¸ºä»€ä¹ˆè¦ sum(if(is_saled=0, 1, 0)) = 5 è€Œä¸æ˜¯
&nbsp; &nbsp;-- sum(is_saled) = 0ï¼Œå› ä¸º rows between ... 4 followingï¼Œåœ¨æ‰«åˆ°è¯¥åˆ†ç»„æœ€å 4 è¡Œæ—¶
&nbsp; &nbsp;-- æ­¤æ—¶çª—å£çš„å®é™…é•¿åº¦å·²ç»ä¸æ˜¯ 5 ä¸ªäº†ï¼Œå› ä¸ºåé¢æ²¡æœ‰æ•°æ®äº†ã€‚ç”¨ sum(is_saled) = 0
&nbsp; &nbsp;-- éœ€è¦å¢åŠ é¢å¤–çš„é€»è¾‘
&nbsp; &nbsp;&nbsp;select
&nbsp; &nbsp; &nbsp; seat_no, seat_row, seat_col
&nbsp; &nbsp; ,&nbsp;sum(if(is_saled=0,&nbsp;1,&nbsp;0))&nbsp;over&nbsp;(partitionby&nbsp;seat_row&nbsp;orderby&nbsp;seat_col&nbsp;asc
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;rowsbetweencurrentrowand4&nbsp;following)&nbsp;as&nbsp;tag
&nbsp; &nbsp; , collect_set(seat_no)&nbsp;over&nbsp;(partitionby&nbsp;seat_row&nbsp;orderby&nbsp;seat_col&nbsp;asc
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;rowsbetweencurrentrowand4&nbsp;following)&nbsp;as&nbsp;seat_plan_array
&nbsp; &nbsp; ,&nbsp;max(seat_row)&nbsp;over&nbsp;()&nbsp;as&nbsp;seat_max_row
&nbsp; &nbsp;&nbsp;-- è¿™é‡Œé˜Ÿåˆ—ä¹‹æ‰€ä»¥ç”¨ partition by seat_rowï¼Œä¸åƒæ±‚æœ€å¤šè¡Œ over åé¢æ²¡æœ‰å†…å®¹ï¼Œ
&nbsp; &nbsp;&nbsp;-- å…¶å®è¿˜æ˜¯å…¼å®¹äº†æ¯æ’åº§ä½æ•°ä¸åŒçš„æƒ…å†µï¼Œåªæ˜¯æ²¡æœ‰è¿‡äºç»†è‡´çš„å¤„ç†
&nbsp; &nbsp; ,&nbsp;max(seat_col)&nbsp;over&nbsp;(partitionby&nbsp;seat_row)&nbsp;as&nbsp;seat_max_col_current_row
&nbsp; &nbsp;&nbsp;from&nbsp;simple_processing_table
)&nbsp;

, calc_euclidean_distance_table&nbsp;as&nbsp;(
&nbsp; &nbsp;&nbsp;-- è®¡ç®—æ¬§å¼è·ç¦»å’Œå°†åº§ä½æ±‡æ€»ï¼Œä¾æ—§æ˜¯æœ‰é“ç¿»è¯‘ï¼Œå–åå¤ªéš¾äº†
&nbsp; &nbsp;&nbsp;select
&nbsp; &nbsp; &nbsp; seat_no&nbsp;as&nbsp;start_seat_no
&nbsp; &nbsp; &nbsp;&nbsp;-- æ³¨æ„åŠ  4
&nbsp; &nbsp; , concat(seat_row,&nbsp;'-', seat_col,&nbsp;'~', seat_row,&nbsp;'-',seat_col+4)&nbsp;as&nbsp;seat_plan
&nbsp; &nbsp; , seat_max_row
&nbsp; &nbsp; , seat_max_col_current_row
&nbsp; &nbsp; , seat_plan_array
&nbsp; &nbsp; &nbsp;&nbsp;-- æ³¨æ„åˆ°æ¯æ’æœ€å 4 ä¸ªçš„æ—¶å€™ï¼Œå®é™…å¯ä¸æ˜¯ 5 ä¸ªè·ç¦»ä¹‹å’Œäº†ï¼›åªä¸è¿‡åé¢ä¼šè¢«æ¡ä»¶ tag=5 ç­›æ‰
&nbsp; &nbsp; ,&nbsp;sum(
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;3*abs(seat_row&nbsp;-0.65*&nbsp;seat_max_row)&nbsp;+2*abs(seat_col&nbsp;-0.5*&nbsp;seat_max_col_current_row)
&nbsp; &nbsp; &nbsp; )&nbsp;over&nbsp;(partitionby&nbsp;seat_row&nbsp;orderby&nbsp;seat_col&nbsp;asc
&nbsp; &nbsp; &nbsp;&nbsp;rowsbetweencurrentrowand4&nbsp;following)&nbsp;as&nbsp;a_distance
&nbsp; &nbsp; , tag&nbsp;
&nbsp; &nbsp;&nbsp;from&nbsp;calc_5_continuous_seats_table
)

select
&nbsp; start_seat_no
, seat_plan
, seat_plan_array
, a_distance
, seat_max_row
, seat_max_col_current_row
from&nbsp;calc_euclidean_distance_table
where&nbsp;tag&nbsp;=5-- çª—å£å‡½æ•°å¡äº† 5 è¡Œï¼Œä¸å¯èƒ½è¶…è¿‡ 5
orderby&nbsp;a_distance&nbsp;asc</code></pre>
<p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š</p>
<section><img src="https://img2024.cnblogs.com/blog/3640949/202504/3640949-20250430080125618-295329761.png" alt="" height="809" width="1186">
<p id="1745971286134"></p>
</section>
<p>å’±ä»¬è·Ÿç½‘é¡µç¤ºæ„å›¾æ ¸å¯¹æ ¸å¯¹ï¼ˆåœ¨ WPS æ¼”ç¤ºä¸­åŠ å·¥ä¸€ä¸‹å±•ç¤ºï¼‰ï¼Œç»¿è‰²åŒºåŸŸæ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œçº¢è‰²åŒºåŸŸå°±æ˜¯æœ€å·®çš„é€‰æ‹©ï¼š</p>
<section></section>
<section><img src="https://img2024.cnblogs.com/blog/3640949/202504/3640949-20250430080138585-1669680149.png" alt="" height="707" width="1412"></section>
<section></section>
<figure>ä»¥ä¸‹æ˜¯è¿”å›ç½‘é¡µçš„&nbsp;<code>Python</code>&nbsp;å‡½æ•°ï¼Œåˆå­¦è€…é‡‡ç”¨&nbsp;<code>CDN</code>&nbsp;æ–¹æ³•å¼•å…¥çš„&nbsp;<code>Vue3</code>ï¼Œæœªä½¿ç”¨å‰ç«¯æ„å»ºå·¥å…·ï¼Œä¹Ÿæ²¡ä½¿ç”¨&nbsp;<code>Flask</code>&nbsp;æˆ–&nbsp;<code>Fastapi</code>&nbsp;å‰åç«¯åˆ†ç¦»ã€‚ä½œä¸ºä¸€åæ•°å­¦ï¼Œæ¥è§¦&nbsp;<code>Vue</code>&nbsp;ä¸ä¹…ï¼Œè¿˜è¯·æ‡‚å‰ç«¯çš„å¤§ä½¬æ”¾è¿‡ğŸ˜ƒï¼š</figure>
<pre class="highlighter-hljs" data-dark-theme="true"><code>def&nbsp;getCinemaHtml(seat_info_str):
&nbsp; &nbsp;&nbsp;return&nbsp;"""
&nbsp; &nbsp; &lt;!DOCTYPE html&gt;
&nbsp; &nbsp; &lt;html lang="zh-CN"&gt;
&nbsp; &nbsp; &lt;head&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;meta charset='UTF-8'&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;title&gt;ç”µå½±é™¢é€‰åº§ demo&lt;/title&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-10-y/font-awesome/5.15.4/css/all.min.css" /&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;style&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #app{
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;overflow: visible;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .row {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; display: flex;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; align-items: center;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .seat {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 0 2px 2px 0;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: #DFDFDF;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width: 30px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; height: 50px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; justify-content: center;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .seat.isSaled {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: #07c160;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .seat.isSaled:after {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; content: 'âœ“';
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 14px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: #000000;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; position: relative;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-weight: 800;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left: 7px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bottom: 42px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .series {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin-left: 10px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; white-space: nowrap;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .seat_no {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 12px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-weight: 600;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; white-space: nowrap;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .title {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; position: relative;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left: calc(10 * 30px);
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin-bottom: 16px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 16px;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; &lt;/style&gt;
&nbsp; &nbsp; &lt;/head&gt;
&nbsp; &nbsp; &lt;body&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;div id='app'&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="title"&gt;ç”µå½±é™¢è¿ç»­é€‰åº§ ç¤ºæ„å›¾ demo&lt;/div&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="row" v-for="(item, index) in seats_info" :key="item.seat_row_no"&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div :class="{seat:true, isSaled:item.is_saled_arr[i]}"&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v-for="(s, i) in item.seat_col_arr"&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;i class="fas fa-chair" style="font-size:30px;"&gt;&lt;/i&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="seat_no"&gt;{{ `${item.seat_row_no}-${s}` }}&lt;/div&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="series"&gt;{{ `ç¬¬ ${item.seat_row_no} æ’`}}&lt;/div&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;
&nbsp; &nbsp; &lt;script type='module'&gt;
&nbsp; &nbsp; import { createApp, reactive } from 'https://unpkg.zhimg.com/vue@3.5.13/dist/vue.esm-browser.js';
&nbsp; &nbsp;&nbsp;
&nbsp; &nbsp; const app = createApp({
&nbsp; &nbsp; &nbsp; setup(){
&nbsp; &nbsp; &nbsp; &nbsp; // å®šä¹‰ä¸€ä¸ª message
&nbsp; &nbsp; &nbsp; &nbsp; const seats_info = reactive(
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %s
&nbsp; &nbsp; &nbsp; &nbsp; );
&nbsp; &nbsp; &nbsp; &nbsp; return {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; seats_info
&nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; });
&nbsp; &nbsp;&nbsp;
&nbsp; &nbsp; app.mount('#app');
&nbsp; &nbsp; &lt;/script&gt;
&nbsp; &nbsp; &lt;/body&gt;
&nbsp; &nbsp; &lt;/html&gt;
&nbsp; &nbsp; """&nbsp;% (seat_info_str)</code></pre>
<hr>
<p>ğŸ˜ƒğŸ˜ƒğŸ˜ƒ<br><strong>æˆ‘ç°åœ¨æ­£åœ¨æ±‚èŒæ•°æ®ç±»å·¥ä½œ</strong>ï¼ˆä¸»è¦æ˜¯æ•°æ®åˆ†ææˆ–æ•°æ®ç§‘å­¦ï¼‰ï¼›å¦‚æœæ‚¨æœ‰åˆé€‚çš„æœºä¼šï¼Œæ³è¯·æ‚¨ä¸æˆ‘è”ç³»ï¼Œå³æ—¶åˆ°å²—ï¼Œä¸é™åŸå¸‚ã€‚</p>
</section>
</div>
<div class="clear"></div>
</div>
	