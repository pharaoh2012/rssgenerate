
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/fqxm/p/18728049" title="发布于 2025-02-20 23:10">
    <span role="heading" aria-level="2">IPMITool 工具使用详细教程</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ipmitool-工具使用详细教程">IPMITool 工具使用详细教程</h1>
<h2 id="一ipmi-与-ipmitool-简介">一、IPMI 与 IPMITool 简介</h2>
<h3 id="1-ipmi-概述">1. IPMI 概述</h3>
<p>智能平台管理接口（Intelligent Platform Management Interface，简称 IPMI）是一种开放标准的硬件管理接口规格，定义了嵌入式管理子系统进行通信的特定方法。它独立于系统的 CPU、BIOS 和操作系统，能够在系统未开机的状态下，对系统进行监控、管理和维护。通过 IPMI，管理员可以远程监控服务器的硬件状态（如温度、电压、风扇转速等）、控制服务器的电源状态、进行系统日志记录等操作。</p>
<h3 id="2-ipmitool-概述">2. IPMITool 概述</h3>
<p>IPMITool 是一个开源的命令行工具，用于与支持 IPMI 标准的系统进行交互。它提供了丰富的功能，允许用户通过 IPMI 接口执行各种管理任务。IPMITool 可以运行在多种操作系统上，如 Linux、Windows 等，为管理员提供了一种方便、灵活的方式来管理和监控服务器硬件。</p>
<h2 id="二ipmitool-安装">二、IPMITool 安装</h2>
<h3 id="1-linux-系统安装">1. Linux 系统安装</h3>
<h4 id="debianubuntu-系统">Debian/Ubuntu 系统</h4>
<p>在终端中执行以下命令进行安装：</p>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install ipmitool
</code></pre>
<h4 id="red-hatcentos-系统">Red Hat/CentOS 系统</h4>
<p>使用以下命令进行安装：</p>
<pre><code class="language-bash">sudo yum install ipmitool
</code></pre>
<h3 id="2-windows-系统安装">2. Windows 系统安装</h3>
<ul>
<li>访问 IPMITool 的官方下载页面或相关软件源，下载适用于 Windows 的 IPMITool 安装包。</li>
<li>运行安装包，按照安装向导的提示完成安装。安装完成后，需要将 IPMITool 的安装目录添加到系统的环境变量中，以便在命令提示符中可以直接使用。</li>
</ul>
<h2 id="三ipmitool-基本使用">三、IPMITool 基本使用</h2>
<h3 id="1-连接到目标服务器">1. 连接到目标服务器</h3>
<p>在使用 IPMITool 之前，需要先与支持 IPMI 的目标服务器建立连接。连接服务器需要知道服务器的 IPMI 接口的 IP 地址、用户名和密码。使用以下命令进行连接：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; &lt;命令&gt;
</code></pre>
<ul>
<li><code>-I lanplus</code>：指定使用 LAN 协议进行连接，这是最常用的连接方式。</li>
<li><code>-H &lt;IP 地址&gt;</code>：指定目标服务器 IPMI 接口的 IP 地址。</li>
<li><code>-U &lt;用户名&gt;</code>：指定登录 IPMI 接口的用户名。</li>
<li><code>-P &lt;密码&gt;</code>：指定登录 IPMI 接口的密码。</li>
</ul>
<p>例如，连接到 IP 地址为 <code>192.168.1.100</code>，用户名为 <code>admin</code>，密码为 <code>password</code> 的服务器，并查看服务器的系统信息：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H 192.168.1.100 -U admin -P password chassis status
</code></pre>
<h3 id="2-查看服务器硬件状态信息">2. 查看服务器硬件状态信息</h3>
<h4 id="查看传感器信息">查看传感器信息</h4>
<p>传感器信息可以反映服务器的硬件状态，如温度、电压、风扇转速等。使用以下命令查看传感器信息：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; sensor
</code></pre>
<p>该命令将输出服务器上所有传感器的详细信息，包括传感器名称、当前值、状态等。例如：</p>
<pre><code class="language-plaintext">CPU Temp         | 32.000     | degrees C  | ok    | na        | 5.000     | 10.000    | 80.000    | 85.000    | 90.000    
MB Temp          | 28.000     | degrees C  | ok    | na        | 5.000     | 10.000    | 70.000    | 75.000    | 80.000    
Fan1             | 3000       | RPM        | ok    | na        | 1000      | 1500      | 8000      | 8500      | 9000    
</code></pre>
<h4 id="查看系统事件日志sel">查看系统事件日志（SEL）</h4>
<p>系统事件日志记录了服务器硬件的各种事件信息，如硬件故障、传感器告警等。使用以下命令查看系统事件日志：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; sel list
</code></pre>
<p>该命令将输出系统事件日志的详细信息，包括事件发生的时间、事件类型、事件描述等。例如：</p>
<pre><code class="language-plaintext">1 | 01/01/2025 | 12:00:00 | Temperature Sensor | CPU Temp | Going High
2 | 01/01/2025 | 12:05:00 | Temperature Sensor | CPU Temp | Going Normal
</code></pre>
<h3 id="3-控制服务器电源状态">3. 控制服务器电源状态</h3>
<h4 id="查看电源状态">查看电源状态</h4>
<p>使用以下命令查看服务器的电源状态：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; chassis power status
</code></pre>
<p>该命令将输出服务器的电源状态，如 <code>Power is on</code> 或 <code>Power is off</code>。</p>
<h4 id="开机">开机</h4>
<p>使用以下命令开启服务器电源：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; chassis power on
</code></pre>
<h4 id="关机">关机</h4>
<p>使用以下命令关闭服务器电源：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; chassis power off
</code></pre>
<h4 id="重启">重启</h4>
<p>使用以下命令重启服务器：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; chassis power reset
</code></pre>
<h3 id="4-远程控制台sol功能">4. 远程控制台（SOL）功能</h3>
<p>远程控制台（Serial over LAN，简称 SOL）允许用户通过网络远程访问服务器的串口控制台。使用以下命令启用 SOL 功能：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; sol activate
</code></pre>
<p>启用 SOL 功能后，用户可以在终端中像操作本地串口控制台一样操作服务器。要退出 SOL 会话，可以按下 <code>Ctrl + ]</code> 组合键。</p>
<h2 id="四高级使用">四、高级使用</h2>
<h3 id="1-设置-ipmi-接口参数">1. 设置 IPMI 接口参数</h3>
<p>可以使用 IPMITool 来设置服务器 IPMI 接口的参数，如 IP 地址、子网掩码、网关等。以下是设置 IPMI 接口 IP 地址的示例：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; lan set 1 ipsrc static
ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; lan set 1 ipaddr &lt;新 IP 地址&gt;
ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; lan set 1 netmask &lt;子网掩码&gt;
ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; lan set 1 defgw ipaddr &lt;网关地址&gt;
</code></pre>
<h3 id="2-批量操作">2. 批量操作</h3>
<p>如果需要对多台服务器进行相同的操作，可以编写脚本实现批量操作。以下是一个使用 Bash 脚本批量查看多台服务器传感器信息的示例：</p>
<pre><code class="language-bash">#!/bin/bash

# 定义服务器列表
servers=(
"192.168.1.100"
"192.168.1.101"
"192.168.1.102"
)

# 定义用户名和密码
username="admin"
password="password"

# 遍历服务器列表
for server in "${servers[@]}"
do
    echo "查看服务器 $server 的传感器信息："
    ipmitool -I lanplus -H $server -U $username -P $password sensor
    echo "------------------------------"
done
</code></pre>
<p>将上述脚本保存为 <code>batch_sensor.sh</code>，并赋予执行权限：</p>
<pre><code class="language-bash">chmod +x batch_sensor.sh
</code></pre>
<p>然后运行脚本：</p>
<pre><code class="language-bash">./batch_sensor.sh
</code></pre>
<h3 id="3-用户管理">3. 用户管理</h3>
<h4 id="创建用户">创建用户</h4>
<p>可以使用 IPMITool 创建新的 IPMI 用户，以便不同的管理员使用不同的账号进行管理操作。创建用户的命令如下：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; user set name &lt;用户 ID&gt; &lt;新用户名&gt;
ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; user set password &lt;用户 ID&gt; &lt;新密码&gt;
ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; user enable &lt;用户 ID&gt;
</code></pre>
<ul>
<li><code>&lt;用户 ID&gt;</code>：是一个唯一的数字，用于标识用户，范围通常是 1 - 16。</li>
<li><code>&lt;新用户名&gt;</code>：指定要创建的新用户的名称。</li>
<li><code>&lt;新密码&gt;</code>：指定新用户的登录密码。</li>
</ul>
<p>例如，创建一个用户 ID 为 3，用户名为 <code>newuser</code>，密码为 <code>newpassword</code> 的新用户：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H 192.168.1.100 -U admin -P password user set name 3 newuser
ipmitool -I lanplus -H 192.168.1.100 -U admin -P password user set password 3 newpassword
ipmitool -I lanplus -H 192.168.1.100 -U admin -P password user enable 3
</code></pre>
<h4 id="修改用户权限">修改用户权限</h4>
<p>创建用户后，可以根据需要为用户分配不同的权限。权限分为不同的级别，如 <code>CALLBACK</code>、<code>USER</code>、<code>OPERATOR</code>、<code>ADMINISTRATOR</code> 等。使用以下命令修改用户权限：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; channel setaccess &lt;通道 ID&gt; &lt;用户 ID&gt; privilege=&lt;权限级别&gt;
</code></pre>
<ul>
<li><code>&lt;通道 ID&gt;</code>：通常为 1，表示 LAN 通道。</li>
<li><code>&lt;权限级别&gt;</code>：可以是 <code>CALLBACK</code>、<code>USER</code>、<code>OPERATOR</code>、<code>ADMINISTRATOR</code> 等。</li>
</ul>
<p>例如，将用户 ID 为 3 的用户权限设置为 <code>ADMINISTRATOR</code>：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H 192.168.1.100 -U admin -P password channel setaccess 1 3 privilege=ADMINISTRATOR
</code></pre>
<h4 id="删除用户">删除用户</h4>
<p>如果某个用户不再需要，可以使用以下命令删除用户：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; user disable &lt;用户 ID&gt;
ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; user delete &lt;用户 ID&gt;
</code></pre>
<p>例如，删除用户 ID 为 3 的用户：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H 192.168.1.100 -U admin -P password user disable 3
ipmitool -I lanplus -H 192.168.1.100 -U admin -P password user delete 3
</code></pre>
<h3 id="4-修改-ipmi-接口密码">4. 修改 IPMI 接口密码</h3>
<p>可以使用 IPMITool 修改 IPMI 接口的管理员密码。使用以下命令修改密码：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;旧密码&gt; user set password &lt;用户 ID&gt; &lt;新密码&gt;
</code></pre>
<p>例如，将用户 ID 为 1（通常为管理员用户）的密码从 <code>oldpassword</code> 修改为 <code>newpassword</code>：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H 192.168.1.100 -U admin -P oldpassword user set password 1 newpassword
</code></pre>
<h3 id="5-传感器阈值设置">5. 传感器阈值设置</h3>
<p>可以使用 IPMITool 设置传感器的阈值，当传感器的值超过或低于阈值时，系统会触发相应的告警。以下是设置 CPU 温度传感器高阈值的示例：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; sensor thresh &lt;传感器名称&gt; upper &lt;高阈值&gt;
</code></pre>
<p>例如，将 CPU 温度传感器的高阈值设置为 85 摄氏度：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H 192.168.1.100 -U admin -P password sensor thresh "CPU Temp" upper 85
</code></pre>
<h3 id="6-远程固件升级">6. 远程固件升级</h3>
<p>部分支持 IPMI 的服务器可以通过 IPMITool 进行远程固件升级。固件升级通常需要先下载最新的固件文件，然后使用 IPMITool 上传并执行升级操作。不同服务器的固件升级命令可能有所不同，一般需要参考服务器的用户手册。以下是一个简单的示例：</p>
<pre><code class="language-bash">ipmitool -I lanplus -H &lt;IP 地址&gt; -U &lt;用户名&gt; -P &lt;密码&gt; raw &lt;升级命令&gt; &lt;固件文件路径&gt;
</code></pre>
<h2 id="五常见问题及解决方法">五、常见问题及解决方法</h2>
<h3 id="1-连接失败">1. 连接失败</h3>
<ul>
<li><strong>原因</strong>：可能是 IP 地址、用户名或密码错误，或者目标服务器的 IPMI 接口未开启。</li>
<li><strong>解决方法</strong>：检查 IP 地址、用户名和密码是否正确，确保目标服务器的 IPMI 接口已开启。可以通过服务器的 BIOS 或 BMC 管理界面进行检查和设置。</li>
</ul>
<h3 id="2-命令执行无响应">2. 命令执行无响应</h3>
<ul>
<li><strong>原因</strong>：可能是网络问题或服务器负载过高。</li>
<li><strong>解决方法</strong>：检查网络连接是否正常，尝试使用 <code>ping</code> 命令测试与目标服务器的网络连通性。如果服务器负载过高，可以等待一段时间后再尝试执行命令。</li>
</ul>
<h3 id="3-权限不足">3. 权限不足</h3>
<ul>
<li><strong>原因</strong>：可能是使用的用户名没有足够的权限执行相应的命令。</li>
<li><strong>解决方法</strong>：使用具有更高权限的用户名登录 IPMI 接口，或者在服务器的 BMC 管理界面中为当前用户分配相应的权限。</li>
</ul>
<h3 id="4-用户创建或权限修改失败">4. 用户创建或权限修改失败</h3>
<ul>
<li><strong>原因</strong>：可能是用户 ID 已被使用，或者权限级别指定错误。</li>
<li><strong>解决方法</strong>：检查用户 ID 是否可用，确保权限级别指定正确。可以使用 <code>ipmitool user list</code> 命令查看已有的用户信息。</li>
</ul>
<h2 id="六总结">六、总结</h2>
<p>IPMITool 是一个功能强大的工具，通过它可以方便地对支持 IPMI 标准的服务器进行管理和监控。本文详细介绍了 IPMITool 的安装、基本使用、高级使用以及常见问题的解决方法。希望通过本文的介绍，你能够熟练掌握 IPMITool 的使用，提高服务器管理的效率。</p>

</div>
<div id="MySignature" role="contentinfo">
    <p>本文来自博客园，作者：<a href="https://www.cnblogs.com/fqxm/" target="_blank">ZHappy-Blog</a>，转载请注明原文链接：<a href="https://www.cnblogs.com/fqxm/p/18728049" target="_blank">https://www.cnblogs.com/fqxm/p/18728049</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.2119870160625" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-02-20 23:10">2025-02-20 23:10</span>&nbsp;
<a href="https://www.cnblogs.com/fqxm">ZHappy-Blog</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18728049" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18728049);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18728049', targetLink: 'https://www.cnblogs.com/fqxm/p/18728049', title: 'IPMITool 工具使用详细教程' })">举报</a>
</div>
        