
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/eastern-sun/p/18779001" title="发布于 2025-03-18 15:20">
    <span role="heading" aria-level="2">日志规范</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="1-日志的核心职责"><strong>1. 日志的核心职责</strong></h3>
<p>日志的核心任务是<strong>记录系统的操作和事件</strong>，以便后续审计、分析和故障排查。具体包括：</p>
<ul>
<li><strong>操作记录</strong>：记录用户的操作（如登录、数据修改、文件上传）。</li>
<li><strong>系统事件</strong>：记录系统的运行状态（如启动、关闭、错误）。</li>
<li><strong>安全事件</strong>：记录与安全相关的事件（如登录失败、权限变更）。</li>
</ul>
<p>日志的作用是提供<strong>可追溯性</strong>和<strong>透明度</strong>，而不是直接过滤或阻止恶意行为。</p>
<hr>
<h3 id="2-日志需要注意的事项"><strong>2. 日志需要注意的事项</strong></h3>
<p>为了确保日志的有效性和安全性，需要注意以下事项：</p>
<h4 id="21-日志内容的完整性"><strong>2.1 日志内容的完整性</strong></h4>
<ul>
<li><strong>记录关键信息</strong>：包括时间、用户ID、操作类型、操作对象、操作描述、操作结果等。</li>
<li><strong>避免敏感信息泄露</strong>：不要在日志中记录敏感信息（如密码、信用卡号）。</li>
</ul>
<h4 id="22-日志的存储与保护"><strong>2.2 日志的存储与保护</strong></h4>
<ul>
<li><strong>集中存储</strong>：将日志集中存储，避免分散在多台服务器上。</li>
<li><strong>访问控制</strong>：限制对日志的访问权限，防止日志被篡改或删除。</li>
<li><strong>加密存储</strong>：对日志进行加密，防止泄露。</li>
</ul>
<h4 id="23-日志的保留与清理"><strong>2.3 日志的保留与清理</strong></h4>
<ul>
<li><strong>保留期限</strong>：根据法规和业务需求设置日志的保留期限。</li>
<li><strong>定期清理</strong>：定期清理过期的日志，避免占用过多存储空间。</li>
</ul>
<h4 id="24-日志的监控与分析"><strong>2.4 日志的监控与分析</strong></h4>
<ul>
<li><strong>实时监控</strong>：实时监控日志，及时发现异常行为。</li>
<li><strong>自动化分析</strong>：使用工具（如ELK Stack、Splunk）对日志进行分析，识别潜在的安全威胁。</li>
</ul>
<hr>
<h3 id="3-日志与过滤安全防护的关系"><strong>3. 日志与过滤、安全防护的关系</strong></h3>
<p>虽然日志的主要职责是记录，但它与过滤和安全防护密切相关，主要体现在以下几个方面：</p>
<h4 id="31-日志为过滤和安全防护提供数据支持"><strong>3.1 日志为过滤和安全防护提供数据支持</strong></h4>
<ul>
<li><strong>输入过滤</strong>：在过滤用户输入时，可以将过滤结果记录到日志中（如“检测到SQL注入尝试”）。</li>
<li><strong>入侵检测</strong>：通过分析日志，可以识别潜在的攻击行为（如多次登录失败、异常查询）。</li>
</ul>
<h4 id="32-日志用于事后分析和审计"><strong>3.2 日志用于事后分析和审计</strong></h4>
<ul>
<li><strong>攻击溯源</strong>：通过日志可以追踪攻击的来源和过程。</li>
<li><strong>责任认定</strong>：通过日志可以确定谁在什么时间执行了什么操作。</li>
</ul>
<h4 id="33-日志与实时告警的结合"><strong>3.3 日志与实时告警的结合</strong></h4>
<ul>
<li><strong>实时监控</strong>：通过实时分析日志，可以触发安全告警（如“检测到XSS攻击尝试”）。</li>
<li><strong>自动化响应</strong>：结合SOAR（安全编排、自动化与响应）工具，可以实现自动化的安全响应（如封锁IP地址）。</li>
</ul>
<hr>
<h3 id="4-日志与过滤的分工"><strong>4. 日志与过滤的分工</strong></h3>
<ul>
<li><strong>过滤</strong>：是<strong>实时</strong>的安全防护措施，负责在用户输入进入系统之前进行验证和过滤。</li>
<li><strong>日志</strong>：是<strong>事后</strong>的记录和分析工具，负责记录系统的操作和事件，为安全防护提供数据支持。</li>
</ul>
<p>举个例子：</p>
<ul>
<li><strong>过滤</strong>：当用户输入<code>' OR 1=1 --</code>时，系统会直接拒绝该请求并返回错误提示。</li>
<li><strong>日志</strong>：系统会记录“检测到SQL注入尝试，用户：guest，IP：192.168.1.1，时间：2023-10-01 12:00:00”。</li>
</ul>
<h3 id="5-具体日志应记录的内容"><strong>5. 具体日志应记录的内容</strong></h3>
<table>
<thead>
<tr>
<th><strong>类别</strong></th>
<th><strong>子类别</strong></th>
<th><strong>记录内容</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>用户操作日志</strong></td>
<td>登录与认证</td>
<td>登录成功/失败、注销、密码修改/重置。</td>
</tr>
<tr>
<td></td>
<td>数据操作</td>
<td>数据增删改查（CRUD）、导入/导出、备份/恢复。</td>
</tr>
<tr>
<td></td>
<td>权限管理</td>
<td>权限分配/修改/撤销、角色创建/修改/删除、权限变更历史。</td>
</tr>
<tr>
<td></td>
<td>其他操作</td>
<td>文件上传/下载/删除、系统配置修改、敏感操作（如删除重要数据）。</td>
</tr>
<tr>
<td><strong>安全日志</strong></td>
<td>登录安全</td>
<td>连续登录失败、异常登录行为（国外IP等异地登录）: 账户锁定/解锁。</td>
</tr>
<tr>
<td></td>
<td>权限变更</td>
<td>管理员和特权用户对普通用户进行权限变更操作。</td>
</tr>
<tr>
<td></td>
<td>安全事件</td>
<td>攻击行为（如SQL注入、跨站伪造脚本、用户超长输入产生的缓冲区溢出）。</td>
</tr>
<tr>
<td></td>
<td>审计日志</td>
<td>敏感数据访问记录；重要配置修改记录；系统审计操作记录。</td>
</tr>
<tr>
<td><strong>第三方服务日志</strong></td>
<td>API调用</td>
<td>第三方API请求/响应；调用成功/失败状态；耗时/错误信息。</td>
</tr>
<tr>
<td></td>
<td>支付与交易</td>
<td>支付请求/结果；交易状态/详情；退款/撤销操作记录。</td>
</tr>
<tr>
<td></td>
<td>消息与通知</td>
<td>短信/邮件/推送发送记录；发送状态/错误信息。</td>
</tr>
<tr>
<td><strong>数据库日志</strong></td>
<td>查询日志</td>
<td>SQL查询执行记录；查询时间/结果/错误信息。</td>
</tr>
<tr>
<td></td>
<td>事务日志</td>
<td>事务开始/提交/回滚记录；事务详细操作步骤。</td>
</tr>
<tr>
<td></td>
<td>数据变更日志</td>
<td>数据插入/更新/删除记录；变更前后值（用于审计）。</td>
</tr>
<tr>
<td><strong>自定义业务日志</strong></td>
<td>业务操作</td>
<td>用户下单/支付/退款。</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="日志记录最佳实践"><strong>日志记录，最佳实践</strong></h3>
<ol>
<li><strong>避免敏感信息</strong>：不记录密码、信用卡号等。</li>
<li><strong>结构化日志</strong>：使用JSON等格式，便于解析。</li>
<li><strong>日志级别控制</strong>：根据环境调整日志级别。</li>
<li><strong>日志采样</strong>：高流量时采样记录，避免日志量过大。</li>
<li><strong>记录入参和出参</strong>：记录入参和出参，方便快速定位问题。</li>
<li><strong>if分支日志</strong>：在每个分支的首行应打印日志，便于理清程序运行逻辑。</li>
</ol>
<hr>

</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.00040937792708333333" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-18 16:21">2025-03-18 15:20</span>&nbsp;
<a href="https://www.cnblogs.com/eastern-sun">西北的风</a>&nbsp;
阅读(<span id="post_view_count">9</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18779001" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18779001);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18779001', targetLink: 'https://www.cnblogs.com/eastern-sun/p/18779001', title: '日志规范' })">举报</a>
</div>
	