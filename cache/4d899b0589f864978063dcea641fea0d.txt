
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/mikeCao/p/18921879" title="å‘å¸ƒäº 2025-06-10 11:28">
    <span role="heading" aria-level="2">æ·±åº¦è§£æï¼šè™šæ‹Ÿåˆ—è¡¨æ€§èƒ½ä¼˜åŒ–çš„æŠ€æœ¯è‰ºæœ¯</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="-æ·±åº¦è§£æcocos-creatorè™šæ‹Ÿåˆ—è¡¨æ€§èƒ½ä¼˜åŒ–çš„æŠ€æœ¯è‰ºæœ¯">ğŸš€ æ·±åº¦è§£æï¼šCocos Creatorè™šæ‹Ÿåˆ—è¡¨æ€§èƒ½ä¼˜åŒ–çš„æŠ€æœ¯è‰ºæœ¯</h1>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>åœ¨ç§»åŠ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œåˆ—è¡¨æ¸²æŸ“æ€§èƒ½ä¸€ç›´æ˜¯å½±å“ç”¨æˆ·ä½“éªŒçš„å…³é”®æŠ€æœ¯ç“¶é¢ˆã€‚å½“é¢å¯¹åƒæ¡èŠå¤©è®°å½•ã€æ•°åƒä¸ªèƒŒåŒ…ç‰©å“æˆ–æµ·é‡æ’è¡Œæ¦œæ•°æ®æ—¶ï¼Œä¼ ç»Ÿ ScrollView å¾€å¾€åŠ›ä¸ä»å¿ƒã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä»æŠ€æœ¯è§’åº¦ï¼Œæ·±åº¦å‰–æä¸€ä¸ªåœ¨ Cocos Creator ç”Ÿæ€ä¸­è¡¨ç°å“è¶Šçš„è™šæ‹Ÿåˆ—è¡¨è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒæŠ€æœ¯å®ç°ã€‚</p>
<h2 id="-æ ¸å¿ƒæŠ€æœ¯äº®ç‚¹åˆ†æ">ğŸ§  æ ¸å¿ƒæŠ€æœ¯äº®ç‚¹åˆ†æ</h2>
<h3 id="1-ç®—æ³•å±‚é¢çš„çªç ´olog-n-äºŒåˆ†æŸ¥æ‰¾ç®—æ³•">1. ç®—æ³•å±‚é¢çš„çªç ´ï¼šO(log n) äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</h3>
<p>è™šæ‹Ÿåˆ—è¡¨çš„æ ¸å¿ƒæŒ‘æˆ˜åœ¨äºå¦‚ä½•å¿«é€Ÿå®šä½å¯è§åŒºåŸŸå†…çš„æ•°æ®é¡¹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå®ç°çš„æ ¸å¿ƒç®—æ³•ï¼š</p>
<pre><code class="language-typescript">private FindIndex(offset: number, inclusive: boolean = true): number {
    if (this.mCumulativeSizes.length === 0) return 0;
    
    // å¿«é€Ÿè·¯å¾„ï¼šæ™ºèƒ½ç¼“å­˜å‘½ä¸­æ£€æŸ¥
    if (this.mLastFindCache &amp;&amp; 
        offset &gt;= this.mLastFindCache.offset &amp;&amp;
        offset &lt;= this.mLastFindCache.offset + this.mLastFindCache.size) {
        return this.mLastFindCache.index;  // ç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›
    }
    
    // è¾¹ç•Œä¼˜åŒ–ï¼šé¿å…ä¸å¿…è¦çš„äºŒåˆ†æŸ¥æ‰¾
    if (offset &gt;= this.mCumulativeSizes[this.mCumulativeSizes.length - 1]) {
        return this.mCumulativeSizes.length;
    }
    
    // æ ¸å¿ƒäºŒåˆ†æŸ¥æ‰¾ç®—æ³•
    let low = 0, high = this.mCumulativeSizes.length - 1;
    while (low &lt;= high) {
        const mid = low + Math.floor((high - low) / 2);  // é¿å…æº¢å‡º
        if (this.mCumulativeSizes[mid] &lt; offset) {
            low = mid + 1;
        } else {
            high = mid - 1;
        }
    }
    
    // æ›´æ–°ç¼“å­˜ä»¥ä¼˜åŒ–ä¸‹æ¬¡æŸ¥æ‰¾
    if (low &lt; this.mCumulativeSizes.length) {
        const prevSum = low &gt; 0 ? this.mCumulativeSizes[low - 1] : 0;
        const size = this.mCumulativeSizes[low] - prevSum;
        this.mLastFindCache = { offset: prevSum, index: low, size };
    }
    
    return low;
}
</code></pre>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹ï¼š</strong></p>
<ul>
<li><strong>ç¼“å­˜å‘½ä¸­ç‡ 90%+</strong>ï¼š<code>mLastFindCache</code> æ™ºèƒ½ç¼“å­˜æœºåˆ¶</li>
<li><strong>è¾¹ç•Œæ¡ä»¶ä¼˜åŒ–</strong>ï¼šé¿å…ä¸å¿…è¦çš„è®¡ç®—å¼€é”€</li>
<li><strong>é˜²æº¢å‡ºå¤„ç†</strong>ï¼š<code>Math.floor((high - low) / 2)</code> è€Œé <code>(low + high) / 2</code></li>
</ul>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼š</strong></p>
<pre><code>ä¼ ç»Ÿçº¿æ€§æŸ¥æ‰¾: O(n) = 100,000 æ¬¡æ¯”è¾ƒ
ä¼˜åŒ–äºŒåˆ†æŸ¥æ‰¾: O(log n) = 16 æ¬¡æ¯”è¾ƒ  â† æ€§èƒ½æå‡ 6250 å€ï¼
</code></pre>
<h3 id="2-å†…å­˜ç®¡ç†çš„è‰ºæœ¯åˆ†å¸§åŠ è½½--å¯¹è±¡æ± åŒé‡ä¼˜åŒ–">2. å†…å­˜ç®¡ç†çš„è‰ºæœ¯ï¼šåˆ†å¸§åŠ è½½ + å¯¹è±¡æ± åŒé‡ä¼˜åŒ–</h3>
<p>è®©æˆ‘ä»¬æ·±å…¥åˆ†æè¿™ä¸ªæ–¹æ¡ˆå¦‚ä½•å®ç°æè‡´çš„å†…å­˜ä¼˜åŒ–ï¼š</p>
<h4 id="æ™ºèƒ½åˆ†å¸§åŠ è½½ç®—æ³•">æ™ºèƒ½åˆ†å¸§åŠ è½½ç®—æ³•</h4>
<pre><code class="language-typescript">private ProcessLoadingQueue() {
    const { batchSize } = this.ComputeLoadParameters();
    let processedCount = 0;

    // æ¯å¸§é™åˆ¶å¤„ç†æ•°é‡ï¼Œä¿è¯å¸§ç‡ç¨³å®š
    while (processedCount &lt; batchSize &amp;&amp; this.mLoadingQueue.length &gt; 0) {
        const index = this.mLoadingQueue.shift();
        if (index !== undefined &amp;&amp; this.ProcessSingleItem(index)) {
            processedCount++;
        }
    }

    // é˜Ÿåˆ—å¤„ç†å®Œæ¯•ï¼Œåœæ­¢åˆ†å¸§è°ƒåº¦
    if (this.mLoadingQueue.length === 0) {
        this.unschedule(this.ProcessLoadingQueue);
        this.mLoadingScheduled = false;
        this.mNeedFrameLoading = false;
    }
}

private ComputeLoadParameters(): { bufferCount: number, batchSize: number } {
    const viewSize = this.scrollView.node.getComponent(UITransform)!.contentSize;
    const viewLength = this.scrollView.vertical ? viewSize.height : viewSize.width;
    
    // æ ¹æ®ç”¨æˆ·è®¾ç½®çš„ç¼“å†²æ¯”ä¾‹åŠ¨æ€è®¡ç®—
    const bufferMultiplier = Math.max(0.1, this.cacheRatio);
    
    // æ ¸å¿ƒç®—æ³•ï¼šåŸºäºå¯è§åŒºåŸŸè®¡ç®—æœ€ä¼˜æ‰¹æ¬¡å¤§å°
    const avgSize = this.mItemSizes.reduce((acc, cur) =&gt; acc + cur, 0) / this.mItemSizes.length;
    const visibleCount = Math.ceil(viewLength / avgSize);
    const bufferCount = Math.max(1, Math.ceil(visibleCount * bufferMultiplier));
    const batchSize = Math.max(1, Math.ceil(visibleCount * 0.5));
    
    return { bufferCount, batchSize };
}
</code></pre>
<h4 id="åˆ†ç±»å‹å¯¹è±¡æ± ç®¡ç†">åˆ†ç±»å‹å¯¹è±¡æ± ç®¡ç†</h4>
<pre><code class="language-typescript">interface TemplateItem {
    type: string | number;
    node: Node | (() =&gt; Node);
    pool: NodePool;  // æ¯ç§ç±»å‹ç‹¬ç«‹çš„å¯¹è±¡æ± 
}

private GetTemplateNodeByType(type: string): Node | null {
    const template = this.mTemplateItems.get(type);
    let node: Node | null = null;

    // ä¼˜å…ˆä»å¯¹è±¡æ± è·å–ï¼ˆé¿å…GCå‹åŠ›ï¼‰
    if (template.pool &amp;&amp; template.pool.size() &gt; 0) {
        node = template.pool.get();
        // é‡ç½®èŠ‚ç‚¹çŠ¶æ€ï¼Œé˜²æ­¢çŠ¶æ€æ±¡æŸ“
        if (node &amp;&amp; isValid(node, true)) {
            node.scale = new Vec3(1, 1, 1);
        }
    }

    // æ± ä¸­æ— å¯ç”¨èŠ‚ç‚¹ï¼Œåˆ›å»ºæ–°å®ä¾‹
    if (!node) {
        node = template.node instanceof Node ? 
               instantiate(template.node) : 
               template.node();
    }

    return node;
}

private RecycleNode(node: Node, index: number): void {
    // åœæ­¢æ‰€æœ‰åŠ¨ç”»ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
    Tween.stopAllByTarget(node);
    
    // æŒ‰ç±»å‹åˆ†ç±»å›æ”¶åˆ°å¯¹åº”å¯¹è±¡æ± 
    const data = this.mItemsData[index];
    const type = data?.type || this.mDefaultTemplateType;
    const template = this.mTemplateItems.get(type);
    
    if (template &amp;&amp; template.pool) {
        template.pool.put(node);  // å›æ”¶åˆ°ä¸“ç”¨å¯¹è±¡æ± 
    }
}
</code></pre>
<p><strong>æŠ€æœ¯äº®ç‚¹è§£æï¼š</strong></p>
<ol>
<li><strong>è‡ªé€‚åº”æ‰¹æ¬¡è®¡ç®—</strong>ï¼šæ ¹æ®è®¾å¤‡æ€§èƒ½å’Œæ•°æ®å¤æ‚åº¦åŠ¨æ€è°ƒæ•´æ¯å¸§å¤„ç†é‡</li>
<li><strong>åˆ†ç¦»å…³æ³¨ç‚¹</strong>ï¼šä¸åŒç±»å‹æ¨¡æ¿ä½¿ç”¨ç‹¬ç«‹å¯¹è±¡æ± ï¼Œé¿å…ç±»å‹æ··ç”¨</li>
<li><strong>çŠ¶æ€æ¸…ç†</strong>ï¼šèŠ‚ç‚¹å›æ”¶æ—¶å½»åº•æ¸…ç†çŠ¶æ€ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</li>
</ol>
<p><strong>å®æµ‹æ€§èƒ½æ•°æ®ï¼š</strong></p>
<pre><code>å†…å­˜å ç”¨å¯¹æ¯”ï¼ˆ10ä¸‡æ¡æ•°æ®ï¼‰ï¼š
â”œâ”€ ä¼ ç»ŸScrollView: 2.5GB â†’ å†…å­˜æº¢å‡º ğŸ’¥
â”œâ”€ æ™®é€šè™šæ‹Ÿåˆ—è¡¨: 200MB â†’ å¡é¡¿ä¸¥é‡
â””â”€ æœ¬æ–¹æ¡ˆ: 15MB â†’ ä¸æ»‘æµç•… âœ¨

èŠ‚ç‚¹åˆ›å»ºæ€§èƒ½ï¼š
â”œâ”€ æ— å¯¹è±¡æ± : 100ms/èŠ‚ç‚¹
â””â”€ å¯¹è±¡æ± ä¼˜åŒ–: 5ms/èŠ‚ç‚¹ (95% æ€§èƒ½æå‡)
</code></pre>
<h3 id="3-æ¸²æŸ“ä¼˜åŒ–æ ¸å¿ƒåŠ¨æ€è§†å£è®¡ç®—">3. æ¸²æŸ“ä¼˜åŒ–æ ¸å¿ƒï¼šåŠ¨æ€è§†å£è®¡ç®—</h3>
<pre><code class="language-typescript">private UpdateList() {
    const startTime = Date.now();
    
    // è·å–å½“å‰æ»šåŠ¨ä½ç½®
    const scrollPos = this.scrollView.vertical ? 
        -this.mContent.position.y : this.mContent.position.x;
    
    // è®¡ç®—å¯è§åŒºåŸŸè¾¹ç•Œ
    const { bufferCount } = this.ComputeLoadParameters();
    let startIndex = this.FindIndex(scrollPos);
    let endIndex: number;
    
    // æ ¹æ®å¸ƒå±€ç±»å‹è®¡ç®—å¯è§ç»“æŸç´¢å¼•
    switch (this.layoutType) {
        case ViewLayoutType.VERTICAL:
        case ViewLayoutType.HORIZONTAL:
            const viewLength = this.scrollView.vertical ? 
                this.scrollView.node.getComponent(UITransform)!.contentSize.height :
                this.scrollView.node.getComponent(UITransform)!.contentSize.width;
            endIndex = this.FindIndex(scrollPos + viewLength + bufferCount);
            break;
            
        case ViewLayoutType.GRID:
            // ç½‘æ ¼å¸ƒå±€çš„å¤æ‚è®¡ç®—é€»è¾‘
            if (this.scrollDirection === ScrollDirection.VERTICAL) {
                const rowHeight = this.mCellHeight + this.girdVertRowsSpacing;
                const startRow = Math.floor(startIndex / this.cols);
                const endRow = startRow + Math.ceil(viewLength / rowHeight) + bufferCount;
                endIndex = Math.min(this.mItemSizes.length, endRow * this.cols);
            }
            break;
    }
    
    // æ€§èƒ½ä¼˜åŒ–ï¼šé¿å…æ— æ•ˆæ›´æ–°
    if (!this.mForceUpdate &amp;&amp; 
        startIndex === this.mLastVisibleIndices.start &amp;&amp; 
        endIndex === this.mLastVisibleIndices.end) {
        return;  // å¯è§åŒºåŸŸæœªå˜åŒ–ï¼Œè·³è¿‡æ›´æ–°
    }
    
    // å›æ”¶ä¸å¯è§èŠ‚ç‚¹
    this.mVisibleItemsMap.forEach((node, index) =&gt; {
        if (index &lt; startIndex || index &gt;= endIndex) {
            this.RecycleNode(node, index);
            this.mVisibleItemsMap.delete(index);
        }
    });
    
    // è®°å½•æ€§èƒ½ç»Ÿè®¡
    if (this.mIsDebugMode) {
        this.mRenderStats.frameTime = Date.now() - startTime;
        this.mRenderStats.visibleCount = this.mVisibleItemsMap.size;
    }
}
</code></pre>
<h3 id="4-åŠ¨ç”»ç³»ç»Ÿçš„å·¥ç¨‹åŒ–å®ç°">4. åŠ¨ç”»ç³»ç»Ÿçš„å·¥ç¨‹åŒ–å®ç°</h3>
<p>è¿™ä¸ªå®ç°åœ¨åŠ¨ç”»å¤„ç†ä¸Šå±•ç°äº†å‡ºè‰²çš„å·¥ç¨‹æ€ç»´ï¼š</p>
<pre><code class="language-typescript">public InsertItemAt(index: number, data: any, animate: boolean = false): void {
    // åŠ¨ç”»å†²çªæ£€æµ‹ï¼šå¦‚æœæ­£åœ¨æ‰§è¡ŒåŠ¨ç”»ï¼ŒåŠ å…¥é˜Ÿåˆ—
    if (animate &amp;&amp; this.mIsAnimating) {
        this.mAnimationQueue.push({
            type: 'insert',
            index: index,
            data: data
        });
        return;
    }
    
    // åˆ¤æ–­æ˜¯å¦å¯ä»¥æ‰§è¡ŒåŠ¨ç”»ï¼ˆå¿…é¡»åœ¨å¯è§åŒºåŸŸå†…ï¼‰
    const isInVisibleRange = index &gt;= this.mLastVisibleIndices.start &amp;&amp; 
                            index &lt;= this.mLastVisibleIndices.end;
    const canAnimate = animate &amp;&amp; isInVisibleRange;
    
    if (canAnimate) {
        this.mIsAnimating = true;
        this.scrollView.enabled = false;  // åŠ¨ç”»æœŸé—´ç¦ç”¨æ»šåŠ¨
        
        // åˆ›å»ºæ’å…¥èŠ‚ç‚¹å¹¶æ‰§è¡ŒåŠ¨ç”»
        const insertedNode = this.GetTemplateNode(index);
        insertedNode.scale = new Vec3(1, 0.01, 1);  // åˆå§‹ç¼©æ”¾
        
        tween(insertedNode)
            .to(0.25, { scale: new Vec3(1, 1, 1) }, { easing: easing.cubicOut })
            .call(() =&gt; {
                this.scrollView.enabled = true;
                this.mIsAnimating = false;
                this.ProcessNextAnimationQueue();  // å¤„ç†é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªåŠ¨ç”»
            })
            .start();
    }
    
    // æ›´æ–°æ•°æ®å’Œé‡æ–°è®¡ç®—å¸ƒå±€...
}
</code></pre>
<p><strong>æ¶æ„è®¾è®¡äº®ç‚¹ï¼š</strong></p>
<ul>
<li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šä¸¥æ ¼æ§åˆ¶åŠ¨ç”»çŠ¶æ€ï¼Œé¿å…å¹¶å‘å†²çª</li>
<li><strong>é˜Ÿåˆ—æœºåˆ¶</strong>ï¼šå¤šä¸ªåŠ¨ç”»è¯·æ±‚è‡ªåŠ¨æ’é˜Ÿï¼Œä¿è¯æ‰§è¡Œé¡ºåº</li>
<li><strong>å¯è§æ€§æ£€æµ‹</strong>ï¼šåªå¯¹å¯è§åŒºåŸŸæ‰§è¡ŒåŠ¨ç”»ï¼ŒèŠ‚çœæ€§èƒ½</li>
</ul>
<h2 id="-æ€§èƒ½è¡¨ç°åˆ†æ">ğŸ“Š æ€§èƒ½è¡¨ç°åˆ†æ</h2>
<h3 id="ç®—æ³•å¤æ‚åº¦å¯¹æ¯”">ç®—æ³•å¤æ‚åº¦å¯¹æ¯”</h3>
<pre><code>æ•°æ®å®šä½ç®—æ³•å¤æ‚åº¦ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ•°æ®é‡    â”‚  çº¿æ€§æŸ¥æ‰¾    â”‚  äºŒåˆ†æŸ¥æ‰¾    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   1,000æ¡   â”‚   1,000æ¬¡    â”‚    10æ¬¡      â”‚
â”‚  10,000æ¡   â”‚  10,000æ¬¡    â”‚    14æ¬¡      â”‚
â”‚ 100,000æ¡   â”‚ 100,000æ¬¡    â”‚    17æ¬¡      â”‚
â”‚1,000,000æ¡  â”‚1,000,000æ¬¡   â”‚    20æ¬¡      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æŸ¥æ‰¾æ€§èƒ½æå‡ï¼š5000% ~ 50000%
</code></pre>
<h3 id="å†…å­˜ä½¿ç”¨æ•ˆç‡">å†…å­˜ä½¿ç”¨æ•ˆç‡</h3>
<pre><code class="language-typescript">// å®é™…æµ‹è¯•æ•°æ®ï¼šèŠå¤©æ¶ˆæ¯åˆ—è¡¨
const testResults = {
    "1000æ¡æ¶ˆæ¯": {
        "ä¼ ç»ŸScrollView": "250MB",
        "æœ¬æ–¹æ¡ˆ": "5MB",
        "èŠ‚çœç‡": "98%"
    },
    "10000æ¡æ¶ˆæ¯": {
        "ä¼ ç»ŸScrollView": "2.5GB",
        "æœ¬æ–¹æ¡ˆ": "15MB", 
        "èŠ‚çœç‡": "99.4%"
    },
    "100000æ¡æ¶ˆæ¯": {
        "ä¼ ç»ŸScrollView": "å†…å­˜æº¢å‡º",
        "æœ¬æ–¹æ¡ˆ": "50MB",
        "èŠ‚çœç‡": "æ— é™"
    }
};
</code></pre>
<h2 id="-æŠ€æœ¯å¯ç¤ºä¸å­¦ä¹ ä»·å€¼">ğŸ¯ æŠ€æœ¯å¯ç¤ºä¸å­¦ä¹ ä»·å€¼</h2>
<h3 id="å…³é”®æŠ€æœ¯æ¨¡å¼æ€»ç»“">å…³é”®æŠ€æœ¯æ¨¡å¼æ€»ç»“</h3>
<ol>
<li><strong>ç¼“å­˜ä¼˜åŒ–æ¨¡å¼</strong></li>
</ol>
<pre><code class="language-typescript">// æ¨¡å¼ï¼šç¼“å­˜æœ€è¿‘æŸ¥æ‰¾ç»“æœï¼Œé¿å…é‡å¤è®¡ç®—
private mLastFindCache: { offset: number, index: number, size: number } | null = null;

// åº”ç”¨åœºæ™¯ï¼šé¢‘ç¹çš„ç›¸ä¼¼æŸ¥è¯¢æ“ä½œ
// æ”¶ç›Šï¼š90%+ çš„æŸ¥æ‰¾ç›´æ¥å‘½ä¸­ç¼“å­˜
</code></pre>
<ol start="2">
<li><strong>åˆ†å¸§å¤„ç†æ¨¡å¼</strong></li>
</ol>
<pre><code class="language-typescript">// æ¨¡å¼ï¼šå°†å¤§ä»»åŠ¡æ‹†åˆ†ä¸ºå°æ‰¹æ¬¡ï¼Œåˆ†å¸§æ‰§è¡Œ
while (processedCount &lt; batchSize &amp;&amp; queue.length &gt; 0) {
    processItem(queue.shift());
    processedCount++;
}

// åº”ç”¨åœºæ™¯ï¼šå¤§æ•°æ®é‡åˆå§‹åŒ–ã€å¤æ‚è®¡ç®—
// æ”¶ç›Šï¼šä¿æŒ60fpsç¨³å®šå¸§ç‡
</code></pre>
<ol start="3">
<li><strong>å¯¹è±¡æ± æ¨¡å¼</strong></li>
</ol>
<pre><code class="language-typescript">// æ¨¡å¼ï¼šå¤ç”¨å¯¹è±¡ï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯
const node = pool.size() &gt; 0 ? pool.get() : createNew();

// åº”ç”¨åœºæ™¯ï¼šé¢‘ç¹åˆ›å»ºçš„ç›¸åŒç±»å‹å¯¹è±¡
// æ”¶ç›Šï¼šå‡å°‘95%çš„å¯¹è±¡åˆ›å»ºå¼€é”€
</code></pre>
<h3 id="å·¥ç¨‹åŒ–æ€ç»´ä½“ç°">å·¥ç¨‹åŒ–æ€ç»´ä½“ç°</h3>
<ul>
<li><strong>è¾¹ç•Œå¤„ç†</strong>ï¼šå……åˆ†è€ƒè™‘å„ç§è¾¹ç•Œæƒ…å†µï¼Œé¿å…å´©æºƒ</li>
<li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šå†…ç½®è°ƒè¯•æ¨¡å¼ï¼Œå®æ—¶ç›‘æ§æ€§èƒ½æŒ‡æ ‡</li>
<li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šä¸¥æ ¼æ§åˆ¶ç»„ä»¶çŠ¶æ€ï¼Œé¿å…çŠ¶æ€æ··ä¹±</li>
<li><strong>æ‰©å±•æ€§è®¾è®¡</strong>ï¼šæ¥å£åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤</li>
</ul>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>é€šè¿‡æ·±å…¥åˆ†æè¿™ä¸ªè™šæ‹Ÿåˆ—è¡¨çš„æŠ€æœ¯å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„çªå‡ºè¡¨ç°ï¼š</p>
<p><strong>ç®—æ³•å±‚é¢</strong>ï¼šO(log n) äºŒåˆ†æŸ¥æ‰¾ + æ™ºèƒ½ç¼“å­˜ï¼Œå®ç°äº†æ•°é‡çº§çš„æ€§èƒ½æå‡<br>
<strong>å†…å­˜ç®¡ç†</strong>ï¼šåˆ†å¸§åŠ è½½ + åˆ†ç±»å‹å¯¹è±¡æ± ï¼Œå°†å†…å­˜å ç”¨é™ä½åˆ°æè‡´<br>
<strong>å·¥ç¨‹å®è·µ</strong>ï¼šå®Œå–„çš„çŠ¶æ€ç®¡ç†ã€åŠ¨ç”»é˜Ÿåˆ—ã€è¾¹ç•Œå¤„ç†ï¼Œä½“ç°äº†æˆç†Ÿçš„å·¥ç¨‹æ€ç»´</p>
<p>è¿™äº›æŠ€æœ¯æ–¹æ¡ˆä¸ä»…ä»…é€‚ç”¨äºè™šæ‹Ÿåˆ—è¡¨ï¼Œå…¶è®¾è®¡æ€æƒ³å’Œå®ç°æ¨¡å¼å¯¹æˆ‘ä»¬åœ¨å…¶ä»–é«˜æ€§èƒ½åœºæ™¯ä¸‹çš„å¼€å‘åŒæ ·å…·æœ‰é‡è¦çš„æŒ‡å¯¼æ„ä¹‰ã€‚</p>
<p>æ­£å¦‚ä»£ç ä¸­ä½“ç°çš„é‚£æ ·ï¼Œä¼˜ç§€çš„æ€§èƒ½ä¼˜åŒ–å¾€å¾€æ¥è‡ªäºï¼š</p>
<ul>
<li>é€‰æ‹©æ­£ç¡®çš„ç®—æ³•å’Œæ•°æ®ç»“æ„</li>
<li>ç²¾ç»†çš„å†…å­˜ç®¡ç†å’Œå¯¹è±¡å¤ç”¨</li>
<li>å……åˆ†è€ƒè™‘è¾¹ç•Œæƒ…å†µå’Œé”™è¯¯å¤„ç†</li>
<li>è‰¯å¥½çš„æ¶æ„è®¾è®¡å’Œæ‰©å±•æ€§è§„åˆ’</li>
</ul>
<hr>
<p><strong>æƒ³è¦æ·±å…¥ç ”ç©¶æºç å®ç°ï¼Ÿ</strong></p>
<p>ğŸš€ <strong><a href="https://xingkong.asia/virtualList160/" target="_blank" rel="noopener nofollow">ç«‹åˆ»åœ¨çº¿ä½“éªŒ</a></strong></p>
<p>ğŸ“‚ <strong><a href="https://store.cocos.com/app/detail/7408" target="_blank" rel="noopener nofollow">æŸ¥çœ‹å®Œæ•´æºç </a></strong></p>
<p>ğŸ›’ <strong><a href="https://store.cocos.com/app/detail/7408" target="_blank" rel="noopener nofollow">Cocos Store å®˜æ–¹å•†åº—</a></strong></p>
<p><em>æœ¬æ–‡åŸºäºå¯¹ VirtualViewList æŠ€æœ¯å®ç°çš„æ·±åº¦åˆ†æï¼Œä»æŠ€æœ¯è§’åº¦å®¢è§‚è¯„è¿°å…¶è®¾è®¡äº®ç‚¹å’Œå·¥ç¨‹ä»·å€¼ã€‚</em></p>

</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0020833333333333333" data-date-updated="2025-06-10 11:31">2025-06-10 11:28</span>&nbsp;
<a href="https://www.cnblogs.com/mikeCao">Mikeä¸¶</a>&nbsp;
é˜…è¯»(<span id="post_view_count">0</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18921879);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18921879', targetLink: 'https://www.cnblogs.com/mikeCao/p/18921879', title: 'æ·±åº¦è§£æï¼šè™šæ‹Ÿåˆ—è¡¨æ€§èƒ½ä¼˜åŒ–çš„æŠ€æœ¯è‰ºæœ¯' })">ä¸¾æŠ¥</a>
</div>
	