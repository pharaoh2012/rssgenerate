
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/developer-tianyiyun/p/18925624" title="发布于 2025-06-12 16:00">
    <span role="heading" aria-level="2">SRv6 验证实验</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>本文分享自天翼云开发者社区《<a href="https://www.ctyun.cn/developer/article/599952687513669" rel="noopener nofollow">SRv6 验证实验</a>》，作者：f****n</p>
<p>引言<br>
Segment Routing over IPv6 (SRv6) 是一种基于 IPv6 的新兴网络架构，其通过在 IPv6 地址中嵌入多个 Segment ID 来实现灵活的流量工程和高效的数据包转发。SRv6 通过简化网络管理，降低运营成本，并提高网络性能，正逐渐成为现代数据中心和广域网的重要选择。本文将深入探讨 SRv6 的原理、配置方法，并通过实验验证其有效性。</p>
<p>1. SRv6 基础知识<br>
1.1 SRv6 概念<br>
SRv6 将网络分段的思想引入到 IP 层，其基本单位是
Segment。每个 Segment 可以表示一个特定的功能或操作，例如：</p>
<p>路由：指定数据包的下一跳。<br>
服务：指向特定的网络服务（如负载均衡、防火墙等）。<br>
终止：指定数据包的最终目的地。<br>
在 SRv6 中，Segment ID 是一个 128 位的 IPv6 地址，其前缀通常为全球单播地址。</p>
<p>1.2 SRv6 工作原理<br>
SRv6 使用一个新的扩展头，即 Segment Routing Header (SRH)，携带 Segment 列表。在数据包转发过程中，路由器根据 SRH 中的 Segment ID 逐步处理和转发数据包。这种方式使得网络路径能够更灵活地进行配置和调整。</p>
<p>1.3 SRv6 的优势<br>
简化网络架构：减少对传统标签交换协议的依赖，降低操作复杂性。<br>
增强可编程性：支持复杂的网络服务链，可以根据需求动态调整。<br>
提高网络效率：通过直通式转发减少了数据包处理延迟。<br>
支持多种应用场景：适用于数据中心互联、云计算、物联网等多种环境。<br>
2. 实验环境搭建<br>
2.1 硬件与软件要求<br>
设备：三台支持 SRv6 的路由器（例如 Cisco
Nexus 9000 系列或类似设备）。<br>
操作系统：确保路由器运行的是最新版本的 IOS XR / IOS XE，支持 SRv6 特性。<br>
实验拓扑设计：<br>
Copy Code<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +-------------+<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; Router A
&nbsp;|<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 2001:db8:1::1 |<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +------+------+<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;|<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;|<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +------+------+<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; Router B
&nbsp;|<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 2001:db8:1::2 |<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +------+------+<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;|<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;|<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +------+------+<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; Router C
&nbsp;|<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 2001:db8:1::3 |<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +--------------+<br>
2.2 实验步骤<br>
配置基础 IPv6 地址：</p>
<p>Router A: 2001:db8:1::1/64<br>
Router B: 2001:db8:1::2/64<br>
Router C: 2001:db8:1::3/64<br>
启用 SRv6 功能：<br>
在每台路由器上执行以下命令以启用 SRv6：</p>
<p>bash<br>
Copy Code<br>
ipv6 segment-routing<br>
配置 Segment ID：<br>
在 Router A 上配置 Segment ID：</p>
<p>bash<br>
Copy Code<br>
interface &lt;interface-name&gt;<br>
&nbsp; &nbsp;ipv6 address 2001:db8:1::1/64<br>
&nbsp; &nbsp;ipv6 sr segment 100<br>
在 Router B 和 Router C 上分别配置相应的 Segment ID，Router B 配置 Segment ID 为 200，Router
C 配置为 300。</p>
<p>配置 SRv6 路由：<br>
在 Router A 上设置 SRv6 路由：</p>
<p>bash<br>
Copy Code<br>
ipv6 route 2001:db8:2::/64 sr 100 200 300<br>
这将使数据包按照 Segment 100 -&gt; 200 -&gt; 300 的顺序进行转发。</p>
<p>验证 Segment Routing Header (SRH)：<br>
在 Router A 上查看 SRH 的配置，以确保 Segment ID 正确：</p>
<p>bash<br>
Copy Code<br>
show ipv6 segment-routing<br>
3. 实验验证<br>
3.1 测试工具<br>
使用 ping, traceroute, 和 tcpdump 工具验证 SRv6 路由的有效性和性能。</p>
<p>3.2 测试步骤<br>
Ping 测试：<br>
从 Router A 发起 ping 测试到 Router C 的地址：</p>
<p>bash<br>
Copy Code<br>
ping 2001:db8:1::3<br>
应该能够成功收到回应，以确认网络连通性。</p>
<p>Traceroute 测试：<br>
在 Router A 上使用 traceroute 检查数据包的转发路径：</p>
<p>bash<br>
Copy Code<br>
traceroute 2001:db8:1::3<br>
输出应该显示数据包经过 Router B 到达 Router
C 的路径，显示 Segment ID 的转发顺序。</p>
<p>抓包分析：<br>
使用 tcpdump 抓取在 Router A 发送的数据包，观察 SRH 的内容：</p>
<p>bash<br>
Copy Code<br>
tcpdump -i &lt;interface-name&gt; ip6<br>
通过分析数据包头部，可以看到 SRH 中包含的 Segment
ID 列表。</p>
<p>3.3 结果分析<br>
Ping 成功：表示 SRv6 路由配置正确，数据包能够顺利到达目标。<br>
Traceroute 路径：确认了数据包经过预期的 Segment 路由，显示 SRv6 的有效性。<br>
抓包结果：验证 SRH 是否包含正确的 Segment ID，从而确保数据包按照预期路径转发。<br>
4. 高级应用场景<br>
4.1 服务链<br>
SRv6 支持将多个网络服务组合成一条服务链。通过配置不同的 Segment ID，可以实现数据包在不同服务之间的转发。例如，在数据包到达 Router B 时，可以将其转发到防火墙、负载均衡器或其他服务节点。</p>
<p>4.2 负载均衡<br>
利用 SRv6 的灵活性，可以在多个路径之间进行负载均衡。通过动态调整 Segment 列表，可以实现基于流量的负载均衡策略，从而优化网络资源的使用。</p>
<p>4.3 网络切片<br>
SRv6 还可以用于实现网络切片，为不同的业务流量提供隔离的网络资源。这在 5G 网络中尤为重要，可以为不同类型的应用提供定制化的网络服务。</p>
<p>5. 总结<br>
通过本实验，我们深入了解了 SRv6 的基本概念、配置过程及其应用场景。SRv6 不仅简化了网络架构，还提升了网络的灵活性和可扩展性。随着网络需求的发展，SRv6
将在未来的网络中扮演越来越重要的角色，值得网络工程师和研究者进一步研究和应用。</p>
<p>参考文献<br>
RFC 8986 - Segment Routing Architecture<br>
Cisco SRv6 Configuration Guide<br>
IETF Draft on SRv6 Network Programming<br>
通过以上实验，希望读者能够对 SRv6 有更深入的理解，并能够在自己的网络环境中进行配置与验证。</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-06-12 16:00">2025-06-12 16:00</span>&nbsp;
<a href="https://www.cnblogs.com/developer-tianyiyun">天翼云开发者社区</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18925624);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18925624', targetLink: 'https://www.cnblogs.com/developer-tianyiyun/p/18925624', title: 'SRv6 验证实验' })">举报</a>
</div>
        