
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/java-h/p/18874188" title="发布于 2025-05-13 14:20">
    <span role="heading" aria-level="2">CentOS安装SFTP</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><strong>1、创建专用用户组</strong></p>
<div class="cnblogs_code">
<pre>sudo groupadd sftpgroup  # 创建组用于统一管理SFTP用户[1,6](@ref)</pre>
</div>
<p><strong>2、​<strong>添加用户并限制Shel</strong>l</strong></p>
<div class="cnblogs_code">
<pre><code class="language-bash"><span class="hljs-built_in">sudo useradd -m -d /data/sftpusr/sftpdata01 -G sftpgroup -s /sbin/nologin <code class="language-bash">sftpdata01</code>    <span class="hljs-comment"># 指定家目录并禁止SSH登录[8](@ref) <br><span class="hljs-built_in">sudo passwd sftpdata01 <span class="hljs-comment"># 设置用户密码</span></span></span></span></code></pre>
</div>
<p><strong>3、​<strong>初始化目录权限</strong></strong></p>
<div class="cnblogs_code">
<pre class="hyc-common-markdown__code-lan"><code class="language-bash"><span class="hljs-built_in">sudo <span class="hljs-built_in">chown root:root /data/sftpusr/            <span class="hljs-comment"># Chroot主目录必须归属root[3,6](@ref)
<span class="hljs-built_in">sudo <span class="hljs-built_in">chmod 755 /data/sftpusr/                  <span class="hljs-comment"># 权限需为755以保证安全性</span></span></span></span></span></span></code></pre>
</div>
<pre><code class="language-bash"></code></pre>
<p><strong>4、​修改SSH服务<strong>限制</strong></strong></p>
<div class="cnblogs_code">
<pre class="hyc-common-markdown__code-lan"><code class="language-bash"><span class="hljs-built_in">(1)修改sshd_config文件<br># 原SFTP配置已注释<br>#Subsystem sftp&nbsp; /usr/libexec/openssh/sftp-server<br>Subsystem sftp internal-sftp<br><br># 其他原有配置...<br><br># 用户sftpdata01的隔离配置<br>Match User sftpdata01<br>&nbsp;&nbsp; ChrootDirectory /data/sftpusr/<br>&nbsp;&nbsp; ForceCommand internal-sftp<br>&nbsp;&nbsp; AllowTcpForwarding no<br>&nbsp;&nbsp; X11Forwarding no<br>&nbsp;&nbsp; PermitTTY no<br></span></code></pre>
</div>
<p><strong>5、​​<strong>创建用户可写子目录</strong></strong></p>
<div class="cnblogs_code">
<pre class="hyc-common-markdown__code-lan"><code class="language-bash"><span class="hljs-built_in">sudo <span class="hljs-built_in">mkdir /data/sftpusr/sftpdata01
<span class="hljs-built_in">sudo <span class="hljs-built_in">chown sftpdata01:sftpgroup /data/sftpusr/sftpdata01     <span class="hljs-comment"># 允许用户上传文件[1,7](@ref)
<span class="hljs-built_in">sudo <span class="hljs-built_in">chmod 770 /data/sftpusr/sftpdata01     <span class="hljs-comment"># 组内用户可读写</span></span></span></span></span></span></span></span></code></pre>
</div>
<p><strong>6、​<strong>调整SELinux策略</strong></strong></p>
<div class="cnblogs_code">
<pre class="hyc-common-markdown__code-lan"><code class="language-bash"><span class="hljs-built_in">sudo <span class="hljs-built_in">chcon -t sshd_chroot_t /data/sftpusr/sftpdata01  <span class="hljs-comment"># 修改目录安全上下文[6](@ref)
<span class="hljs-built_in">sudo setsebool -P ssh_chroot_rw_homedirs on           <span class="hljs-comment"># 允许Chroot目录读写</span></span></span></span></span></code></pre>
</div>
<p><strong>7、​​​<strong>放行SFTP端口</strong></strong></p>
<div class="cnblogs_code">
<pre class="hyc-common-markdown__code-lan"><code class="language-bash"><span class="hljs-built_in">sudo firewall-cmd --permanent --add-service=ssh  <span class="hljs-comment"># 开放22端口（默认SFTP端口）
<span class="hljs-built_in">sudo firewall-cmd --reload</span></span></span></code></pre>
</div>
<p><strong><strong>8、</strong>重启SSH服务</strong></p>
<div class="cnblogs_code">
<pre>sudo systemctl restart sshd  # 应用配置[2,6](@ref)</pre>
</div>
<p>&nbsp;</p>
</div>
<div id="MySignature" role="contentinfo">
    你所拥抱的并不总是拥抱你
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0017717813020833334" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-13 14:21">2025-05-13 14:20</span>&nbsp;
<a href="https://www.cnblogs.com/java-h">今天早点睡</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18874188);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18874188', targetLink: 'https://www.cnblogs.com/java-h/p/18874188', title: 'CentOS安装SFTP' })">举报</a>
</div>
        