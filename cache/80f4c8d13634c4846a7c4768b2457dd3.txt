
<table cellspacing="0" cellpadding="0"><tbody><tr><td class="t_f" id="postmessage_52742135">
<i class="pstatus"> 本帖最后由 shadddow 于 2025-3-29 11:06 编辑 </i><br>
<br>
&amp;#128293; 最近三大运营商开始玩新花样了？&amp;#128545; 你家光猫的超级密码是不是隔三差五就被偷偷改掉？今天教你用技术手段反制运营商动态密码策略！只需两个骚操作：<br>
1&amp;#65039;&amp;#8419; 趁Telnet开放时直接修改超管密码锁死权限<br>
2&amp;#65039;&amp;#8419; 暴力移除IPv6防火墙实现公网直连内网<br>
&amp;#128161; 再也不用苦求桥接模式！不用加软路由/服务器！光猫本身就能当跳板机！（高危操作老鸟专属）<br>
&amp;#128204; 核心痛点突破：<br>
运营商陰招：现在光猫超密定时自动变更（TR069远程操控，定期间隔有无大佬知道）<br>
【永续方案】&amp;#128640; 光靠手工改一次怎么够？运营商半夜重置超密怎么办？上定时任务自动化战斗！<br>
破解关键：只要Telnet没封，就能用sidbg命令直接改写密码数据库<br>
终极目标：配合ip6tables删除防火墙规则，原生支持IPv6公网入站（比DDNS+端口映射更香）<br>
<br>
<div class="parsedown-markdown"><h3 id="52742135_"></h3>
<h4 id="52742135_【代码功能解析】">【代码功能解析】</h4>
<p>本Python脚本实现自动化Telnet连接电信光猫，主要完成两个核心功能：</p>
<ol>
<li>修改光猫超级管理员密码（修改为CMCCAdmin）</li>
<li>设置IPv6防火墙规则（允许ppp和wan接口的IPv6转发）</li>
</ol>
<h4 id="52742135_【代码关键点解析】">【代码关键点解析】</h4>
<h5 id="52742135_1.-telnet连接模块">1. Telnet连接模块</h5>
<pre><code class="language-python">import telnetlib
import time</code></pre>
<p>使用Python标准库的telnetlib实现远程连接，time模块用于命令执行间隔控制</p>
<h5 id="52742135_2.-登录认证流程">2. 登录认证流程</h5>
<pre><code class="language-python">tn.read_until(b"Login:")
tn.write(username.encode('ascii') + b"\n")
tn.read_until(b"Password:")</code></pre>
<p>完整模拟人工登录过程，等待提示符后输入凭证</p>
<h5 id="52742135_3.-命令批量执行">3. 命令批量执行</h5>
<pre><code class="language-python">for cmd in commands:
&nbsp; &nbsp; tn.write(cmd.encode('ascii') + b"\n")
&nbsp; &nbsp; time.sleep(1)&nbsp;&nbsp;# 防止命令阻塞
&nbsp; &nbsp; output = tn.read_very_eager().decode('ascii')</code></pre>
<p>循环执行预设命令组，包含1秒延时确保命令完整执行</p>
<h5 id="52742135_4.-核心配置命令">4. 核心配置命令</h5>
<pre><code class="language-python">commands = [
&nbsp; &nbsp; "sidbg 1 DB set DevAuthInfo 0 Pass CMCCAdmin",&nbsp;&nbsp;# 修改超级密码
&nbsp; &nbsp; "sidbg 1 DB save",&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;# 保存配置
&nbsp; &nbsp; "ip6tables -t filter -I FORWARD 1 -i ppp+ -j ACCEPT",&nbsp;&nbsp;# IPv6规则
&nbsp; &nbsp; "ip6tables -t filter -I FORWARD 2 -i wan+ -j ACCEPT",
]</code></pre>
<ul>
<li><code>sidbg</code>命令用于修改电信设备数据库</li>
<li><code>ip6tables</code>配置IPv6防火墙规则</li>
</ul>
<h4 id="52742135_【使用注意事项】">【使用注意事项】</h4>
<ol>
<li>需提前确保光猫已开启Telnet服务</li>
<li>默认IP为192.168.6.1，请根据实际网络修改</li>
<li>原始密码为"chzhdpl@246"，使用时请确认</li>
<li>执行后会修改超级密码为"CMCCAdmin",超级用户名为CMCCAdmin</li>
<li>IPv6规则将允许ppp和wan接口的转发</li>
</ol>
<h4 id="52742135_【扩展改进建议】">【扩展改进建议】</h4>
<ol>
<li>可增加异常处理代码，应对连接失败等情况</li>
<li>添加日志记录功能，保存操作记录</li>
<li>可参数化输入，提升工具灵活性</li>
<li>考虑增加SSH支持（部分新款光猫已禁用Telnet）</li>
</ol>
<h4 id="52742135_【完整代码】">【完整代码】</h4>
<pre><code class="language-python">import telnetlib
import time

def telnet_connect(ip, username, password, commands):
&nbsp; &nbsp; # 创建Telnet对象
&nbsp; &nbsp; tn = telnetlib.Telnet(ip)

&nbsp; &nbsp; # 等待登录提示符
&nbsp; &nbsp; tn.read_until(b"Login:")
&nbsp; &nbsp; tn.write(username.encode('ascii') + b"\n")

&nbsp; &nbsp; # 等待密码提示符
&nbsp; &nbsp; tn.read_until(b"Password:")
&nbsp; &nbsp; tn.write(password.encode('ascii') + b"\n")

&nbsp; &nbsp; # 等待命令提示符或任何输出
&nbsp; &nbsp; tn.read_until(b"$")

&nbsp; &nbsp; # 发送命令
&nbsp; &nbsp; for cmd in commands:
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;tn.write(cmd.encode('ascii') + b"\n")
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;time.sleep(1)&nbsp;&nbsp;# 给服务器一些时间来处理命令
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;output = tn.read_very_eager().decode('ascii')
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;print(output)

&nbsp; &nbsp; # 关闭连接
&nbsp; &nbsp; tn.close()

if __name__ == "__main__":
&nbsp; &nbsp; ip = "192.168.6.1"
&nbsp; &nbsp; username = "admin"
&nbsp; &nbsp; password = "chzhdpl@246"
&nbsp; &nbsp; commands = [
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;"sidbg 1 DB set DevAuthInfo 0 Pass CMCCAdmin",
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;"sidbg 1 DB save",
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;"ip6tables -t filter -I FORWARD 1 -i ppp+ -j ACCEPT",
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;"ip6tables -t filter -I FORWARD 2 -i wan+ -j ACCEPT ",
&nbsp; &nbsp; ]</code></pre>
<h4 id="52742135_【免责声明】本工具仅限技术研究使用，请勿用于非法用途，操作光猫配置可能导致设备异常，请谨慎使用。">【免责声明】本工具仅限技术研究使用，请勿用于非法用途，操作光猫配置可能导致设备异常，请谨慎使用。</h4></div>
<div class="parsedown-markdown-end_FLAG_ZXSQ" style="display:none"></div></td></tr></tbody></table>

<div class="pattl">


<ignore_js_op>

<dl class="tattl attm">
<dt></dt>
<dd>

<p class="mbn">
<a href="forum.php?mod=attachment&amp;aid=Mjc2Njg0OXwxM2Q3ZGE1NnwxNzQ0NjE4OTAwfDEzMDQ0NDJ8MjAxOTYwNA%3D%3D&amp;nothumb=yes" onmouseover="showMenu({'ctrlid':this.id,'pos':'12'})" id="aid2766849" class="xw1" target="_blank">微信图片_20250328203251.png</a>
<em class="xg1">(106.45 KB, 下载次数: 3)</em>
</p>
<div class="tip tip_4" id="aid2766849_menu" style="display: none" disautofocus="true">
<div>
<p>
<a href="forum.php?mod=attachment&amp;aid=Mjc2Njg0OXwxM2Q3ZGE1NnwxNzQ0NjE4OTAwfDEzMDQ0NDJ8MjAxOTYwNA%3D%3D&amp;nothumb=yes" target="_blank">下载附件</a>

</p>
<p>
<span class="y">2025-3-28 20:33 上传</span>
<a href="javascript:;" onclick="imageRotate('aimg_2766849', 1)"><img src="https://static.52pojie.cn/static/image/common/rleft.gif" class="vm"></a>
<a href="javascript:;" onclick="imageRotate('aimg_2766849', 2)"><img src="https://static.52pojie.cn/static/image/common/rright.gif" class="vm"></a>
</p>
</div>
<div class="tip_horn"></div>
</div>
<p class="mbn">

</p>



<div class="mbn savephotop">

<img id="aimg_2766849" aid="2766849" src="https://attach.52pojie.cn/forum/202503/28/203311z8re5l2ysdb5118e.png" zoomfile="https://attach.52pojie.cn/forum/202503/28/203311z8re5l2ysdb5118e.png" file="https://attach.52pojie.cn/forum/202503/28/203311z8re5l2ysdb5118e.png" class="zoom" onclick="zoom(this, this.src, 0, 0, 0)" width="1080" alt="微信图片_20250328203251.png" title="微信图片_20250328203251.png" w="1231">

</div>

</dd>
</dl>

</ignore_js_op>



<ignore_js_op>

<dl class="tattl attm">
<dt></dt>
<dd>

<p class="mbn">
<a href="forum.php?mod=attachment&amp;aid=Mjc2Njg1MnxlZTMyZWVjMXwxNzQ0NjE4OTAwfDEzMDQ0NDJ8MjAxOTYwNA%3D%3D&amp;nothumb=yes" onmouseover="showMenu({'ctrlid':this.id,'pos':'12'})" id="aid2766852" class="xw1" target="_blank">微信图片_20250328203422.png</a>
<em class="xg1">(87.36 KB, 下载次数: 3)</em>
</p>
<div class="tip tip_4" id="aid2766852_menu" style="display: none" disautofocus="true">
<div>
<p>
<a href="forum.php?mod=attachment&amp;aid=Mjc2Njg1MnxlZTMyZWVjMXwxNzQ0NjE4OTAwfDEzMDQ0NDJ8MjAxOTYwNA%3D%3D&amp;nothumb=yes" target="_blank">下载附件</a>

</p>
<p>
<span class="y">2025-3-28 20:34 上传</span>
<a href="javascript:;" onclick="imageRotate('aimg_2766852', 1)"><img src="https://static.52pojie.cn/static/image/common/rleft.gif" class="vm"></a>
<a href="javascript:;" onclick="imageRotate('aimg_2766852', 2)"><img src="https://static.52pojie.cn/static/image/common/rright.gif" class="vm"></a>
</p>
</div>
<div class="tip_horn"></div>
</div>
<p class="mbn">

</p>



<div class="mbn savephotop">

<img id="aimg_2766852" aid="2766852" src="https://attach.52pojie.cn/forum/202503/28/203430lx9z6azbgrw633w3.png" zoomfile="https://attach.52pojie.cn/forum/202503/28/203430lx9z6azbgrw633w3.png" file="https://attach.52pojie.cn/forum/202503/28/203430lx9z6azbgrw633w3.png" class="zoom" onclick="zoom(this, this.src, 0, 0, 0)" width="1080" alt="微信图片_20250328203422.png" title="微信图片_20250328203422.png" w="1535">

</div>

</dd>
</dl>

</ignore_js_op>

</div>

