
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ChebyshevTST/p/18800115" title="发布于 2025-03-29 23:33">
    <span role="heading" aria-level="2">Solana编译失败探讨（OpenEuler RISC-V版）</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>  <span style="font-size: 16px">Solana 是 2017 年由 Anatoly Yakovenko 创立的开源项目，旨在打造高性能、去中心化且低成本的区块链平台<span class="ref_content_circle container-YwEnUn short-jOgn87 clickable-oxF_Xw" tabindex="0" data-testid="ref_content_circle" aria-describedby="15tqea8" data-popupid="15tqea8">2</span>。它采用独特的 Proof of History（PoH）共识机制，结合 Tower BFT 等技术，实现了每秒数千笔交易的高吞吐量，确认时间仅 400 毫秒，每笔交易中位数费用为 0.00064 SOL<span class="ref_content_circle container-YwEnUn short-jOgn87 clickable-oxF_Xw" tabindex="0" data-testid="ref_content_circle" aria-describedby="hq5peni" data-popupid="hq5peni">1</span><span class="ref_content_circle container-YwEnUn short-jOgn87 clickable-oxF_Xw" tabindex="0" data-testid="ref_content_circle" aria-describedby="732bbpm" data-popupid="732bbpm">2</span>。Solana 支持链上程序开发，开发者可用 Rust 等语言编写智能合约，基于 eBPF 虚拟机高效运行<span class="ref_content_circle container-YwEnUn short-jOgn87 clickable-oxF_Xw" tabindex="0" data-testid="ref_content_circle" aria-describedby="iel8oby" data-popupid="iel8oby">1</span>。其生态发展迅速，在 DeFi、NFT、GameFi 等领域扩张迅猛，凭借高性能和低费用吸引了大量开发者和用户，是市值第三的公链，对以太坊等传统公链构成有力挑战。</span></p>
<p><span style="font-size: 16px">  结合手头的工作，我做一次在OpenEuler 24.09 RISC-V上部署Solana的实战，并且调研失败的原因。</span></p>
<p><span style="font-size: 16px">  此处跳过Rustup以及Cargo、Rustc的下载，直接先从官网克隆Solana的项目下来。</span></p>
<pre class="highlighter-prismjs prismjs-lines-highlighted language-bash" tabindex="0"><code>cd solana
./cargo build</code></pre>
<p>  <span style="font-size: 16px">cargo用的是Solana官方提供的，不过出现了以下错误</span></p>
<p><span style="font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250329232222432-390757634.png"></span></p>
<p><span style="font-size: 16px">  我查了一下ring，它是一个加密算法库，主要用Rust实现，不过里面还有不少汇编代码，到这里的时候，我是初步怀疑没有提供RISC-V的汇编导致 build 失败，看了一下还真是。</span></p>
<p><span style="font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250329232355930-1078872752.png"></span></p>
<p>  <span style="font-size: 16px">有很大篇幅都是用 Assembly 写的，再随便挑了一个源码看看</span></p>
<p><span style="font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250329232526362-2050877817.png"></span></p>
<p><span style="font-size: 16px">  就比如这个函数，很显然在OpenEuler RISC-V上，这几个预编译条件都不满足，好在这是 void 类型的函数，最后这个函数变成了空函数。不过有意思的是，cargo build 很顺利，并没有失败。</span></p>
<p>  <span style="font-size: 16px">cargo build 是顺利的，不过到了这里有一个 build-script，是一个可执行文件，我尝试运行了一下，出现了似曾相识的错误。</span></p>
<p><span style="font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250329232759068-1950823589.png"></span></p>
<p><span style="font-size: 16px">  和文章开头的那图一样，也是 thread "main" panic，因此又可以找到一个可以移植的软件包了，那就是 ring，因为这个，我在部署 Solana 的时候受挫，同时我也看了看 build.rs，这大概是它支持的几种架构。</span></p>
<p><span style="font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250329233008728-418098319.png"></span></p>
<p><span style="font-size: 16px">  看起来只支持常见的 x86，arm和wasm。不过这只是我在部署 Solana 遇到的第一个难点，假设 ring 移植成功了，后面可能还会遇到其它同样因为 RISC-V 而失败的包，本来 ring 已经够庞大了，因此移植 Solana 看起来似乎是一个工作量非常大的任务。</span></p>
<p><span style="font-size: 16px">  记录下来，如果有一天这些包成功移植完成了，再回头看看是否可以移植 Solana。</span></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.6159712501886574" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-29 23:33">2025-03-29 23:33</span>&nbsp;
<a href="https://www.cnblogs.com/ChebyshevTST">ChebyshevTST</a>&nbsp;
阅读(<span id="post_view_count">38</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18800115" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18800115);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18800115', targetLink: 'https://www.cnblogs.com/ChebyshevTST/p/18800115', title: 'Solana编译失败探讨（OpenEuler RISC-V版）' })">举报</a>
</div>
        