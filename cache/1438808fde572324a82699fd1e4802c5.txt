
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ChebyshevTST/p/18792300" title="发布于 2025-03-25 20:45">
    <span role="heading" aria-level="2">osmts：OERV之一站式管理测试脚本</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><span style="font-size: 16px; font-family: &quot;comic sans ms&quot;, sans-serif">  最近团队里面实习的小伙伴开发了一个新的项目，可以用来一键式运行各种测试脚本并且完成数据总结，我也尝试部署了一下，遇到了一些问题，接下来一起解析一下这个项目。</span></p>
<p><span style="font-size: 16px; font-family: &quot;comic sans ms&quot;, sans-serif">  首先是获取osmts</span></p>
<pre class="highlighter-prismjs prismjs-lines-highlighted language-bash" tabindex="0"><code>git clone https://gitee.com/April_Zhao/osmts.git
cd osmts</code></pre>
<p>  <span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">运行前环境安装</span></p>
<pre class="highlighter-prismjs language-bash prismjs-lines-highlighted" tabindex="0"><code>dnf install gcc python python3-devel python3-pip
pip install --upgrade pip setuptools
pip install -r requirements.txt

# 如果遇到SSL问题
pip install --trusted-host pypi.org --trusted-host pypi.python.org --trusted-host=files.pythonhosted.org -r requirements.txt

# 仍然提示SSL错误
dnf install ntp
ntpdate cn.pool.ntp.org</code></pre>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">  直接运行脚本</span></p>
<pre class="highlighter-prismjs language-bash prismjs-lines-highlighted" tabindex="0"><code># main.py应当直接以root身份运行
chmod +x main.py
./main.py</code></pre>
<p>  <span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">做到这里，照理来说是可以运行的（官方做法），但是我却遇到了这个问题。</span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250325202537206-1172357984.png"></span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">  于是我向官方提交了一个轻量级PR，在requirements.txt里面加了tornado，就可以运行起来了。PR：<a href="https://gitee.com/April_Zhao/osmts/pulls/1" rel="noopener nofollow">【轻量级 PR】：Tornado missing · Pull Request !1 · April_Zhao/osmts - Gitee.com</a></span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250325202647722-1914471327.png"></span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">  这是测试的过程，由于过程缓慢，所以建议用tmux挂在后台运行。接下来我们看看项目结构。</span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250325202822919-1728444950.png"></span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">  testclasses目录里面存放着各种各样的测试样本，有LLVM的测试，ltp测试等等。真正跑起来是在main.py。</span></p>
<pre class="highlighter-prismjs prismjs-lines-highlighted language-python" tabindex="0"><code>testclasses = from_tests_to_tasks(run_tests)

if not osmts_tmp_dir.exists():
    osmts_tmp_dir.mkdir()

# 所有检查都通过,则正式开始测试
for testclass in testclasses:
    testclass.run()</code></pre>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">  这是测试运行的代码，而from_tests_to_tasks这个函数，主要用来对测试任务进行收集，测试任务环境准备以及调整测试顺序，并且分别调用了fio_judge和netperf_judge，这两个函数用于在使用fio以及netperf测试之前对本机环境进行检测，判断是否适合进行相应的测试。</span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">  最终测试结果类似下图：</span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250325204250998-1127969224.png"></span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/3254001/202503/3254001-20250325204258313-1736384739.png"></span></p>
<p><span style="font-family: &quot;comic sans ms&quot;, sans-serif; font-size: 16px">  不过小伙伴和我说，他的机器不需要安装tornado也能运行，但是在我这里行不通，因此我这个PR还有争议。我推断是跟Python版本或者软件包版本有关系，我目前运行环境是OERV 24.09，希望后面能顺利探讨出原因。</span></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.7332545773171296" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-03-25 20:46">2025-03-25 20:45</span>&nbsp;
<a href="https://www.cnblogs.com/ChebyshevTST">ChebyshevTST</a>&nbsp;
阅读(<span id="post_view_count">23</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18792300" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18792300);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18792300', targetLink: 'https://www.cnblogs.com/ChebyshevTST/p/18792300', title: 'osmts：OERV之一站式管理测试脚本' })">举报</a>
</div>
        