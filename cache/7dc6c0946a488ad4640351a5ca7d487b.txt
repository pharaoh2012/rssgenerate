
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yanshajiuzhou/p/18631661" title="发布于 2024-12-25 23:36">
    <span role="heading" aria-level="2">命令模式</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        命令模式把请求或者命令封装成一个对象，从而让我们可以使用不同的请求、队列或日志请求、以及支持可撤销的操作等功能。
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<span id="cke_bm_1413S">命令（Command）模式属于<strong>行为型</strong>模式的一种。</span>
<p>命令模式把请求或者命令封装成一个对象，从而让我们可以使用不同的请求、队列或日志请求、以及支持可撤销的操作等功能。</p>
<p>命令模式的核心思想是将请求发送者与请求接收者解耦，使得发送者不需要知道请求的具体细节。</p>
<p>实际应用中的场景，比如GUI 系统中的菜单操作（复制、粘贴、撤销等）、事务处理、多线程和异步任务调度等。</p>
<p>在真实生活中，比如你去饭店点菜，服务员会将你点的菜都写在单子上，然后将单子送到厨房，大厨师根据单子做出你点的菜，这个单子其实就是一个命令。</p>
<p>命令模式通常有以下组成部分：&nbsp;</p>
<ul>
<li>Command（命令接口/抽象类）：定义一个执行命令的接口（通常是一个方法，如 execute()&nbsp;），让所有的具体命令类去实现，execute() 用于执行某个操作。</li>
<li>ConcreteCommand（具体命令）：实现 Command 接口，并且将请求调用的具体操作封装在 execute() 方法中，每个具体命令类对应一个具体的请求或动作。具体命令对象会持有对接收者（Receiver）的引用。</li>
<li>Receiver（接收者）：知道如何执行与请求相关的操作，承担具体的业务逻辑，该角色通常是执行真正的操作或任务的类。</li>
<li>Invoker（调用者）：负责调用命令对象来执行请求，持有命令对象的引用，并在需要的时候请求执行命令。一般情况下，调用者不会知道命令对象内部具体做了什么。</li>
<li>Client（客户端）：客户端负责创建命令对象，并设定命令的接收者。客户端会把这些命令对象设置到调用者对象中，之后调用者对象就能执行命令。</li>
</ul>
<p>模拟命令模式编码。</p>
<p>1、定义命令接口</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="4" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22java%22%2C%22code%22%3A%22%2F%2F%20Command%20%E6%8E%A5%E5%8F%A3%5Cnpublic%20interface%20Command%20%7B%5Cn%20%20%20%20void%20execute()%3B%20%20%2F%2F%20%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%5Cn%7D%5Cn%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-java hljs"><span class="hljs-comment">// Command 接口
<span class="hljs-keyword">public <span class="hljs-keyword">interface <span class="hljs-title class_">Command {
    <span class="hljs-keyword">void <span class="hljs-title function_">execute<span class="hljs-params">();  <span class="hljs-comment">// 执行命令
}
</span></span></span></span></span></span></span></span></code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2024.cnblogs.com/blog/1171560/202412/1171560-20241225233638081-208857266.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1"></span></div>
<p>2、具体命令类</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="3" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22java%22%2C%22code%22%3A%22%2F%2F%20ConcreteCommand%20%E5%AE%9E%E7%8E%B0%20Command%20%E6%8E%A5%E5%8F%A3%5Cnpublic%20class%20LightOnCommand%20implements%20Command%20%7B%5Cn%20%20%20%20private%20Light%20light%3B%5Cn%5Cn%20%20%20%20public%20LightOnCommand(Light%20light)%20%7B%5Cn%20%20%20%20%20%20%20%20this.light%20%3D%20light%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%40Override%5Cn%20%20%20%20public%20void%20execute()%20%7B%5Cn%20%20%20%20%20%20%20%20light.turnOn()%3B%20%20%2F%2F%20%E6%89%A7%E8%A1%8C%E5%85%B7%E4%BD%93%E7%9A%84%E6%93%8D%E4%BD%9C%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cnpublic%20class%20LightOffCommand%20implements%20Command%20%7B%5Cn%20%20%20%20private%20Light%20light%3B%5Cn%5Cn%20%20%20%20public%20LightOffCommand(Light%20light)%20%7B%5Cn%20%20%20%20%20%20%20%20this.light%20%3D%20light%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%40Override%5Cn%20%20%20%20public%20void%20execute()%20%7B%5Cn%20%20%20%20%20%20%20%20light.turnOff()%3B%20%20%2F%2F%20%E6%89%A7%E8%A1%8C%E5%85%B7%E4%BD%93%E7%9A%84%E6%93%8D%E4%BD%9C%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-java hljs"><span class="hljs-comment">// ConcreteCommand 实现 Command 接口
<span class="hljs-keyword">public <span class="hljs-keyword">class <span class="hljs-title class_">LightOnCommand <span class="hljs-keyword">implements <span class="hljs-title class_">Command {
    <span class="hljs-keyword">private Light light;

    <span class="hljs-keyword">public <span class="hljs-title function_">LightOnCommand<span class="hljs-params">(Light light) {
        <span class="hljs-built_in">this.light = light;
    }

    <span class="hljs-meta">@Override
    <span class="hljs-keyword">public <span class="hljs-keyword">void <span class="hljs-title function_">execute<span class="hljs-params">() {
        light.turnOn();  <span class="hljs-comment">// 执行具体的操作
    }
}

<span class="hljs-keyword">public <span class="hljs-keyword">class <span class="hljs-title class_">LightOffCommand <span class="hljs-keyword">implements <span class="hljs-title class_">Command {
    <span class="hljs-keyword">private Light light;

    <span class="hljs-keyword">public <span class="hljs-title function_">LightOffCommand<span class="hljs-params">(Light light) {
        <span class="hljs-built_in">this.light = light;
    }

    <span class="hljs-meta">@Override
    <span class="hljs-keyword">public <span class="hljs-keyword">void <span class="hljs-title function_">execute<span class="hljs-params">() {
        light.turnOff();  <span class="hljs-comment">// 执行具体的操作
    }
}
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2024.cnblogs.com/blog/1171560/202412/1171560-20241225233638081-208857266.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1"></span></div>
<p>3、接收者</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="2" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22java%22%2C%22code%22%3A%22%2F%2F%20Receiver%20-%20%E6%89%A7%E8%A1%8C%E6%93%8D%E4%BD%9C%E7%9A%84%E5%AF%B9%E8%B1%A1%5Cnpublic%20class%20Light%20%7B%5Cn%20%20%20%20public%20void%20turnOn()%20%7B%5Cn%20%20%20%20%20%20%20%20System.out.println(%5C%22Light%20is%20ON%5C%22)%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20public%20void%20turnOff()%20%7B%5Cn%20%20%20%20%20%20%20%20System.out.println(%5C%22Light%20is%20OFF%5C%22)%3B%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-java hljs"><span class="hljs-comment">// Receiver - 执行操作的对象
<span class="hljs-keyword">public <span class="hljs-keyword">class <span class="hljs-title class_">Light {
    <span class="hljs-keyword">public <span class="hljs-keyword">void <span class="hljs-title function_">turnOn<span class="hljs-params">() {
        System.out.println(<span class="hljs-string">"Light is ON");
    }

    <span class="hljs-keyword">public <span class="hljs-keyword">void <span class="hljs-title function_">turnOff<span class="hljs-params">() {
        System.out.println(<span class="hljs-string">"Light is OFF");
    }
}
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2024.cnblogs.com/blog/1171560/202412/1171560-20241225233638081-208857266.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1"></span></div>
<p>4、调用者</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="1" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22java%22%2C%22code%22%3A%22%2F%2F%20Invoker%20-%20%E8%B0%83%E7%94%A8%E5%91%BD%E4%BB%A4%E7%9A%84%E5%AF%B9%E8%B1%A1%5Cnpublic%20class%20RemoteControl%20%7B%5Cn%20%20%20%20private%20Command%20command%3B%5Cn%5Cn%20%20%20%20public%20void%20setCommand(Command%20command)%20%7B%5Cn%20%20%20%20%20%20%20%20this.command%20%3D%20command%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20public%20void%20pressButton()%20%7B%5Cn%20%20%20%20%20%20%20%20command.execute()%3B%20%20%2F%2F%20%E6%8C%89%E4%B8%8B%E6%8C%89%E9%92%AE%EF%BC%8C%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-java hljs"><span class="hljs-comment">// Invoker - 调用命令的对象
<span class="hljs-keyword">public <span class="hljs-keyword">class <span class="hljs-title class_">RemoteControl {
    <span class="hljs-keyword">private Command command;

    <span class="hljs-keyword">public <span class="hljs-keyword">void <span class="hljs-title function_">setCommand<span class="hljs-params">(Command command) {
        <span class="hljs-built_in">this.command = command;
    }

    <span class="hljs-keyword">public <span class="hljs-keyword">void <span class="hljs-title function_">pressButton<span class="hljs-params">() {
        command.execute();  <span class="hljs-comment">// 按下按钮，执行命令
    }
}
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2024.cnblogs.com/blog/1171560/202412/1171560-20241225233638081-208857266.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1"></span></div>
<p>5、客户端</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="代码段" data-cke-filter="off" data-cke-widget-id="0" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22lang%22%3A%22java%22%2C%22code%22%3A%22%2F%2F%20Client%20-%20%E5%AE%A2%E6%88%B7%E7%AB%AF%5Cnpublic%20class%20Client%20%7B%5Cn%20%20%20%20public%20static%20void%20main(String%5B%5D%20args)%20%7B%5Cn%20%20%20%20%20%20%20%20Light%20livingRoomLight%20%3D%20new%20Light()%3B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%2F%2F%20%E5%88%9B%E5%BB%BA%E5%91%BD%E4%BB%A4%E5%AF%B9%E8%B1%A1%5Cn%20%20%20%20%20%20%20%20Command%20lightOn%20%3D%20new%20LightOnCommand(livingRoomLight)%3B%5Cn%20%20%20%20%20%20%20%20Command%20lightOff%20%3D%20new%20LightOffCommand(livingRoomLight)%3B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%2F%2F%20%E5%88%9B%E5%BB%BA%E8%B0%83%E7%94%A8%E8%80%85%E5%AF%B9%E8%B1%A1%5Cn%20%20%20%20%20%20%20%20RemoteControl%20remote%20%3D%20new%20RemoteControl()%3B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%2F%2F%20%E8%AE%BE%E7%BD%AE%E5%91%BD%E4%BB%A4%E5%B9%B6%E6%89%A7%E8%A1%8C%5Cn%20%20%20%20%20%20%20%20remote.setCommand(lightOn)%3B%5Cn%20%20%20%20%20%20%20%20remote.pressButton()%3B%20%20%2F%2F%20%E8%BE%93%E5%87%BA%3A%20Light%20is%20ON%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20remote.setCommand(lightOff)%3B%5Cn%20%20%20%20%20%20%20%20remote.pressButton()%3B%20%20%2F%2F%20%E8%BE%93%E5%87%BA%3A%20Light%20is%20OFF%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="language-java hljs"><span class="hljs-comment">// Client - 客户端
<span class="hljs-keyword">public <span class="hljs-keyword">class <span class="hljs-title class_">Client {
    <span class="hljs-keyword">public <span class="hljs-keyword">static <span class="hljs-keyword">void <span class="hljs-title function_">main<span class="hljs-params">(String[] args) {
        <span class="hljs-type">Light <span class="hljs-variable">livingRoomLight <span class="hljs-operator">= <span class="hljs-keyword">new <span class="hljs-title class_">Light();
        
        <span class="hljs-comment">// 创建命令对象
        <span class="hljs-type">Command <span class="hljs-variable">lightOn <span class="hljs-operator">= <span class="hljs-keyword">new <span class="hljs-title class_">LightOnCommand(livingRoomLight);
        <span class="hljs-type">Command <span class="hljs-variable">lightOff <span class="hljs-operator">= <span class="hljs-keyword">new <span class="hljs-title class_">LightOffCommand(livingRoomLight);
        
        <span class="hljs-comment">// 创建调用者对象
        <span class="hljs-type">RemoteControl <span class="hljs-variable">remote <span class="hljs-operator">= <span class="hljs-keyword">new <span class="hljs-title class_">RemoteControl();
        
        <span class="hljs-comment">// 设置命令并执行
        remote.setCommand(lightOn);
        remote.pressButton();  <span class="hljs-comment">// 输出: Light is ON
        
        remote.setCommand(lightOff);
        remote.pressButton();  <span class="hljs-comment">// 输出: Light is OFF
    }
}
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img src="https://img2024.cnblogs.com/blog/1171560/202412/1171560-20241225233638081-208857266.gif" width="15" height="15" class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" data-cke-widget-drag-handler="1"></span></div>
<p>命令模式的<strong>优缺点。</strong></p>
<p>优点：</p>
<ul>
<li><strong>扩展性强</strong>：可以通过添加新的命令类来扩展系统，而不需要改变现有的类。只需要实现新的命令类并将其传递给调用者即可。</li>
<li><strong>支持撤销操作</strong>：命令模式非常适合实现撤销功能（Undo）。具体命令可以保存执行前的状态并在需要时撤销该命令。</li>
<li><strong>支持队列操作</strong>：可以将命令排入队列，或者将命令进行日志记录，从而支持命令的回放等操作。</li>
</ul>
<p>缺点：</p>
<ul>
<li><strong>类的数量增加</strong>：每一个命令对象都需要一个类，这可能会导致类的数量迅速增加，尤其是系统中有很多操作时。</li>
<li><strong>设计上较为复杂</strong>：引入命令模式会导致系统结构变得更复杂，尤其是在小型系统中，可能会觉得过度设计。</li>
</ul>
<p>原型模式可用于<strong>保存</strong>命令模式的历史记录。</p>
<p>模式带来的设计复杂度的增加是随着需求而增加的，它减少的是系统各组件的耦合度。</p>
<p style="text-align: right"><span style="color: rgba(0, 204, 255, 1)">不敢停歇，不敢哭泣，不敢抱怨，从深夜到黎明。-- 烟沙九洲</span></p>
<div>
<div style="position: fixed; right: 0; top: 0; width: 18px; height: 100%; z-index: 99999; pointer-events: none; background-image: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAKeCAYAAACoI0vdAAAAAXNSR0IArs4c6QAAAeFJREFUeF7t0qENAAAIBDHYf2lGqEEe+oJofufp9unP9MiSGWVkARftKCMLuGhHGVnARTvKyAIu2lFGFnDRjjKygIt2lJEFXLSjjCzgoh1lZAEX7SgjC7hoRxlZwEU7ysgCLtpRRhZw0Y4ysoCLdpSRBVy0o4ws4KIdZWQBF+0oIwu4aEcZWcBFO8rIAi7aUUYWcNGOMrKAi3aUkQVctKOMLOCiHWVkARftKCMLuGhHGVnARTvKyAIu2lFGFnDRjjKygIt2lJEFXLSjjCzgoh1lZAEX7SgjC7hoRxlZwEU7ysgCLtpRRhZw0Y4ysoCLdpSRBVy0o4ws4KIdZWQBF+0oIwu4aEcZWcBFO8rIAi7aUUYWcNGOMrKAi3aUkQVctKOMLOCiHWVkARftKCMLuGhHGVnARTvKyAIu2lFGFnDRjjKygIt2lJEFXLSjjCzgoh1lZAEX7SgjC7hoRxlZwEU7ysgCLtpRRhZw0Y4ysoCLdpSRBVy0o4ws4KIdZWQBF+0oIwu4aEcZWcBFO8rIAi7aUUYWcNGOMrKAi3aUkQVctKOMLOCiHWVkARftKCMLuGhHGVnARTvKyAIu2lFGFnDRjjKygIt2lJEFXLSjjCzgoh1lZAEX7SgjC7hoRxlZwMUBMJwCnyNbHuwAAAAASUVORK5CYII=&quot;); background-size: 100% 100%; background-repeat: no-repeat">&nbsp;</div>
<button class="move-button" style="position: fixed; right: 18px; left: auto; top: 50%; z-index: 99999; display: none">◀</button></div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.6134810806388888" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2024-12-25 23:37">2024-12-25 23:36</span>&nbsp;
<a href="https://www.cnblogs.com/yanshajiuzhou">烟沙九洲</a>&nbsp;
阅读(<span id="post_view_count">109</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18631661" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18631661);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18631661', targetLink: 'https://www.cnblogs.com/yanshajiuzhou/p/18631661', title: '命令模式' })">举报</a>
</div>
        