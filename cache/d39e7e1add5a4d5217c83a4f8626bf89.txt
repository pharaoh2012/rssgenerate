
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/luckyegg/p/18961221" title="发布于 2025-07-02 11:30">
    <span role="heading" aria-level="2">分享一个自己在用的从K3数据库抓取数据写入EXCEL的模板</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>　　今天分享一个我自己在用的VBA小程序，我自己套用这个模板，解决了不同员工不同的需求。</p>
<p>　　工作中，经常遇到需要从金蝶ERP中打印一些客户需要的格式的文档，还有一些内部员工自己需要的数据做分析，如果使用K3套打相对麻烦，所以一般就是用宏从K3数据库抓取数据再写入EXCEL，这样员工就能自己更新需要的数据（抓取的数据库内容基本是固定的字段，需要调整的时候不多）。</p>
<p>　　因为每个员工要求的结果不一样，但是操作过程都是一样的，所以，从一开始对每个人写不同的程序要求，到最后总结出来这个小模板，也是方便自己管理和维护这些小程序。下面就开始介绍这个模板是如何工作的：</p>
<p>　　一、建立EXCEL表格</p>
<p>　　如下图，这是我给所有人设计的EXCEL模板：</p>
<p><img alt="" style="display: block; margin-left: auto; margin-right: auto" data-src="https://img2024.cnblogs.com/blog/3661292/202507/3661292-20250702101551903-1621864240.png" class="lazyload"></p>
<p>　　&nbsp;如图所示：</p>
<p>　　　　1、不管员工需要得到多少个表的内容，我都是会建立一个如图中1所示的工作表名，用于区分，如果有多个，就多建几个。</p>
<p>　　　　2、根据员工要求得到的结果，先建立一个范围，写上对应的字段名，再选中这个范围，创建一个“超级表”</p>
<p>　　　　3、对超级表的命名，我使用统一的格式，就是用 “表_" 加上 ”工作表名“ 的格式，这主要是为了在写VBA的过程中，让程序更方便读懂。比如这个例子中，我的工作表名是 ”出货清单FromERP“ ，那我的超级表名就叫 ”表_出货清单FromERP“ ，这个地方大家根据自己的习惯来修改就行。</p>
<p>　　二、代码</p>
<p>　　首先，我没有使用任何的其它变量，比如需要读取某个日期范围的数据，比如读取某个单据号的数据等，这些大家可以根据自己的要求添加，全部代码如下图：（后面我还会放出代码和分析用处，这里只是让大家直观看到代码其实是很少的，但它就能完成很多的工作需求）</p>
<p><img alt="" style="display: block; margin-left: auto; margin-right: auto" data-src="https://img2024.cnblogs.com/blog/3661292/202507/3661292-20250702111321894-1595720858.png" class="lazyload"></p>
<p>　　下面开始讲解这段代码：</p>
<p>　　1、全程变量</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)">1</span> <span style="color: rgba(0, 0, 255, 1)">Public</span> IP <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span>, DB <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span>, UID <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span>, PW <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span>
<span style="color: rgba(0, 128, 128, 1)">2</span> <span style="color: rgba(0, 0, 255, 1)">Public</span> cn <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">Object</span>, rs <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">Object</span>
<span style="color: rgba(0, 128, 128, 1)">3</span> <span style="color: rgba(0, 0, 255, 1)">Public</span> Obj <span style="color: rgba(0, 0, 255, 1)">As</span> ListObject</pre>
</div>
<p>　　这里没什么需要特别说明的，就是一些需要用到的全程变量，有强迫症的也可以把一些非全程需要的变量自己改成局部变量。</p>
<p>　　2、初始化过程</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> <span style="color: rgba(0, 0, 255, 1)">Sub</span><span style="color: rgba(0, 0, 0, 1)"> Ini()
</span><span style="color: rgba(0, 128, 128, 1)"> 2</span> <span style="color: rgba(0, 0, 255, 1)">Dim</span> cnSQL <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span>
<span style="color: rgba(0, 128, 128, 1)"> 3</span> 
<span style="color: rgba(0, 128, 128, 1)"> 4</span>     IP = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">你的服务器IP</span><span style="color: rgba(128, 0, 0, 1)">"</span>
<span style="color: rgba(0, 128, 128, 1)"> 5</span>     DB = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">你的数据库名</span><span style="color: rgba(128, 0, 0, 1)">"</span>
<span style="color: rgba(0, 128, 128, 1)"> 6</span>     UID = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">用于访问数据库的用户名</span><span style="color: rgba(128, 0, 0, 1)">"</span>
<span style="color: rgba(0, 128, 128, 1)"> 7</span>     PW = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">用户密码</span><span style="color: rgba(128, 0, 0, 1)">"</span>
<span style="color: rgba(0, 128, 128, 1)"> 8</span> 
<span style="color: rgba(0, 128, 128, 1)"> 9</span>     <span style="color: rgba(0, 0, 255, 1)">Set</span> cn = <span style="color: rgba(0, 0, 255, 1)">CreateObject</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ADODB.Connection</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
</span><span style="color: rgba(0, 128, 128, 1)">10</span>     <span style="color: rgba(0, 0, 255, 1)">Set</span> rs = <span style="color: rgba(0, 0, 255, 1)">CreateObject</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ADODB.Recordset</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
</span><span style="color: rgba(0, 128, 128, 1)">11</span>     cnSQL = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Provider=sqloledb;Server=</span><span style="color: rgba(128, 0, 0, 1)">"</span> &amp; IP &amp; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">;Database=</span><span style="color: rgba(128, 0, 0, 1)">"</span> &amp; DB &amp; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">;Uid=</span><span style="color: rgba(128, 0, 0, 1)">"</span> &amp; UID &amp; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">;Pwd=</span><span style="color: rgba(128, 0, 0, 1)">"</span> &amp; PW &amp; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">;</span><span style="color: rgba(128, 0, 0, 1)">"</span>
<span style="color: rgba(0, 128, 128, 1)">12</span> 
<span style="color: rgba(0, 128, 128, 1)">13</span>     <span style="color: rgba(0, 0, 255, 1)">If</span> cn.State &lt;&gt; <span style="color: rgba(128, 0, 128, 1)">1</span> <span style="color: rgba(0, 0, 255, 1)">Then</span>
<span style="color: rgba(0, 128, 128, 1)">14</span> <span style="color: rgba(0, 0, 0, 1)">        cn.Open cnSQL
</span><span style="color: rgba(0, 128, 128, 1)">15</span>     <span style="color: rgba(0, 0, 255, 1)">End</span> <span style="color: rgba(0, 0, 255, 1)">If</span>
<span style="color: rgba(0, 128, 128, 1)">16</span>    
<span style="color: rgba(0, 128, 128, 1)">17</span> <span style="color: rgba(0, 0, 255, 1)">End Sub</span></pre>
</div>
<p>　　这里也没什么好介绍的，直接套用就行，这段代码我也是网上抄的。</p>
<p>　　3、主过程</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> <span style="color: rgba(0, 0, 255, 1)">Sub</span><span style="color: rgba(0, 0, 0, 1)"> Process()
</span><span style="color: rgba(0, 128, 128, 1)"> 2</span> <span style="color: rgba(0, 0, 255, 1)">Dim</span> StrSql <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span>
<span style="color: rgba(0, 128, 128, 1)"> 3</span>     
<span style="color: rgba(0, 128, 128, 1)"> 4</span>     <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">----调用变量初始化</span>
<span style="color: rgba(0, 128, 128, 1)"> 5</span>     <span style="color: rgba(0, 0, 255, 1)">Call</span><span style="color: rgba(0, 0, 0, 1)"> Ini
</span><span style="color: rgba(0, 128, 128, 1)"> 6</span> 
<span style="color: rgba(0, 128, 128, 1)"> 7</span>     <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">------从导出最新的采购价格。</span>
<span style="color: rgba(0, 128, 128, 1)"> 8</span>     StrSql = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">这里写你读取SQL的语句</span><span style="color: rgba(128, 0, 0, 1)">"</span>
<span style="color: rgba(0, 128, 128, 1)"> 9</span>     <span style="color: rgba(0, 0, 255, 1)">Call</span> ReadFromSQL(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">出货清单FromERP</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">表_出货清单FromERP</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">, StrSql)
</span><span style="color: rgba(0, 128, 128, 1)">10</span> 
<span style="color: rgba(0, 128, 128, 1)">11</span>     cn.Close                 <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">关闭连接</span>
<span style="color: rgba(0, 128, 128, 1)">12</span>     <span style="color: rgba(0, 0, 255, 1)">Set</span> rs = <span style="color: rgba(0, 0, 255, 1)">Nothing</span>         <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">清空对象</span>
<span style="color: rgba(0, 128, 128, 1)">13</span>     <span style="color: rgba(0, 0, 255, 1)">Set</span> cn = <span style="color: rgba(0, 0, 255, 1)">Nothing</span>         <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">清空对象</span>
<span style="color: rgba(0, 128, 128, 1)">14</span>     
<span style="color: rgba(0, 128, 128, 1)">15</span> <span style="color: rgba(0, 0, 255, 1)">End Sub</span></pre>
</div>
<p>　　这里就是我们运行宏的时候执行的过程，它先调用了前面的初始化过程，然后需要你把SQL语句放进去，再调用一个读取SQL并写入EXCEL的过程，最后关闭连接，清空对象。</p>
<p>　　这里的关键其实就是在第8行：StrSql = "这里写你读取SQL的语句"</p>
<p>　　这个SQL语句呢，我们可以在相应的读取SQL的软件里调试，并根据你的要求能得到你要的结果，最后就把那一句SQL语句放在上面的双引号里就行。</p>
<p>　　这里提示一下，有时候SQL语句会很长很长，那没关系，我们可以把SQL语句拆分成多个字符串再连接起来就行，比如写成这样</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)">1</span> StrSql=<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">字符串1</span><span style="color: rgba(128, 0, 0, 1)">"</span> &amp;<span style="color: rgba(0, 0, 0, 1)"> _
</span><span style="color: rgba(0, 128, 128, 1)">2</span>        <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">字符串2</span><span style="color: rgba(128, 0, 0, 1)">"</span> &amp;<span style="color: rgba(0, 0, 0, 1)"> _
</span><span style="color: rgba(0, 128, 128, 1)">3</span>        <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">字符串3</span><span style="color: rgba(128, 0, 0, 1)">"</span> &amp;<span style="color: rgba(0, 0, 0, 1)"> _
</span><span style="color: rgba(0, 128, 128, 1)">4</span> <span style="color: rgba(0, 0, 0, 1)">       ……
</span><span style="color: rgba(0, 128, 128, 1)">5</span>        <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">字符串n</span><span style="color: rgba(128, 0, 0, 1)">"</span></pre>
</div>
<p>　　比如我就曾经写过一个8行的字符串，它需要通过很多个表关联查询并出一个结果，大概内容如下图：</p>
<p><img alt="" style="display: block; margin-left: auto; margin-right: auto" data-src="https://img2024.cnblogs.com/blog/3661292/202507/3661292-20250702111548803-1409440209.png" class="lazyload"></p>
<p>　　第9行这里，大家就可以一目了然了，过程引用中，变量的排列为：工作表名，超级表名，SQL字符串。</p>
<p>　　4、从SQL读取数据，并写入EXCEL</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> <span style="color: rgba(0, 0, 255, 1)">Sub</span> ReadFromSQL(ShtName <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span>, objName <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span>, SQLStr <span style="color: rgba(0, 0, 255, 1)">As</span> <span style="color: rgba(0, 0, 255, 1)">String</span><span style="color: rgba(0, 0, 0, 1)">)
</span><span style="color: rgba(0, 128, 128, 1)"> 2</span> 
<span style="color: rgba(0, 128, 128, 1)"> 3</span>     <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">----选择目标表</span>
<span style="color: rgba(0, 128, 128, 1)"> 4</span> <span style="color: rgba(0, 0, 0, 1)">    Sheets(ShtName).Select
</span><span style="color: rgba(0, 128, 128, 1)"> 5</span>     
<span style="color: rgba(0, 128, 128, 1)"> 6</span>     <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">----清除原来数据</span>
<span style="color: rgba(0, 128, 128, 1)"> 7</span>     <span style="color: rgba(0, 0, 255, 1)">With</span><span style="color: rgba(0, 0, 0, 1)"> Sheets(ShtName).ListObjects(objName)
</span><span style="color: rgba(0, 128, 128, 1)"> 8</span>     
<span style="color: rgba(0, 128, 128, 1)"> 9</span>         <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">----判断当前表格是否在筛选状态，如果是，就显示所有数据，如果不做这一步，在筛选状态下，下一步操作删除的时候会出错</span>
<span style="color: rgba(0, 128, 128, 1)">10</span>         <span style="color: rgba(0, 0, 255, 1)">If</span> .AutoFilter.FilterMode = <span style="color: rgba(0, 0, 255, 1)">True</span> <span style="color: rgba(0, 0, 255, 1)">Then</span>
<span style="color: rgba(0, 128, 128, 1)">11</span> <span style="color: rgba(0, 0, 0, 1)">            .AutoFilter.ShowAllData
</span><span style="color: rgba(0, 128, 128, 1)">12</span>         <span style="color: rgba(0, 0, 255, 1)">End</span> <span style="color: rgba(0, 0, 255, 1)">If</span>
<span style="color: rgba(0, 128, 128, 1)">13</span>     
<span style="color: rgba(0, 128, 128, 1)">14</span>         <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">----如果目标表有内容，就清空</span>
<span style="color: rgba(0, 128, 128, 1)">15</span>         <span style="color: rgba(0, 0, 255, 1)">If</span> .ListRows.Count &lt;&gt; <span style="color: rgba(128, 0, 128, 1)">0</span> <span style="color: rgba(0, 0, 255, 1)">Then</span>
<span style="color: rgba(0, 128, 128, 1)">16</span> <span style="color: rgba(0, 0, 0, 1)">            .DataBodyRange.Select
</span><span style="color: rgba(0, 128, 128, 1)">17</span> <span style="color: rgba(0, 0, 0, 1)">            Selection.Delete
</span><span style="color: rgba(0, 128, 128, 1)">18</span>         <span style="color: rgba(0, 0, 255, 1)">End</span> <span style="color: rgba(0, 0, 255, 1)">If</span>
<span style="color: rgba(0, 128, 128, 1)">19</span>        
<span style="color: rgba(0, 128, 128, 1)">20</span>        <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">----读取SQL查询结果到Records记录集</span>
<span style="color: rgba(0, 128, 128, 1)">21</span> <span style="color: rgba(0, 0, 0, 1)">        rs.Open SQLStr, cn
</span><span style="color: rgba(0, 128, 128, 1)">22</span>         
<span style="color: rgba(0, 128, 128, 1)">23</span>         <span style="color: rgba(0, 0, 255, 1)">If</span> rs.EOF = <span style="color: rgba(0, 0, 255, 1)">True</span> <span style="color: rgba(0, 0, 255, 1)">Then</span>
<span style="color: rgba(0, 128, 128, 1)">24</span>             <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">MsgBox "这里可以根据需要自己写出错提示"</span>
<span style="color: rgba(0, 128, 128, 1)">25</span>         <span style="color: rgba(0, 0, 255, 1)">Else</span>
<span style="color: rgba(0, 128, 128, 1)">26</span>             <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">下面的循环把查询结果写到Excel表中</span>
<span style="color: rgba(0, 128, 128, 1)">27</span>             .Range(<span style="color: rgba(128, 0, 128, 1)">2</span>, <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">).CopyFromRecordset rs
</span><span style="color: rgba(0, 128, 128, 1)">28</span>         <span style="color: rgba(0, 0, 255, 1)">End</span> <span style="color: rgba(0, 0, 255, 1)">If</span>
<span style="color: rgba(0, 128, 128, 1)">29</span>     
<span style="color: rgba(0, 128, 128, 1)">30</span>     <span style="color: rgba(0, 0, 255, 1)">End</span> <span style="color: rgba(0, 0, 255, 1)">With</span>
<span style="color: rgba(0, 128, 128, 1)">31</span>     
<span style="color: rgba(0, 128, 128, 1)">32</span>     <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">----关闭记录集</span>
<span style="color: rgba(0, 128, 128, 1)">33</span> <span style="color: rgba(0, 0, 0, 1)">    rs.Close
</span><span style="color: rgba(0, 128, 128, 1)">34</span> 
<span style="color: rgba(0, 128, 128, 1)">35</span> <span style="color: rgba(0, 0, 255, 1)">End Sub</span></pre>
</div>
<p>　　第4行：我们要确定我们会转到需要写入数据的工作表，所以先定位好工作表</p>
<p>　　第7-30行：通过控制超级表，来清除数据。这也里讲一下为什么要用超级表，因为使用超级表，在定位、清除数据、写入数据等，它会相应的更加灵活。</p>
<p>　　第10-12行：这一步很关键。因为在实际使用过程中，用户有可能会把一个结果筛选，如果不加这一步，在筛选状态进行一些VBA操作，会提示出错，所以就强制的，把超级表的筛选状态变成未筛选。</p>
<p>　　第15-18行：这里是判断，如果这个超级表不为空，那就清空它。</p>
<p>　　第21行：把我们要的SQL语句对应的结果读取出来。</p>
<p>　　第23-28行：把SQl查询结果，写在超级表的表体区域：.Range(2,1) 位置。</p>
<p>　　第33行：关闭记录集。这里说一下，为什么要把这一个操作放在这，因为我们有可能会同时对多个工作表进行操作，每一个操作都会调用一次这一个过程，所以就需要在下一个调用前，把当前的记录集关闭。</p>
<p>　　到这里，就全部介绍结束了。</p>
<p>　　下面给大家看一个例子，如下图：</p>
<p><img alt="" style="display: block; margin-left: auto; margin-right: auto" data-src="https://img2024.cnblogs.com/blog/3661292/202507/3661292-20250702112355729-358205440.png" class="lazyload"></p>
<p>　　如图所示，我同时需要对多个工作表进行数据写入，所以我就套用了上面的模板，这样代码一目了然，而且细心的你可能会发现，为什么我的超级表会以 "表_" 开头，因为我这里直接使用的都是变量了。</p>
<p>　　还有一个，可能你还发现我多了两个变量：StartRow 和 StartCol 。这两个是放在过程：ReadFromSQL中第27行：Range(StartRow,StartCol) 的，因为我可能同时读取了两个SQL语句，但是放在同一个超级表的不同位置。</p>
<p>　　另外，如果你的EXCEL表还包含了一些其它的内容，并且带有公式的，那么我建立在执行VBA的时候，可以在一开始关闭“自动重算”功能，等执行完VBA后，再重新开启“自动重算”，就象上我面截图中的 “AutoCalNo” 和 “AutoCalYes”，这样运行速度有明显提升。代码如下：</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)">1</span> <span style="color: rgba(0, 0, 255, 1)">Sub</span><span style="color: rgba(0, 0, 0, 1)"> AutoCalNo()
</span><span style="color: rgba(0, 128, 128, 1)">2</span>     Application.Calculation = xlCalculationManual       <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">使用手动重算</span>
<span style="color: rgba(0, 128, 128, 1)">3</span> <span style="color: rgba(0, 0, 255, 1)">End Sub</span>
<span style="color: rgba(0, 128, 128, 1)">4</span> <span style="color: rgba(0, 0, 255, 1)">Sub</span><span style="color: rgba(0, 0, 0, 1)"> AutoCalYes()
</span><span style="color: rgba(0, 128, 128, 1)">5</span>     Application.Calculation = xlCalculationAutomatic    <span style="color: rgba(0, 128, 0, 1)">'</span><span style="color: rgba(0, 128, 0, 1)">使用自动重算</span>
<span style="color: rgba(0, 128, 128, 1)">6</span> <span style="color: rgba(0, 0, 255, 1)">End Sub</span></pre>
</div>
<p>　　剩下的，就请大家自行发挥吧。</p>
<p>　　今天的介绍就到这。希望对大家有帮助。</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.014583333333333334" data-date-updated="2025-07-02 11:51">2025-07-02 11:30</span>&nbsp;
<a href="https://www.cnblogs.com/luckyegg">Luckyegg</a>&nbsp;
阅读(<span id="post_view_count">41</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18961221);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18961221', targetLink: 'https://www.cnblogs.com/luckyegg/p/18961221', title: '分享一个自己在用的从K3数据库抓取数据写入EXCEL的模板' })">举报</a>
</div>
        