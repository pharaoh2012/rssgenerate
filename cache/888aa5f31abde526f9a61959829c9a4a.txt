
        <div class="postTitle">
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/token-ai/p/19056197" title="发布于 2025-08-25 03:40">
    <span role="heading" aria-level="2">免费SSL申请并使用Yarp实现支持内网穿透</span>
    

</a>

        </div>
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="fastgateway-全新升级指南">FastGateway 全新升级指南</h1>
<h2 id="-版本亮点">🚀 版本亮点</h2>
<p>FastGateway 新版本进行了重大架构升级，不再依赖 SQLite 数据库，改为使用轻量级的配置文件管理，同时移除了请求日志记录功能，实现了更加轻量级、高性能的网关解决方案。</p>
<h2 id="-核心功能特性">✨ 核心功能特性</h2>
<ul>
<li><strong>🌐 内网穿透</strong> - 安全高效的内网服务外网访问</li>
<li><strong>🔄 动态路由代理</strong> - 实时刷新路由配置，无需重启服务</li>
<li><strong>🛡️ 访问控制</strong> - 支持黑白名单机制，精确控制访问权限</li>
<li><strong>🔒 SSL 证书管理</strong> - 免费自动申请和续期 SSL 证书</li>
<li><strong>📁 文件代理</strong> - 单文件静态资源代理服务</li>
<li><strong>💾 文件管理</strong> - 内置服务器文件管理系统</li>
<li><strong>⚡ 流量控制</strong> - 自定义限流策略，保障服务稳定性</li>
</ul>
<h2 id="-docker-部署指南">📦 Docker 部署指南</h2>
<h3 id="环境准备">环境准备</h3>
<p>使用 Docker Compose 快速部署 FastGateway 服务。首先创建 <code>docker-compose.yaml</code> 配置文件：</p>
<pre><code class="language-yml">version: '3.8'
services:
  fast-gateway:
    image: crpi-j9ha7sxwhatgtvj4.cn-shenzhen.personal.cr.aliyuncs.com/koala-ai/fast-gateway
    container_name: fast-gateway
    restart: always
    privileged: true
    environment:
      - TunnelToken:Aa123456.
      - PASSWORD:Aa123456.
    volumes:
      - ./data:/app/data
      - ./certs:/app/certs
      - /proc/diskstats:/proc/diskstats
      - /proc/meminfo:/proc/meminfo
      - /proc/stat:/proc/stat
    ports:
        - "8080:8080"
        - "80:80"
        - "443:443/udp"
        - "443:443/tcp"
</code></pre>
<h3 id="-配置说明">🔧 配置说明</h3>
<p><strong>端口配置：</strong></p>
<ul>
<li><code>80</code>: HTTP 服务端口</li>
<li><code>443</code>: HTTPS 服务端口（TCP/UDP 双协议支持）</li>
<li><code>8080</code>: 管理控制台端口</li>
</ul>
<p><strong>环境变量：</strong></p>
<ul>
<li><code>TunnelToken</code>: 内网穿透客户端连接令牌</li>
<li><code>PASSWORD</code>: 管理控制台登录密码</li>
</ul>
<p>启动服务后，访问 <code>http://your-server:8080</code> 进入管理控制台，使用配置的密码 <code>Aa123456.</code> 进行登录。</p>
<p><img src="https://img2024.cnblogs.com/blog/3578564/202508/3578564-20250825034015353-2125645961.png" alt="image" loading="lazy"></p>
<h3 id="-服务配置">🎯 服务配置</h3>
<p>登录成功后，进入服务管理页面，点击右上角的「新增服务」按钮：<br>
<img src="https://img2024.cnblogs.com/blog/3578564/202508/3578564-20250825034010751-1050950910.png" alt="image" loading="lazy"></p>
<p>配置服务监听 80 端口并启用 HTTPS 功能。当在 80 端口启用 HTTPS 时，系统会自动同时监听 443 端口，这是标准 Web 服务的推荐配置。完成配置后点击「保存」按钮。</p>
<p><img src="https://img2024.cnblogs.com/blog/3578564/202508/3578564-20250825034006529-2088269860.png" alt="image" loading="lazy"></p>
<p>保存后，点击服务管理菜单中的「启动服务」按钮。服务启动后将同时监听 80 和 443 端口。</p>
<p><strong>SSL 证书配置（可选）：</strong><br>
如果您拥有域名，可以通过「证书管理」功能申请免费 SSL 证书。</p>
<blockquote>
<p>⚠️ <strong>注意</strong>：申请 SSL 证书时必须确保服务正在监听 80 端口，以完成域名验证。</p>
</blockquote>
<h3 id="-客户端下载">📥 客户端下载</h3>
<p>服务启动完成后，即可下载内网穿透客户端进行配置：</p>
<p><img src="https://img2024.cnblogs.com/blog/3578564/202508/3578564-20250825034002020-787395338.png" alt="image" loading="lazy"></p>
<h2 id="️-内网穿透客户端配置">🖥️ 内网穿透客户端配置</h2>
<h3 id="下载客户端">下载客户端</h3>
<p>访问 <a href="https://github.com/239573049/FastGateway/releases/tag/master" target="_blank" rel="noopener nofollow">FastGateway Releases</a> 页面，根据操作系统选择对应的客户端版本。本教程以 Windows 版本为例。</p>
<h3 id="客户端文件结构">客户端文件结构</h3>
<p>下载并解压后，客户端文件包含以下内容：<br>
<img src="https://img2024.cnblogs.com/blog/3578564/202508/3578564-20250825033956630-1118987010.png" alt="image" loading="lazy"></p>
<h3 id="-配置文件设置">🔧 配置文件设置</h3>
<p>打开 <code>tunnel.json</code> 配置文件，进行客户端参数配置：</p>
<pre><code class="language-json">{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  },
  // 客户端监听端口
  "Port": 1881,
  "Token": "Aa123456.",
   // 链接网关的协议，如果没有https则使用ws协议 
  "ServerUrl": "ws://127.0.0.1",
  "Name": "FastGateway1",
  // 支持h2,ws
  "Type": "ws",
  // 只有https的时候才需要使用h2，http不能使用h2  
  "ServerHttp2Support": false,
  // 服务端是否支持HTTP/2
  "ReconnectInterval": 5000,
  // 重连间隔，单位毫秒
  "HeartbeatInterval": 30000,
  // 心跳间隔，单位毫秒
  "Proxy": [
    {
      // 请求当前服务的host
      "Host": "www.cnblogs.com",
      // 网关路由匹配  
      "Route": "/",
      // 匹配的域名，注意如果设置了以后只有这个域名才会请求当前配置
      "Domains": [],
       // 当前本地服务请求的端点 
      "LocalRemote": "https://www.cnblogs.com/",
       // 当前服务名称用于在网关中查看 
      "Name": "Test Proxy",
      "Description": "This is a test proxy",
      // 启用当前代理服务
      "Enabled": true
    }
  ]
}
</code></pre>
<h3 id="-配置参数说明">🔑 配置参数说明</h3>
<p><strong>连接参数：</strong></p>
<ul>
<li><code>Token</code>: 必须与服务端 <code>TunnelToken</code> 保持一致</li>
<li><code>ServerUrl</code>: 服务端 WebSocket 连接地址</li>
<li><code>Type</code>: 支持 <code>ws</code> 和 <code>h2</code> 协议（HTTPS 环境推荐 h2）</li>
</ul>
<p><strong>代理配置：</strong></p>
<ul>
<li><code>Host</code>: 目标服务的主机地址</li>
<li><code>Route</code>: URL 路径匹配规则</li>
<li><code>Domains</code>: 域名限制（可选）</li>
<li><code>LocalRemote</code>: 实际代理的本地服务地址</li>
</ul>
<h3 id="-启动客户端">🚀 启动客户端</h3>
<p>完成配置后，保存文件并打开命令行，执行以下命令启动客户端：</p>
<pre><code class="language-sh">.\TunnelClient.exe -c .\tunnel.json
</code></pre>
<h3 id="-连接验证">✅ 连接验证</h3>
<p>客户端成功连接后会显示连接成功信息。此时可以在网关管理控制台的「节点管理」中查看连接状态：</p>
<p><img src="https://img2024.cnblogs.com/blog/3578564/202508/3578564-20250825033950846-940114511.png" alt="image" loading="lazy"></p>
<p>在节点管理页面中，可以查看所有已注册的客户端节点信息、连接状态和代理规则。</p>
<h3 id="-功能测试">🌐 功能测试</h3>
<p>现在可以通过访问服务地址来测试路由代理是否正常工作：</p>
<p><img src="https://img2024.cnblogs.com/blog/3578564/202508/3578564-20250825033947146-2075968959.png" alt="image" loading="lazy"></p>
<h2 id="-测试结果">🎉 测试结果</h2>
<p>成功访问服务后，可以看到：</p>
<ol>
<li><strong>代理成功</strong> - 目标网站（博客园）的内容被正确代理</li>
<li><strong>请求日志</strong> - 客户端控制台显示详细的请求处理日志</li>
<li><strong>网关管理</strong> - 可在网关控制台实时监控流量和连接状态</li>
</ol>
<p>至此，FastGateway 全新版本的部署和配置已经完成，您可以开始使用这个轻量级、高性能的网关解决方案了。<br>
<img src="https://img2024.cnblogs.com/blog/3578564/202508/3578564-20250825033944088-803753612.png" alt="image" loading="lazy"></p>
<h2 id="技术探讨">技术探讨</h2>
<p>qq群：737776595<br>
wx:wk28u9123456789</p>
<p>项目开源地址：<a href="https://github.com/239573049/FastGateway" target="_blank" rel="noopener nofollow">https://github.com/239573049/FastGateway</a></p>

</div>
<div class="clear"></div>

        <div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-08-25 03:40">2025-08-25 03:40</span>&nbsp;
<a href="https://www.cnblogs.com/token-ai">239573049</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19056197);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19056197', targetLink: 'https://www.cnblogs.com/token-ai/p/19056197', title: '免费SSL申请并使用Yarp实现支持内网穿透' })">举报</a>
</div>
    