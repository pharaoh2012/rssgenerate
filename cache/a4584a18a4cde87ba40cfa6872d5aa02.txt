
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/shanyou/p/18717449" title="发布于 2025-02-15 21:47">
    <span role="heading" aria-level="2">Drasi Reactions SDK</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>Drasi Reactions SDK 是一个跨语言的开发工具包，用于实现和处理 Drasi 平台的 Reactions（反应器）功能。该 SDK 目前支持三种主流编程语言：JavaScript/TypeScript、Python 和 .NET。</p><p>主要功能和特点：</p><ol><li><p>核心功能：</p><ul><li>处理来自 Continuous Query（持续查询）的变更事件（ChangeEvent）
</li><li>处理控制事件（ControlEvent）
</li><li>支持查询配置的解析和管理
</li><li>提供事件订阅和处理机制</li></ul></li><li><p>主要事件类型：</p><ul><li>ChangeEvent（变更事件）：包含查询结果的添加、删除和更新信息
</li><li>ControlEvent（控制事件）：处理启动、停止等控制信号</li></ul></li><li><p>支持的语言实现：</p></li></ol><p>JavaScript/TypeScript 版本：</p><p><br></p><pre><code><p>import { DrasiReaction, ChangeEvent } from '@drasi/reaction-sdk';

let myReaction = new DrasiReaction(async (event: ChangeEvent) =&gt; {
    console.log(`Received change sequence: ${event.sequence} for query ${event.queryId}`);
    // 处理添加的结果
    for (let added of event.addedResults) {
        console.log(`Added result: ${JSON.stringify(added)}`);
    }
    // 处理删除的结果
    for (let deleted of event.deletedResults) {
        console.log(`Removed result: ${JSON.stringify(deleted)}`);
    }
    // 处理更新的结果
    for (let updated of event.updatedResults) {
        console.log(`Updated result - before: ${JSON.stringify(updated.before)}, after: ${JSON.stringify(updated.after)}`);
    }
});

myReaction.start();</p></code></pre><p>Python 版本：</p><p><br></p><pre><code><p>from drasi.reaction.models.ChangeEvent import ChangeEvent
from drasi.reaction.sdk import DrasiReaction

async def change_event(event: ChangeEvent, query_configs: dict[str, Any] | None = None):
    print(f"Received change sequence {event.sequence} for query {event.queryId}")
    if event.addedResults:
        print(f"Added result: {event.addedResults}")
    if event.deletedResults:
        print(f"Removed result: {event.deletedResults}")
    if event.updatedResults:
        print(f"Updated result - before: {event.updatedResults[0].before}, after {event.updatedResults[0].after}")

reaction = DrasiReaction(on_change_event=change_event)
reaction.start()</p></code></pre><p>.NET 版本：</p><p><br></p><pre><code><p>var reaction = new ReactionBuilder()
    .UseChangeEventHandler(async (evt, queryConfig) =&gt; {
        Console.WriteLine($"Received change event from query {evt.QueryId} sequence {evt.Sequence}");
        
        foreach (var item in evt.AddedResults)
            Console.WriteLine($"Added result: {item}");

        foreach (var item in evt.UpdatedResults)
            Console.WriteLine($"Updated result, before {item.Before}, after {item.After}");

        foreach (var item in evt.DeletedResults)
            Console.WriteLine($"Deleted result: {item}");
    })
    .Build();

await reaction.StartAsync();</p></code></pre><ol start="4"><li><p>高级特性：</p><ul><li>支持自定义查询配置（Query Configuration）
</li><li>支持 YAML 配置文件解析
</li><li>提供配置值获取工具
</li><li>支持依赖注入（特别是在 .NET 版本中）
</li><li>提供完整的事件处理生命周期管理</li></ul></li><li><p>架构特点：</p><ul><li>基于 Dapr 实现发布订阅模式
</li><li>支持异步事件处理
</li><li>提供优雅的错误处理和日志记录
</li><li>支持配置文件热加载</li></ul></li></ol><p>SDK 的设计理念是提供一个简单但强大的接口，让开发者能够方便地实现和管理 Drasi 平台的反应器功能。无论使用哪种编程语言，都可以通过相似的 API 设计模式来处理事件和管理配置。</p>
</div>
<div id="MySignature" role="contentinfo">
    <p>欢迎大家扫描下面二维码成为我的客户，扶你上云</p>
<img src="https://images.cnblogs.com/cnblogs_com/shanyou/57459/o_220125090408_%E9%82%80%E8%AF%B7%E4%BA%8C%E7%BB%B4%E7%A0%81-258px.jpeg" width="170">
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.01690262604050926" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-02-15 21:48">2025-02-15 21:47</span>&nbsp;
<a href="https://www.cnblogs.com/shanyou">张善友</a>&nbsp;
阅读(<span id="post_view_count">2</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=18717449" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18717449);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18717449', targetLink: 'https://www.cnblogs.com/shanyou/p/18717449', title: 'Drasi Reactions SDK' })">举报</a>
</div>
        