
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/powertoolsteam/p/18901744" title="发布于 2025-05-29 08:52">
    <span role="heading" aria-level="2">从传统搜索到智能问答：自研 RAG 系统的技术实践与工程落地</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="一引言">一、引言</h2>
<p>在数字化转型浪潮下，企业知识服务体系正经历着深刻变革。如何让用户高效获取所需信息，成为提升产品竞争力和用户满意度的关键。葡萄城作为企业级开发工具与解决方案提供商，长期致力于知识服务体系的建设。本文将系统介绍葡萄城自研 RAG（Retrieval-Augmented Generation，检索增强生成）智能问答系统的技术创新、架构设计与工程实践，分享我们在智能搜索与问答领域的探索与思考。</p>
<h2 id="二项目缘起从搜索到智能问答的需求升级">二、项目缘起：从搜索到智能问答的需求升级</h2>
<h3 id="1-现状与挑战">1. 现状与挑战</h3>
<p>葡萄城已建立了完善的<a href="https://gcdn.grapecity.com.cn/" target="_blank" rel="noopener nofollow">知识服务体系</a>，包括标准化文档、技术社区、搜索平台等。现有“葡萄城搜索中心”支持跨平台内容检索，覆盖官网、博客、社区、视频等多种内容源。然而，随着知识库规模的扩大和用户需求的提升，传统基于关键词的搜索方式暴露出诸多不足：</p>
<ul>
<li>用户难以精准定位帮助文档中的功能说明；</li>
<li>技术支持人员难以快速查重和定位历史解决方案；</li>
<li>方案搜寻效率低，用户体验不佳。</li>
</ul>
<h3 id="2-技术探索与自研动因">2. 技术探索与自研动因</h3>
<p>随着大语言模型（LLM）技术的快速发展，基于 RAG 的智能问答成为提升知识服务能力的理想路径。我们调研了多种开源与商业化 RAG 方案，发现它们难以直接适配葡萄城多源异构的数据结构和业务需求。为此，我们决定自研 RAG 系统，目标包括：</p>
<ul>
<li>适配多样化内容结构（如帮助文档、论坛帖子等）；</li>
<li>支持高频动态更新，保障知识库时效性；</li>
<li>灵活扩展，满足未来产品演进需求；</li>
<li>性能与维护可控，便于长期运维。</li>
</ul>
<hr>
<h2 id="三创新点qa-预生成与问题对问题匹配">三、创新点：QA 预生成与“问题对问题”匹配</h2>
<h3 id="1-传统-rag-的局限">1. 传统 RAG 的局限</h3>
<p>传统 RAG 方案通常将用户问题与文档段落直接匹配，但用户提问多为简洁疑问句，文档内容则为陈述性描述，二者在语义表达上存在结构性差异，导致检索准确率受限。</p>
<h3 id="2-预生成-qa-对的创新">2. 预生成 QA 对的创新</h3>
<p>我们基于大语言模型的信息抽取能力，提出了“问题与问题匹配”的创新思路：</p>
<ul>
<li>利用 LLM 为每段文档生成“预设问题”，将原始文档转化为多个 QA 对（问题+答案）；</li>
<li>用户问题与预设问题进行语义一致的精准匹配，显著提升检索效果；</li>
<li>每个 QA 对还配有详细答案（Full Answer）和上下文摘要（Summary），为后续生成环节提供丰富上下文。</li>
</ul>
<p>这种方式不仅解决了语义错位问题，还能将一篇文档拆解为多个知识点，极大提升了知识库的颗粒度和检索相关性。</p>
<hr>
<h2 id="四产品设计融合搜索与智能问答的极致体验">四、产品设计：融合搜索与智能问答的极致体验</h2>
<h3 id="1-界面设计">1. 界面设计</h3>
<p>我们摒弃了传统对话式 AI 助手的设计，转而采用“传统搜索界面 + 智能问答”的混合方案：</p>
<ul>
<li><strong>首页（Home）</strong>：聚焦搜索，支持产品切换，输入框简洁直观；</li>
<li><strong>搜索页（Search）</strong>：顶部导航+产品切换器+搜索框，智能回答区域采用打字机效果逐字输出，搜索结果分为“全部/帮助文档/求助中心/专题教程”四个选项卡，支持数量提示与禁用。<br>
<img src="https://img2024.cnblogs.com/blog/139239/202505/139239-20250529085229505-458181209.png" alt="" loading="lazy"></li>
</ul>
<h3 id="2-智能回答与多轮对话">2. 智能回答与多轮对话</h3>
<ul>
<li>智能回答区域支持加载动画、逐字生成、停止生成、复制、追问等操作；</li>
<li>支持多轮追问，自动折叠历史内容，保持上下文连贯；</li>
<li>回答区提供“有用/没用”反馈，便于后续优化。</li>
</ul>
<h3 id="3-搜索结果优化">3. 搜索结果优化</h3>
<ul>
<li>选项卡显示结果数量，无结果时自动禁用；</li>
<li>帮助文档类结果支持“展开更多”查看详细答案，无需跳转原文；</li>
<li>搜索结果无分页，提升信息获取效率。</li>
</ul>
<hr>
<h2 id="五技术架构三阶段-rag-流程与多通道混合检索">五、技术架构：三阶段 RAG 流程与多通道混合检索</h2>
<h3 id="1-架构总览">1. 架构总览</h3>
<p>系统采用典型的三阶段 RAG 架构：</p>
<ul>
<li><strong>构建（ETL）</strong>：文档采集、QA 对生成、向量化、入库；</li>
<li><strong>检索（Retrieval）</strong>：多通道混合检索（稀疏+稠密），RRF 融合排序；</li>
<li><strong>生成（Generation）</strong>：基于 LLM 和检索结果生成自然语言回答。</li>
</ul>
<h3 id="2-知识构建etl">2. 知识构建（ETL）</h3>
<ul>
<li>支持多源内容采集（帮助文档、论坛、API 文档等）；</li>
<li>基于 LLM 生成结构化 QA 对，人工抽检保证质量；</li>
<li>向量化采用稀疏（BM25）+稠密（Dense Vector）双通道，支持前缀机制区分不同文档场景；</li>
<li>每条知识条目包含问题、答案、详细答案、摘要、链接、标题、分类、时间等丰富元数据。</li>
</ul>
<h3 id="3-检索机制">3. 检索机制</h3>
<ul>
<li>混合检索策略：BM25（关键词）+ Dense（语义）双通道，分别检索问题和答案字段；</li>
<li>RRF（Reciprocal Rank Fusion）融合排序，提升相关性与多样性；</li>
<li>TopK 策略，最终返回最优结果集。</li>
</ul>
<h3 id="4-生成机制">4. 生成机制</h3>
<ul>
<li>LLM 结合用户问题与检索结果生成自然语言回答，附带文档链接；</li>
<li>支持“思考模式”，输出中间推理过程，增强信任感；</li>
<li>多轮对话场景下，自动识别用户意图并改写问题，保证上下文连贯。</li>
</ul>
<hr>
<h2 id="六工程落地高可用可扩展的系统实践">六、工程落地：高可用、可扩展的系统实践</h2>
<h3 id="1-部署架构">1. 部署架构</h3>
<p>系统分为两大模块：</p>
<ul>
<li><strong>知识检索与问答服务</strong>：Qdrant 向量数据库、MySQL 日志与反馈、Server 应用（API）、Client 应用（前端）、第三方 LLM 服务接入；</li>
<li><strong>知识库构建服务（ETL）</strong>：定时任务驱动的文档采集、QA 生成、向量化与入库，支持全量与增量更新。</li>
</ul>
<h3 id="2-请求限流与熔断">2. 请求限流与熔断</h3>
<ul>
<li>采用移动窗口算法实现多维度限流（接口/时间），防止突发流量冲击；</li>
<li>支持熔断与降级机制，保障系统稳定性。</li>
</ul>
<h3 id="3-性能与监控">3. 性能与监控</h3>
<ul>
<li>检索性能：2 秒内返回结果，支持异步加载；</li>
<li>生成性能：依赖 LLM，平均 30 秒内完成；</li>
<li>全链路监控：请求成功率、响应时间、LLM 调用、向量库查询等多维度指标。</li>
</ul>
<h3 id="4-用户体验优化">4. 用户体验优化</h3>
<ul>
<li>前端界面简洁直观，支持 Markdown 展示详细答案；</li>
<li>多轮对话与上下文记忆，提升连续交互体验；</li>
<li>用户反馈机制完善，所有反馈入库用于后续优化。</li>
</ul>
<hr>
<h2 id="七落地效果与未来展望">七、落地效果与未来展望</h2>
<h3 id="1-实际应用成效">1. 实际应用成效</h3>
<ul>
<li>首批覆盖活字格、Wyn、SpreadJS、GcExcel 四大核心产品，支持帮助文档与技术社区内容；</li>
<li>日活用户数、提问频次、热门问题分布等数据持续增长；</li>
<li>答案准确率与用户满意度显著提升，系统稳定性良好。</li>
</ul>
<h3 id="2-持续优化方向">2. 持续优化方向</h3>
<ul>
<li>拓展更多内容源（API 文档、视频、插件等）；</li>
<li>优化检索与生成策略，提升响应速度与准确率；</li>
<li>深化用户反馈分析，驱动系统持续迭代；</li>
<li>探索模型微调与新功能（如图像复制、链接分享等）。</li>
</ul>
<hr>
<h2 id="八结语">八、结语</h2>
<p>葡萄城自研 RAG 智能问答系统，融合了前沿的自然语言处理技术与工程化最佳实践，实现了从传统搜索到智能问答的跨越。我们相信，随着技术的不断演进和用户需求的持续升级，智能知识服务将在企业数字化转型中发挥越来越重要的作用。欢迎业界开发者交流探讨，共同推动智能问答技术的创新与落地！</p>
<hr>
<p>如需了解更多细节，欢迎访问<a href="https://www.grapecity.com.cn/" target="_blank" rel="noopener nofollow">葡萄城官网</a>或关注我们的<a href="https://gcdn.grapecity.com.cn/" target="_blank" rel="noopener nofollow">技术社区</a>。</p>
<p>葡萄城 AI 搜索地址： <a href="https://ai-assist.grapecity.com.cn/" target="_blank" rel="noopener nofollow">https://ai-assist.grapecity.com.cn/</a></p>

</div>
<div id="MySignature" role="contentinfo">
    <hr>
<br>
<p style="font-size: 16px; font-family: 微软雅黑, 黑体, Arial; color: #000">本文是由葡萄城技术开发团队发布，转载请注明出处：<a href="https://www.grapecity.com.cn/" target="_blank">葡萄城官网</a></p>
<!--p style="font-size: 16px; font-family: 微软雅黑, 黑体, Arial; color: #000">了解企业级低代码开发平台，请前往<a href="https://www.grapecity.com.cn/solutions/huozige" target="_blank">活字格</a>
</p><p style="font-size: 16px; font-family: 微软雅黑, 黑体, Arial; color: #000">了解可嵌入您系统的在线 Excel，请前往<a href="https://www.grapecity.com.cn/developer/spreadjs" target="_blank">SpreadJS纯前端表格控件</a></p>
<p style="font-size: 16px; font-family: 微软雅黑, 黑体, Arial; color: #000">了解嵌入式的商业智能和报表软件，请前往<a href="https://www.grapecity.com.cn/solutions/wyn" target="_blank">Wyn Enterprise
</a></p-->

<br>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.01255441525462963" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-29 08:53">2025-05-29 08:52</span>&nbsp;
<a href="https://www.cnblogs.com/powertoolsteam">葡萄城技术团队</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18901744);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18901744', targetLink: 'https://www.cnblogs.com/powertoolsteam/p/18901744', title: '从传统搜索到智能问答：自研 RAG 系统的技术实践与工程落地' })">举报</a>
</div>
        