
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/oberon-zjt0806/p/18984823" title="发布于 2025-07-14 23:19">
    <span role="heading" aria-level="2">Avalonia硬配.NET Framework 4.8</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p><strong>Warning:这种方法能保证运行初始项目，但至于有没有什么其他问题我就不知道了，根据Avalonia官网的说法，Avalonia基于<a href="https://learn.microsoft.com/en-us/dotnet/standard/net-standard?tabs=net-standard-2-0" target="_blank" rel="noopener nofollow">.NET Standard 2.0</a>构建，该标准涵盖从.NET Framework 4.6.2直至.NET 9。<br>
根据社区讨论，预期在Avalonia 12将终止对.NET Standard 2.0的支持，见<a href="https://github.com/AvaloniaUI/Avalonia/discussions/18606" target="_blank" rel="noopener nofollow">https://github.com/AvaloniaUI/Avalonia/discussions/18606</a></strong></p>
</blockquote>
<blockquote>
<p>Avalonia版本：11.3<br>
.NET Framework 4.8</p>
</blockquote>
<blockquote>
<p>本文地址：<a href="https://www.cnblogs.com/oberon-zjt0806/p/18984823" target="_blank">https://www.cnblogs.com/oberon-zjt0806/p/18984823</a></p>
</blockquote>
<p>首先按照一般流程创建Avalonia .NET (Mvvm) App项目，在默认状态下，Avalonia将使用.NET 8.0，直接编辑项目文件，修改目标平台<code>&lt;TargetPlatform&gt;</code>为<code>net4.8</code>。</p>
<p>然而，Avalonia中用到了相当多的新版本语言特性，.NET Framework 4.8官方最大支持为C# 7.3，Nullable引用类型是不支持的。于是通过<code>&lt;LangVersion&gt;</code>修改语言版本为<code>8.0</code>（如果项目文件里没有，则在<code>&lt;PropertyGroup&gt;</code>中手动添加）。修改完的项目文件如下所示：</p>
<pre><code class="language-xml">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;
  &lt;PropertyGroup&gt;
    &lt;OutputType&gt;WinExe&lt;/OutputType&gt;
    &lt;TargetFramework&gt;net4.8&lt;/TargetFramework&gt; &lt;!--Modified--&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
    &lt;BuiltInComInteropSupport&gt;true&lt;/BuiltInComInteropSupport&gt;
    &lt;ApplicationManifest&gt;app.manifest&lt;/ApplicationManifest&gt;
    &lt;AvaloniaUseCompiledBindingsByDefault&gt;true&lt;/AvaloniaUseCompiledBindingsByDefault&gt;
    &lt;LangVersion&gt;8.0&lt;/LangVersion&gt; &lt;!--Added--&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;Folder Include="Models\" /&gt;
    &lt;AvaloniaResource Include="Assets\**" /&gt;
  &lt;/ItemGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include="Avalonia" Version="11.3.0" /&gt;
    &lt;PackageReference Include="Avalonia.Desktop" Version="11.3.0" /&gt;
    &lt;PackageReference Include="Avalonia.Themes.Fluent" Version="11.3.0" /&gt;
    &lt;PackageReference Include="Avalonia.Fonts.Inter" Version="11.3.0" /&gt;
    &lt;!--Condition below is needed to remove Avalonia.Diagnostics package from build output in Release configuration.--&gt;
    &lt;PackageReference Include="Avalonia.Diagnostics" Version="11.3.0"&gt;
      &lt;IncludeAssets Condition="'$(Configuration)' != 'Debug'"&gt;None&lt;/IncludeAssets&gt;
      &lt;PrivateAssets Condition="'$(Configuration)' != 'Debug'"&gt;All&lt;/PrivateAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include="CommunityToolkit.Mvvm" Version="8.2.1" /&gt;
  &lt;/ItemGroup&gt;
&lt;/Project&gt;
</code></pre>
<p>然后，还差一个位置——在<code>ViewLocator.cs</code>中，有一句</p>
<pre><code class="language-csharp">var name = param.GetType().FullName?.Replace("ViewModel", "View", StringComparison.Ordinal);
</code></pre>
<p>这里<code>String.Replace</code>方法用了一个<code>(string oldValue,string newValue,StringComparison compType)</code>的重载版本，这个重载版本直至.NET Core 2.0开始才有，是不受.NET Framework 4.8支持的。因此我们需要删掉最后一个参数<code>StringComparison.Ordinal</code>，这个参数只影响<code>Replace</code>方法在<code>oldValue</code>中的搜索模式，基本不会影响替换结果。</p>
<p>全部完成后我们就可以构建初始项目——</p>
<p><img src="https://img2024.cnblogs.com/blog/1648849/202507/1648849-20250714231802232-632420915.png" alt="image" loading="lazy"></p>
<p>可以看出，Avalonia在.NET Framework 4.8的环境下生成并运行了。当然了，这种情况下Avalonia跨平台的特性就不再支持了。</p>

</div>
<div id="MySignature" role="contentinfo">
    <hr>
<div>作者：<a href="https://www.cnblogs.com/oberon-zjt0806/" target="_blank">Oberon</a></div>
<div>出处：<a href="https://www.cnblogs.com/oberon-zjt0806/" target="_blank">https://www.cnblogs.com/oberon-zjt0806/</a></div>
<div>本文版权归作者和博客园共有，欢迎转载，但未经作者同意必须在文章页面给出原文连接，否则保留追究法律责任的权利。 </div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.006944444444444444" data-date-updated="2025-07-14 23:29">2025-07-14 23:19</span>&nbsp;
<a href="https://www.cnblogs.com/oberon-zjt0806">Oberon</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18984823);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18984823', targetLink: 'https://www.cnblogs.com/oberon-zjt0806/p/18984823', title: 'Avalonia硬配.NET Framework 4.8' })">举报</a>
</div>
        