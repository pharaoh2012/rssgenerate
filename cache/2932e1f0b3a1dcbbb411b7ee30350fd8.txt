
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/the-pig-of-zf/p/19031196" title="发布于 2025-08-10 22:34">
    <span role="heading" aria-level="2">通过Certbot自动申请更新HTTPS网站的SSL证书</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>原文地址：<a href="https://frozencola.com/?p=819" target="_blank" rel="noopener nofollow">通过Certbot自动申请更新HTTPS网站的SSL证书</a></p>
</blockquote>
<p>现在很多云服务运营商免费的HTTPS证书有效期只有3个月，对于个人网站来说，这就很麻烦，现在可以用 <strong>Certbot</strong> + <strong>Crontab</strong> 自动申请并定期更新 HTTPS 网站的 SSL 证书，来解决我们这个痛点。</p>
<p>需要云服务器可以看这里：<strong><a href="https://frozencola.com/?page_id=556" target="_blank" rel="noopener nofollow">云服务器优惠合集。</a></strong></p>
<h2 id="1-安装-certbot">1. 安装 Certbot</h2>
<p>不同系统安装方式略有不同，这里给你 CentOS / RHEL 和 Debian / Ubuntu 的常用方法。</p>
<h3 id="centos--rhel-789"><strong>CentOS / RHEL 7/8/9</strong></h3>
<pre><code class="language-bash"># 安装 EPEL
sudo yum install epel-release -y

# 安装 Certbot 和 Nginx 插件（如果用 Apache 就换成 python3-certbot-apache）
sudo yum install certbot python3-certbot-nginx -y
</code></pre>
<h3 id="debian--ubuntu"><strong>Debian / Ubuntu</strong></h3>
<pre><code class="language-bash">sudo apt update
sudo apt install certbot python3-certbot-nginx -y
</code></pre>
<h2 id="2-申请-ssl-证书">2. 申请 SSL 证书</h2>
<p>如果你用 <strong>Nginx</strong>：</p>
<pre><code class="language-bash">sudo certbot --nginx -d example.com -d www.example.com
</code></pre>
<ul>
<li><code>-d</code> 参数后面写你的域名（可以多个）</li>
<li>Certbot 会自动修改 Nginx 配置并申请证书</li>
<li>申请过程中会让你选择是否重定向 HTTP → HTTPS</li>
</ul>
<p><strong>注意</strong>：这里需要你的nginx的conf文件里面的sercer_name指定对应的域名，如果你配置的是下划线 "_"，会导致该命令运行失败，报下面的错误。</p>
<pre><code class="language-bash">Could not automatically find a matching server block for zhangfeidezhu.com. Set the `server_name` directive to use the Nginx installer.
</code></pre>
<p>如果你用 <strong>Apache</strong>：</p>
<pre><code class="language-bash">sudo certbot --apache -d example.com -d www.example.com
</code></pre>
<h2 id="3-测试证书是否生效">3. 测试证书是否生效</h2>
<p>申请完成后，可以在浏览器访问你的域名，查看是否已经是有效的 <strong>Let's Encrypt</strong> 证书。</p>
<h2 id="4-自动更新证书">4. 自动更新证书</h2>
<p><strong>Let's Encrypt</strong> 证书有效期是 90 天，所以要自动续签。</p>
<p>Certbot 自带定时任务（通常是 <code>/etc/cron.d/certbot</code> 或 systemd 定时器），也可以手动添加 crontab：</p>
<pre><code class="language-bash">sudo crontab -e
</code></pre>
<p>加入：</p>
<pre><code class="language-bash">0 3 1 */3 * certbot renew --quiet --post-hook "nginx -s reload"
</code></pre>
<p>解释：</p>
<ul>
<li><code>0 3 1 */3 *</code> → 每隔 3 个月的1号3点执行一次</li>
<li><code>--quiet</code> → 静默模式</li>
<li><code>--post-hook "nginx -s reload"</code> → 续签后自动重载 Nginx</li>
</ul>
<h2 id="5-检查自动续签是否正常">5. 检查自动续签是否正常</h2>
<p>手动测试续签：</p>
<pre><code class="language-bash">sudo certbot renew --dry-run
</code></pre>
<p>如果提示 <strong>Congratulations, all renewals succeeded</strong>，说明没问题。</p>
<p>✅ 这样配置后，你的网站 HTTPS 证书会在到期前自动续签，Nginx 会自动加载新证书，几乎可以做到“一劳永逸”。</p>

</div>
<div id="MySignature" role="contentinfo">
    <p>本文来自博客园，作者：<a href="https://www.cnblogs.com/the-pig-of-zf/" target="_blank">张飞的猪</a>，转载请注明原文链接：<a href="https://www.cnblogs.com/the-pig-of-zf/p/19031196" target="_blank">https://www.cnblogs.com/the-pig-of-zf/p/19031196</a></p>
<p>公众号：张飞的猪大数据分享，不定期分享大数据学习的总结和相关资料，欢迎关注。</p>
<p>个人网站"张飞的猪编程工作室"链接: <a href="https://zhangfeidezhu.com" target="_blank">https://zhangfeidezhu.com</a> </p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2025-08-10 22:35">2025-08-10 22:34</span>&nbsp;
<a href="https://www.cnblogs.com/the-pig-of-zf">张飞的猪</a>&nbsp;
阅读(<span id="post_view_count">223</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19031196);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19031196', targetLink: 'https://www.cnblogs.com/the-pig-of-zf/p/19031196', title: '通过Certbot自动申请更新HTTPS网站的SSL证书' })">举报</a>
</div>
        