
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/zzhallen/p/18984598/fft" title="发布于 2025-07-14 20:15">
    <span role="heading" aria-level="2">快速傅里叶变换(FFT) 笔记</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="2upd2025710">2.upd.2025.7.10</h1>
<h2 id="oipolofft">oi.polo.fft</h2>
<h1 id="快速傅里叶变换fast-fourier-transform"><em><strong>快速傅里叶变换(Fast Fourier Transform</strong></em>)</h1>
<h2 id="fft三问">FFT三问：</h2>
<h3 id="1什么是fft">1.什么是FFT</h3>
<ul>
<li>一个快速处理卷积的算法</li>
</ul>
<h3 id="2什么是卷积">2.什么是卷积</h3>
<ul>
<li>就是多项式乘法</li>
</ul>
<h3 id="3fft有多快">3.FFT有多快</h3>
<ul>
<li>常规卷积或是DFT时间复杂度为<span class="math inline">\(O(n^2)\)</span>,而FFT为<span class="math inline">\(O(nlog_2n)\)</span>,比常规卷积快了将近一阶</li>
</ul>
<h1 id="_"></h1>
<h1 id="_-1"></h1>
<h1 id="_-2"></h1>
<h2 id="算法实现">算法实现：</h2>
<h3 id="chapter1--首先我们先来看两种多项式的表示形式">$Chapter1: $ 首先我们先来看两种多项式的表示形式</h3>
<h5 id="1记录系数">1.记录系数</h5>
<h5 id="2记录点">2.记录点</h5>
<h4 id="首先我们先来看1记录系数">首先我们先来看1.记录系数:</h4>
<h3 id="假设我现在有一个多项式叫做它有个系数n项">假设我现在有一个多项式叫做<span class="math inline">\(P(x)\)</span>，它有<span class="math inline">\(n\)</span>个系数(n项)</h3>
<h3 id="那么不难发现它代数形式肯定能写成">那么不难发现它代数形式肯定能写成:</h3>
<h3 id="_-3"><span class="math inline">\(P(x) = a_0 +a_1x+a_2x+...+a_{n-2}x^{n-2}+a_{n-1}x^{n-1}\)</span></h3>
<h3 id="因此我记录也只需要记录其系数序列">因此我记录<span class="math inline">\(P(x)\)</span>也只需要记录其系数<span class="math inline">\({\{a_n\}}\)</span>序列</h3>
<h1 id="_-4"></h1>
<h4 id="我们再来看2记录点">我们再来看2.记录点</h4>
<h3 id="我们都学过待定系数法">我们都学过<em><strong>待定系数法</strong></em></h3>
<h3 id="因此我们知道对于一个次函数我们只需要取个点就可以求出这个函数的代数式了">因此我们知道对于一个<span class="math inline">\(n\)</span>次函数，我们只需要取<span class="math inline">\(n+1\)</span>个点就可以求出这个函数的代数式了！</h3>
<h3 id="所以我们只要记录个点就可以表示这个项多项式了">所以我们只要记录<span class="math inline">\(n\)</span>个点就可以表示这个<span class="math inline">\(n\)</span>项多项式<span class="math inline">\(P(x)\)</span>了</h3>
<h1 id="_-5"></h1>
<h1 id="_-6"></h1>
<h3 id="chapter2-这两种存储方式该如何进行卷积运算">$Chapter2: $这两种存储方式该如何进行卷积运算？</h3>
<h4 id="1记录系数方式的卷积">1.记录系数方式的卷积：</h4>
<h4 id="很简单我们直接用乘法分配律去算但是对于两个项数为的多项式这样做的时间复杂度为-非常菜">很简单，我们直接用乘法分配律去算，但是对于两个项数为<span class="math inline">\(n\)</span>的多项式，这样做的时间复杂度为<span class="math inline">\(O(n^2)\)</span>, <s>非常菜</s></h4>
<h4 id="2记录点坐标方式的卷积">2.记录点坐标方式的卷积：</h4>
<h4 id="设阶多项式与阶多项式相乘结果为阶多项式--">设<span class="math inline">\(n\)</span>阶多项式<span class="math inline">\(F(x)\)</span>与<span class="math inline">\(m\)</span>阶多项式<span class="math inline">\(G(x)\)</span>相乘，结果为<span class="math inline">\(n+m\)</span>阶多项式<span class="math inline">\(P(x)\)</span> <span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\(P(x) = F(x)*G(x)\)</span></h4>
<h4 id="因此我们取和共个点将每一个点和相乘得到">因此我们取<span class="math inline">\(F(x)\)</span>和<span class="math inline">\(G(x)\)</span>共<span class="math inline">\(n+m\)</span>个点,将每一个点<span class="math inline">\((x_0,F(x))\)</span>和<span class="math inline">\((x_0,G(x))\)</span>相乘，得到<span class="math inline">\((x_0,F(x)*G(x)),这个点一定在P(x)上\)</span></h4>
<h4 id="但是我们发现取点需要计算需要总共还是要目前我们优化卷积还是毫无进展">但是我们发现取点需要<span class="math inline">\(O(n)\)</span>,计算需要<span class="math inline">\(O(n)\)</span>,总共还是要<span class="math inline">\(O(n^2)\)</span>,目前我们优化卷积还是毫无进展</h4>
<h1 id="_-7"></h1>
<h1 id="_-8"></h1>
<h1 id="_-9"></h1>
<h3 id="chapter3-对于记录点坐标方式卷积的优化">$Chapter3: $对于记录点坐标方式卷积的优化</h3>
<h4 id="假设我现在要对于取个点我们要怎么做呢">假设我现在要对于<span class="math inline">\(F(x)=x^2+1\)</span>取<span class="math inline">\(m\)</span>个点，我们要怎么做呢</h4>
<h4 id="一种方法是直接简单的取m个点如取并分别计算需要算2m次2为fx的项数">一种方法是直接简单的取m个点,如取<span class="math inline">\(x=1,2,3,...,m\)</span>,并分别计算<span class="math inline">\(F(x)\)</span>,需要算2*m次(2为F(x)的项数)</h4>
<h4 id="但是我们思考的性质它是一个偶函数欸">但是我们思考<span class="math inline">\(F(x)\)</span>的性质,它是一个偶函数欸!</h4>
<h3 id="_-10"><span class="math inline">\(F(x) = F(-x)\)</span></h3>
<h4 id="因此如果我们取-这样我们计算出就相当于计算出了要算次">因此如果我们取 <span class="math inline">\(\pm 1,\pm2\)</span>这样,我们计算出<span class="math inline">\(F(x)\)</span>就相当于计算出了<span class="math inline">\(F(-x)\)</span>!,要算<span class="math inline">\(m\)</span>次</h4>
<h4 id="同理对于奇函数我们也是如此">同理，对于奇函数我们也是如此</h4>
<h2 id="但是万一我的函数非奇非偶呢"><em>但是万一我的函数非奇非偶呢？？？</em></h2>
<h3 id="给定多项式为方便讨论我们假设为偶数">给定多项式<span class="math inline">\(F(x)=a_0+a_1x+a_2x^2+...+a_{n-1}x^{n-1}+a_{n}x^{n}\)</span>,为方便讨论我们假设<span class="math inline">\(n\)</span>为偶数</h3>
<h3 id="我们有什么办法给施加奇偶性呢">我们有什么办法给<span class="math inline">\(F(x)\)</span>施加奇偶性呢？</h3>
<h3 id="我们按照的次数分为两类">我们按照<span class="math inline">\(x\)</span>的次数分为两类:</h3>
<h3 id="_-11"><span class="math inline">\(F(x) = (a_0 +a_2x^2+a_4x^4+...+a_nx^n) + (a_1x+a_3x^3+...+a_{n-1}x^{n-1})\)</span></h3>
<h3 id="我们令">我们令<span class="math inline">\(F_{even}(x^2)=a_0+a_2x^2+a_4x^4 + ...+a_nx^n,F_{odd}(x^2)=a_1+a_3x^2+...+a_{n-1}x^{n-2}\)</span></h3>
<h1 id="_-12"><span class="math inline">\(F(x)=F_{even}(x^2) + xF_{odd}(x^2)\)</span>!</h1>
<h1 id="_-13"><span class="math inline">\(F(-x)=F_{even}(x^2) - xF_{odd}(x^2)\)</span></h1>
<h4 id="我们不难发现现在我们的被拆成了一个偶函数和一个奇函数">我们不难发现现在我们的<span class="math inline">\(F(x)\)</span>被拆成了一个偶函数<span class="math inline">\(F_{even}(x^2)\)</span>和一个奇函数<span class="math inline">\(xF_{odd}(x^2)\)</span></h4>
<h4 id="现在我们对于取的点计算出和后相加可得相减可得">现在我们对于取的点<span class="math inline">\((x_0,F(x_0))\)</span>计算出<span class="math inline">\(F_{even}(x_0^2)\)</span>和<span class="math inline">\(F_{odd}(x_0^2)\)</span>后相加可得<span class="math inline">\(F(x)\)</span>,相减可得<span class="math inline">\(F(-x)\)</span></h4>
<h3 id="那我们怎么计算和">那我们怎么计算<span class="math inline">\(F_{even}(x_0^2)\)</span>和<span class="math inline">\(F_{odd}(x_0^2)\)</span>?</h3>
<h4 id="这不就是一个递归嘛将看作变量继续来一遍拆分直到我的函数只有常数项为止由主定理可得时间复杂度为">这不就是一个递归嘛，将<span class="math inline">\(x_0^2\)</span>看作变量，继续来一遍拆分，直到我的函数只有常数项为止，由主定理可得时间复杂度为<span class="math inline">\(O(nlog_2n)\)</span></h4>
<h3 id="但是我有啊原来的都会变成我在递归去求子函数的值的时候取点全会变成正的无法正负取点了所以递归无法进行">但是，我有<span class="math inline">\(x_0^2\)</span>啊，原来的<span class="math inline">\(\pm x_0\)</span>都会变成<span class="math inline">\(x_0^2\)</span>,我在递归去求子函数的值的时候取点全会变成正的，无法正负取点了，所以递归无法进行。</h3>
<h2 id="-数域推广"><span class="math inline">\(Chapter4:\)</span> 数域推广</h2>
<h3 id="现在我们需要寻找一类数满足且对于由构成的集合和满足同样的性质">现在我们需要寻找一类数<span class="math inline">\(S\)</span>,满足<span class="math inline">\(\forall x \in S,-x \in S\)</span>且对于由<span class="math inline">\(\forall x \in S, x^2\)</span>构成的集合<span class="math inline">\(S'\)</span>和<span class="math inline">\(S\)</span>满足同样的性质</h3>
<h3 id="实数无法满足的原因是你无法在中找到因此我们将数域推广至复数">实数无法满足的原因是你无法在<span class="math inline">\(S'\)</span>中找到<span class="math inline">\(-x\)</span>,因此我们将数域推广至复数</h3>
<h3 id="以前的注意力大神发现了单位根-就满足这样的性质">以前的注意力大神发现了<em>单位根</em> 就满足这样的性质</h3>
<h3 id="什么是单位根">什么是单位根？</h3>
<h3 id="单位根就是在复数域下所有满足-的构成的集合">单位根<span class="math inline">\(\{\omega_n\}\)</span>就是在复数域下所有满足 <span class="math inline">\(x^n=1\)</span>的<span class="math inline">\(x\)</span>构成的集合</h3>
<h3 id="我们不难发现将复平面上的单位圆进行了等分所以我们可以得到单位根的表达式">我们不难发现<span class="math inline">\(\{\omega_n\}\)</span>将复平面上的单位圆进行了<span class="math inline">\(n\)</span>等分,所以我们可以得到单位根的表达式:</h3>
<h3 id="_-14"><span class="math inline">\(\omega^k_n = cos\theta+isin\theta,\theta=\frac{2\pi k}{n}\)</span></h3>
<h3 id="我们这个时候取点取就可以满足条件了">我们这个时候取点取<span class="math inline">\(\{\omega_n\}\)</span>就可以满足条件了</h3>
<h2 id="-fft完全版"><span class="math inline">\(Chapter5:\)</span> FFT完全版</h2>
<ul>
<li>对于n项多项式<span class="math inline">\(F(x)\)</span>取<span class="math inline">\(n\)</span>次单位根为点</li>
<li>分奇偶函数递归计算<span class="math inline">\(F(\omega_n^i)\)</span></li>
<li>同样计算<span class="math inline">\(G(x)\)</span></li>
<li>将<span class="math inline">\(G(x)\)</span>与<span class="math inline">\(F(x)\)</span>以点坐标形式相乘</li>
</ul>
<h3 id="这就是fft很简单吧">这就是FFT，很简单吧</h3>
<h3 id="但是我们发现这离结果还远着呢所以我们需要从点表示转换为系数表示因此我们需要插值操作">但是我们发现这离结果还远着呢，所以我们需要从点表示转换为系数表示，因此我们需要插值操作</h3>
<h2 id="-插值"><span class="math inline">\(Chapter6:\)</span> 插值</h2>
<h3 id="我们将待定系数列的方程组写为矩阵形式系数为">我们将待定系数列的方程组写为矩阵形式(<span class="math inline">\(P(x)\)</span>系数为<span class="math inline">\(\{a_n\}\)</span>)</h3>
<p><span class="math inline">\(
{\begin{bmatrix}
    P(\omega^0) \\\\
    P(\omega^1) \\\\
    P(\omega^2) \\\\
    \vdots \\\\
    P(\omega^{n-1}) \\\\
\end{bmatrix}} = {\begin{bmatrix}
    1 &amp; 1 &amp; 1 &amp; ... &amp;1\\\\
    1 &amp; \omega &amp; \omega^2 &amp; ... &amp; \omega^{n-1}\\\\
    1&amp;\omega^2&amp;\omega^4&amp;...&amp;\omega^{2
    (n-1)}\\\\
    \vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\\\
    1&amp;\omega^{n-1}&amp;\omega^{2(n-1)}&amp;...&amp;\omega^{(n-1)(n-1)}
\end{bmatrix}} {\begin{bmatrix}
    a_0 \\\\
    a_1\\\\
    a_2 \\\\
    \vdots \\\\
    a_{n-1} \\\\
\end{bmatrix}}
\)</span></p>
<h3 id="移项将解出">移项将<span class="math inline">\(\{a_n\}\)</span>解出</h3>
<p><span class="math inline">\(
{\begin{bmatrix}
    a_0 \\\\
    a_1\\\\
    a_2 \\\\
    \vdots \\\\
    a_{n-1} 
\end{bmatrix}} = {\begin{bmatrix}
    1 &amp; 1 &amp; 1 &amp; ... &amp;1\\\\
    1 &amp; \omega &amp; \omega^2 &amp; ... &amp; \omega^{n-1}\\\\
    1&amp;\omega^2&amp;\omega^4&amp;...&amp;\omega^{2
    (n-1)}\\\\
    \vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\\\
    1&amp;\omega^{n-1}&amp;\omega^{2(n-1)}&amp;...&amp;\omega^{(n-1)(n-1)}
\end{bmatrix}}^{-1} {\begin{bmatrix}
    P(\omega^0) \\\\
    P(\omega^1) \\\\
    P(\omega^2) \\\\
    \vdots \\\\
    P(\omega^{n-1}) 
\end{bmatrix}}
\)</span></p>
<h3 id="我们发现中间的那个矩阵为dft离散傅里叶变换矩阵因此可得">我们发现中间的那个矩阵为DFT(离散傅里叶变换)矩阵,因此可得</h3>
<p><span class="math inline">\(
{\begin{bmatrix}
    a_0 \\\\
    a_1\\\\
    a_2 \\\\
    \vdots \\\\
    a_{n-1} 
\end{bmatrix}} = \frac{1}{n}{\begin{bmatrix}
    1 &amp; 1 &amp; 1 &amp; ... &amp;1\\\\
    1 &amp; \omega^{-1} &amp; \omega^{-2} &amp; ... &amp; \omega^{-(n-1)}\\\\
    1&amp;\omega^{-2}&amp;\omega^{-4}&amp;...&amp;\omega^{-2
    (n-1)}\\\\
    \vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\\\
    1&amp;\omega^{-(n-1)}&amp;\omega^{-2(n-1)}&amp;...&amp;\omega^{-(n-1)(n-1)}
\end{bmatrix}} {\begin{bmatrix}
    P(\omega^0) \\\\
    P(\omega^1) \\\\
    P(\omega^2) \\\\
    \vdots \\\\
    P(\omega^{n-1}) 
\end{bmatrix}}
\)</span></p>
<h3 id="然后我们发现我们只需要求解这个矩阵乘法即可">然后我们发现我们只需要求解这个矩阵乘法即可</h3>
<h3 id="矩阵乘法是什么卷积卷积是什么多项式乘法">矩阵乘法是什么？卷积，卷积是什么？多项式乘法</h3>
<h3 id="因此我们再fft一遍就行了">因此我们再FFT一遍就行了</h3>
<h3 id="end">end.</h3>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-07-14 20:16">2025-07-14 20:15</span>&nbsp;
<a href="https://www.cnblogs.com/zzhallen">ZzhAllen</a>&nbsp;
阅读(<span id="post_view_count">0</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18984598);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18984598', targetLink: 'https://www.cnblogs.com/zzhallen/p/18984598/fft', title: '快速傅里叶变换(FFT) 笔记' })">举报</a>
</div>
        