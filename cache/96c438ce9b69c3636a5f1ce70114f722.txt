
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/shanyou/p/18930500" title="发布于 2025-06-16 07:02">
    <span role="heading" aria-level="2">.NET 10 支持Linux/Unix 的Shebang（Hashbang）</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><font face="微软雅黑" size="3">.NET 10 Preview 5 带来的C# 文件脚本化运行，在 <strong></strong><strong>Linux/Unix 系统中通过 #!/usr/bin/dotnet run 支持 Shebang（Hashbang）</strong> 的详细说明：</font></p><font face="微软雅黑" size="3"><hr></font><h3><font face="微软雅黑"><font size="3">⚙️ <strong></strong><strong>一、Shebang 的原理与作用</strong></font></font></h3><ol><li><strong></strong><font face="微软雅黑"><font size="3"><strong>基本定义</strong> <strong></strong><strong>Shebang</strong>（又称 <strong></strong><strong>Hashbang</strong>）是脚本文件开头的特殊标记，格式为 #!&lt;解释器路径&gt;。</font></font></li></ol><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>作用</strong>：告知操作系统使用指定程序执行脚本，无需显式调用解释器。</font></font></li></ul><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>示例</strong>： </font></font></li></ul><pre><code><p><font face="微软雅黑" size="3">#!/usr/bin/dotnet run  # 指定用 dotnet run 执行后续代码</font></p><p><font face="微软雅黑" size="3">Console.WriteLine("Hello from C# script!");</font></p></code></pre><p><font face="微软雅黑" size="3"><br></font></p><ol start="2"><li><strong></strong><strong><font face="微软雅黑" size="3">运行机制</font></strong></li></ol><ul><li><font face="微软雅黑" size="3">当直接执行脚本（如 ./hello.cs）时，系统读取首行 Shebang，调用 /usr/bin/dotnet run 解释文件内容。</font></li></ul><ul><li><font face="微软雅黑" size="3">若未添加可执行权限（chmod +x hello.cs），会报权限错误。</font></li></ul><font face="微软雅黑" size="3"><hr></font><h3><font face="微软雅黑"><font size="3"> <strong></strong><strong>二、在 C# 中使用 Shebang 的方法（.NET 10 支持）</strong></font></font></h3><h4><font face="微软雅黑" size="3">步骤详解</font></h4><ol><li><strong></strong><font face="微软雅黑"><font size="3"><strong>添加 Shebang 声明</strong> 在 C# 文件首行写入：</font></font></li></ol><pre><code><p><font face="微软雅黑" size="3">#!/usr/bin/dotnet run</font></p><p><font face="微软雅黑" size="3">Console.WriteLine("Hello, .NET 10!");</font></p></code></pre><p><font face="微软雅黑" size="3"><br></font></p><ol start="2"><li><strong></strong><strong><font face="微软雅黑" size="3">赋予可执行权限</font></strong></li></ol><pre><code><p><font face="微软雅黑" size="3">chmod +x hello.cs  # 使文件可直接执行</font></p></code></pre><p><font face="微软雅黑" size="3"><br></font></p><ol start="3"><li><strong></strong><strong><font face="微软雅黑" size="3">直接运行脚本</font></strong></li></ol><pre><code><p><font face="微软雅黑" size="3">./hello.cs  # 输出：Hello, .NET 10!</font></p></code></pre><p><font face="微软雅黑" size="3"><br></font></p><h4><font face="微软雅黑" size="3">关键特性</font></h4><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>无需项目文件</strong>：直接运行单个 .cs 文件，无需 .csproj 或编译步骤。</font></font></li></ul><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>依赖管理</strong>：结合文件级指令（如 #:package）引用 NuGet 包： </font></font></li></ul><pre><code><p><font face="微软雅黑" size="3">#!/usr/bin/dotnet run</font></p><p><font face="微软雅黑" size="3">#:package Humanizer@2.14.1</font></p><p><font face="微软雅黑" size="3">using Humanizer;</font></p><p><font face="微软雅黑" size="3">Console.WriteLine(TimeSpan.FromDays(1).Humanize());  // 输出："1 day"</font></p></code></pre><p><font face="微软雅黑" size="3"><br></font></p><p><font face="微软雅黑" size="3">指令需紧接 Shebang 后声明。</font></p><font face="微软雅黑" size="3"><hr></font><h3><font face="微软雅黑"><font size="3">⚡ <strong></strong><strong>三、实际应用场景</strong></font></font></h3><ol><li><strong></strong><strong><font face="微软雅黑" size="3">自动化脚本</font></strong></li></ol><ul><li><font face="微软雅黑" size="3">替代 Bash/Python 编写系统工具（如日志清理、文件备份）： </font></li></ul><pre><code><p><font face="微软雅黑" size="3">#!/usr/bin/dotnet run</font></p><p><font face="微软雅黑" size="3">foreach (var file in Directory.GetFiles("./logs"))</font></p><p><font face="微软雅黑" size="3">    File.Delete(file);</font></p></code></pre><p><font face="微软雅黑" size="3"><br></font></p><ol start="2"><li><strong></strong><strong><font face="微软雅黑" size="3">快速原型验证</font></strong></li></ol><ul><li><font face="微软雅黑" size="3">直接运行代码片段验证逻辑，省去创建项目的开销。</font></li></ul><ol start="3"><li><strong></strong><strong><font face="微软雅黑" size="3">跨平台 CLI 工具</font></strong></li></ol><ul><li><font face="微软雅黑" size="3">通过 Shebang 兼容 Linux/macOS，Windows 需通过 dotnet run hello.cs 显式执行（因 Windows 不支持 Shebang）。</font></li></ul><font face="微软雅黑" size="3"><hr></font><h3><font face="微软雅黑"><font size="3">⚠️ <strong></strong><strong>四、注意事项与限制</strong></font></font></h3><ol><li><strong></strong><strong><font face="微软雅黑" size="3">系统兼容性</font></strong></li></ol><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>仅限 Unix/Linux</strong>：Shebang 在 Windows 无效，需改用 dotnet run hello.cs。</font></font></li></ul><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>路径正确性</strong>：若 /usr/bin/dotnet 不存在，需调整为实际安装路径（如 #!/usr/local/bin/dotnet run）。</font></font></li></ul><ol start="2"><li><strong></strong><strong><font face="微软雅黑" size="3">文件格式要求</font></strong></li></ol><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>首行声明</strong>：Shebang 必须是文件第一行，否则无效。</font></font></li></ul><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>编码与换行符</strong>：文件需保存为 UTF-8 编码，使用 LF 换行符（Unix 格式）。</font></font></li></ul><ol start="3"><li><strong></strong><strong><font face="微软雅黑" size="3">当前限制</font></strong></li></ol><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>多文件支持</strong>：暂不支持跨文件引用（如 partial class），需等待后续更新。</font></font></li></ul><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>调试支持</strong>：需转换为正式项目（dotnet project convert hello.cs）后调试。</font></font></li></ul><font face="微软雅黑" size="3"><hr></font><h3><font face="微软雅黑"><font size="3"> <strong></strong><strong>五、与传统执行方式的对比</strong></font></font></h3><p><strong></strong><strong><a href="https://img2023.cnblogs.com/blog/510/202506/510-20250616070227803-90458526.png"><font face="微软雅黑" size="3"><img width="1285" height="330" title="image" style="display: inline; background-image: none" alt="image" src="https://img2023.cnblogs.com/blog/510/202506/510-20250616070228981-1462977343.png" border="0"></font></a></strong></p><p><font face="微软雅黑" size="3"></font></p><font face="微软雅黑" size="3"><hr></font><h3><font face="微软雅黑"><font size="3"> <strong></strong><strong>总结</strong></font></font></h3><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>开发者价值</strong>： Shebang 支持使 C# 成为真正的脚本语言，<strong></strong><strong>降低学习门槛</strong>，提升在自动化场景的竞争力，尤其适合 DevOps 和跨平台工具开发。</font></font></li></ul><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>适用场景</strong>：快速验证、小型工具开发、教学演示。</font></font></li></ul><ul><li><strong></strong><font face="微软雅黑"><font size="3"><strong>未来展望</strong>：多文件支持、Windows 兼容优化（如通过 env 查找路径）。</font></font></li></ul><blockquote><p><strong></strong><font face="微软雅黑"><font size="3"><strong>提示</strong>：通过 .NET 10 SDK 安装体验，搭配 VS Code + C# Dev Kit 扩展可获得完整脚本开发支持。下载地址：<a title="https://dotnet.microsoft.com/zh-cn/download" href="https://dotnet.microsoft.com/zh-cn/download" rel="noopener nofollow">https://dotnet.microsoft.com/zh-cn/download</a>&nbsp;</font></font></p></blockquote>
</div>
<div id="MySignature" role="contentinfo">
    <p>欢迎大家扫描下面二维码成为我的客户，扶你上云</p>
<img src="https://images.cnblogs.com/cnblogs_com/shanyou/57459/o_220125090408_%E9%82%80%E8%AF%B7%E4%BA%8C%E7%BB%B4%E7%A0%81-258px.jpeg" width="170">
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0020833333333333333" data-date-updated="2025-06-16 07:05">2025-06-16 07:02</span>&nbsp;
<a href="https://www.cnblogs.com/shanyou">张善友</a>&nbsp;
阅读(<span id="post_view_count">422</span>)&nbsp;
评论(<span id="post_comment_count">4</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18930500);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18930500', targetLink: 'https://www.cnblogs.com/shanyou/p/18930500', title: '.NET 10 支持Linux/Unix 的Shebang（Hashbang）' })">举报</a>
</div>
        