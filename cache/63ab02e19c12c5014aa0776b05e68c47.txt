
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xiaokang-coding/p/18895297" title="å‘å¸ƒäº 2025-05-25 13:02">
    <span role="heading" aria-level="2">ã€Œç¡¬æ ¸ç§‘æ™®ã€C++11é”æœºåˆ¶ä¸‰å…„å¼Ÿå¤§æ¯”æ‹¼ï¼šmutexã€lock_guardä¸unique_lock</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¤§å®¶å¥½å•Šï¼Œæˆ‘æ˜¯å°åº·ã€‚ä»Šå¤©å’±ä»¬èŠç‚¹"å®¶å¸¸"â€”â€”é‚£äº›è®©C++ç¨‹åºå‘˜åˆçˆ±åˆæ¨çš„å¤šçº¿ç¨‹åŒæ­¥å·¥å…·ï¼</p>
<p>å¦‚æœä½ æ›¾ç»è¢«å¤šçº¿ç¨‹æå¾—å¤´å¤§ï¼Œæˆ–è€…å¬åˆ°"æ­»é”"å°±å¿ƒæ…Œï¼Œé‚£è¿™ç¯‡æ–‡ç« å°±æ˜¯ä¸ºä½ å‡†å¤‡çš„ã€‚ä»Šå¤©æˆ‘è¦ç”¨æœ€æ¥åœ°æ°”çš„æ–¹å¼ï¼Œå¸®ä½ å½»åº•ææ‡‚C++11ä¸­çš„ä¸‰å…„å¼Ÿï¼š<code>mutex</code>ã€<code>lock_guard</code>å’Œ<code>unique_lock</code>ã€‚</p>
<h2 id="ä¸ºå•¥è¦ç”¨è¿™äº›åŒæ­¥å·¥å…·">ä¸ºå•¥è¦ç”¨è¿™äº›åŒæ­¥å·¥å…·ï¼Ÿ</h2>
<p>å…ˆåˆ«æ€¥ç€å­¦æ€ä¹ˆç”¨ï¼Œå’±ä»¬å¾—å…ˆçŸ¥é“ä¸ºå•¥è¦ç”¨å•Šï¼</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼šä½ å’Œå®¤å‹å…±ç”¨ä¸€ä¸ªå«ç”Ÿé—´ã€‚å¦‚æœä½ ä»¬åŒæ—¶å†²è¿›å»...å—¯ï¼Œç”»é¢å¤ªç¾ä¸æ•¢æƒ³è±¡ã€‚æ‰€ä»¥ä½ ä»¬ä¼šæ€ä¹ˆåšï¼Ÿè‚¯å®šæ˜¯å…ˆçœ‹çœ‹æœ‰æ²¡æœ‰äººï¼Œæ²¡äººæ‰è¿›å»ï¼Œç„¶ååé”é—¨ï¼Œç”¨å®Œäº†å†å¼€é—¨ã€‚</p>
<p>å¤šçº¿ç¨‹ç¨‹åºä¹Ÿä¸€æ ·ï¼ä¸åŒçš„çº¿ç¨‹å¯èƒ½ä¼šåŒæ—¶è®¿é—®åŒä¸€å—"åœ°ç›˜"ï¼ˆå…±äº«èµ„æºï¼‰ï¼Œå¦‚æœä¸åŠ æ§åˆ¶ï¼Œå°±ä¼šå‡ºç°æ•°æ®é”™ä¹±ã€ç¨‹åºå´©æºƒç­‰ä¸€ç³»åˆ—ç¾éš¾ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬çš„ä¸‰å…„å¼Ÿå°±é—ªäº®ç™»åœºäº†ï¼</p>
<h2 id="è€å¤§mutexäº’æ–¥é”">è€å¤§ï¼šmutexï¼ˆäº’æ–¥é”ï¼‰</h2>
<p><code>mutex</code>å°±åƒé‚£ä¸ªå«ç”Ÿé—´çš„é—¨é”ï¼Œå®ƒæ˜¯æœ€åŸºç¡€çš„åŒæ­¥å·¥å…·ï¼Œæ ¸å¿ƒåŠŸèƒ½å°±ä¸¤ä¸ªï¼šé”ä¸Š(<code>lock</code>)å’Œå¼€é”(<code>unlock</code>)ã€‚</p>
<p>æ¥çœ‹ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;mutex&gt;

std::mutex mtx;  // è¿™å°±æ˜¯æˆ‘ä»¬çš„"é—¨é”"
int shared_value = 0;  // è¿™æ˜¯æˆ‘ä»¬è¦ä¿æŠ¤çš„"å«ç”Ÿé—´"

void increment_value() {
    mtx.lock();  // è¿›å»ä¹‹å‰å…ˆé”é—¨
    std::cout &lt;&lt; "çº¿ç¨‹ " &lt;&lt; std::this_thread::get_id() &lt;&lt; " è¿›å…¥ä¸´ç•ŒåŒº" &lt;&lt; std::endl;
    
    // æƒ³è±¡è¿™æ˜¯ä¸ªå¾ˆå¤æ‚çš„æ“ä½œï¼Œéœ€è¦ä¸€äº›æ—¶é—´
    shared_value++;
    std::this_thread::sleep_for(std::chrono::milliseconds(100));
    
    std::cout &lt;&lt; "çº¿ç¨‹ " &lt;&lt; std::this_thread::get_id() &lt;&lt; " å³å°†ç¦»å¼€ï¼Œå…±äº«å€¼ä¸º: " &lt;&lt; shared_value &lt;&lt; std::endl;
    mtx.unlock();  // ç”¨å®Œäº†è®°å¾—å¼€é”ï¼Œè®©åˆ«äººèƒ½è¿›æ¥
}

int main() {
    std::thread t1(increment_value);
    std::thread t2(increment_value);
    
    t1.join();
    t2.join();
    
    return 0;
}
</code></pre>
<p>çœ‹ç€æŒºç®€å•å¯¹å§ï¼Ÿä½†è¿™æœ‰ä¸ªå¤§å‘â€”â€”å¦‚æœåœ¨<code>lock</code>å’Œ<code>unlock</code>ä¹‹é—´å‘ç”Ÿäº†å¼‚å¸¸ï¼Œæˆ–è€…ä½ å•çº¯å¿˜è®°äº†<code>unlock</code>ï¼Œé‚£ä¹ˆé”å°±æ°¸è¿œä¸ä¼šè¢«é‡Šæ”¾ï¼Œå…¶ä»–çº¿ç¨‹æ°¸è¿œè¿›ä¸äº†"å«ç”Ÿé—´"ï¼è¿™å°±æ˜¯ä¼ è¯´ä¸­çš„"æ­»é”"ã€‚</p>
<p>æ­£å› å¦‚æ­¤ï¼Œç›´æ¥ä½¿ç”¨<code>mutex</code>å¾ˆå®¹æ˜“å‡ºé”™ï¼Œæ‰€ä»¥C++11ç»™æˆ‘ä»¬æä¾›äº†æ›´æ™ºèƒ½çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 id="è€äºŒlock_guardä¿å®‰å¤§å“¥">è€äºŒï¼šlock_guardï¼ˆä¿å®‰å¤§å“¥ï¼‰</h2>
<p><code>lock_guard</code>å°±åƒä¸€ä¸ªé è°±çš„ä¿å®‰å¤§å“¥ã€‚å½“ä½ è¿›"å«ç”Ÿé—´"æ—¶ï¼Œä»–ä¼šè‡ªåŠ¨é”é—¨ï¼›å½“ä½ å‡ºæ¥æ—¶ï¼Œæ— è®ºæ˜¯æ­£å¸¸å‡ºæ¥è¿˜æ˜¯å› ä¸ºçªå‘æƒ…å†µï¼ˆå¼‚å¸¸ï¼‰è·‘å‡ºæ¥ï¼Œä»–éƒ½ä¼šè´Ÿè´£è§£é”ã€‚</p>
<p>çœ‹çœ‹ç”¨<code>lock_guard</code>å¦‚ä½•æ”¹å†™ä¸Šé¢çš„ä¾‹å­ï¼š</p>
<pre><code class="language-cpp">void safer_increment() {
    std::lock_guard&lt;std::mutex&gt; guard(mtx);  // ä¿å®‰ä¸Šå²—ï¼Œè‡ªåŠ¨é”é—¨
    
    std::cout &lt;&lt; "çº¿ç¨‹ " &lt;&lt; std::this_thread::get_id() &lt;&lt; " è¿›å…¥ä¸´ç•ŒåŒº" &lt;&lt; std::endl;
    
    // å³ä½¿è¿™é‡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œç¦»å¼€å‡½æ•°ä½œç”¨åŸŸæ—¶lock_guardä¹Ÿä¼šè‡ªåŠ¨è§£é”
    shared_value++;
    std::this_thread::sleep_for(std::chrono::milliseconds(100));
    
    std::cout &lt;&lt; "çº¿ç¨‹ " &lt;&lt; std::this_thread::get_id() &lt;&lt; " å³å°†ç¦»å¼€ï¼Œå…±äº«å€¼ä¸º: " &lt;&lt; shared_value &lt;&lt; std::endl;
    
    // ä¸éœ€è¦æ‰‹åŠ¨è§£é”ï¼Œguardç¦»å¼€ä½œç”¨åŸŸæ—¶ä¼šè‡ªåŠ¨è§£é”
}
</code></pre>
<p>æ˜¯ä¸æ˜¯ç®€å•å¤šäº†ï¼Ÿè¿™å°±æ˜¯RAIIï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰çš„é­…åŠ›â€”â€”èµ„æºçš„ç®¡ç†è·Ÿå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šåœ¨ä¸€èµ·ã€‚<code>lock_guard</code>ä¸€æ—¦åˆ›å»ºå°±ä¼šé”å®šäº’æ–¥é‡ï¼Œä¸€æ—¦é”€æ¯ï¼ˆç¦»å¼€ä½œç”¨åŸŸï¼‰å°±ä¼šè§£é”äº’æ–¥é‡ã€‚</p>
<p>ä¸è¿‡<code>lock_guard</code>æœ‰ä¸ªå±€é™æ€§ï¼šä¸€æ—¦ä¸Šé”ï¼Œåœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…ä½ å°±ä¸èƒ½æ‰‹åŠ¨è§£é”äº†ã€‚å°±åƒä½ è¯·äº†ä¸ªç‰¹åˆ«æ­»æ¿çš„ä¿å®‰ï¼Œä»–åšæŒè¦ç­‰ä½ å½»åº•ç¦»å¼€æ‰ä¼šå¼€é—¨ï¼Œä¸­é€”æƒ³å‡ºå»é€ä¸ªæ°”éƒ½ä¸è¡Œã€‚</p>
<h2 id="è€ä¸‰unique_lockä¸‡èƒ½ç®¡å®¶">è€ä¸‰ï¼šunique_lockï¼ˆä¸‡èƒ½ç®¡å®¶ï¼‰</h2>
<p>å¦‚æœè¯´<code>lock_guard</code>æ˜¯ä¿å®‰å¤§å“¥ï¼Œé‚£<code>unique_lock</code>å°±æ˜¯ä¸€ä¸ªé«˜çº§ç®¡å®¶ï¼Œä¸ä½†èƒ½è‡ªåŠ¨é”é—¨è§£é”ï¼Œè¿˜èƒ½æ ¹æ®ä½ çš„æŒ‡ä»¤éšæ—¶é”é—¨æˆ–å¼€é—¨ï¼Œç”šè‡³å¯ä»¥"å€Ÿ"é’¥åŒ™ç»™åˆ«äººã€‚</p>
<p>æ¥çœ‹ä¸ªä¾‹å­ï¼š</p>
<pre><code class="language-cpp">void flexible_operation() {
    std::unique_lock&lt;std::mutex&gt; superlock(mtx);  // é»˜è®¤æƒ…å†µä¸‹æ„é€ æ—¶ä¼šé”å®šmutex
    
    std::cout &lt;&lt; "çº¿ç¨‹ " &lt;&lt; std::this_thread::get_id() &lt;&lt; " å¼€å§‹å·¥ä½œ" &lt;&lt; std::endl;
    shared_value++;
    
    // å‡è®¾è¿™é‡Œä¸éœ€è¦é”äº†ï¼Œå¯ä»¥æå‰è§£é”
    superlock.unlock();
    std::cout &lt;&lt; "ä¸´æ—¶è§£é”ï¼Œæ‰§è¡Œä¸€äº›ä¸éœ€è¦ä¿æŠ¤çš„æ“ä½œ" &lt;&lt; std::endl;
    std::this_thread::sleep_for(std::chrono::milliseconds(50));
    
    // éœ€è¦å†æ¬¡è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œå¯ä»¥é‡æ–°ä¸Šé”
    superlock.lock();
    shared_value++;
    std::cout &lt;&lt; "çº¿ç¨‹ " &lt;&lt; std::this_thread::get_id() &lt;&lt; " å®Œæˆå·¥ä½œï¼Œå…±äº«å€¼ä¸º: " &lt;&lt; shared_value &lt;&lt; std::endl;
    
    // åŒæ ·ï¼Œä¸éœ€è¦æ‰‹åŠ¨è§£é”ï¼Œç¦»å¼€ä½œç”¨åŸŸæ—¶ä¼šè‡ªåŠ¨è§£é”ï¼ˆå¦‚æœå½“æ—¶å¤„äºé”å®šçŠ¶æ€ï¼‰
}
</code></pre>
<p>é™¤äº†æ‰‹åŠ¨<code>lock</code>å’Œ<code>unlock</code>ï¼Œ<code>unique_lock</code>è¿˜æœ‰æ›´å¤šé«˜çº§åŠŸèƒ½ï¼š</p>
<pre><code class="language-cpp">std::unique_lock&lt;std::mutex&gt; master_lock(mtx, std::defer_lock);  // åˆ›å»ºæ—¶ä¸é”å®š
if (master_lock.try_lock()) {  // å°è¯•é”å®šï¼Œå¦‚æœå¤±è´¥ä¹Ÿä¸ä¼šé˜»å¡
    std::cout &lt;&lt; "æˆåŠŸè·å–é”ï¼" &lt;&lt; std::endl;
} else {
    std::cout &lt;&lt; "è·å–é”å¤±è´¥ï¼Œä½†æˆ‘å¯ä»¥å»åšåˆ«çš„äº‹" &lt;&lt; std::endl;
}

// è¿˜å¯ä»¥é…åˆæ¡ä»¶å˜é‡ä½¿ç”¨
std::condition_variable cv;
std::unique_lock&lt;std::mutex&gt; lock(mtx);
cv.wait(lock, []{ return ready; });  // è¿™é‡Œä¼šè‡ªåŠ¨è§£é”å¹¶ç­‰å¾…æ¡ä»¶æ»¡è¶³
</code></pre>
<p><code>unique_lock</code>æ¯”<code>lock_guard</code>çµæ´»ï¼Œä½†ä¹Ÿä»˜å‡ºäº†ä¸€ç‚¹æ€§èƒ½ä»£ä»·ï¼Œå®ƒå†…éƒ¨éœ€è¦ç»´æŠ¤æ›´å¤šçŠ¶æ€ä¿¡æ¯ã€‚</p>
<h2 id="ä¸‰å…„å¼Ÿå¤§æ¯”æ‹¼">ä¸‰å…„å¼Ÿå¤§æ¯”æ‹¼</h2>
<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œæ¥ä¸ªç®€å•å¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>mutex</th>
<th>lock_guard</th>
<th>unique_lock</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ‰‹åŠ¨é”å®š/è§£é”</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âœ…</td>
</tr>
<tr>
<td>å¼‚å¸¸å®‰å…¨</td>
<td>âŒï¼ˆéœ€æ‰‹åŠ¨ä¿è¯ï¼‰</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>æ¡ä»¶å˜é‡é…åˆ</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âœ…</td>
</tr>
<tr>
<td>å°è¯•é”å®š(try_lock)</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âœ…</td>
</tr>
<tr>
<td>æ€§èƒ½å¼€é”€</td>
<td>æœ€å°</td>
<td>å¾ˆå°</td>
<td>ç¨å¤§</td>
</tr>
<tr>
<td>ä½¿ç”¨éš¾åº¦</td>
<td>å®¹æ˜“å‡ºé”™</td>
<td>ç®€å•å®‰å…¨</td>
<td>çµæ´»ä½†å¤æ‚</td>
</tr>
</tbody>
</table>
<h2 id="å®æˆ˜æ¨¡æ‹Ÿatmå–æ¬¾ä¸ç³»ç»Ÿç»´æŠ¤">å®æˆ˜ï¼šæ¨¡æ‹ŸATMå–æ¬¾ä¸ç³»ç»Ÿç»´æŠ¤</h2>
<p>æœ€åç”¨ä¸€ä¸ªè´´è¿‘ç”Ÿæ´»çš„ä¾‹å­æ¥å·©å›ºä¸€ä¸‹ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸ªATMç³»ç»Ÿï¼Œæ—¢è¦å¤„ç†ç”¨æˆ·å–æ¬¾ï¼Œåˆè¦å¤„ç†é“¶è¡Œçš„ç³»ç»Ÿç»´æŠ¤ï¼š</p>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;mutex&gt;
#include &lt;condition_variable&gt;

class ATMSystem {
private:
    double cash_available;  // ATMä¸­å¯ç”¨ç°é‡‘
    bool maintenance_mode;  // æ˜¯å¦å¤„äºç»´æŠ¤æ¨¡å¼
    std::mutex mtx;
    std::condition_variable cv;  // æ¡ä»¶å˜é‡ï¼Œç”¨äºç­‰å¾…ç»´æŠ¤ç»“æŸ

public:
    ATMSystem(double initial_cash) : cash_available(initial_cash), maintenance_mode(false) {}
    
    // ç”¨æˆ·å–æ¬¾æ“ä½œ
    bool withdraw(double amount) {
        // è¿™é‡Œå¿…é¡»ç”¨unique_lockï¼Œå› ä¸ºæ¡ä»¶å˜é‡waitéœ€è¦å®ƒ
        std::unique_lock&lt;std::mutex&gt; lock(mtx);
        
        // å¦‚æœATMæ­£åœ¨ç»´æŠ¤ä¸­ï¼Œç­‰å¾…ç»´æŠ¤ç»“æŸ
        cv.wait(lock, [this] { return !maintenance_mode; });
        
        // æ£€æŸ¥ä½™é¢å¹¶å–æ¬¾
        if (cash_available &gt;= amount) {
            std::this_thread::sleep_for(std::chrono::milliseconds(50));
            cash_available -= amount;
            std::cout &lt;&lt; "å–å‡º: " &lt;&lt; amount &lt;&lt; "ï¼ŒATMå‰©ä½™ç°é‡‘: " &lt;&lt; cash_available &lt;&lt; std::endl;
            return true;
        }
        
        std::cout &lt;&lt; "ATMç°é‡‘ä¸è¶³ï¼Œå–æ¬¾å¤±è´¥ï¼å½“å‰å‰©ä½™: " &lt;&lt; cash_available &lt;&lt; std::endl;
        return false;
    }
    
    // å¼€å§‹ç³»ç»Ÿç»´æŠ¤
    void start_maintenance() {
        std::lock_guard&lt;std::mutex&gt; guard(mtx);
        maintenance_mode = true;
        std::cout &lt;&lt; "ATMè¿›å…¥ç»´æŠ¤æ¨¡å¼ï¼Œæš‚åœæœåŠ¡" &lt;&lt; std::endl;
    }
    
    // ç»“æŸç³»ç»Ÿç»´æŠ¤
    void end_maintenance() {
        {
            std::lock_guard&lt;std::mutex&gt; guard(mtx);
            maintenance_mode = false;
            std::cout &lt;&lt; "ATMç»´æŠ¤å®Œæˆï¼Œæ¢å¤æœåŠ¡" &lt;&lt; std::endl;
        }
        // é€šçŸ¥æ‰€æœ‰ç­‰å¾…çš„å–æ¬¾çº¿ç¨‹
        cv.notify_all();
    }
    
    // è¡¥å……ç°é‡‘
    void refill_cash(double amount) {
        std::lock_guard&lt;std::mutex&gt; guard(mtx);
        cash_available += amount;
        std::cout &lt;&lt; "ATMè¡¥å……ç°é‡‘: " &lt;&lt; amount &lt;&lt; "ï¼Œå½“å‰æ€»ç°é‡‘: " &lt;&lt; cash_available &lt;&lt; std::endl;
    }
};

// æ¨¡æ‹Ÿç”¨æˆ·çº¿ç¨‹
void user_thread(ATMSystem&amp; atm, int user_id) {
    std::cout &lt;&lt; "ç”¨æˆ· " &lt;&lt; user_id &lt;&lt; " å°è¯•å–æ¬¾..." &lt;&lt; std::endl;
    atm.withdraw(100);
}

// æ¨¡æ‹Ÿç»´æŠ¤çº¿ç¨‹
void maintenance_thread(ATMSystem&amp; atm) {
    std::this_thread::sleep_for(std::chrono::milliseconds(20));
    atm.start_maintenance();
    
    // æ‰§è¡Œç»´æŠ¤æ“ä½œ
    std::this_thread::sleep_for(std::chrono::milliseconds(300));
    atm.refill_cash(500);
    
    // ç»´æŠ¤ç»“æŸ
    atm.end_maintenance();
}

int main() {
    ATMSystem atm(300);  // åˆå§‹ç°é‡‘300å…ƒ
    
    // å¯åŠ¨ä¸€ä¸ªç»´æŠ¤çº¿ç¨‹å’Œå¤šä¸ªç”¨æˆ·çº¿ç¨‹
    std::thread maint(maintenance_thread, std::ref(atm));
    
    std::vector&lt;std::thread&gt; users;
    for (int i = 1; i &lt;= 5; ++i) {
        users.push_back(std::thread(user_thread, std::ref(atm), i));
    }
    
    // ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ
    maint.join();
    for (auto&amp; t : users) {
        t.join();
    }
    
    return 0;
}
</code></pre>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<ol>
<li><strong>mutex</strong>ï¼šæœ€åŸºç¡€çš„é”ï¼Œéœ€è¦æ‰‹åŠ¨é”å®šå’Œè§£é”ï¼Œç”¨ä¸å¥½å®¹æ˜“å‡ºé—®é¢˜ï¼Œå°±åƒè‡ªå·±ç®¡ç†å«ç”Ÿé—´é—¨é”ã€‚</li>
<li><strong>lock_guard</strong>ï¼šç®€å•å®‰å…¨çš„è‡ªåŠ¨é”ï¼Œæ„é€ æ—¶é”å®šï¼Œææ„æ—¶è§£é”ï¼Œä½†ä¸èƒ½ä¸­é€”æ“ä½œé”çŠ¶æ€ï¼Œå°±åƒè¯·äº†ä¸ªæ­»æ¿ä½†å¯é çš„ä¿å®‰ã€‚</li>
<li><strong>unique_lock</strong>ï¼šåŠŸèƒ½æœ€å…¨é¢çš„é”åŒ…è£…å™¨ï¼Œçµæ´»æ€§æœ€é«˜ï¼Œä½†æœ‰è½»å¾®çš„æ€§èƒ½å¼€é”€ï¼Œå°±åƒä¸€ä¸ªä¸‡èƒ½çš„ç®¡å®¶ã€‚</li>
</ol>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>ç®€å•åœºæ™¯ï¼Œä¼˜å…ˆä½¿ç”¨<code>lock_guard</code></li>
<li>éœ€è¦æ¡ä»¶å˜é‡æˆ–çµæ´»é”å®š/è§£é”æ—¶ï¼Œä½¿ç”¨<code>unique_lock</code></li>
<li>å¯¹æ€§èƒ½æåº¦æ•æ„Ÿçš„åœºæ™¯ï¼Œè€ƒè™‘ç›´æ¥ä½¿ç”¨<code>mutex</code>ï¼Œä½†è¦éå¸¸å°å¿ƒ</li>
</ul>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½è®©ä½ å¯¹C++11çš„åŒæ­¥å·¥å…·æœ‰ä¸ªæ¸…æ™°çš„è®¤è¯†ã€‚å¤šçº¿ç¨‹ä¸å†å¯æ€•ï¼Œç†Ÿç»ƒæŒæ¡è¿™"ä¸‰å…„å¼Ÿ"ï¼Œä½ å°±èƒ½å†™å‡ºå®‰å…¨é«˜æ•ˆçš„å¹¶å‘ç¨‹åºå•¦ï¼</p>
<h3 id="-åŠ é”ä¸è¿·è·¯cæŠ€æœ¯ä¸€èµ·å­¦">ğŸ”’ åŠ é”ä¸è¿·è·¯ï¼ŒC++æŠ€æœ¯ä¸€èµ·å­¦ï¼ğŸ”’</h3>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œåˆ«å¿˜äº†ç‚¹èµã€æ”¶è—ã€å…³æ³¨å“¦~ ï¼Œæ”¯æŒä¸€ä¸‹ï¼ä½ çš„æ¯ä¸€æ¬¡äº’åŠ¨ï¼Œéƒ½æ˜¯æˆ‘ç»§ç»­åˆ›ä½œçš„åŠ¨åŠ›ï¼</p>
<p>æœ‰ç–‘é—®ï¼Ÿæœ‰ç»éªŒæƒ³åˆ†äº«ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºå’Œå¤§å®¶ä¸€èµ·è®¨è®ºï¼Œæˆ‘ä¼šä¸€ä¸€å›å¤ï¼</p>
<p><strong>ğŸ‘‰ å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œè·Ÿç€å°åº·å­¦ç¼–ç¨‹ã€</strong>ï¼Œè¿™é‡Œæ²¡æœ‰ç”Ÿæ¶©éš¾æ‡‚çš„ä»£ç è®²è§£ï¼Œåªæœ‰æ¥åœ°æ°”çš„ç¼–ç¨‹çŸ¥è¯†å’ŒæŠ€å·§ï¼</p>
<p><strong>åœ¨æˆ‘çš„"å…¬ä¼—å·"é‡Œï¼Œä½ å°†è·å¾—ï¼š</strong></p>
<ul>
<li>ğŸ¯ C++é¢è¯•å®å…¸ï¼šé¢è¯•å¸¸è€ƒç‚¹ä¸€ç½‘æ‰“å°½ï¼ŒHRç›´å‘¼"å°±æ˜¯ä½ äº†"</li>
<li>ğŸ§© STLæºç æ¢ç§˜ï¼šåƒå‰¥æ´‹è‘±ä¸€æ ·å±‚å±‚è§£æï¼Œå¤§ç¥æ€è·¯å°½æ”¶çœ¼åº•</li>
<li>âš¡ æ€§èƒ½è°ƒä¼˜ç§˜ç±ï¼šè®©ä½ çš„ä»£ç æ¯”åŒäº‹å¿«10å€ï¼ŒåŒäº‹ç›´å‘¼"666"</li>
<li>ğŸš€ å¤§å‚é¡¹ç›®å®æˆ˜ï¼šçœŸå®é¡¹ç›®ç»éªŒåˆ†äº«ï¼Œå°‘èµ°å¼¯è·¯äº‹åŠåŠŸå€</li>
<li>ğŸ§ Linuxå¼€å‘æŠ€å·§ï¼šæœåŠ¡å™¨ç¼–ç¨‹ä»å…¥é—¨åˆ°ç²¾é€š</li>
</ul>
<p><strong>æ¯å‘¨æŒç»­æ›´æ–°ï¼ŒçŸ¥è¯†å¹²è´§åœä¸ä¸‹æ¥ï¼</strong></p>
<p>è®°å¾—ã€Œ<strong>è½¬å‘</strong>ã€ç»™æ›´å¤šéœ€è¦çš„æœ‹å‹ï¼Œè®©æˆ‘ä»¬ä¸€èµ·åœ¨ä»£ç ä¸–ç•Œé‡Œå¿«ä¹æˆé•¿ï¼ä¸‹æœŸç²¾å½©å†…å®¹ï¼Œä¸è§ä¸æ•£~</p>
<h4 id="æ€ä¹ˆå…³æ³¨æˆ‘çš„å…¬ä¼—å·">æ€ä¹ˆå…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼Ÿ</h4>
<p><strong>æ‰«ç å³å¯å…³æ³¨</strong>ã€‚</p>
<p><img src="https://files.mdnice.com/user/71186/0dde803d-d52f-4ed8-b74b-b7f3da5817b9.png" alt="" loading="lazy"></p>
<p>å“¦å¯¹äº†ï¼Œæˆ‘è¿˜å»ºäº†ä¸ªæŠ€æœ¯äº¤æµç¾¤ï¼Œå¤§å®¶ä¸€èµ·èŠæŠ€æœ¯ã€è§£ç­”é—®é¢˜ã€‚å¡å£³äº†ï¼Ÿä¸æ‡‚çš„åœ°æ–¹ï¼Ÿéšæ—¶åœ¨ç¾¤é‡Œæé—®ï¼ä¸åªæ˜¯æˆ‘ï¼Œç¾¤é‡Œè¿˜æœ‰ä¸€å †æŠ€æœ¯å¤§ä½¬éšæ—¶å‡†å¤‡å¸®ä½ è§£æƒ‘ã€‚ä¸€èµ·å­¦ï¼Œæ‰æœ‰åŠ¨åŠ›å˜›ï¼</p>
<p><img src="https://files.mdnice.com/user/48364/971ccaa3-8f57-4e33-8bc9-d0863eeade81.png" alt="" loading="lazy"></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.05302191309837963" data-date-created="BlogServer.Application.Dto.BlogPost.BlogPostDto" data-date-updated="2025-05-25 13:02">2025-05-25 13:02</span>&nbsp;
<a href="https://www.cnblogs.com/xiaokang-coding">æ±Ÿå°åº·</a>&nbsp;
é˜…è¯»(<span id="post_view_count">3</span>)&nbsp;
è¯„è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(18895297);return false;">æ”¶è—</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '18895297', targetLink: 'https://www.cnblogs.com/xiaokang-coding/p/18895297', title: 'ã€Œç¡¬æ ¸ç§‘æ™®ã€C++11é”æœºåˆ¶ä¸‰å…„å¼Ÿå¤§æ¯”æ‹¼ï¼šmutexã€lock_guardä¸unique_lock' })">ä¸¾æŠ¥</a>
</div>
        